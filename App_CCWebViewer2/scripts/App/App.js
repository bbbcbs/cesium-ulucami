/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ToolId.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/App/ToolId.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Matrix3.js 
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Cartesian3.js 
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/InputSource.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/InputEventModifiers.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/Button.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ButtonEvent.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/Tool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/extend.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/PrimitiveTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/Element.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/PickTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/SelectionTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Range3.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/NpcCorners.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/Frustum.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Constants.js 
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/AnimatorState.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/BeDuration.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/ViewportAnimator.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewToolSettings.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewTool.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Cartesian2.js 
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/WindowAreaTool.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/foreach.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewManipHitPriority.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewHandleType.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewHandleArray.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/Cursor.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewingToolHandle.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/dynamicCast.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Matrix3.js 
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/StandardView.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/StandardViewMatrices.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/View.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/SpatialView.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/CameraInfo.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/CameraView.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Matrix4.js 
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/CoordSystem.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewPan.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewRotate.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/OrientationResult.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/NavigateMode.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/NavigateMotion.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewNavigate.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewWalk.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewManip.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/FitViewTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewWalkTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ToolFactory.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/App/ToolFactory.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/requestJson.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: App/RDS.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/OrthoView.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/View2d.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/DrawingView.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/isCollectionEmpty.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/SelectionSet.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/ViewFactory.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/ViewRect.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Math/Map4.js 
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/MouseWheelEvent.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/GestureId.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/GestureInfo.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewGestureTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/RotatePanZoomGestureTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ViewIdleTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/GestureEvent.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/CameraController.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/getFunction.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ToolAdmin.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Util/functionDefined.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/SelectionSetStyler.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/TilesetStyler.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/PropertyVisibilityStyler.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/Viewport.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/Model.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/DrawingModel.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/SpatialModel.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/ModelFactory.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bim/Bim.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/ElementSetTool.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Tools/StandardViewRotationTool.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/PropertyGrid.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/PropertyVisibilityList.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ModelVisibilityList.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/SettingsWidget.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/Toolbar.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ToolbarButton.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ViewList.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ZoneWidget.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/Action.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ToolAction.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ViewHistoryAction.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/Spinner.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/BaseLayerPickerWidget.js $ test
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ModelMarker.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/ViewLinkWidget.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Widgets/Viewer.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/ModelGeometry.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Scene/BimGeometry.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/Bentley/Bentley.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/**
 * math.js
 * https://github.com/josdejong/mathjs
 *
 * Math.js is an extensive math library for JavaScript and Node.js,
 * It features real and complex numbers, units, matrices, a large set of
 * mathematical functions, and a flexible expression parser.
 *
 * @version 3.13.3
 * @date    2017-05-27
 *
 * @license
 * Copyright (C) 2013-2017 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */

/**
 * @license Complex.js v2.0.1 11/02/2016
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/

/**
 * @license Fraction.js v4.0.0 09/09/2015
 * http://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/App/main.js $
|
|  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------+
|
|     $Source: TilePublisher/lib/scripts/App/App.js $
|
|  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
|
+--------------------------------------------------------------------------------------*/

define("scripts/Bentley/Tools/ToolId",[],function(){var e={Selection:"Bim.Selection",WindowArea:"Bim.WindowArea",FitView:"Bim.FitView",Default:"Bim.Default",Idle:"Bim.Idle",ViewManip:"Bim.ViewManip",StandardViewRotation:"Bim.StandardViewRotation",Gesture:"Bim.Gesture",Walk:"Bim.Walk"};return e}),define("scripts/App/ToolId",["../Bentley/Tools/ToolId"],function(e){return e.Rotate="App.Rotate",e.Pan="App.Pan",e.Default="App.Default",e.MeasurePosition="App.MeasurePosition",e.MeasureDistance="App.MeasureDistance",e.MeasureArea="App.MeasureArea",e}),define("scripts/Bentley/Math/Angle",[],function(){var e={};return e.cyclic3dAxis=function(e){return 0<=e?e<3?e:e%3:e>-3?3+e:2-(-1-e)%3},e.atan2=function(e,t){return 0==t&&0==e?0:Math.atan2(e,t)},e}),define("scripts/Bentley/Math/Cartesian3",["./Angle"],function(e){function t(e,t,n){return n=Cesium.defaultValue(n,1e-15),Math.abs(t)>n*Math.abs(e)?e/t:void 0}Cesium.Cartesian3.prototype.init=function(e,t,n){Cesium.Cartesian3.fromElements(e,t,n,this)},Cesium.Cartesian3.prototype.zero=function(){this.init(0,0,0)},Cesium.Cartesian3.prototype.normalize=function(){var e=this.magnitude();if(e>0){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=1,this.y=0,this.z=0,e=0;return e},Cesium.Cartesian3.prototype.crossProduct=function(e,t){Cesium.Cartesian3.cross(e,t,this)},Cesium.Cartesian3.fromCrossProduct=function(e,t,n){var r=Cesium.defined(n)?n:new Cesium.Cartesian3;return r.crossProduct(e,t),r},Cesium.Cartesian3.prototype.normalizedDifference=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.normalize()},Cesium.Cartesian3.prototype.normalizedCrossProduct=function(e,t){return this.crossProduct(e,t),this.normalize()},Cesium.Cartesian3.prototype.negate=function(){Cesium.Cartesian3.negate(this,this)},Cesium.Cartesian3.prototype.sumOf=function(e,t,n){n=Cesium.defaultValue(n,1),this.x=e.x+t.x*n,this.y=e.y+t.y*n,this.z=e.z+t.z*n},Cesium.Cartesian3.prototype.sumOf2ScaledVectors=function(e,t,n,r,i){this.x=e.x+t.x*n+r.x*i,this.y=e.y+t.y*n+r.y*i,this.z=e.z+t.z*n+r.z*i},Cesium.Cartesian3.prototype.sumOf3ScaledVectors=function(e,t,n,r,i,o,a){this.x=e.x+t.x*n+r.x*i+o.x*a,this.y=e.y+t.y*n+r.y*i+o.y*a,this.z=e.z+t.z*n+r.z*i+o.z*a},Cesium.Cartesian3.prototype.add=function(e){Cesium.Cartesian3.add(this,e,this)},Cesium.Cartesian3.prototype.scaleByVector=function(e,t){this.x=e.x,this.y=e.y,this.z=e.z,this.scale(t)},Cesium.Cartesian3.prototype.scale=function(e){this.x*=e,this.y*=e,this.z*=e},Cesium.Cartesian3.fromSumOf=function(e,t,n,r){var i=Cesium.defined(r)?r:new Cesium.Cartesian3;return i.sumOf(e,t,n),i},Cesium.Cartesian3.prototype.magnitude=function(){return Cesium.Cartesian3.magnitude(this)},Cesium.Cartesian3.prototype.magnitudeXY=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Cesium.Cartesian3.prototype.differenceOf=function(e,t){return Cesium.Cartesian3.subtract(e,t,this)},Cesium.Cartesian3.prototype.subtract=function(e){Cesium.Cartesian3.subtract(this,e,this)},Cesium.Cartesian3.fromDifferenceOf=function(e,t,n){var r=Cesium.defined(n)?n:new Cesium.Cartesian3;return r.differenceOf(e,t),r},Cesium.Cartesian3.fromStartEnd=function(e,t,n){return Cesium.defined(n)||(n=new Cesium.Cartesian3),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},Cesium.Cartesian3.fromInterpolate=function(e,t,n){var r=new Cesium.Cartesian3;return r.interpolate(e,t,n),r},Cesium.Cartesian3.prototype.dot=function(e){return Cesium.Cartesian3.dot(this,e)},Cesium.Cartesian3.prototype.interpolate=function(e,t,n){if(t<0||t>1)throw new Cesium.DeveloperError("Fraction must be in [0.0..1.0]");var r=e;t>.5&&(r=n,t-=1),this.x=r.x+t*(n.x-e.x),this.y=r.y+t*(n.y-e.y),this.z=r.z+t*(n.z-e.z)},Cesium.Cartesian3.prototype.tripleProduct=function(e,t){return this.x*(e.y*t.z-e.z*t.y)+this.y*(e.z*t.x-e.x*t.z)+this.z*(e.x*t.y-e.y*t.x)},Cesium.Cartesian3.prototype.copyFrom=function(e){Cesium.Cartesian3.clone(e,this)},Cesium.Cartesian3.prototype.getNormalizedTriad=function(e,t,n){var r=this.magnitude(),i=r/64;if(0==r)return e.copyFrom(Cesium.Cartesian3.UNIT_X),t.copyFrom(Cesium.Cartesian3.UNIT_Y),n.copyFrom(Cesium.Cartesian3.UNIT_Z),!1;n.copyFrom(this);var o=new Cesium.Cartesian3;return Math.abs(n.x)<i&&Math.abs(n.y)<i?o.y=1:o.z=1,e.crossProduct(o,n),t.crossProduct(n,e),e.normalize(),t.normalize(),n.normalize(),!0},Cesium.Cartesian3.prototype.distanceSquaredXY=function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},Cesium.Cartesian3.prototype.distanceXY=function(e){return Math.sqrt(this.distanceSquaredXY(e))},Cesium.Cartesian3.prototype.distance=function(e){return Cesium.Cartesian3.distance(this,e)},Cesium.Cartesian3.prototype.scaleToLength=function(e){var t=this.normalize();return this.scale(e),t},Cesium.Cartesian3.fromScale=function(e,t){return new Cesium.Cartesian3(e.x*t,e.y*t,e.z*t)},Cesium.Cartesian3.prototype.initFromScaledVector=function(e,t){this.init(e.x*t,e.y*t,e.z*t)},Cesium.Cartesian3.fromObject=function(e){return new Cesium.Cartesian3(e.x,e.y,e.z)};var n=new Cesium.Cartesian3;return Cesium.Cartesian3.prototype.angleTo=function(t){var r=n;r.crossProduct(this,t);var i=r.magnitude(),o=this.dot(t);return e.atan2(i,o)},Cesium.Cartesian3.prototype.tryNormalizeFrom=function(e){var n=e.magnitude(),r=t(1,n);return Cesium.defined(r)?(this.initFromScaledVector(e,r),n):void this.init(1,0,0)},Cesium.Cartesian3.prototype.angleAndAxisOfRotationFromVectorToVector=function(t){var n=new Cesium.Cartesian3,r=n.tryNormalizeFrom(this);if(Cesium.defined(r)){var i=new Cesium.Cartesian3,o=i.tryNormalizeFrom(t);if(Cesium.defined(o)){var a=new Cesium.Cartesian3,s=n.dot(i);a.crossProduct(n,i);var u,c=new Cesium.Cartesian3,l=c.tryNormalizeFrom(a);if(Cesium.defined(l))u=e.atan2(l,s);else{var f=new Cesium.Cartesian3,h=new Cesium.Cartesian3,p=new Cesium.Cartesian3;n.getNormalizedTriad(f,h,p),u=s<0?Math.PI:0}return{radians:u,axis:c}}}},Cesium.Cartesian3.prototype.isEqual=function(e,t){return Cesium.defined(t)?Math.abs(this.x-e.x)<=t&&Math.abs(this.y-e.y)<=t&&Math.abs(this.z-e.z)<=t:this.equals(e)},Cesium.Cartesian3.prototype.isZero=function(){return this.equals(Cesium.Cartesian3.ZERO)},Cesium.Cartesian3}),define("scripts/Bentley/Tools/InputSource",[],function(){var e={Unknown:0,Mouse:1,Touch:2};return e}),define("scripts/Bentley/Bim/InputEventModifiers",[],function(){var e={None:0,Control:1,Shift:4};return e}),define("scripts/Bentley/Tools/Button",[],function(){var e={Data:0,Reset:1,Middle:2};return e}),define("scripts/Bentley/Tools/ButtonEvent",["../Math/Cartesian3","./InputSource","../Bim/InputEventModifiers","./Button"],function(e,t,n,r){function i(){this.point=new e,this.viewPoint=new e,this.keyModifiers=n.None,this.isDoubleClick=!1,this.isDown=!1,this.button=r.Data,this.inputSource=t.Unknown,this.actualInputSource=t.Unknown}return i.prototype.initEvent=function(e,i,o,a,s,u,c,l){this.setPoint(e),this.setViewPoint(i),this.viewport=o,this.keyModifiers=Cesium.defaultValue(a,n.None),this.button=Cesium.defaultValue(s,r.Data),this.isDown=Cesium.defaultValue(u,!0),this.isDoubleClick=Cesium.defaultValue(c,!1),this.inputSource=Cesium.defaultValue(l,t.Unknown),this.actualInputSource=this.inputSource},i.prototype.clone=function(e){var t=Cesium.defined(e)?e:new i;return t.copyFrom(this),t},i.prototype.copyFrom=function(e){this.setPoint(e.point),this.setViewPoint(e.viewPoint),this.keyModifiers=e.keyModifiers,this.isDoubleClick=e.isDoubleClick,this.isDown=e.isDown,this.button=e.button,this.inputSource=e.inputSource,this.actualInputSource=e.actualInputSource,this.viewport=e.viewport},i.prototype.setPoint=function(e){this.point.copyFrom(e)},i.prototype.setViewPoint=function(e){this.viewPoint.copyFrom(e)},i.prototype.reset=function(){this.viewport=void 0},Cesium.defineProperties(i.prototype,{isControlKey:{get:function(){return 0!=(this.keyModifiers&n.Control)}},isShiftKey:{get:function(){return 0!=(this.keyModifiers&n.Shift)}}}),i}),define("scripts/Bentley/Tools/Tool",["./ButtonEvent"],function(e){function t(e,t){this.viewport=e,this.id=t}return Cesium.defineProperties(t.prototype,{toolAdmin:{get:function(){return this.viewport.toolAdmin}}}),t.prototype.installTool=function(){return this.installToolImplementation()},t.prototype.onPostInstall=function(){},t.prototype.onInstall=function(){return!0},t.prototype.onDataButtonDown=function(e){throw new Cesium.DeveloperError("onDataButtonDown must be implemented")},t.prototype.onDataButtonUp=function(e){return!1},t.prototype.onResetButtonDown=function(e){return!1},t.prototype.onResetButtonUp=function(e){return!1},t.prototype.onMiddleButtonDown=function(e){return!1},t.prototype.onMiddleButtonUp=function(e){return!1},t.prototype.onModelMotion=function(e){},t.prototype.onModelNoMotion=function(e){},t.prototype.onModelMotionStopped=function(e){},t.prototype.onModelStartDrag=function(e){return!1},t.prototype.onModelEndDrag=function(e){return this.onDataButtonDown(e)},t.prototype.onMouseWheel=function(e){return!1},t.prototype.exitTool=function(){throw new Cesium.DeveloperError("exitTool must be implemented")},t.prototype.onCleanup=function(){},t.prototype.onViewportResized=function(){},t.prototype.updateDynamics=function(e){},t.prototype.onTouchMotionPaused=function(){return!1},t.prototype.onEndGesture=function(e){return!1},t.prototype.onSingleFingerMove=function(e){return!1},t.prototype.onMultiFingerMove=function(e){return!1},t.prototype.onTwoFingerTap=function(e){return!1},t.prototype.onPressAndTap=function(e){return!1},t.prototype.onSingleTap=function(e){return!1},t.prototype.onDoubleTap=function(e){return!1},t.prototype.onLongPress=function(e){return!1},t.prototype.getCurrentButtonEvent=function(t){var n=Cesium.defined(t)?t:new e(this.viewport);return this.toolAdmin.fillEventFromCursorLocation(n),n},t}),define("scripts/Bentley/Util/extend",[],function(){var e=function(e,t){var n=t.prototype;t.prototype=Object.create(e.prototype);for(var r in n)t.prototype[r]=n[r];Object.defineProperty(t.prototype,"constructor",{enumerable:!1,value:t})};return e}),define("scripts/Bentley/Tools/PrimitiveTool",["./Tool","../Util/extend"],function(e,t){function n(t,n){e.call(this,t,n)}return t(e,n),n.prototype.installToolImplementation=function(){return this.toolAdmin.startPrimitiveTool(this),this.toolAdmin.setPrimitiveTool(this),this.toolAdmin.onPostInstallTool(this),!0},n.prototype.exitTool=function(){this.toolAdmin.startDefaultTool()},n.prototype.onSuspended=function(){},n.prototype.onResumed=function(){},n}),define("scripts/Bentley/Bim/Element",[],function(){function e(e,t,n){this.elementId=e,this.modelId=t,this.categoryId=n}return e.isValidElement=function(e){return Cesium.defined(e)&&Cesium.defined(e.elementId)},e}),define("scripts/Bentley/Tools/PickTool",["./PrimitiveTool","../Util/extend","../Bim/InputEventModifiers","../Bim/Element","./InputSource"],function(e,t,n,r,i){function o(t,n){e.call(this,t,n);this.flashDelay=250,this.tooltipDelay=500,this.lastMotion=Date.now();var r=document.createElement("div");r.className="bim-hidden",t.canvas.parentElement.appendChild(r),this.tooltip=r}return t(e,o),o.prototype.getPickModifiers=function(){return n.None},o.prototype.onPick=function(e,t){throw new Cesium.DeveloperError("onPick must be implemented")},o.prototype.onDataButtonDown=function(e){if(n.None!=e.keyModifiers&&n.None==(e.keyModifiers&this.getPickModifiers()))return!1;var t=this.viewport.pickElement(e.viewPoint);return this.onPick(t,e)},o.prototype.onModelMotion=function(e){return this.clearMouseovered(),!0},o.prototype.onModelNoMotion=function(e){return this.onModelMotionStopped(e)},o.prototype.onModelMotionStopped=function(e){if(i.Mouse==e.inputSource){var t=Date.now()-this.lastMotion,n=!this.haveFlashed&&t>this.flashDelay,o=!this.haveTooltip&&t>this.tooltipDelay;if(!n&&!o)return!0;var a=this.viewport.pickEntity(e.viewPoint),s=this.viewport.pickedEntityToElement(a),u=!1;if(!r.isValidElement(s)&&!n){var c=this.viewport.pickedEntityToModelId(a);Cesium.defined(c)&&(u=!0,s={modelId:c})}return n?(this.haveFlashed=!0,this.viewport.selectionSet.setFlashed(s),!0):(this.haveTooltip=!0,this.clearTooltip(),Cesium.defined(s)&&this.updateTooltip(e.viewPoint,s,u),!0)}},o.prototype.updateTooltip=function(e,t,n){n?this.populateDefaultTooltip(this.tooltip,e,t):this.populateTooltip(this.tooltip,e,t),this.tooltip.firstChild&&(this.tooltip.style.left=e.x+10+"px",this.tooltip.style.top=e.y+20+"px",this.tooltip.className="bim-viewer-tooltip")},o.prototype.populateDefaultTooltip=function(e,t,n){var r=this.viewport.bim,i=Cesium.defined(n.categoryId)?r.categories[n.categoryId]:void 0,o=Cesium.defined(n.modelId)?r.models[n.modelId].name:void 0;if(Cesium.defined(i)){var a=document.createElement("div");a.textContent="Category: "+i,e.appendChild(a)}if(Cesium.defined(o)){var s=document.createElement("div");s.textContent="Model: "+o,e.appendChild(s)}},o.prototype.populateTooltip=function(e,t,n){this.populateDefaultTooltip(e,t,n)},o.prototype.onCleanup=function(){this.clearMouseovered()},o.prototype.clearMouseovered=function(){this.lastMotion=Date.now(),this.haveFlashed=this.haveTooltip=!1,this.clearTooltip(),this.viewport.selectionSet.setFlashed(void 0)},o.prototype.clearTooltip=function(){if(Cesium.defined(this.tooltip)){for(;this.tooltip.firstChild;)this.tooltip.removeChild(this.tooltip.firstChild);this.tooltip.className="bim-hidden"}},o.prototype.onSuspended=function(){this.clearMouseovered()},o.prototype.onResumed=function(){this.clearMouseovered()},o}),define("scripts/Bentley/Tools/SelectionTool",["./PickTool","../Util/extend","./ToolId","../Bim/InputEventModifiers"],function(e,t,n,r){function i(t){e.call(this,t,n.Selection)}return t(e,i),i.prototype.getPickModifiers=function(){return r.Control},i.prototype.onCleanup=function(){this.viewport.selectionSet.clear(),e.prototype.onCleanup.call(this)},i.prototype.onPick=function(e,t){var n=this.viewport.selectionSet;return t.isControlKey?n.toggleElement(e):n.setSelectedElement(e),!0},i}),define("scripts/Bentley/Math/Range3",["./Cartesian3"],function(e){function t(t,n){this.low=Cesium.defined(t)?t.clone():new e,this.high=Cesium.defined(n)?n.clone():new e}return t.from2Points=function(e,n,r){var i=Cesium.defined(r)?r:new t;return i.initFrom2Points(e,n),i},t.prototype.volume=function(){return Cesium.defined(this.low)&&Cesium.defined(this.high)?(this.high.x-this.low.x)*(this.high.y-this.low.y)*(this.high.z-this.low.z):0},t.prototype.initFrom2Points=function(e,t){this.low=e.clone(this.low),this.high=e.clone(this.high),this.extend(t)},t.fromArray=function(e){for(var n=e.length,r=n>0?e[0]:void 0,i=n>1?e[1]:r,o=new t(r,i),a=2;a<e.length;a++)o.extend(e[a]);return o},t.prototype.extend=function(e){var t=this.low,n=this.high;t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.z=Math.min(t.z,e.z),n.x=Math.max(n.x,e.x),n.y=Math.max(n.y,e.y),n.z=Math.max(n.z,e.z)},t.prototype.union=function(e){this.extend(e.low),this.extend(e.high)},t.fromUnionOf=function(e,t){var n=e.clone();return n.union(t.clone()),n},t.prototype.getCenter=function(t){var n=Cesium.defined(t)?t:new e;return n.x=this.low.x+(this.high.x-this.low.x)/2,n.y=this.low.y+(this.high.y-this.low.y)/2,n.z=this.low.z+(this.high.z-this.low.z)/2,n},t.prototype.get8Corners=function(){for(var t=[this.low.clone(),this.high.clone()],n=[new e,new e,new e,new e,new e,new e,new e,new e],r=0,i=0;i<2;i++)for(var o=0;o<2;o++)for(var a=0;a<2;a++)n[r].x=t[a].x,n[r].y=t[o].y,n[r].z=t[i].z,r++;return n},t.prototype.copyFrom=function(e){this.low.copyFrom(e.low),this.high.copyFrom(e.high)},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},Cesium.defineProperties(t.prototype,{diagonalDistance:{get:function(){return this.low.distance(this.high)}}}),t}),define("scripts/Bentley/Bim/NpcCorners",["../Math/Cartesian3"],function(e){var t={LeftBottomRear:0,RightBottomRear:1,LeftTopRear:2,RightTopRear:3,LeftBottomFront:4,RightBottomFront:5,LeftTopFront:6,RightTopFront:7,CornerCount:8,First:0,Last:7,NPC_000:0,NPC_100:1,NPC_010:2,NPC_110:3,NPC_001:4,NPC_101:5,NPC_011:6,NPC_111:7,Corners:[new e(0,0,0),new e(1,0,0),new e(0,1,0),new e(1,1,0),new e(0,0,1),new e(1,0,1),new e(0,1,1),new e(1,1,1)]};return t}),define("scripts/Bentley/Bim/Frustum",["../Math/Cartesian3","../Math/Range3","./NpcCorners"],function(e,t,n){function r(){this.pts=[new e,new e,new e,new e,new e,new e,new e,new e]}return r.clone=function(t,n){Cesium.defined(n)||(n=new r);for(var i=0;i<t.pts.length;i++)e.clone(t.pts[i],n.pts[i]);return n},r.prototype.clone=function(e){return r.clone(this,e)},r.prototype.copyFrom=function(e){e.clone(this)},r.prototype.getCorner=function(e){if(e<0||e>7)throw new Cesium.DeveloperError("Invalid Index");return this.pts[e]},r.prototype.multiply=function(e){e.multiplyArray(this.pts)},r.prototype.translate=function(e){for(var t=0;t<this.pts.length;t++)this.pts[t].add(e)},r.prototype.transformBy=function(e,t){return Cesium.defined(t)||(t=new r),e.multiplyArray(this.pts,t.pts),t},r.prototype.toRange=function(){return t.fromArray(this.pts)},r.prototype.invalidate=function(){for(var e=0;e<this.pts.length;e++){var t=this.pts[e];t.x=t.y=t.z=0}},r.prototype.equals=function(e){for(var t=0;t<this.pts.length;t++)if(!this.pts[t].equals(e.pts[t]))return!1;return!0},r.fromRange=function(e){var t=new r;return t.initFromRange(e),t},r.prototype.initFromRange=function(e){this.pts[0].x=this.pts[3].x=this.pts[4].x=this.pts[7].x=e.low.x,this.pts[1].x=this.pts[2].x=this.pts[5].x=this.pts[6].x=e.high.x,this.pts[0].y=this.pts[1].y=this.pts[4].y=this.pts[5].y=e.low.y,this.pts[2].y=this.pts[3].y=this.pts[6].y=this.pts[7].y=e.high.y,this.pts[0].z=this.pts[1].z=this.pts[2].z=this.pts[3].z=e.low.z,this.pts[4].z=this.pts[5].z=this.pts[6].z=this.pts[7].z=e.high.z},r.prototype.getCenter=function(t){return Cesium.defined(t)||(t=new e),t.interpolate(this.pts[n.Last],.5,this.pts[n.First]),t},r}),define("scripts/Bentley/Math/Constants",[],function(){var e={mgds_fc_epsilon:1e-5,oneMillimeter:.001,oneCentimeter:.01,oneMeter:1,oneKilometer:1e3,diameterOfEarth:12742e3};return e}),define("scripts/Bentley/Bim/AnimatorState",["./Frustum","../Math/Cartesian3","../Math/Constants","../Math/Range3","./NpcCorners"],function(e,t,n,r,i){function o(e,r,o){this.init(r),this.animationTime=e,this.destViewBox=o,this.startLoc=t.fromInterpolate(this.initialViewBox.getCorner(i.NPC_000),.5,this.initialViewBox.getCorner(i.NPC_111)),this.endLoc=t.fromInterpolate(this.destViewBox.getCorner(i.NPC_000),.5,this.destViewBox.getCorner(i.NPC_111)),this.hasTranslation=t.distanceSquared(this.startLoc,this.endLoc)>n.mgds_fc_epsilon,this.hasTranslation&&this.xVec.differenceOf(this.endLoc,this.startLoc)}return o.prototype.init=function(n){this.initialViewBox=n,this.intermediateBox=new e,this.destViewBox=new e,this.frameBox=new e,this.segment1scale=1,this.segment2scale=1,this.hasTranslation=!1,this.firstSegmentTime=0,this.fraction=0,this.startLoc=new t,this.endLoc=new t,this.xVec=new t,this.rotationPoint=new t},o.prototype.computeScaleTranslationTimeFactor=function(e,t){var n=r.fromArray(e.pts),i=r.fromArray(t.pts),o=r.fromUnionOf(n,i);return o.volume()/n.volume()-1},o.prototype.hasNoTransformation=function(){return!(Math.abs(1-this.segment2scale*this.segment1scale)>n.mgds_fc_epsilon)&&!this.hasTranslation},o.prototype.setUpLinearInterpolatedFrustum=function(e,t,n,r){for(var a=0;a<i.CornerCount;a++)this.frameBox.getCorner(a).interpolate(e.getCorner(a),this.fraction,t.getCorner(a));o.setUpFromFrustum(this.frameBox,r)},o.setUpFromFrustum=function(e,t){t.setupFromFrustum(e)},o}),define("scripts/Bentley/Bim/BeDuration",[],function(){return Number.prototype.toSeconds=function(){return this/1e3},Number.prototype.isZero=function(){return 0===this},Number.prototype.isTowardsFuture=function(){return this>0},Number.prototype.isTowardsPast=function(){return this<0},Number}),define("scripts/Bentley/Bim/ViewportAnimator",["./AnimatorState","../Math/Constants","./BeDuration"],function(e,t){function n(t,n,r){this.totalTime=r.totalTime,this.velocityFactor=r.velocityFactor,this.viewport=r.viewport,this.allowZoom=r.allowZoom,this.state=new e(this.totalTime,t,n)}return n.prototype.animate=function(e){var t=Date.now();Cesium.defined(this.startTime)||(this.startTime=t,this.animateTotalTime=this.initTimeSegments());var n=this.animateTotalTime,r=this.startTime+n;if(r<=t)return this.moveToTimeSegment(n),!0;var i=t-this.startTime;return i>n&&(i=n),this.moveToTimeSegment(i),!1},n.prototype.moveToTimeSegment=function(e){e<=this.state.firstSegmentTime&&this.state.animationTime.isTowardsFuture()?(this.state.fraction=this.state.firstSegmentTime.isTowardsFuture()?e.toSeconds()/this.state.firstSegmentTime.toSeconds():0,this.state.setUpLinearInterpolatedFrustum(this.state.initialViewBox,this.state.intermediateBox,!0,this.viewport)):(this.state.fraction=this.state.animationTime!==this.state.firstSegmentTime?(e-this.state.firstSegmentTime)/(this.state.animationTime-this.state.firstSegmentTime):0,this.state.setUpLinearInterpolatedFrustum(this.state.initialViewBox,this.state.destViewBox,!0,this.viewport))},n.prototype.interrupt=function(e){Cesium.defined(this.startTime)&&this.moveToTimeSegment(this.animateTotalTime),this.destroy()},n.prototype.initTimeSegments=function(){var e=this.totalTime/10,n=this.viewport.getFrustum(),r=this.state.computeScaleTranslationTimeFactor(n,this.state.intermediateBox)+this.state.segment1scale-1;Math.abs(1-this.state.segment1scale)<t.mgds_fc_epsilon&&(r=0);var i=this.state.computeScaleTranslationTimeFactor(this.state.destViewBox,this.state.intermediateBox)+Math.abs(this.state.segment2scale-1),o=e*(r+i);return o=Math.min(o,this.totalTime),o=Math.max(o,4*e),this.state.animationTime=o,this.state.firstSegmentTime=this.state.animationTime*r/(r+i),this.state.animationTime},n.prototype.destroy=function(){return Cesium.destroyObject(this)},n}),define("scripts/Bentley/Tools/ViewToolSettings",[],function(){var e={dynamicRotationSphere:!1,preserveWorldUp:!0,fitExpandsClipping:!0,walkEnforceZUp:!1,fitModes:0,mode3dInput:0,viewBallRadius:.35,viewBallTransparency:.6,walkVelocity:3.5,walkCameraAngle:75.6,animationTime:260,animateZoom:!1,minDistanceToSurface:1};return e}),define("scripts/Bentley/Tools/ViewTool",["./Tool","../Util/extend","../Bim/ViewportAnimator","./ViewToolSettings"],function(e,t,n,r){function i(t,n){e.call(this,t,n)}return t(e,i),i.prototype.installToolImplementation=function(){return!!this.toolAdmin.onInstallTool(this)&&(this.toolAdmin.startViewTool(this),this.toolAdmin.setViewTool(this),this.toolAdmin.onPostInstallTool(this),!0)},i.animateFrustumChange=function(e,t,i,o){if(o=Cesium.defaultValue(o,r.animationTime),0>=o)return void e.setupFromFrustum(i);var a=new n(t,i,{viewport:e,totalTime:o,velocityFactor:1,allowZoom:!1});e.setAnimator(a)},i.prototype.onResetButtonUp=function(e){return this.exitTool(),!0},i.prototype.exitTool=function(){this.toolAdmin.exitViewTool()},i}),define("scripts/Bentley/Math/Cartesian2",["./Angle"],function(e){return Cesium.Cartesian2.prototype.init=function(e,t){this.x=e,this.y=t},Cesium.Cartesian2.prototype.copyFrom=function(e){Cesium.Cartesian2.clone(e,this)},Cesium.Cartesian2.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},Cesium.Cartesian2.prototype.floor=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},Cesium.Cartesian2.prototype.scale=function(e){this.x*=e,this.y*=e},Cesium.Cartesian2.prototype.dot=function(e){return Cesium.Cartesian2.dot(this,e)},Cesium.Cartesian2.prototype.crossProduct=function(e){return this.x*e.y-this.y*e.x},Cesium.Cartesian2.prototype.angleTo=function(t){var n=this.crossProduct(t),r=this.dot(t);return e.atan2(n,r)},Cesium.Cartesian2.prototype.distance=function(e){return Cesium.Cartesian2.distance(this,e)},Cesium.Cartesian2}),define("scripts/Bentley/Tools/WindowAreaTool",["../Math/Cartesian3","./ViewTool","../Util/extend","./ToolId","../Math/Range3","../Math/Cartesian2"],function(e,t,n,r,i,o){function a(e,t,n,r){this._left=Cesium.defined(n)?n.x:0,this._top=Cesium.defined(n)?n.y:0,this._width=Cesium.defined(r)?r.x:0,this._height=Cesium.defined(r)?r.y:0,this.ruleColor="1px solid "+Cesium.defaultValue(t,"white");var i=document.createElement("div");this.element=i,this.parentElement=e;var a=document.createElement("div");a.style.height="0px",a.style.left="0px",this.horizontalRule=a,e.appendChild(a);var s=document.createElement("div");s.style.top="0px",s.style.width="0px",this.verticalRule=s,e.appendChild(s),this.crossHalfLength=7,this.firstPt=new o;var u=document.createElement("div");u.style.height=u.left="0px",this.horizontalCross=u,e.appendChild(u);var c=document.createElement("div");c.style.top=c.style.width="0px",this.verticalCross=c,e.appendChild(c),this._setVisible(!1,!0),this.update(),e.appendChild(i)}function s(n){t.call(this,n,r.WindowArea),this.haveFirstPoint=!1,this.firstPtWorld=new e,this.secondPtWorld=new e,this.corners=[new e,new e],this.overlay=new a(n.canvas.parentElement,n.getContrastToBackgroundColor()),this.overlay.visible=!1}return a.prototype._setVisible=function(e,t){(t||e!=this.visible)&&(this.element.className=e?"bim-overlay-box":"bim-hidden",this.horizontalRule.className=e?"bim-hidden":"bim-overlay-box-rule-horizontal",this.verticalRule.className=e?"bim-hidden":"bim-overlay-box-rule-vertical",this.horizontalCross.className=e?"bim-overlay-box-rule-horizontal":"bim-hidden",this.verticalCross.className=e?"bim-overlay-box-rule-vertical":"bim-hidden",this.horizontalRule.style.borderBottom=this.ruleColor,this.verticalRule.style.borderLeft=this.ruleColor,this.horizontalCross.style.borderBottom=this.ruleColor,this.verticalCross.style.borderLeft=this.ruleColor,this.element.style.border=this.ruleColor)},Cesium.defineProperties(a.prototype,{visible:{get:function(){return"bim-overlay-box"==this.element.className},set:function(e){this._setVisible(e)}},origin:{get:function(){return new o(this.left,this.top)},set:function(e){this._left=e.x,this._top=e.y,this.update()}},extents:{get:function(){return new o(this.width,this.height)},set:function(e){this.width=e.x,this.height=e.y,this.update()}},bottomRight:{get:function(){return new o(this.left+this.width,this.top+this.height)},set:function(e){this._width=e.x-this.left,this._height=e.y-this.top,this.update()}},center:{get:function(){return new o(this.left+this.width/2,this.top+this.height/2)}},left:{get:function(){return this._left},set:function(e){this._left=e,this.update()}},top:{get:function(){return this._top},set:function(e){this._top=e,this.update()}},width:{get:function(){return this._width},set:function(e){this._width=e,this.update()}},height:{get:function(){return this._height},set:function(e){this._height=e,this.update()}},right:{get:function(){return this._left+this._width},set:function(e){this._width=e-this._left,this.update()}},bottom:{get:function(){return this._top+this._height},set:function(e){this._height=e-this._top,this.update()}}}),a.prototype.destroy=function(){this._destroyed||(this.parentElement.removeChild(this.element),this.parentElement.removeChild(this.horizontalRule),this.parentElement.removeChild(this.verticalRule),this.parentElement.removeChild(this.horizontalCross),this.parentElement.removeChild(this.verticalCross),this._destroyed=!0)},a.prototype.update=function(){var e=this.element.style;e.left=this._left+"px",e.top=this._top+"px",e.width=this._width+"px",e.height=this._height+"px",this.horizontalRule.style.width=this.parentElement.clientWidth+"px",this.horizontalRule.style.top=this._top+"px",this.verticalRule.style.height=this.parentElement.clientHeight+"px",this.verticalRule.style.left=this._left+"px",this.horizontalCross.style.width=2*this.crossHalfLength+1+"px",this.horizontalCross.style.top=this.firstPt.y+"px",this.horizontalCross.style.left=this.firstPt.x-this.crossHalfLength+"px",this.verticalCross.style.height=2*this.crossHalfLength+1+"px",this.verticalCross.style.left=this.firstPt.x+"px",this.verticalCross.style.top=this.firstPt.y-this.crossHalfLength+"px"},n(t,s),s.prototype.onCleanup=function(){Cesium.defined(this.overlay)&&(this.overlay.destroy(),this.overlay=void 0)},s.prototype.onModelEndDrag=function(e){return this.onDataButtonDown(e)},s.prototype.onReinitialize=function(){this.haveFirstPoint=!1,this.firstPtWorld.zero(),this.secondPtWorld.zero()},s.prototype.onModelMotion=function(e){this.doManipulation(e,!0)},s.prototype.updateDynamics=function(e){this.doManipulation(e,!0)},s.prototype.onDataButtonDown=function(e){return this.haveFirstPoint?(this.secondPtWorld.copyFrom(e.point),this.doManipulation(e,!1),this.onReinitialize()):(this.firstPtWorld.copyFrom(e.point),this.secondPtWorld.copyFrom(this.firstPtWorld),this.haveFirstPoint=!0,this.overlay.firstPt.x=e.viewPoint.x,this.overlay.firstPt.y=e.viewPoint.y),!0},s.prototype.onResetButtonUp=function(e){return this.haveFirstPoint?(this.haveFirstPoint=!1,!0):t.prototype.onResetButtonUp.call(this,e)},s.prototype.computeWindowCorners=function(){var t=this.viewport,n=this.corners;n[0].copyFrom(this.firstPtWorld),n[1].copyFrom(this.secondPtWorld),t.worldToViewArray(n);var r=e.fromDifferenceOf(n[1],n[0]);if(!(r.magnitudeXY()<2)){var i=this.viewport.viewDelta;if(0!=i.x&&0!=r.x){var o,a,s=i.y/i.x,u=Math.abs(r.y/r.x);u<s?(o=Math.abs(r.x)/2,a=o*s):(a=Math.abs(r.y)/2,o=a/s);var c=e.fromSumOf(n[0],r,.5);return n[0].x=c.x-o,n[0].y=c.y-a,n[1].x=c.x+o,n[1].y=c.y+a,n}}},s.prototype.doManipulation=function(n,r){if(this.secondPtWorld.copyFrom(n.point),r)return void this.updateOverlay();var i=this.computeWindowCorners();if(Cesium.defined(i)){var a=this.viewport,s=a.getFrustum();if(a.isCameraOn){var u=a.pickRange(this.overlay.origin,this.overlay.extents);if(!Cesium.defined(u))return;var c=u.minDepth,l=a.windowToDrawingBufferFlipY(this.overlay.center),f=a.drawingBufferToWorld(l,c);if(this.overlay.width<this.overlay.height)var h=new o(this.overlay.left,this.overlay.top+this.overlay.height/2);else var h=new o(this.overlay.left+this.overlay.width/2,this.overlay.top);var p=a.windowToDrawingBufferFlipY(h),m=a.drawingBufferToWorld(p,c),d=e.distance(f,m),v=new Cesium.BoundingSphere(f,d);a.fitBoundingSphere(v)}else a.viewToWorldArray(i),a.changeArea(i);t.animateFrustumChange(a,s,a.getFrustum())}},s.prototype.updateOverlay=function(){this.haveFirstPoint?this.updateRectangle():this.updateRules()},s.prototype.updateRectangle=function(){var e=this.viewport.worldToView(this.firstPtWorld);this.overlay.firstPt.x=e.x,this.overlay.firstPt.y=e.y;var t=this.computeWindowCorners();if(this.overlay.visible=Cesium.defined(t),this.overlay.visible){var n=i.from2Points(t[0],t[1]);this.overlay.left=n.low.x,this.overlay.top=n.low.y,this.overlay.right=n.high.x,this.overlay.bottom=n.high.y}},s.prototype.updateRules=function(){var e=this.getCurrentButtonEvent();this.overlay.left=e.viewPoint.x,this.overlay.top=e.viewPoint.y,this.overlay.visible=!1},s.prototype.onSingleFingerMove=function(e){return this.toolAdmin.convertGestureMoveToButtonDownAndMotion(e),!0},s.prototype.onEndGesture=function(e){return this.toolAdmin.convertGestureEndToButtonUp(e),!0},s}),define("scripts/Bentley/Util/foreach",[],function(){var e=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else if("object"==typeof e)for(var r in e)e.hasOwnProperty(r)&&t(e[r])};return e}),define("scripts/Bentley/Tools/ViewManipHitPriority",[],function(){var e={Low:1,Normal:10,Medium:100,High:1e3};return e}),define("scripts/Bentley/Tools/ViewHandleType",[],function(){var e={None:0,Rotate:1,TargetCenter:2,ViewPan:4,ViewScroll:8,ViewZoom:16,ViewWalk:32,ViewFly:64,ViewWalkMobile:128,ViewLook:512};return e}),define("scripts/Bentley/Tools/ViewHandleArray",["../Util/foreach","./ViewManipHitPriority","./ViewHandleType"],function(e,t,n){function r(e){this.viewTool=e,this.handles=[],this.empty()}return r.prototype.empty=function(){this.focus=-1,this.focusDrag=!1,this.hitHandleIndex=-1,this.handles.length=0},r.prototype.add=function(e){this.handles.push(e)},r.prototype.get=function(e){return e>=0&&e<this.count?this.handles[e]:void 0},r.prototype.testHit=function(e,r){r=Cesium.defaultValue(r,n.None),this.hitHandleIndex=-1;for(var i,o=0,a=!1,s=t.Low,u=0;u<this.count;u++){var c=this.handles[u];
if(Cesium.defined(c))if(r!=n.None){if(c.handleType==r)return this.hitHandleIndex=u,!0}else{var l=c.testHandleForHit(e);if(!Cesium.defined(l))continue;l.priority>=s&&(l.priority>s&&(a=!1),s=l.priority,(!a||l.distance<o)&&(a=!0,o=l.distance,i=c,this.hitHandleIndex=u))}}return Cesium.defined(i)},r.prototype.focusHitHandle=function(){this.setFocus(this.hitHandleIndex)},r.prototype.setFocus=function(e){if(this.focus!=e||this.focusDrag!=this.viewTool.isDragging){var t;this.focus>=0&&(t=this.get(this.focus),Cesium.defined(t)&&t.focusOut()),e>=0&&(t=this.get(e),Cesium.defined(t)&&t.focusIn()),this.focus=e,this.focusDrag=this.viewTool.isDragging}},Cesium.defineProperties(r.prototype,{count:{get:function(){return this.handles.length}},viewport:{get:function(){return this.viewTool.viewport}},hitHandle:{get:function(){return this.get(this.hitHandleIndex)}},focusHandle:{get:function(){return this.get(this.focusHandle)}}}),r.prototype.onReinitialize=function(){e(this.handles,function(e){Cesium.defined(e)&&e.onReinitialize()})},r.prototype.hasHandle=function(e){for(var t=0;t<this.count;t++){var n=this.get(t);if(Cesium.defined(n)&&n.handleType==e)return!0}return!1},r.prototype.getHandleByType=function(e){for(var t=0;t<this.count;t++){var n=this.get(t);if(n.handleType==e)return n}},r.prototype.motion=function(t){return e(this.handles,function(e){Cesium.defined(e)&&e.motion(t)}),!0},r}),define("scripts/Bentley/Tools/Cursor",[],function(){var e={Default:"default",CrossHair:"crosshair",OpenHand:"grab",ClosedHand:"grabbing",Rotate:"move",Arrow:"default"};return e}),define("scripts/Bentley/Tools/ViewingToolHandle",["./Cursor"],function(e){function t(e){this.viewTool=e}return t.prototype.onReinitialize=function(){},t.prototype.focusOut=function(){},t.prototype.noMotion=function(e){return!1},t.prototype.motion=function(e){return!1},t.prototype.checkOneShot=function(){return!0},t.prototype.getHandleCursor=function(){return e.Default},t.prototype.doManipulation=function(e,t){throw new Cesium.DeveloperError("Missing function implementation")},t.prototype.firstPoint=function(e){throw new Cesium.DeveloperError("Missing function implementation")},t.prototype.testHandleForHit=function(e){throw new Cesium.DeveloperError("Missing function implementation")},t.prototype.focusIn=function(){this.viewTool.toolAdmin.setViewCursor(this.getHandleCursor())},Cesium.defineProperties(t.prototype,{viewport:{get:function(){return this.viewTool.viewport}}}),t}),define("scripts/Bentley/Util/dynamicCast",[],function(){function e(e,t){return Cesium.defined(e)&&Cesium.defined(t)&&e instanceof t?e:void 0}return e}),define("scripts/Bentley/Math/Matrix3",["./Cartesian3","./Angle"],function(e,t){function n(e,t,n,r){var i;return r>s?(i=.5*Math.sqrt(r),t*e<0&&(i=-i)):i=e*n,i}function r(n,r){var i=Cesium.defined(r)?r:new e;i.init(n.x,n.y,n.z);var o=i.normalize(),a=2*t.atan2(o,n.w);return a>Math.PI&&(a=2*Math.PI-a,i.init(i.x*-1,i.y*-1,i.z*-1)),0==a&&i.init(0,0,1),a}Cesium.Matrix3.prototype.element=function(e,t){if(e>2||t>2||e<0||t<0)throw new Cesium.DeveloperError("Invalid row or column");return this[3*t+e]},Cesium.Matrix3.prototype.setElement=function(e,t,n){if(e>2||t>2||e<0||t<0)throw new Cesium.DeveloperError("Invalid row or column");this[3*t+e]=n},Cesium.Matrix3.prototype.addToElement=function(e,t,n){var r=this.element(e,t);this.setElement(e,t,r+n)},Cesium.Matrix3.prototype.getRow=function(t,n){return Cesium.defined(n)||(n=new e),Cesium.Matrix3.getRow(this,t,n),n},Cesium.Matrix3.prototype.getRows=function(t,n,r){return t=Cesium.defined(t)?t:new e,n=Cesium.defined(n)?n:new e,r=Cesium.defined(r)?r:new e,this.getRow(0,t),this.getRow(1,n),this.getRow(2,r),[t,n,r]},Cesium.Matrix3.prototype.getColumn=function(t,n){return Cesium.defined(n)||(n=new e),Cesium.Matrix3.getColumn(this,t,n),n},Cesium.Matrix3.prototype.copyFrom=function(e){Cesium.Matrix3.clone(e,this)},Cesium.Matrix3.prototype.maxDiff=function(e){for(var t=0,n=0;n<9;n++){var r=Math.abs(this[n]-e[n]);r>t&&(t=r)}return t},Cesium.Matrix3.prototype.maxAbs=function(){for(var e=0,t=0;t<9;t++){var n=Math.abs(this[t]);n>e&&(e=n)}return e},Cesium.Matrix3.prototype.multiply=function(e,t){t=Cesium.defaultValue(t,e),Cesium.Matrix3.multiplyByVector(this,e,t)},Cesium.Matrix3.prototype.multiplyArray=function(e,t){if(t=Cesium.defaultValue(t,e),e.length!==t.length)throw new Cesium.DeveloperError("Invalid Parameters");for(var n=0;n<e.length;n++)this.multiply(e[n],t[n])};var i=new Cesium.Matrix3;Cesium.Matrix3.prototype.multiplyTranspose=function(e,t){var n=Cesium.Matrix3.transpose(this,i);Cesium.Matrix3.multiplyByVector(n,t,e)},Cesium.Matrix3.prototype.multiplyTransposeInPlace=function(e){this.multiplyTranspose(e,e)},Cesium.Matrix3.fromRowVectors=function(e,t,n){var r=new Cesium.Matrix3;return r.fromRowVectors(e,t,n),r},Cesium.Matrix3.prototype.fromRowVectors=function(e,t,n){this.setRow(0,e),this.setRow(1,t),this.setRow(2,n)},Cesium.Matrix3.fromColumnVectors=function(e,t,n){var r=new Cesium.Matrix3;return r.initFromColumnVectors(e,t,n),r},Cesium.Matrix3.prototype.initFromColumnVectors=function(e,t,n){this.setColumn(0,e),this.setColumn(1,t),this.setColumn(2,n)},Cesium.Matrix3.prototype.setRow=function(e,t){Cesium.Matrix3.setRow(this,e,t,this)};var o=new e;Cesium.Matrix3.prototype.setRowValues=function(e,t,n,r){var i=o;i.x=t,i.y=n,i.z=r,this.setRow(e,i)},Cesium.Matrix3.prototype.setColumn=function(e,t){Cesium.Matrix3.setColumn(this,e,t,this)},Cesium.Matrix3.prototype.setColumnValues=function(e,t,n,r){var i=o;i.x=t,i.y=n,i.z=r,this.setColumn(e,i)},Cesium.Matrix3.prototype.initFromScaleFactors=function(e,t,n){this[0]=e,this[4]=t,this[8]=n},Cesium.Matrix3.prototype.initIdentity=function(){Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY,this)},Cesium.Matrix3.prototype.squareAndNormalizeColumns=function(e,n,r){var i=t.cyclic3dAxis(n),o=t.cyclic3dAxis(r),a=3-(i+o);if(i==o)return Cesium.Matrix3.clone(e,this),!1;var s=[e.getColumn(0),e.getColumn(1),e.getColumn(2)],u=s[i].normalize(),c=s[a].normalizedCrossProduct(s[i],s[o]);if(0==c)return Cesium.Matrix3.clone(e,this),!1;var l=s[o].normalizedCrossProduct(s[a],s[i]);return 0==l?0==u?(this.initIdentity(),!1):(s[i].getNormalizedTriad(s[o],s[a],s[i]),this.initFromColumnVectors(s[0],s[1],s[2]),!1):((o+1)%3==i&&s[a].negate(),this.initFromColumnVectors(s[0],s[1],s[2]),!0)},Cesium.Matrix3.prototype.inverseOf=function(e){Cesium.Matrix3.inverse(e,this)},Cesium.Matrix3.fromInverseOf=function(e,t){var n=Cesium.defined(t)?t:new Cesium.Matrix3;return n.inverseOf(e),n},Cesium.Matrix3.prototype.isEqual=function(e,t){return t=Cesium.defaultValue(t,1e-6),this.maxDiff(e)<=t*this.maxAbs()},Cesium.Matrix3.prototype.initFromScaledOuterProduct=function(e,t,n){this.setColumnValues(0,n*e.x*t.x,n*e.y*t.x,n*e.z*t.x),this.setColumnValues(1,n*e.x*t.y,n*e.y*t.y,n*e.z*t.y),this.setColumnValues(2,n*e.x*t.z,n*e.y*t.z,n*e.z*t.z)};var a=new e;Cesium.Matrix3.prototype.initFromVectorAndRotationAngle=function(t,n){var r=Math.cos(n),i=Math.sin(n),o=1-r,s=e.clone(t,a),u=s.normalize();return 0==u?void this.initIdentity():(this.initFromScaledOuterProduct(s,s,o),this.addToElement(0,0,r),this.addToElement(0,1,-(i*s.z)),this.addToElement(0,2,i*s.y),this.addToElement(1,0,i*s.z),this.addToElement(1,1,r),this.addToElement(1,2,-(i*s.x)),this.addToElement(2,0,-(i*s.y)),this.addToElement(2,1,i*s.x),void this.addToElement(2,2,r))},Cesium.Matrix3.fromVectorAndRotationAngle=function(e,t,n){var r=Cesium.defined(n)?n:new Cesium.Matrix3;return r.initFromVectorAndRotationAngle(e,t),r},Cesium.Matrix3.prototype.initFromAxisAndRotationAngle=function(e,t){var n=Math.cos(t),r=Math.sin(t);switch(this.initIdentity(),e){case 0:this.setElement(1,1,n),this.setElement(2,2,n),this.setElement(1,2,-r),this.setElement(2,1,r);break;case 1:this.setElement(0,0,n),this.setElement(2,2,n),this.setElement(0,2,r),this.setElement(2,0,-r);break;case 2:this.setElement(0,0,n),this.setElement(1,1,n),this.setElement(1,0,r),this.setElement(0,1,-r)}},Cesium.Matrix3.fromAxisAndRotationAngle=function(e,t){var n=new Cesium.Matrix3;return n.initFromAxisAndRotationAngle(e,t),n},Cesium.Matrix3.prototype.initRotationFromVectorToVector=function(e,t){var n=e.angleAndAxisOfRotationFromVectorToVector(t);return Cesium.defined(n)?(this.initFromVectorAndRotationAngle(n.axis,n.radians),!0):(this.initIdentity(),!1)},Cesium.Matrix3.prototype.initProduct=function(e,t){Cesium.Matrix3.multiply(e,t,this)},Cesium.Matrix3.fromProduct=function(e,t,n){return Cesium.defined(n)||(n=new Cesium.Matrix3),Cesium.Matrix3.multiply(e,t,n)};var s=.5;Cesium.Matrix3.prototype.toQuaternion=function(e,t){for(var r=Cesium.defined(t)?t:new Cesium.Cartesian4,i=this.element(0,0),o=this.element(1,1),a=this.element(2,2),s=[1+i-o-a,1-i+o-a,1-i-o+a,1+i+o+a],u=0,c=0;c<4;c++)s[c]>s[u]&&(u=c);var l;return 0==u?(r.x=.5*Math.sqrt(s[0]),l=1/(4*r.x),r.y=n(this.element(0,1)+this.element(1,0),r.x,l,s[1]),r.z=n(this.element(0,2)+this.element(2,0),r.x,l,s[2]),r.w=n(this.element(2,1)-this.element(1,2),r.x,l,s[3])):1==u?(r.y=.5*Math.sqrt(s[1]),l=1/(4*r.y),r.x=n(this.element(0,1)+this.element(1,0),r.y,l,s[0]),r.z=n(this.element(1,2)+this.element(2,1),r.y,l,s[2]),r.w=n(this.element(0,2)-this.element(2,0),r.y,l,s[3])):2==u?(r.z=.5*Math.sqrt(s[2]),l=1/(4*r.z),r.x=n(this.element(0,2)+this.element(2,0),r.z,l,s[0]),r.y=n(this.element(1,2)+this.element(2,1),r.z,l,s[1]),r.w=n(this.element(1,0)-this.element(0,1),r.z,l,s[3])):(r.w=.5*Math.sqrt(s[3]),l=1/(4*r.w),r.x=n(this.element(2,1)-this.element(1,2),r.w,l,s[0]),r.y=n(this.element(0,2)-this.element(2,0),r.w,l,s[1]),r.z=n(this.element(1,0)-this.element(0,1),r.w,l,s[2])),e&&(r.w=-r.w),r},Cesium.Matrix3.prototype.getRotationAngleAndVector=function(e){var t=this.toQuaternion(!1);return r(t,e)},Cesium.Matrix3.fromScaleFactors=function(e,t,n){var r=new Cesium.Matrix3;return r.initFromScaleFactors(e,t,n),r},Cesium.Matrix3.fromTranspose=function(e){var t=new Cesium.Matrix3;return t.transposeOf(e),t},Cesium.Matrix3.prototype.transposeOf=function(e){Cesium.Matrix3.transpose(e,this)},Cesium.Matrix3.fromPrincipleAxisRotations=function(e,t,n,r,i){var o=Cesium.defined(i)?i:new Cesium.Matrix3;return o.initFromPrincipleAxisRotations(e,t,n,r),o};var u=new Cesium.Matrix3,c=new Cesium.Matrix3;return Cesium.Matrix3.prototype.initFromPrincipleAxisRotations=function(e,t,n,r){var i=u,o=c;0!=t?o.initFromAxisAndRotationAngle(0,t):o.initIdentity(),0!=n&&(i.initFromAxisAndRotationAngle(1,n),o.initProduct(o,i)),0!=r&&(i.initFromAxisAndRotationAngle(2,r),o.initProduct(o,i)),this.initProduct(o,e)},Cesium.Matrix3}),define("scripts/Bentley/Bim/StandardView",["../Math/Matrix3"],function(e){var t={Top:e.IDENTITY,Bottom:new e(1,0,0,0,-1,0,0,0,-1),Left:new e(0,0,-1,-1,0,0,0,1,0),Right:new e(0,0,1,1,0,0,0,1,0),Front:new e(1,0,0,0,0,-1,0,1,0),Back:new e(-1,0,0,0,0,1,0,1,0),Iso:new e(.707106781186548,.408248290463863,-.577350269189626,-.7071067811865476,.408248290463863,-.5773502691896257,0,.816496580927726,.5773502691896257),RightIso:new e(.707106781186548,-.408248290463863,.577350269189626,.7071067811865476,.408248290463863,-.5773502691896257,0,.816496580927726,.5773502691896257)};return t}),define("scripts/Bentley/Bim/StandardViewMatrices",["./StandardView"],function(e){var t=[e.Top,e.Bottom,e.Left,e.Right,e.Front,e.Back,e.Iso,e.RightIso];return t}),define("scripts/Bentley/Bim/View",["../Math/Matrix3","../Math/Cartesian3","../Math/Constants","./NpcCorners","./StandardViewMatrices","../Math/Range3"],function(e,t,n,r,i,o){function a(n,r){return this.bim=r,this.dir=new t,this.up=new t,this.dest=new t,Cesium.defined(n)?(this.name=n.name,this.type=n.type,this.categorySelector=n.categorySelector,this.modelSelector=n.modelSelector,this.displayStyle=n.displayStyle,this.origin=t.fromObject(n.origin),this.extents=t.fromObject(n.extents),void(this.rotation=e.fromArray(n.rotation))):(this.origin=new t,this.extents=new t,void(this.rotation=new e))}var s=new t;Cesium.defineProperties(a.prototype,{categories:{get:function(){return this.bim.categorySelectors[this.categorySelector]}},models:{get:function(){return this.bim.modelSelectors[this.modelSelector]}},backgroundColor:{get:function(){return this.bim.displayStyles[this.displayStyle]?this.bim.displayStyles[this.displayStyle].backgroundColor:void 0}},center:{get:function(){var e=s;this.rotation.multiplyTranspose(e,this.extents);var n=new t;return n.sumOf(this.origin,e,.5),n}},xVector:{get:function(){return this.rotation.getRow(0)}},yVector:{get:function(){return this.rotation.getRow(1)}},zVector:{get:function(){return this.rotation.getRow(2)}},isCameraView:{get:function(){return Cesium.defined(this.toCameraView())}},isOrthographicView:{get:function(){return Cesium.defined(this.toOrthographicView())}},isDrawingView:{get:function(){return Cesium.defined(this.toDrawingView())}},is3d:{get:function(){return!this.is2d}},is2d:{get:function(){return Cesium.defined(this.toView2d())}},isSpatialView:{get:function(){return Cesium.defined(this.toSpatialView())}},isCameraOn:{get:function(){return!1}}}),a.prototype.toUrl=function(){var e="extents="+this.extents.x+","+this.extents.y+","+this.extents.z+"&origin="+this.origin.x+","+this.origin.y+","+this.origin.z+"&rotation="+Cesium.Matrix3.toArray(this.rotation).toString();return e},a.prototype.updateFromJson=function(n){Cesium.defined(n.extents)&&(this.extents=t.fromObject(n.extents)),Cesium.defined(n.origin)&&(this.origin=t.fromObject(n.origin)),Cesium.defined(n.rotation)&&(this.rotation=e.fromArray(n.rotation))},a.prototype.copyFrom=function(e){this.bim=e.bim,this.name=e.name,this.type=e.type,this.viewId=e.viewId,this.categorySelector=e.categorySelector,this.modelSelector=e.modelSelector,this.displayStyle=e.displayStyle,this.origin.copyFrom(e.origin),this.extents.copyFrom(e.extents),this.rotation.copyFrom(e.rotation)},a.prototype.isEqual=function(e){return this.name==e.name&&this.type==e.type&&this.categorySelector==e.categorySelector&&this.modelSelector==e.modelSelector&&this.origin.equals(e.origin)&&this.extents.equals(e.extents)&&this.rotation.equals(e.rotation)},a.maxViewDelta=2*n.diameterOfEarth,a.minViewDelta=n.oneMillimeter/100,a.limitWindowSize=function(e){return e<a.minViewDelta?e=a.minViewDelta:e>a.maxViewDelta&&(e=a.maxViewDelta),e},a.validateViewDelta=function(e){var t=a.limitWindowSize(e.x),n=a.limitWindowSize(e.y);e.z=a.limitWindowSize(e.z);var r=t!=e.x||n!=e.y;return r&&(e.x=t,e.y=n),!r},a.fixFrustumOrder=function(e){var t=e.pts,n=Cesium.Cartesian3.fromDifferenceOf(t[r.NPC_001],t[r.NPC_000]),i=Cesium.Cartesian3.fromDifferenceOf(t[r.NPC_010],t[r.NPC_000]),o=Cesium.Cartesian3.fromDifferenceOf(t[r.NPC_100],t[r.NPC_000]);if(n.tripleProduct(i,o)<=0)return e;for(var a=e.clone(),s=0;s<8;s+=2){var u=t[s].clone();Cesium.Cartesian3.clone(t[s+1],a.pts[s]),Cesium.Cartesian3.clone(u,a.pts[s+1])}return a},a.prototype.setupFromFrustum=function(e){var t=a.fixFrustumOrder(e);return this._setupFromFrustum(t)},a.prototype._setupFromFrustum=function(e){return this._baseSetupFromFrustum(e)},a.prototype._baseSetupFromFrustum=function(n){var i=n.pts,o=i[r.NPC_000].clone(),s=t.fromDifferenceOf(i[r.NPC_100],o),u=t.fromDifferenceOf(i[r.NPC_010],o),c=t.fromDifferenceOf(i[r.NPC_001],o),l=e.fromColumnVectors(s,u,c);if(!l.squareAndNormalizeColumns(l,0,1))return!1;a.findNearbyStandardViewMatrix(l);var f=l.getColumn(0),h=l.getColumn(1),p=l.getColumn(2),m=new e;m.inverseOf(l);var d=p.dot(c);if(d<0)return!1;var v=new t;v.sumOf2ScaledVectors(t.ZERO,f,f.dot(s),h,h.dot(u)),v.sumOf(v,p,d),o.sumOf(n.getCenter(),v,-.5);var g=new t;return m.multiply(v,g),!!a.validateViewDelta(g,!1)&&(this.setOrigin(o),this.setExtents(g),this.setRotation(m),!0)},a.prototype.lookAtViewAlignedVolume=function(e,r,i){var o=this.extents.clone(),s=this.origin.clone(),u=this.rotation.clone(),c=e.low.clone(),l=new t;l.differenceOf(e.high,e.low);var f=n.oneMillimeter;l.z<f&&(c.z-=(f-l.z)/2,l.z=f);var h=l.clone();if(!this.isCameraOn){l.scale(1.04);var p=l.magnitudeXY();p>l.z&&(l.z=p)}if(a.validateViewDelta(l),this.setExtents(l),Cesium.defined(r)&&this.adjustAspectRatio(r,!0),l.copyFrom(this.extents),c.x-=(l.x-h.x)/2,c.y-=(l.y-h.y)/2,c.z-=(l.z-h.z)/2,this.isCameraView&&!i){u.multiply(s),c.z=s.z;var m=this.extents.clone();m.z=o.z,this.setExtents(m)}var d=new t;if(u.multiplyTranspose(d,c),this.setOrigin(d),this.isCameraOn){this.cameraInfo.validateLens();var v=Math.max(l.x,l.y)/(2*Math.tan(this.cameraInfo.lensAngle/2)),g=v+l.z;this.cameraInfo.focusDistance=v,this.centerEyePoint(g),this.verifyFocusPlane()}},a.findNearbyStandardViewMatrix=function(e){for(var t=i,n=0;n<t.length;n++){var r=t[n],o=r.maxDiff(e);if(o<1e-7)return e.copyFrom(r),!0}return!1},a.prototype.toSpatialView=function(){},a.prototype.toOrthographicView=function(){},a.prototype.toCameraView=function(){},a.prototype.toView2d=function(){},a.prototype.toDrawingView=function(){};var u=new t,c=new t,l=new t,f=new t;return a.prototype.init=function(){if(Cesium.defined(this._origin)){if(this._origin.equals(this.origin)&&this._extents.equals(this.extents)&&this._rotation.equals(this.rotation))return!1;this._origin.copyFrom(this.origin),this._extents.copyFrom(this.extents),this._rotation.copyFrom(this.rotation)}else this._origin=this.origin.clone(),this._extents=this.extents.clone(),this._rotation=this.rotation.clone();var e=this.extents,n=this.rotation,r=n.getRow(1,u),i=n.getRow(2,c),o=l;n.multiply(this.origin,o),o.sumOf(o,e,.5),n.multiplyTransposeInPlace(o);var a=e.x/Math.tan(this.fov),s=t.fromSumOf(o,i,a,f);return r.normalize(),i.normalize(),i.negate(),this.dest.copyFrom(s),this.dir.copyFrom(i),this.up.copyFrom(r),!0},a}),define("scripts/Bentley/Bim/SpatialView",["./View","../Math/Cartesian3","../Util/extend","../Math/Range3"],function(e,t,n,r){function i(t,n){e.call(this,t,n)}return n(e,i),i.prototype.adjustAspectRatio=function(t,n){var r=this.origin,i=this.extents,o=this.rotation;i.x=Math.abs(i.x),i.y=Math.abs(i.y),i.z=Math.abs(i.z);var a=Math.max(i.x,i.y);0==a&&(i.x=i.y=100),0==i.x&&(i.x=a),0==i.y&&(i.y=a);var s=i.x/i.y;if(!(Math.abs(1-s/t)<1e-9)){var u=i.clone();if(n||(s>1?i.y=i.x:i.x=i.y),n?s>t:t>1){var c=i.x/t;c<e.maxViewDelta?i.y=c:(i.y=e.maxViewDelta,i.x=e.maxViewDelta*t)}else{var c=i.y*t;c<e.maxViewDelta?i.x=c:(i.x=e.maxViewDelta,i.y=e.maxViewDelta/t)}var l=r.clone();o.multiply(l),l.x+=(u.x-i.x)/2,l.y+=(u.y-i.y)/2,o.multiplyTranspose(r,l)}},i.prototype.toSpatialView=function(){return this},i.prototype.setOrigin=function(e){this.origin.copyFrom(e)},i.prototype.setRotation=function(e){this.rotation.copyFrom(e)},i.prototype.setExtents=function(e){this.extents.copyFrom(e)},i.prototype.getViewedExtents=function(e){var t=Cesium.defined(e)?e:new r;return t.copyFrom(this.bim.projectExtents),t},i.prototype.enableCamera=function(){},i.prototype.turnCameraOff=function(){},Cesium.defineProperties(i.prototype,{supportsCamera:{get:function(){return!1}}}),i}),define("scripts/Bentley/Bim/CameraInfo",[],function(){function e(e,t,n){this.lensAngle=e,this.focusDistance=t,this.eyePoint=n}return Cesium.defineProperties(e.prototype,{isFocusValid:{get:function(){return this.focusDistance>0&&this.focusDistance<1e14}},isLensValid:{get:function(){return e.isValidLensAngle(this.lensAngle)}},isValid:{get:function(){return this.isLensValid&&this.isFocusValid}}}),e.prototype.clone=function(){return new e(this.lensAngle,this.focusDistance,this.eyePoint.clone())},e.isValidLensAngle=function(e){return e>Math.PI/8&&e<Math.PI},e.prototype.invalidateFocus=function(){this.focusDistance=-1},e.prototype.equals=function(e){return e.lensAngle==this.lensAngle&&e.focusDistance==this.focusDistance&&e.eyePoint.equals(this.eyePoint)},e.prototype.validateLens=function(){this.isLensValid||(this.lensAngle=Math.PI/2)},e.prototype.copyFrom=function(e){this.lensAngle=e.lensAngle,this.focusDistance=e.focusDistance,this.eyePoint=e.eyePoint},e}),define("scripts/Bentley/Bim/CameraView",["./View","./SpatialView","../Math/Cartesian3","../Util/extend","./CameraInfo","../Math/Matrix3","../Math/Cartesian3","./NpcCorners","../Math/Constants","../Math/Cartesian2"],function(e,t,n,r,i,o,n,a,s,u){function c(e,r){t.call(this,e,r),Cesium.defined(e)&&(this.cameraInfo=new i(e.lensAngle,e.focusDistance,n.fromObject(e.eyePoint)),this._cameraOn=Cesium.defaultValue(e.isCameraOn,!0))}var l=new n,f=new n,h=new n,p=new n,m=new n;c.prototype.toUrl=function(){var t=this.cameraInfo.eyePoint,n=e.prototype.toUrl.call(this);return this.isCameraOn&&(n+="&eyePoint="+t.x+","+t.y+","+t.z+"&focusDistance="+this.cameraInfo.focusDistance+"&lensAngle="+this.cameraInfo.lensAngle),n},c.prototype.updateFromJson=function(t){e.prototype.updateFromJson.call(this,t),Cesium.defined(t.eyePoint)&&Cesium.defined(t.focusDistance)&&Cesium.defined(t.lensAngle)?(Cesium.defined(t.eyePoint)&&(this.cameraInfo.eyePoint=n.fromObject(t.eyePoint)),Cesium.defined(t.focusDistance)&&(this.cameraInfo.focusDistance=t.focusDistance),Cesium.defined(t.lensAngle)&&(this.cameraInfo.lensAngle=t.lensAngle),this.enableCamera()):this.turnCameraOff()},c.prototype.init=function(t){if(!this.isCameraOn)return e.prototype.init.call(this,t);if(Cesium.defined(t)&&this.cameraInfo.copyFrom(t),Cesium.defined(this._origin)){if(this._origin.equals(this.origin)&&this._extents.equals(this.extents)&&this._rotation.equals(this.rotation)&&this._cameraInfo.equals(this.cameraInfo))return!1;this._origin.copyFrom(this.origin),this._extents.copyFrom(this.extents),this._rotation.copyFrom(this.rotation),this._cameraInfo.copyFrom(this.cameraInfo)}else this._origin=this.origin.clone(),this._extents=this.extents.clone(),this._rotation=this.rotation.clone(),this._cameraInfo=this.cameraInfo.clone();var n=this.extents;this.fov=2*Math.atan2(n.x/2,this.cameraInfo.focusDistance),i.isValidLensAngle(this.fov)||(this.fov=Math.PI/2);var r=this.rotation,a=this.origin.clone(l),s=this.cameraInfo.eyePoint.clone(f);o.multiplyByVector(r,a,a),o.multiplyByVector(r,s,s);var u=h;u.x=a.x+n.x/2,u.y=a.y+n.y/2,u.z=s.z-this.cameraInfo.focusDistance;var c=p;r.multiplyTranspose(c,u);var d=r.getRow(0),v=r.getRow(1),g=m;return g.normalizedDifference(this.cameraInfo.eyePoint,c),d.normalizedCrossProduct(v,g),v.normalizedCrossProduct(g,d),g.negate(),this.dest.copyFrom(this.cameraInfo.eyePoint),this.dir.copyFrom(g),this.up.copyFrom(v),!0},c.prototype.clone=function(){var e=new c(void 0,this.bim);return e.copyFrom(this),e.cameraInfo=this.cameraInfo.clone(),e._cameraOn=this._cameraOn,e},c.prototype.equals=function(e){return!!this.isEqual(e)&&(this.isCameraOn==e.isCameraOn&&(!this.isCameraOn||this.cameraInfo.equals(e.cameraInfo)))},r(t,c);var d=new n;Cesium.defineProperties(c.prototype,{frontDistance:{get:function(){return this.backDistance-this.extents.z}},backDistance:{get:function(){var e=n.subtract(this.cameraInfo.eyePoint,this.origin,d);return this.rotation.multiply(e),e.z}},targetPoint:{get:function(){return this.getCameraTarget()}},eyePoint:{get:function(){return this.cameraInfo.eyePoint}},lensAngle:{get:function(){return this.cameraInfo.lensAngle},set:function(e){this.cameraInfo.lensAngle=e}},focusDistance:{get:function(){return this.cameraInfo.focusDistance},set:function(e){this.cameraInfo.focusDistance=e}},supportsCamera:{get:function(){return!0}},isCameraOn:{get:function(){return this._cameraOn}}}),c.prototype.enableCamera=function(){this._cameraOn=!0},c.prototype.turnCameraOff=function(){this._cameraOn=!1},c.prototype._setupFromFrustum=function(e){if(!this._baseSetupFromFrustum(e))return!1;if(!this.isCameraOn)return!0;var t=e.pts,r=t[a.NPC_000].distance(t[a.NPC_100]),i=t[a.NPC_001].distance(t[a.NPC_101]),o=1e-6;if(i>r*(1+o))return!1;var s=i/r,u=t[a.NPC_000].clone(),c=this.extents.clone(),l=this.zVector,f=n.fromStartEnd(u,t[a.NPC_001]),h=n.fromScale(f,1/(1-s)),p=n.fromSumOf(u,h),m=h.dot(l);if(0==m)return!1;var d=m-c.z/2,v=d/m;return u.sumOf(p,h,-v),u.sumOf(u,l,d-m),c.x*=v,c.y*=v,this.cameraInfo.eyePoint.copyFrom(p),this.cameraInfo.focusDistance=d,this.origin.copyFrom(u),this.extents.copyFrom(c),this.cameraInfo.lensAngle=this.calcLensAngle(),!0};var v=new n;c.prototype.getCameraTarget=function(t){if(!this.isCameraOn)return e.prototype.getCameraTarget.call(this,t);Cesium.defined(t)||(t=new n);var r=this.rotation.getRow(2,v);return t.sumOf(this.cameraInfo.eyePoint,r,-1*this.cameraInfo.focusDistance),t};var g=new n,y=new n;c.prototype.centerEyePoint=function(e){var t=Cesium.defaultValue(e,this.backDistance),r=this.extents.clone(g),i=y;i.scaleByVector(r,.5),i.z=t,this.rotation.multiplyTransposeInPlace(i),i.add(this.origin),n.clone(i,this.cameraInfo.eyePoint)},c.prototype.centerFocusDistance=function(){var e=this.backDistance,t=this.frontDistance,r=this.cameraInfo.eyePoint.clone(),i=n.fromSumOf(r,this.zVector,t-e);return this.lookAtUsingLensAngle(r,i,this.yVector,this.cameraInfo.lensAngle,t,e)};var w=new n;c.prototype.lookAtUsingLensAngle=function(e,t,n,r,i,o){var a=w;a.differenceOf(e,t);var c=a.normalize();if(c<s.oneMillimeter)return!1;if(r<1e-4||r>Math.pi)return!1;var l=2*Math.tan(r/2)*c,f=new u(this.extents.x,this.extents.y),h=Math.max(f.x,f.y);return f.scale(l/h),this.lookAt(e,t,n,f,i,o)};var x=new n,b=new n;return c.prototype.lookAt=function(t,r,i,a,u,c){var l=i.clone();if(l.normalize()<=s.mgds_fc_epsilon)return!1;var f=n.fromDifferenceOf(t,r),h=f.normalize();if(h<=s.oneMillimeter)return!1;var p=new n;if(!(p.normalizedCrossProduct(l,f)<=s.mgds_fc_epsilon)){if(l.normalizedCrossProduct(f,p)<=s.mgds_fc_epsilon)return!1;var m=o.fromRowVectors(p,l,f),d=Cesium.defaultValue(c,this.backDistance),v=Cesium.defaultValue(u,this.frontDistance),g=x;Cesium.defined(a)?(g.x=Math.abs(a.x),g.y=Math.abs(a.y)):(g.x=this.extents.x,g.y=this.extents.y),v=Math.max(v,s.oneMillimeter),d=Math.max(d,h+s.oneMillimeter),d<h&&(d=h+s.oneMillimeter),g.z=d-v;var y=b;return y.scaleByVector(g,v/h),!!e.validateViewDelta(y)&&(!(g.z>this.calculateMaxDepth(g,f))&&(this.origin.sumOf3ScaledVectors(t,f,-d,p,-.5*g.x,l,-.5*g.y),n.clone(t,this.cameraInfo.eyePoint),o.clone(m,this.rotation),this.cameraInfo.focusDistance=h,n.clone(g,this.extents),this.cameraInfo.lensAngle=this.calcLensAngle(),this.enableCamera(),!0))}},c.prototype.verifyFocusPlane=function(){if(this.isCameraOn){var e=this.cameraInfo,t=n.fromStartEnd(this.origin,e.eyePoint);this.rotation.multiply(t);var r=t.z,i=r-this.extents.z;if(r<=0||i<=0){var o=Math.tan(e.lensAngle/2);return r=this.extents.z/o,e.focusDistance=r/2,void this.centerEyePoint(r)}var a=e.focusDistance;if(!(a>i&&a<r)){e.focusDistance=this.extents.z/2+i;var s=e.focusDistance/a;this.extents.x*=s,this.extents.y*=s;var u=this.rotation.getRow(0),c=this.rotation.getRow(1),l=this.rotation.getRow(2);this.origin.sumOf3ScaledVectors(e.eyePoint,l,-r,u,-.5*this.extents.x,c,-.5*this.extents.y)}}},c.prototype.calcLensAngle=function(){var e=Math.max(this.extents.x,this.extents.y);return 2*Math.atan2(.5*e,this.cameraInfo.focusDistance)},c.prototype.calculateMaxDepth=function(e,t){var n=1e8,r=1e5,i=Math.min(Math.abs(t.x),Math.abs(t.y)),o=0==i?n:Math.min(r/i,n);return Math.max(e.x,e.y)*o},c.prototype.toCameraView=function(){return this},c}),define("scripts/Bentley/Math/Matrix4",["./Cartesian3","./Matrix3"],function(e,t){return Cesium.Matrix4.prototype.setRowValues=function(e,t,n,r,i){Cesium.Matrix4.setRow(this,e,new Cesium.Cartesian4(t,n,r,i),this)},Cesium.Matrix4.prototype.initScaleAndTranslate=function(e,t){this.setRowValues(0,e.x,0,0,t.x),this.setRowValues(1,0,e.y,0,t.y),this.setRowValues(2,0,0,e.z,t.z),this.setRowValues(3,0,0,0,1)},Cesium.Matrix4.initFromRange=function(t,n,r,i){if(!Cesium.defined(t)&&!Cesium.defined(n))throw new Cesium.DeveloperError("Invalid Parameters");var o=e.fromDifferenceOf(i,r);0==o.x&&(o.x=1),0==o.y&&(o.y=1),0==o.z&&(o.z=1);var a=new Cesium.Matrix3;if(Cesium.defined(t)&&(a.initFromScaleFactors(o.x,o.y,o.z),t.initFromMatrixAndTranslation(a,r)),Cesium.defined(n)){var s=new e(-r.x/o.x,-r.y/o.y,-r.z/o.z);a.initFromScaleFactors(1/o.x,1/o.y,1/o.z),n.initFromMatrixAndTranslation(a,s)}},Cesium.Matrix4.fromIdentity=function(){return Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY)},Cesium.Matrix4.prototype.initIdentity=function(){this.copyFrom(Cesium.Matrix4.IDENTITY)},Cesium.Matrix4.prototype.copyFrom=function(e){Cesium.Matrix4.clone(e,this)},Cesium.Matrix4.prototype.initFromMatrix=function(e){this.initFromMatrixAndTranslation(e,void 0)},Cesium.Matrix4.prototype.initFromTranslation=function(e){this.initFromMatrixAndTranslation(void 0,e)},Cesium.Matrix4.fromTranslation=function(e,t){return Cesium.defined(t)||(t=new Cesium.Matrix4),t.initFromTranslation(e),t},Cesium.Matrix4.fromMatrixAndTranslation=function(e,t,n){return Cesium.defined(n)||(n=new Cesium.Matrix4),n.initFromMatrixAndTranslation(e,t),n},Cesium.Matrix4.prototype.initFromMatrixAndTranslation=function(t,n){t=Cesium.defaultValue(t,Cesium.Matrix3.IDENTITY),n=Cesium.defaultValue(n,e.ZERO),Cesium.Matrix4.fromRotationTranslation(t,n,this)},Cesium.Matrix4.prototype.initProduct=function(e,t){Cesium.Matrix4.multiply(e,t,this)},Cesium.Matrix4.fromProduct=function(e,t,n){return Cesium.defined(n)||(n=new Cesium.Matrix4),Cesium.Matrix4.multiply(e,t,n)},Cesium.Matrix4.prototype.multiplyByPointAsVector=function(t,n){return Cesium.defined(n)||(n=new e),Cesium.Matrix4.multiplyByPointAsVector(this,t,n)},Cesium.Matrix4.prototype.multiplyByPoint=function(t,n){return Cesium.defined(n)||(n=new e),Cesium.Matrix4.multiplyByPoint(this,t,n)},Cesium.Matrix4.prototype.element=function(e,t){if(e>3||t>3||e<0||t<0)throw new Cesium.DeveloperError("Invalid row or column");return this[4*t+e]},Cesium.Matrix4.prototype.setElement=function(e,t,n){if(e>3||t>3||e<0||t<0)throw new Cesium.DeveloperError("Invalid row or column");this[4*t+e]=n},Cesium.Matrix4.prototype.multiplyAndRenormalize=function(t,n){Cesium.defined(n)||(n=new e);var r=t.x,i=t.y,o=t.z,a=this.element(0,0)*r+this.element(0,1)*i+this.element(0,2)*o+this.element(0,3),s=this.element(1,0)*r+this.element(1,1)*i+this.element(1,2)*o+this.element(1,3),u=this.element(2,0)*r+this.element(2,1)*i+this.element(2,2)*o+this.element(2,3),c=this.element(3,0)*r+this.element(3,1)*i+this.element(3,2)*o+this.element(3,3),l=1==c||0==c?1:1/c;return n.x=a*l,n.y=s*l,n.z=u*l,n},Cesium.Matrix4.prototype.multiplyAndRenormalizeArray=function(e,t){for(var n=Cesium.defaultValue(t,e),r=0;r<e.length;r++)this.multiplyAndRenormalize(e[r],n[r])},Cesium.Matrix4.fromFixedPointAndScaleFactors=function(e,t,n,r){return new Cesium.Matrix4(t,0,0,(1-t)*e.x,0,n,0,(1-n)*e.y,0,0,r,(1-r)*e.z,0,0,0,1)},Cesium.Matrix4.fromMatrixAndFixedPoint=function(e,t,n){return Cesium.defined(n)||(n=new Cesium.Matrix4),n.initFromMatrixAndFixedPoint(e,t),n},Cesium.Matrix4.prototype.initFromMatrixAndFixedPoint=function(e,t){this.initFromMatrix(e),this.setFixedPoint(t)},Cesium.Matrix4.prototype.setFixedPoint=function(e){var t=e.x,n=e.y,r=e.z;this.setColumnValues(3,e.x-this.element(0,0)*t-this.element(0,1)*n-this.element(0,2)*r,e.y-this.element(1,0)*t-this.element(1,1)*n-this.element(1,2)*r,e.z-this.element(2,0)*t-this.element(2,1)*n-this.element(2,2)*r)},Cesium.Matrix4.prototype.setColumn=function(e,t){Cesium.Matrix4.setColumn(this,e,t,this)},Cesium.Matrix4.prototype.setColumnValues=function(e,t,n,r,i){this.setColumn(e,new Cesium.Cartesian4(t,n,r,Cesium.defaultValue(i,1)))},Cesium.Matrix4.prototype.multiplyArray=function(e,t){Cesium.defined(t)||(t=e);for(var n=0;n<e.length;n++)this.multiplyByPoint(e[n],t[n])},Cesium.Matrix4.prototype.inverseOf=function(e){Cesium.Matrix4.inverse(e,this)},Cesium.Matrix4.prototype.scaleCompleteRows=function(e,t,n,r){for(var i=0;i<4;i++)this.setElement(0,i,e.element(0,i)*t),this.setElement(1,i,e.element(1,i)*n),this.setElement(2,i,e.element(2,i)*r);this.setRowValues(3,0,0,0,1)},Cesium.Matrix4.prototype.multiply=function(e,t){return t=Cesium.defaultValue(t,e),Cesium.Matrix4.multiplyByPoint(this,e,t),t},Cesium.Matrix4.fromLineAndRotationAngle=function(e,t,n){var r=new Cesium.Matrix4;return r.initFromLineAndRotationAngle(e,t,n),r},Cesium.Matrix4.prototype.initFromLineAndRotationAngle=function(n,r,i){var o=e.fromDifferenceOf(r,n),a=t.fromVectorAndRotationAngle(o,i);this.initFromMatrixAndFixedPoint(a,n)},Cesium.Matrix4.prototype.initFromAxisAndRotationAngle=function(e,t,n){
var r=Cesium.Matrix3.fromVectorAndRotationAngle(t,n);this.initFromMatrixAndFixedPoint(r,e)},Cesium.Matrix4}),define("scripts/Bentley/Bim/CoordSystem",[],function(){var e={Screen:0,View:1,Npc:2,World:3};return e}),define("scripts/Bentley/Tools/ViewPan",["./ViewingToolHandle","../Util/extend","../Math/Cartesian3","./ViewHandleType","./ViewManipHitPriority","./Cursor"],function(e,t,n,r,i,o){function a(t){e.call(this,t),this.anchorPt=new n,this.lastPtNpc=new n,this.lastGoodNpc=new n,this.handleType=r.ViewPan}a.prototype.getHandleCursor=function(){return this.viewTool.isDragging?o.ClosedHand:o.OpenHand};var s={doPan:{dist:new n,firstPt:new n,secondPt:new n},doManipulation:{newPtWorld:new n,thisPtNpc:new n,firstPtNpc:new n}};return a.prototype.doManipulation=function(e,t){var n=s.doManipulation,r=this.viewport,i=e.point.clone(n.newPtWorld),o=r.worldToNpc(i,n.thisPtNpc),a=r.worldToNpc(this.anchorPt,n.firstPtNpc);return o.z=a.z,!!this.lastPtNpc.isEqual(o,1e-10)||(i=r.npcToWorld(o,i),this.lastPtNpc.copyFrom(o),this.doPan(i))},a.prototype.firstPoint=function(e){var t=this.viewport;if(this.anchorPt.copyFrom(e.point),t.isCameraOn){var n=t.pickDepthBuffer(e.viewPoint);if(Cesium.defined(n))this.anchorPt.copyFrom(n);else{var r=t.worldToNpc(this.anchorPt);r.z=t.getFocusPlaneNpc(),this.anchorPt=t.npcToWorld(r,this.anchorPt)}}return!0},a.prototype.onReinitialize=function(){var e=this.viewTool.viewHandles.hitHandle;e==this&&this.viewTool.toolAdmin.setViewCursor(this.getHandleCursor())},a.prototype.testHandleForHit=function(e){return{distance:0,priority:i.Low}},a.prototype.doPan=function(e){var t=s.doPan,r=this.viewport;if(r.isCameraOn){var i=n.fromDifferenceOf(this.anchorPt,e,t.dist),o=r.view,a=n.fromSumOf(o.eyePoint,i,void 0,t.firstPt);if(r.pointIsBelowSurface(a))return this.doPan(this.resetNpcYCoordinate(e));this.setLastGoodNpc(e);var u=n.fromSumOf(o.targetPoint,i,void 0,t.secondPt);if(!o.lookAt(a,u,o.yVector))return!1;r.synchWithView(!1)}else{var c=r.worldToView(this.anchorPt,t.firstPt),l=r.worldToView(e,t.secondPt),i=n.fromDifferenceOf(c,l,t.dist),f=Math.floor(i.x),h=Math.floor(i.y);if(!r.scroll(f,h))return!1}return!0},a.prototype.resetNpcYCoordinate=function(e){var t=this.viewport.worldToNpc(e);return t.y=this.lastGoodNpc.y,this.viewport.npcToWorld(t,e)},a.prototype.setLastGoodNpc=function(e){this.lastGoodNpc.copyFrom(this.viewport.worldToNpc(e)),this.lastGoodNpc.isEqual(this.lastPtNpc)&&this.lastPtNpc.copyFrom(this.lastGoodNpc)},t(e,a),a}),define("scripts/Bentley/Tools/ViewRotate",["./ViewingToolHandle","../Util/extend","../Math/Cartesian3","./ViewHandleType","./ViewManipHitPriority","../Bim/Frustum","./ViewToolSettings","../Math/Matrix3","../Math/Matrix4","./Cursor"],function(e,t,n,r,i,o,a,s,u,c){function l(t){e.call(this,t),this.handleType=r.ViewRotate,this.ballVector0=new n,this.lastPtNpc=new n,this.firstPtNpc=new n,this.frustum=new o,this.activeFrustum=new o}t(e,l);var f={firstPoint:{pickPt:new n,pickPtOrig:new n,viewPt:new n},doManipulation:{ptNpc:new n,currentFrustum:new o,currPt:new n}};return l.prototype.getHandleCursor=function(){return c.Rotate},l.prototype.testHandleForHit=function(e){var t=this.viewport.worldToView(this.viewTool.targetCenterWorld),n=t.distanceXY(e);if(!(this.viewTool.useSphere&&this.viewport.allow3dManipulations&&n>this.viewTool.ballRadius+3))return{distance:n,priority:i.Normal}},l.prototype.firstPoint=function(e){if(this.viewport.toolAdmin.isGesturePending)return!1;var t;this.viewport.allow3dManipulations&&(t=this.viewport.pickDepthBuffer(e.viewPoint,f.firstPoint.pickPt)),Cesium.defined(t)?this.viewTool.setTargetCenterWorld(t):t=e.point.clone(f.firstPoint.pickPt);var n=t.clone(f.firstPoint.pickPtOrig),r=this.viewport.worldToView(t,f.firstPoint.viewPt);return this.viewTool.viewPtToSpherePt(r,!0,this.ballVector0),this.viewport.worldToNpc(n,this.firstPtNpc),this.lastPtNpc.copyFrom(this.firstPtNpc),this.viewport.getWorldFrustum(this.activeFrustum),this.frustum.copyFrom(this.activeFrustum),!0},l.prototype.doManipulation=function(e,t){var r=this.viewport,i=r.worldToNpc(e.point,f.doManipulation.ptNpc);if(this.lastPtNpc.isEqual(i,1e-10))return!0;this.firstPtNpc.isEqual(i,.01)&&i.copyFrom(this.firstPtNpc),this.lastPtNpc.copyFrom(i);var o=r.getWorldFrustum(f.doManipulation.currentFrustum),u=!o.equals(this.activeFrustum);if(u)this.frustum.copyFrom(o);else if(!r.setupFromFrustum(this.frustum))return!1;var c=r.npcToView(i,f.doManipulation.currPt);u&&(this.firstPtNpc.copyFrom(i),this.viewTool.viewPtToSpherePt(c,!0,this.ballVector0));var l=0,h=new n,p=this.viewTool.targetCenterWorld;if(this.viewTool.useSphere||!r.allow3dManipulations){var m=this.viewTool.viewPtToSpherePt(c,!0),d=new n;l=this.viewTool.ballPointsToMatrix(void 0,d,this.ballVector0,m);var v=r.rotMatrix,g=v.getRow(0),y=v.getRow(1),w=v.getRow(2);h.sumOf3ScaledVectors(n.ZERO,g,d.x,y,d.y,w,d.z)}else{var x=r.getViewRect(),b=x.width,C=x.height,c=r.npcToView(i),M=r.npcToView(this.firstPtNpc),T=c.x-M.x,N=c.y-M.y,E=a.preserveWorldUp?this.viewTool.worldUpVector.clone():r.rotMatrix.getRow(1),A=r.rotMatrix.getRow(0),S=new s;T?S.initFromVectorAndRotationAngle(E,Math.PI/(b/T)):S.initIdentity();var P=new s;N?P.initFromVectorAndRotationAngle(A,Math.PI/(C/N)):P.initIdentity();var O=s.fromProduct(P,S);l=-O.getRotationAngleAndVector(h)}return this.rotateViewWorld(p,h,l),r.getWorldFrustum(this.activeFrustum),!0},l.prototype.rotateViewWorld=function(e,t,n){var r=s.fromVectorAndRotationAngle(t,n),i=u.fromMatrixAndFixedPoint(r,e),o=this.frustum.clone();o.multiply(i),this.viewport.setupFromFrustum(o),this.viewport.moveViewToSurfaceIfRequired()},l}),define("scripts/Bentley/Tools/OrientationResult",[],function(){var e={Success:0,NoEvent:1,Disabled:2,RejectedByController:3};return e}),define("scripts/Bentley/Tools/NavigateMode",[],function(){var e={Pan:0,Look:1,Travel:2};return e}),define("scripts/Bentley/Tools/NavigateMotion",["../Math/Matrix4","../Math/Cartesian3","../Math/Matrix3"],function(e,t,n){function r(t){this.viewport=t,this.deltaTime=0,this.transform=e.fromIdentity()}r.prototype.init=function(e){this.deltaTime=.001*e,this.transform.initIdentity()},r.prototype.getViewUp=function(e){var n=Cesium.defined(e)?e:new t;return this.viewport.rotMatrix.getRow(1,n),n},r.prototype.getViewDirection=function(e){var n=Cesium.defined(e)?e:new t;return this.viewport.rotMatrix.getRow(2,n),n.scale(-1),n};var i=new t(0,0,0);r.prototype.takeElevator=function(e){var t=i;t.z=e*this.deltaTime,this.transform.initFromTranslation(t)};var o=new t,a=new t;r.prototype.modifyPitchAngleToPreventInversion=function(e){var n=Math.PI/180*85,r=Math.PI/180*.01;if(0==e)return 0;var i=this.getViewUp(o),s=this.getViewDirection(a),u=t.UNIT_Z,c=u.angleTo(i);s.z<0&&(c*=-1);var l=e+c;if(Math.abs(l)<n)return e;if(e>0!=c>0&&Math.abs(e)<Math.PI/2)return e;if(Math.abs(c)>=n-r)return 0;var f=Math.abs(l)-n;return l=e>0?e-f:e+f},r.prototype.getWorldUp=function(e){var n=Cesium.defined(e)?e:new t;return this.viewport.geometry.rootTransform.multiplyByPointAsVector(t.UNIT_Z,n),n};var s=new t,u=new n,c=new n,l=new n,f=new n;r.prototype.generateRotationTransform=function(t,r,i){var o=Cesium.defined(i)?i:new e,a=t*this.deltaTime,h=this.modifyPitchAngleToPreventInversion(r*this.deltaTime),p=n.fromInverseOf(this.viewport.rotMatrix,u),m=this.getWorldUp(s),d=n.fromVectorAndRotationAngle(m,a,c),v=n.fromPrincipleAxisRotations(this.viewport.rotMatrix,h,0,0,l);v.initProduct(p,v);var g=n.fromProduct(d,v,f);return o.initFromMatrixAndFixedPoint(g,this.viewport.view.dest),o};var h=[new t,new t,new t],p=[new t,new t,new t],m=[new t,new t,new t],d=new t,v=new t,g=new t,y=new t,w=new t,x=new t,b=new t;r.prototype.generateTranslationTransform=function(n,r,i){var o=Cesium.defined(i)?i:new e,a=h;if(a[0].zero(),a[1].init(1,0,0),a[2].init(0,1,0),this.viewport.isCameraOn){var s=p;this.viewport.viewToNpcArray(a,s),s[0].z=s[1].z=s[2].z=this.viewport.getFocusPlaneNpc(),this.viewport.npcToViewArray(s,a)}var u=m;this.viewport.viewToWorldArray(a,u);var c=t.fromDifferenceOf(u[1],u[0],y);c.normalize(),c.scale(n.x*this.deltaTime);var l=t.fromDifferenceOf(u[2],u[0],w);l.normalize(),l.scale(n.y*this.deltaTime);var f;if(r){var C=this.getViewDirection(d),M=this.getWorldUp(v),T=t.fromCrossProduct(M,C,b);f=t.fromCrossProduct(T,M,x),f.normalize()}else f=this.getViewDirection(x);f.scale(n.z*this.deltaTime);var N=g;return N.sumOf(c,l),N.sumOf(N,f),o.initFromTranslation(N),o};var C=new e,M=new e;r.prototype.moveAndLook=function(e,t,n,r){var i=this.generateRotationTransform(t,n,C),o=this.generateTranslationTransform(e,r,M);this.transform.initProduct(i,o)};var T=new t;r.prototype.pan=function(e,t){var n=T;n.init(e,t,0),this.moveAndLook(n,0,0,!1)};var N=new t;r.prototype.travel=function(e,t,n,r){var i=N;i.init(0,0,n),this.moveAndLook(i,e,t,r)},r.prototype.look=function(e,t){this.generateRotationTransform(e,t,this.transform)};var E=new t,A=new t;return r.prototype.resetToLevel=function(){var e=this.getViewDirection(d);if(Math.abs(e.z)<.001)return void this.transform.initIdentity();var n=e.clone(E);n.z=0;var r=e.angleTo(n),i=this.viewport.eyePoint,o=t.fromCrossProduct(e,n,A);this.transform.initFromAxisAndRotationAngle(i,o,r)},r}),define("scripts/Bentley/Tools/ViewNavigate",["./ViewingToolHandle","../Util/extend","../Math/Cartesian3","./ViewToolSettings","./ViewManipHitPriority","../Math/Matrix4","../Math/Matrix3","./ViewHandleType","./ToolId","./OrientationResult","./NavigateMode","./NavigateMotion","./Cursor","../Bim/Frustum","./ViewTool"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m){function d(e,t,n){this.parentElement=e;var r="1px solid "+Cesium.defaultValue(n,"white"),i=7,o=2*i+1,a=document.createElement("div");a.className="bim-overlay-box-rule-horizontal",this.hor=a;var s=a.style;s.height="0px",s.width=o+"px",s.top=t.y+"px",s.left=t.x-i+"px",s.borderBottom=r,e.appendChild(a);var u=document.createElement("div");u.className="bim-overlay-box-rule-vertical",this.ver=u,s=u.style,s.width="0px",s.height=o+"px",s.left=t.x+"px",s.top=t.y-i+"px",s.borderLeft=r,e.appendChild(u)}function v(t){e.call(this,t),this.anchorPtView=new n,this.lastPtView=new n,this.initialized=!1,this.lastMotionTime=0,this.orientationValid=!1,this.orientationTime=0,this.orientationZ=new n}d.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.parentElement.removeChild(this.hor),this.parentElement.removeChild(this.ver))},t(e,v),v.prototype.haveStaticOrientation=function(e,t){var n=.075;if(!this.orientationValid||e.angleTo(this.orientationZ)>n||this.orientationZ.isZero())return this.orientationValid=!0,this.orientationTime=t,this.orientationZ=e,!1;var r=500;return t-this.orientationTime>r},v.prototype.tryOrientationEvent=function(e,t){return{eventsEnabled:!1,result:c.NoEvent}},v.prototype.getElapsedTime=function(e){var t=e-this.lastMotionTime;return(0==this.lastMotionTime||t<0||t>1e3)&&(t=100),t},v.prototype.getMaxLinearVelocity=function(){return r.walkVelocity},v.prototype.getMaxAngularVelocity=function(){return Math.PI/4},v.prototype.testHandleForHit=function(e){return{distance:0,priority:i.Low}},v.prototype.getInputVector=function(e){var t=Cesium.defined(e)?e:new n,r=5;t.differenceOf(this.lastPtView,this.anchorPtView);var i=this.viewport.getViewRect();return Math.abs(t.x)<r?t.x=0:t.x=2*t.x/i.width,Math.abs(t.y)<r?t.y=0:t.y=2*t.y/i.height,t.x=Math.min(t.x,1),t.y=Math.min(t.y,1),t},v.prototype.getCenterPoint=function(e){var t=Cesium.defined(e)?e:new n;t.zero();var r=this.viewport.getViewRect(),i=r.width,o=r.height;return i>0&&(t.x=i/2),o>0&&(t.y=o/2),t},v.prototype.getNavigateMode=function(){var e=this.viewport.toolAdmin.currentInputState;return e.isShiftDown||!this.viewport.isCameraOn?l.Pan:e.isControlDown?l.Look:l.Travel};var g=new n,y=new p;return v.prototype.doNavigate=function(e){var t=Date.now(),n=g,r=this.tryOrientationEvent(n,e),i=r.result,o=(r.eventsEnabled,this.getElapsedTime(t));this.lastMotionTime=t;var a=this.viewport,s=this.getNavigateMotion(o),u=Cesium.defined(s);if(u){var l=a.getWorldFrustum(y);if(l.multiply(s.transform),a.setupFromFrustum(l),u=!1,c.NoEvent==i)return!1}return!!u||c.Success==i&&!this.haveStaticOrientation(n,t)},v.prototype.doManipulation=function(e,t){return!t||(this.lastPtView.copyFrom(e.viewPoint),this.doNavigate(e))},v.prototype.noMotion=function(e){return this.doNavigate(e),!1},v.prototype.onReinitialize=function(){if(!this.initialized){this.initialized=!0;var e=this.viewport,t=e.view.toSpatialView();if(Cesium.defined(t)&&e.allow3dManipulations){var n=e.getWorldFrustum(),i=r.walkCameraAngle*(Math.PI/180);this.viewTool.lensAngleMatches(i,10*(Math.PI/180))&&this.viewTool.isZUp()||this.viewTool.setCameraLensAngle(i,this.viewTool.lensAngleMatches(i,45*(Math.PI/180))),r.walkEnforceZUp&&this.viewTool.enforceZUp(t.getCameraTarget());var o=e.getWorldFrustum();n.equals(o)||m.animateFrustumChange(e,n,o),this.getCenterPoint(this.anchorPtView)}}},v.prototype.firstPoint=function(e){return this.lastPtView.copyFrom(e.viewPoint),this.anchorPtView.copyFrom(this.lastPtView),this.decoration=new d(this.viewport.canvas.parentElement,this.anchorPtView,this.viewport.getContrastToBackgroundColor()),!0},v.prototype.getHandleCursor=function(){return h.CrossHair},v.prototype.focusOut=function(){this.decoration=this.decoration&&this.decoration.destroy()},v}),define("scripts/Bentley/Tools/ViewWalk",["./ViewNavigate","./ViewHandleType","./NavigateMotion","../Util/extend","./NavigateMode","../Math/Cartesian3"],function(e,t,n,r,i,o){function a(r){e.call(this,r),this.handleType=t.ViewWalk,this.navigateMotion=new n(this.viewport)}r(e,a);var s=new o;return a.prototype.getNavigateMotion=function(e){var t=this.getInputVector(s);if(0!=t.x||0!=t.y){var n=this.navigateMotion;switch(n.init(e),this.getNavigateMode()){case i.Pan:t.scale(this.getMaxLinearVelocity()),n.pan(t.x,t.y);break;case i.Look:t.scale(-this.getMaxAngularVelocity()),n.look(t.x,t.y);break;case i.Travel:n.travel(-t.x*this.getMaxAngularVelocity(),0,-t.y*this.getMaxLinearVelocity(),!0)}return n}},a}),define("scripts/Bentley/Tools/ViewManip",["./ViewHandleArray","./ViewHandleType","./ViewingToolHandle","./ViewTool","../Util/extend","../Math/Cartesian3","../Bim/Frustum","../Util/dynamicCast","../Bim/CameraView","../Math/Matrix3","../Math/Matrix4","../Math/Constants","../Bim/CoordSystem","../Bim/NpcCorners","./ViewToolSettings","./ButtonEvent","./ViewPan","./ViewRotate","./ToolId","./ViewWalk"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m,d,v,g,y,w){function x(n,i,s,u,c,l){r.call(this,n,Cesium.defaultValue(l,y.ViewManip)),this.handleMask=i,this.isOneShot=s,this.scrollOnNoMotion=u,this.isDragOperationRequired=Cesium.defaultValue(c,!1),this.useSphere=m.dynamicRotationSphere&&!s,this.wantMotionStop=!0,this.isDragOperation=!1,this.targetCenterValid=!1,this.lastPtScreen=new o,this.targetCenterWorld=new o,this.ballRadius=0,this.worldUpVector=new o,this.forcedHandle=t.None,this.lastFrustum=new a,this.viewHandles=new e(this),i&t.ViewPan&&this.viewHandles.add(new v(this)),i&t.Rotate&&(this.synchViewBallInfo(!0),this.viewHandles.add(new g(this))),i&t.ViewWalk&&this.viewHandles.add(new w(this)),this.onReinitialize()}var b={viewPtToSpherePt:{targetCenterView:new o,ballMouse:new o},ballPointsToMatrix:{normal:new o},screenRangeAndFrustum:{screenRange:new o,frustum:new a,testPtView:new o},updateTargetCenter:{center:new o},zup:{viewX:new o,viewY:new o,viewZ:new o,rotMatrix:new c,transform:new l,frust:new a},fitView:{before:new a},setTargetCenterWorld:{viewPt:new o},setCameraLensAngle:{xVec:new o,yVec:new o,zVec:new o,targetNpc:new o,corners:[new o,new o,new o],eye:new o}};x.prototype.onReinitialize=function(){this.viewport.toolAdmin.gesturePending=!1,this.viewport.synchWithView(!0),this.nPts=0,this.isDragging=!1,this.frustumValid=!1,this.viewHandles.onReinitialize()},x.prototype.onDataButtonDown=function(e){if(0==this.nPts&&this.isDragOperationRequired&&!this.isDragOperation)return!1;switch(this.nPts){case 0:this.processFirstPoint(e)&&(this.nPts=1);break;case 1:this.nPts=2}return this.nPts>1&&(this.processPoint(e,!1)&&this.isOneShot?this.exitTool():this.onReinitialize()),!0},x.prototype.onDataButtonUp=function(e){return this.nPts<=1&&this.isDragOperationRequired&&!this.isDragOperation&&this.isOneShot&&this.exitTool(),!1},x.prototype.onMiddleButtonDown=function(e){return!1},x.prototype.onMiddleButtonUp=function(e){return this.nPts<=1&&!this.isDragOperation&&this.isOneShot&&this.exitTool(),!1},x.prototype.onMouseWheel=function(e){var n=e.clone();return this.handleMask&t.Rotate&&n.setPoint(this.targetCenterWorld),this.viewport.toolAdmin.processMouseWheelEvent(n,!1),this.doUpdate(!0),!0},x.prototype.onModelStartDrag=function(e){return this.isDragOperation=!0,this.viewport.toolAdmin.gesturePending=!1,0==this.nPts&&this.onDataButtonDown(e),!0},x.prototype.onModelEndDrag=function(e){return this.isDragOperation=!1,0==this.nPts||this.onDataButtonDown(e)},x.prototype.onModelMotion=function(e){0==this.nPts&&this.viewHandles.testHit(e.viewPoint)&&this.viewHandles.focusHitHandle(),0!=this.nPts&&this.processPoint(e,!0),this.viewHandles.motion(e)},x.prototype.onModelMotionStopped=function(e){0==this.nPts&&this.viewHandles.testHit(e.viewPoint)&&this.viewHandles.focusHitHandle()},x.prototype.onModelNoMotion=function(e){if(0!=this.nPts){var t=this.viewHandles.hitHandle;Cesium.defined(t)&&t.noMotion(e)&&this.doUpdate(!1)}},x.prototype.onCleanup=function(){this.viewport.synchWithView(!0),this.viewHandles.setFocus(-1),this.viewHandles.empty()};var C=new a;x.prototype.isSameFrustum=function(){var e=this.viewport.getWorldFrustum(C);return!(!this.frustumValid||!e.equals(this.lastFrustum))||(e.clone(this.lastFrustum),this.frustumValid=!0,!1)},x.prototype.viewPtToSpherePt=function(e,t,n){var r=this.viewport,i=this.ballRadius,a=r.worldToView(this.targetCenterWorld,b.viewPtToSpherePt.targetCenterView),s=b.viewPtToSpherePt.ballMouse;s.x=(e.x-a.x)/i,s.y=(e.y-a.y)/i;var u=s.x*s.x+s.y*s.y;if(u>1||!r.allow3dManipulations){if(u<=0)return;var c=1/Math.sqrt(u);s.x*=c,s.y*=c,s.z=0}else s.z=r.allow3dRotations?Math.sqrt(1-u):0;t&&(s.y=-s.y);var l=Cesium.defined(n)?n:new o;return l.copyFrom(s),l},x.prototype.ballPointsToMatrix=function(e,t,n,r){var i=b.ballPointsToMatrix.normal;i.crossProduct(r,n);var o=r.angleTo(n);return Cesium.defined(e)&&e.initFromVectorAndRotationAngle(i,o),Cesium.defined(t)&&t.copyFrom(i),o},x.prototype.synchViewBallInfo=function(e){var t=this.viewport.getFrustum(h.Screen,!1,b.screenRangeAndFrustum.frustum),n=b.screenRangeAndFrustum.screenRange;n.x=t.getCorner(p.NPC_000).distance(t.getCorner(p.NPC_100)),n.y=t.getCorner(p.NPC_000).distance(t.getCorner(p.NPC_010)),n.z=t.getCorner(p.NPC_000).distance(t.getCorner(p.NPC_001)),this.ballRadius=(n.x<n.y?n.x:n.y)*m.viewBallRadius,this.updateTargetCenter(),this.updateWorldUpVector(e)},x.prototype.updateTargetCenter=function(){if(!this.targetCenterValid){var e=b.updateTargetCenter.center;if(Cesium.defined(this.viewCmdTargetCenter)&&this.isPointVisible(this.viewCmdTargetCenter))return void this.setTargetCenterWorld(this.viewCmdTargetCenter,!0);this.viewport.allow3dManipulations?this.viewport.determineDefaultRotatePoint(e):(e=this.viewport.npcToWorld(new o(.5,.5,.5),e),e.z=0),this.setTargetCenterWorld(e,!1)}},x.prototype.setViewCmdTargetCenter=function(e){this.viewCmdTargetCenter=Cesium.defined(e)?e.clone(this.viewCmdTargetCenter):void 0},x.prototype.updateWorldUpVector=function(e){e&&(this.worldUpVector.x=0,this.worldUpVector.y=0,this.worldUpVector.z=1,l.multiplyByPointAsVector(this.viewport.geometry.rootTransform,this.worldUpVector,this.worldUpVector))},x.prototype.processFirstPoint=function(e){var n=this.forcedHandle;if(this.forcedHandle=t.None,this.frustumValid=!1,this.viewHandles.testHit(e.viewPoint,n)){this.isDragging=!0,this.viewHandles.focusHitHandle();var r=this.viewHandles.hitHandle;if(Cesium.defined(r)&&!r.firstPoint(e))return!1}return!0},x.prototype.processPoint=function(e,t){var n=this.viewHandles.hitHandle;if(!Cesium.defined(n))return!0;var r=n.doManipulation(e,t);return r&&this.doUpdate(!0),t||r&&n.checkOneShot()},x.distXY=function(e,t){return t.distanceXY(e)},x.prototype.lensAngleMatches=function(e,t){var n=s(this.viewport.view,u);return Cesium.defined(n)&&Math.abs(n.calcLensAngle()-e)<t},x.prototype.isZUp=function(){var e=this.viewport.view,t=e.rotation.getRow(0,b.zup.viewX),n=e.rotation.getRow(1,b.zup.viewY),r=(e.rotation.getRow(2,b.zup.viewZ),o.UNIT_Z);return Math.abs(r.dot(n))>.99&&Math.abs(r.dot(t))<.01},x.prototype.doUpdate=function(e){};var M=new d;return x.prototype.setTargetCenterWorld=function(e,t){this.targetCenterWorld.copyFrom(e),this.viewport.allow3dManipulations||(this.targetCenterWorld.z=0),this.targetCenterValid=!0,this.setViewCmdTargetCenter(t?e:void 0);var n=this.viewport.worldToView(this.targetCenterWorld,b.setTargetCenterWorld.viewPt),r=M;r.initEvent(this.targetCenterWorld,n,this.viewport),this.viewport.toolAdmin.setAdjustedDataPoint(r),r.reset()},x.prototype.invalidateTargetCenter=function(){this.targetCenterValid=!1},x.prototype.isPointVisible=function(e){var t=this.viewport.worldToView(e,b.screenRangeAndFrustum.testPtView),n=this.viewport.getFrustum(h.Screen,!1,b.screenRangeAndFrustum.frustum),r=b.screenRangeAndFrustum.screenRange;return r.x=n.getCorner(p.NPC_000).distance(n.getCorner(p.NPC_100)),r.y=n.getCorner(p.NPC_000).distance(n.getCorners(p.NPC_010)),r.z=n.getCorner(p.NPC_000).distance(n.getCorner(p.NPC_001)),!(t.x<0||t.x>r.x||t.y<0||t.y>r.y)},x.fitView=function(e,t,n){var i=e.computeViewRange(),o=e.getViewRect().aspect,a=e.getWorldFrustum(b.fitView.before);e.view.lookAtViewAlignedVolume(i,o,m.fitExpandsClipping),e.synchWithView(!1),t&&r.animateFrustumChange(e,a,e.getFrustum()),e.synchWithView(!0)},x.prototype.setCameraLensAngle=function(e,t){var n=s(this.viewport.view,u);if(!Cesium.defined(n))return!1;var r=b.setCameraLensAngle;this.viewport.rotMatrix.getRows(r.xVec,r.yVec,r.zVec);var i=n.eyePoint.clone(r.eye),o=n.targetPoint,a=n.backDistance,c=120*f.oneMillimeter;if(!t){o=this.viewport.determineDefaultRotatePoint();var l=this.viewport.worldToNpc(o,r.targetNpc),h=r.corners;h[0].init(0,0,l.z),h[1].init(0,1,l.z),h[2].init(1,0,l.z),this.viewport.npcToWorldArray(h);var p=new Cesium.Cartesian2(h[0].distance(h[1]),h[0].distance(h[2])),m=2*Math.tan(e/2),d=Math.max(p.x,p.y)/m;i.sumOf(o,r.zVec,d),a=2*d}return!!n.lookAtUsingLensAngle(i,o,r.yVec,e,c,a)&&(this.targetCenterValid=!1,this.viewport.synchWithView(!1),!0)},x.prototype.enforceZUp=function(e){if(this.isZUp())return!1;var t=this.viewport.view,n=(t.rotation.getRow(0,b.zup.viewX),t.rotation.getRow(1,b.zup.viewY)),r=(t.rotation.getRow(2,b.zup.viewZ),o.UNIT_Z),i=b.zup.rotMatrix;if(!i.initRotationFromVectorToVector(n,r))return!1;var a=l.fromMatrixAndFixedPoint(i,e,b.zup.transform),s=this.viewport.getWorldFrustum(b.zup.frust);return s.multiply(a),this.viewport.setupFromFrustum(s),!0},i(r,x),x}),define("scripts/Bentley/Tools/FitViewTool",["../Util/extend","./ViewTool","./ViewManip","./ToolId"],function(e,t,n,r){function i(e,n){t.call(this,e,r.FitView),this.oneShot=Cesium.defaultValue(n,!1)}return e(t,i),i.prototype.onDataButtonDown=function(e){return this.doFit()},i.prototype.onPostInstall=function(){t.prototype.onPostInstall.call(this),this.doFit()},i.prototype.doFit=function(){return n.fitView(this.viewport,!0),this.oneShot&&this.exitTool(),this.oneShot},i}),define("scripts/Bentley/Tools/ViewWalkTool",["./ViewManip","./ViewHandleType","./ToolId","../Util/extend"],function(e,t,n,r){function i(r,i){e.call(this,r,t.ViewWalk,!1,!0,i,n.Walk)}return r(e,i),i}),define("scripts/Bentley/Tools/ToolFactory",["./ToolId","./SelectionTool","./WindowAreaTool","./FitViewTool","./ViewWalkTool"],function(e,t,n,r,i){var o={};return o[e.Selection]=function(e){return new t(e)},o[e.WindowArea]=function(e){return new n(e)},o[e.FitView]=function(e){return new r(e)},o[e.Walk]=function(e){return new i(e,!1)},o.createTool=function(e,t){var n=this[t];return Cesium.defined(n)?n(e):void 0},o}),define("scripts/App/ToolFactory",["../Bentley/Tools/ToolFactory","./ToolId","../Bentley/Tools/ViewManip","../Bentley/Tools/ViewHandleType"],function(e,t,n,r){return e[t.Rotate]=function(t){return e.createRotateTool(t,!1,!1)},e[t.Pan]=function(t){return e.createPanTool(t,!1,!1)},e.createPanTool=function(e,i,o){return new n(e,r.ViewPan,i,!1,o,t.Pan)},e.createRotateTool=function(e,i,o){return new n(e,r.ViewPan|r.Rotate,i,!1,o,t.Rotate)},e}),define("scripts/Bentley/Util/requestJson",[],function(){var e=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="json",n.onload=function(e){if(4===n.readyState&&200===n.status){var r=n.response;try{r="string"==typeof r?JSON.parse(r):JSON.parse(JSON.stringify(r)),t(void 0,r)}catch(e){t("Invalid Json",void 0)}}else t(n.statusText,void 0)},n.onerror=function(e){t(e,void 0)},n.send(null)};return e}),define("scripts/App/RDS",[],function(){var e={getCONNECTToken:function(e){var t=Cesium.when.defer(),n=new XMLHttpRequest;return n.open("POST",e.baseURL+e.tokenURL,!0),n.onload=function(e){4===n.readyState&&200===n.status?t.resolve(n.responseText):t.reject(n.statusText)},n.onerror=function(e){t.reject(e)},n.send(null),t},requestJSON:function(e,t){var n=Cesium.when.defer(),r=new XMLHttpRequest;return r.open("GET",e,!0),r.setRequestHeader("Content-Type","application/json"),r.onload=function(e){if(4===r.readyState&&200===r.status){var t=r.response;try{t="string"==typeof t?JSON.parse(t):JSON.parse(JSON.stringify(t)),n.resolve(t)}catch(e){n.reject("Failed to parse JSON")}}else{var t=r.response;try{t="string"==typeof t?JSON.parse(t):JSON.parse(JSON.stringify(t)),Cesium.defined(t.errorMessage)?n.reject(t.errorMessage):n.reject(r.statusText)}catch(e){n.reject(r.statusText)}}},r.onerror=function(e){n.reject(e)},r.send(null),n},getBlobContainerURL:function(e,t,n,r){var i=Cesium.when.defer(),o=r.baseURL+r.APIURLBegin+(Cesium.defined(t)?t:r.APIURLMiddle)+r.APIURLEnd+"/"+e+r.fileAccessURL;return Cesium.when(this.requestJSON(o,n)).then(function(e){Cesium.defined(e.errorMessage)?i.reject(e.errorMessage):Cesium.defined(e.instances)&&0!=e.instances.length?e.instances.length>1?i.reject("Multiple instances were returned"):Cesium.defined(e.instances[0].properties.Url)?i.resolve(e.instances[0].properties.Url):i.reject("Url property is not defined"):i.reject("No instance was returned")},function(e){i.reject(e)}),i},getDocumentProperties:function(e,t,n,r){var i=Cesium.when.defer(),o=r.baseURL+r.APIURLBegin+(Cesium.defined(t)?t:r.APIURLMiddle)+r.APIURLEnd+"/"+e;return Cesium.when(this.requestJSON(o,n)).then(function(e){if(Cesium.defined(e.errorMessage))i.reject(e.errorMessage);else if(Cesium.defined(e.instances)&&0!=e.instances.length)if(e.instances.length>1)i.reject("Multiple instances were returned");else{var t=e.instances[0].properties.Name,n=e.instances[0].properties.RootDocument,r=e.instances[0].properties.Type;Cesium.defined(r)?"RealityMesh3DTiles"!=r?i.reject("Dataset is not of the expected type Reality Mesh 3DTiles"):Cesium.defined(t)?Cesium.defined(n)?i.resolve({Name:t,RootDocument:n}):i.reject("RootDocument property is not defined"):i.reject("Name property is not defined"):i.reject("Type property is not defined")}else i.reject("No instance was returned")},function(e){i.reject(e)}),i},getTilesetNameAndURL:function(e,t,n){var r=Cesium.when.defer(),i=this;return Cesium.when(this.getCONNECTToken(n)).then(function(o){Cesium.when.all([Cesium.when(i.getBlobContainerURL(e,t,o,n)),Cesium.when(i.getDocumentProperties(e,t,o,n))]).then(function(e){var t=e[0],n=e[1].Name,i=e[1].RootDocument,o=t,a=o.indexOf("?"),s=o.substring(a);o=o.substring(0,a)+"/"+i+s,r.resolve({Name:n,URL:o})},function(e){r.reject(e)})},function(e){r.reject(e)}),r}};return e}),define("scripts/Bentley/Bim/OrthoView",["./View","../Math/Cartesian3","../Util/extend","./SpatialView"],function(e,t,n,r){function i(e,t){r.call(this,e,t),this.fov=.01}return n(r,i),i.prototype.clone=function(){var e=new i(void 0,this.bim);return e.copyFrom(this),e},i.prototype.equals=function(e){return this.isEqual(e)},i.prototype.toOrthographicView=function(){return this},i}),define("scripts/Bentley/Bim/View2d",["./View","../Math/Cartesian3","../Util/extend","../Math/Range3"],function(e,t,n,r){function i(t,n){e.call(this,t,n)}return n(e,i),i.prototype.toView2d=function(){return this},i.prototype.setOrigin=function(e){this.origin.x=e.x,this.origin.y=e.y},i.prototype.setExtents=function(e){this.extents.x=e.x,this.extents.y=e.y},i.prototype.setRotation=function(e){var t=e.getColumn(0),n=Math.atan2(t.y,t.x);this.rotation.initFromAxisAndRotationAngle(2,n)},i.prototype.adjustAspectRatio=function(n,r){var i=this.extents;i.x=Math.abs(i.x),i.y=Math.abs(i.y);var o=Math.max(i.x,i.y);0==o&&(i.x=i.y=100),0==i.x&&(i.x=o),0==i.y&&(i.y=o);var a=i.x/i.y;if(!(Math.abs(1-a/n)<1e-9)){var s=i.clone();if(r||(a>1?i.y=i.x:i.x=i.y),r?a>n:n>1){var u=i.x/n;u<e.maxViewDelta?i.y=u:(i.y=e.maxViewDelta,i.x=e.maxViewDelta*n)}else{var u=i.y*n;u<e.maxViewDelta?i.x=u:(i.x=e.maxViewDelta,i.y=e.maxViewDelta/n)}var c=new t,l=this.rotation.clone();l.multiply(this.origin,c),c.x+=(s.x-i.x)/2,c.y+=(s.y-i.y)/2,l.transposeOf(l),l.multiply(c,this.origin)}},i.prototype.init=function(){if(!Cesium.defined(this.fov)){this.fov=.01;var t=this.getViewedExtents(),n=t.diagonalDistance,r=n/Math.tan(this.fov),i=5e4;r>i&&(this.fov=2*Math.atan2(n/2,i))}return e.prototype.init.call(this)},i.prototype.getViewedExtents=function(e){var t=this.models[0],n=this.bim.models[t],i=Cesium.defined(e)?e:new r;return i.copyFrom(n.extents),i},i}),define("scripts/Bentley/Bim/DrawingView",["./View","./View2d","../Math/Cartesian3","../Util/extend"],function(e,t,n,r){function i(e,n){t.call(this,e,n,!0)}return r(t,i),i.prototype.clone=function(){var e=new i(void 0,this.bim);return e.copyFrom(this),e},i.prototype.equals=function(e){return this.isEqual(e)},i.prototype.toDrawingView=function(){return this},i}),define("scripts/Bentley/Util/isCollectionEmpty",[],function(){var e=function(e){if(Array.isArray(e))return 0===e.length;if("object"!=typeof e)return!0;for(var t in e)return!1;return!0};return e}),define("scripts/Bentley/Bim/SelectionSet",["./Element","../Util/isCollectionEmpty"],function(e,t){function n(e){this.elements={},this.bim=e,this.changed=new Cesium.Event,this.flashed=void 0,this.flashChanged=new Cesium.Event}return n.prototype.raiseChanged=function(){this.changed.raiseEvent(this)},n.prototype.raiseFlashChanged=function(){this.flashChanged.raiseEvent(this)},n.prototype.isElementSelected=function(t){return!!e.isValidElement(t)&&this.isElementIdSelected(t.elementId)},n.prototype.isElementIdSelected=function(e){for(var t in this.elements)if(t==e)return!0;return!1},n.prototype.getSingleSelectedElement=function(){var e=void 0;for(var t in this.elements){if(Cesium.defined(e))return;e=this.elements[t]}return e},n.prototype._setElementSelected=function(t,n){return!!e.isValidElement(t)&&(n=Cesium.defaultValue(n,!0),this.isElementSelected(t)!=n&&(n?this.elements[t.elementId]=t:delete this.elements[t.elementId],!0))},n.prototype.setElementSelected=function(e,t){this._setElementSelected(e,t)&&this.raiseChanged()},n.prototype.addElement=function(e){this.setElementSelected(e,!0)},n.prototype.removeElement=function(e){this.setElementSelected(e,!1)},n.prototype.toggleElement=function(e){this.setElementSelected(e,!this.isElementSelected(e))},n.prototype.isEmpty=function(){return t(this.elements)},n.prototype.setFlashed=function(e){this.flashed!=e&&(this.flashed=e,this.raiseFlashChanged())},n.prototype._clear=function(){return!this.isEmpty()&&(this.elements={},!0)},n.prototype.clear=function(){this._clear()&&this.raiseChanged()},n.prototype.setSelectedElement=function(t){Cesium.defined(t)?e.isValidElement(t)&&(this._clear(),this.setElementSelected(t)):this.clear()},n.prototype.setSelectedElements=function(e){var t=this._clear();foreach(e,function(e){t|=this._setElementSelected(e)}),t&&this.raiseChanged()},n.prototype.setElementsSelected=function(e,t){var n=!1;foreach(e,function(e){n|=this._setElementSelected(e,t)}),n&&this.raiseChanged()},n.prototype.addElements=function(e){
this.setElementsSelected(e,!0)},n.prototype.removeElements=function(e){this.setElementsSelected(e,!1)},n}),define("scripts/Bentley/Bim/ViewFactory",["./View","./OrthoView","./CameraView","./DrawingView"],function(e,t,n,r){function i(e,t){var n={};return e.split("&").forEach(function(e){var t=e.split("="),r=t[0],i=t[1];if(Cesium.defined(i)){var s=i.split(",");a(r,s)&&(n[r]=o(r,s))}}),n}function o(e,t){return"origin"===e||"extents"===e||"eyePoint"===e?{x:Number(t[0]),y:Number(t[1]),z:Number(t[2])}:"lensAngle"===e||"focusDistance"===e?Number(t[0]):"rotation"===e?t.map(Number):t[0]}function a(e,t){return"origin"===e||"extents"===e||"eyePoint"===e?3===t.length&&0===t.filter(function(e){return isNaN(e)}).length:"lensAngle"===e||"focusDistance"===e?1===t.length&&0===t.filter(function(e){return isNaN(e)}).length:"rotation"!==e||9===t.length&&0===t.filter(function(e){return isNaN(e)}).length}var s={};return s.createView=function(e,i){return"camera"==e.type?new n(e,i):"ortho"==e.type?new t(e,i):"drawing"==e.type?new r(e,i):void 0},s.cloneViewFromUrl=function(e,t){var n=i(e,t),r=t.views[n.viewId];if(Cesium.defined(r)){var o=r.clone();return o.updateFromJson(n),o}},s}),define("scripts/Bentley/Bim/ViewRect",["../Math/Cartesian3","../Math/Cartesian2"],function(e,t){function n(e,n){this.origin=new t,this.corner=new t,Cesium.defined(e)&&t.clone(e,this.origin),Cesium.defined(n)&&t.clone(n,this.corner)}return n.from4Points=function(e,t,r,i){var o=new n;return o.initFrom4Points(e,t,r,i),o},n.prototype.initFrom4Points=function(e,t,n,r){this.origin.x=e,this.origin.y=t,this.corner.x=n,this.corner.y=r},Cesium.defineProperties(n.prototype,{left:{get:function(){return this.origin.x}},top:{get:function(){return this.origin.y}},right:{get:function(){return this.corner.x}},bottom:{get:function(){return this.corner.y}},width:{get:function(){return this.corner.x-this.origin.x+1}},height:{get:function(){return this.corner.y-this.origin.y+1}},area:{get:function(){return this.width*this.height}},aspect:{get:function(){return this.width/this.height}}}),n.prototype.equals=function(e){return e.origin.equals(this.origin)&&e.corner.equals(this.corner)},n}),define("scripts/Bentley/Math/Map4",["./Cartesian3","./Matrix4"],function(e,t){function n(){this.m0=new t,this.m1=new t,this.initIdentity()}return n.frustumFractionLimit=1e-8,n.flatViewTolerance=1e-8,n.prototype.initIdentity=function(){t.clone(t.IDENTITY,this.m0),t.clone(t.IDENTITY,this.m1)},n.clone=function(e,n){t.clone(e.m0,n.m0),t.clone(e.m1,n.m1)},n.prototype.initFromTransform=function(e,n){var r=new t,i=!0;try{r=t.inverse(e,r)}catch(e){i=!1,t.clone(t.IDENTITY,r)}return n?(t.clone(e,this.m1),t.clone(r,this.m0)):(t.clone(e,this.m0),t.clone(r,this.m1)),i},n.prototype.initProduct=function(e,n){t.multiply(e.m0,n.m0,this.m0),t.multiply(n.m1,e.m1,this.m1)},n.prototype.initFromVectorFrustum=function(e,r,i,o,a){var s=new n,u=new n;a<n.frustumFractionLimit&&(a=n.frustumFractionLimit);var c=new t(r.x,i.x,o.x,e.x,r.y,i.y,o.y,e.y,r.z,i.z,o.z,e.z,0,0,0,1);return s.initFromTransform(c,!0)?(Math.abs(a-1)>n.flatViewTolerance?(u.m0.setRowValues(2,0,0,a,0),u.m0.setRowValues(3,0,0,a-1,1),u.m1.setRowValues(2,0,0,1/a,0),u.m1.setRowValues(3,0,0,(1-a)/a,1),this.initProduct(u,s)):n.clone(s,this),!0):(this.initIdentity(),!1)},n.mapBetweenBoxes=function(e,t,n,r,i,o){var a=r.x-n.x,s=r.y-n.y,u=r.z-n.z;return 0!=a&&0!=s&&0!=u&&(t.x=(o.x-i.x)/a,t.y=(o.y-i.y)/s,t.z=(o.z-i.z)/u,e.x=i.x-t.x*n.x,e.y=i.y-t.y*n.y,e.z=i.z-t.z*n.z,!0)},n.fromRanges=function(e,t,r,i){var o=new n;return o.initFromRanges(e,t,r,i)?o:void 0},n.prototype.initFromRanges=function(t,r,i,o){var a=new e,s=new e,u=new e,c=new e;return n.mapBetweenBoxes(u,a,t,r,i,o)&&n.mapBetweenBoxes(c,s,i,o,t,r)?(this.m0.initScaleAndTranslate(a,u),this.m1.initScaleAndTranslate(s,c),!0):(this.initIdentity(),!1)},n}),define("scripts/Bentley/Tools/MouseWheelEvent",["../Util/extend","./ButtonEvent"],function(e,t){function n(e){t.call(this),this.wheelDelta=Cesium.defaultValue(e,0)}return e(t,n),n.prototype.clone=function(e){var t=Cesium.defined(e)?e:new n(this.wheelDelta);return t.copyFrom(this),t},n}),define("scripts/Bentley/Tools/GestureId",[],function(){var e={None:0,MultiFingerMove:1,SingleFingerMove:2,TwoFingerTap:3,PressAndTap:4,SingleTap:5,DoubleTap:6,LongPress:7};return e}),define("scripts/Bentley/Tools/GestureInfo",["./GestureId","../Math/Cartesian3","../Math/Cartesian2"],function(e,t,n){function r(e,t,r,i,o,a,s,u){this.touches=[new n,new n,new n],this.ptsLocation=new n,Cesium.defined(e)&&this.init(e,t,r,i,o,a,s,u)}function i(t){switch(t){case e.None:return"None";case e.MultiFingerMove:return"MultiFingerMove";case e.SingleFingerMove:return"SingleFingerMove";case e.TwoFingerTap:return"TwoFingerTap";case e.PressAndTap:return"PressAndTap";case e.SingleTap:return"SingleTap";case e.DoubleTap:return"DoubleTap";case e.LongPress:return"LongPress";default:return"UNKNOWN"}}function o(e,t){for(var n=" touch["+t+"]:",r=0;r<t;r++)n+=e[r].toString()+" ";return n}return r.prototype.init=function(e,t,n,r,i,o,a,s){i=Cesium.defaultValue(i,[]),this.gestureId=e,this.numberTouches=Math.min(i.length,3),this.previousNumberTouches=s,this.isEndGesture=o,this.ptsLocation.x=Math.floor(t),this.ptsLocation.y=Math.floor(n),this.distance=r;for(var u=0;u<this.numberTouches;u++)this.touches[u].x=Math.floor(i[u].x),this.touches[u].y=Math.floor(i[u].y);this.isFromMouse=a},r.prototype.getViewPoint=function(e,n){Cesium.defined(n)||(n=new t);var r=e.getViewRect();return n.init(this.ptsLocation.x-r.origin.x,this.ptsLocation.y-r.origin.y,0),n},r.prototype.copyFrom=function(e){this.gestureId=e.gestureId,this.numberTouches=e.numberTouches,this.previousNumberTouches=e.previousNumberTouches,this.isEndGesture=e.isEndGesture,this.ptsLocation.x=e.ptsLocation.x,this.ptsLocation.y=e.ptsLocation.y,this.distance=e.distance;for(var t=0;t<this.numberTouches;t++)this.touches[t].x=e.touches[t].x,this.touches[t].y=e.touches[t].y;this.isFromMouse=e.isFromMouse},r.prototype.clone=function(e){var t=Cesium.defined(e)?e:new r;return t.copyFrom(this),t},r.prototype.toString=function(){return i(this.gestureId)+":"+this.ptsLocation.toString()+" dist:"+this.distance+o(this.touches,this.numberTouches)},r}),define("scripts/Bentley/Tools/ViewGestureTool",["./ViewManip","../Util/extend","../Math/Cartesian2","../Math/Cartesian3","./ToolId","./GestureInfo","../Bim/Frustum","../Bim/CoordSystem"],function(e,t,n,r,i,o,a,s){function u(t){e.call(this,t.viewport,0,!0,!1,!1,i.Gesture),this.centerNpc=new r,this.startInfo=new o,this.numberTouches=0,this.touches=[new n,new n,new n]}t(e,u),u.prototype.onDataButtonDown=function(e){return!1};var c=new a;return u.prototype.doGesture=function(e){var t=this.viewport,n=t.getFrustum(s.Npc,!1,c);if(n.multiply(e),t.npcToWorldArray(n.pts),!t.setupFromFrustum(n))return!1;var r=t.isCameraOn?t.view:void 0;return Cesium.defined(r)&&(r.centerEyePoint(),t.setupFromView()),this.doUpdate(!0),!0},u.prototype.endGesture=function(){return this.clearTouchStopData(),this.doUpdate(!0),this.exitTool(),!0},u.prototype.saveTouchStopData=function(e){this.numberTouches=e.numberTouches;for(var t=0;t<this.numberTouches;t++)this.touches[t].copyFrom(e.touches[t])},u.prototype.clearTouchStopData=function(){this.numberTouches=0},u.prototype.onStart=function(e){this.clearTouchStopData(),this.startInfo.copyFrom(e.gestureInfo)},u}),define("scripts/Bentley/Tools/RotatePanZoomGestureTool",["../Math/Cartesian3","../Math/Cartesian2","../Math/Matrix4","../Math/Matrix3","../Bim/Frustum","./ViewGestureTool","../Util/extend","./ViewGestureTool","./ViewToolSettings"],function(e,t,n,r,i,o,a,o,s){function u(t,n,r){o.call(this,t),this.allowRotate=n,this.allow2dRotate=Cesium.defaultValue(r,!1),this.allowZoom=!0,this.rotatePrevented=this.doing2dRotation=this.rotateInitialized=!1,this.ballVector0=new e,this.lastPtView=new e,this.startPtWorld=new e,this.startPtView=new e,this.startTime=0,this.frustum=new i,this.onStart(t),this.handleEvent(t)}a(o,u);var c=350;return u.prototype.is2dRotateGesture=function(e){if(!this.allow2dRotate||!this.allowRotate||this.rotatePrevented)return!1;if(this.doing2dRotation)return!0;var t=this.viewport,n=e.gestureInfo;if(t.allow3dManipulations||2!=n.numberTouches)return this.rotatePrevented=!1,!1;var r=this.startInfo,i=Math.abs(this.getRotationFromStart(n)),o=Math.abs(n.distance/2*Math.sin(i)),a=Math.abs(n.distance-r.distance),s=r.getViewPoint(t).distance(n.getViewPoint(t));if(i>Math.PI/10||o>a&&o>.75*s)return this.doing2dRotation=!0,!0;var u=Date.now()-this.startTime;return this.rotatePrevented=u>c,!1},u.prototype.is3dRotateGesture=function(e){return this.allowRotate&&1==e.gestureInfo.numberTouches&&this.viewport.allow3dManipulations},u.prototype.compute2dRotationAxis=function(t){var n=this.viewport,r=n.worldToNpc(t),i=new e(r.x,r.y,.4),o=n.npcToWorld(i);i.z=.6;var a=n.npcToWorld(i);return{start:o,end:a}},u.prototype.computeZoomRatio=function(e){if(!this.allowZoom)return 1;var t=e.distance;t<1&&(t=1);var n=this.startInfo.distance;n<1&&(n=1);var r=n/t;return r<.1?r=.1:r>10&&(r=10),(e.numberTouches>2||Math.abs(n-t)<this.viewport.pixelsFromInches(.125))&&(r=1),r},u.prototype.getRotationFromStart=function(e){var n=e.touches,r=this.startInfo.touches,i=new t(r[1].x-r[0].x,r[1].y-r[0].y),o=new t(n[1].x-n[0].x,n[1].y-n[0].y);return i.angleTo(o)},u.prototype.handle2dRotate=function(t){var r=this.viewport;if(!r.setupFromFrustum(this.frustum))return!0;var i=t.gestureInfo,o=i.touches,a=this.startInfo.touches,s=r.viewToWorld(new e(a[0].x,a[0].y,0)),u=r.viewToWorld(new e(o[0].x,o[0].y,0)),c=s.clone();c.subtract(u);var l=n.fromTranslation(c),f=this.compute2dRotationAxis(u),h=this.getRotationFromStart(i),p=n.fromLineAndRotationAngle(f.start,f.end,h),m=n.fromProduct(l,p),d=this.computeZoomRatio(i),v=n.fromFixedPointAndScaleFactors(s,d,d,0);m=n.fromProduct(v,m);var g=this.frustum.transformBy(m);return r.setupFromFrustum(g),this.saveTouchStopData(i),this.doUpdate(!0),this.lastPtView.copyFrom(u),!0},u.prototype.handle3dRotate=function(t){if(this.lastPtView.isEqual(t.viewPoint,2))return!0;var i=this.viewport,o=t.viewPoint.clone();if(this.startPtView.isEqual(o,2)&&o.copyFrom(this.startPtView),this.lastPtView.copyFrom(o),!i.setupFromFrustum(this.frustum))return!0;var a=this.startPtWorld,u=new e,c=0;if(this.useSphere||!i.allow3dManipulations);else{var l=i.getViewRect(),f=l.width,h=l.height,p=o.x-this.startPtView.x,m=o.y-this.startPtView.y,d=s.preserveWorldUp?this.worldUpVector:i.rotMatrix.getRow(1),v=i.rotMatrix.getRow(0),g=0!=p?r.fromVectorAndRotationAngle(d,Math.PI/(f/p)):r.IDENTITY,y=0!=m?r.fromVectorAndRotationAngle(v,Math.PI/(h/m)):r.IDENTITY,w=r.fromProduct(y,g);c=-w.getRotationAngleAndVector(u)}var x=r.fromVectorAndRotationAngle(u,c),b=n.fromMatrixAndFixedPoint(x,a),C=this.frustum.transformBy(b);return!i.setupFromFrustum(C)||(this.saveTouchStopData(t.gestureInfo),this.doUpdate(!0),!0)},u.prototype.onStart=function(e){o.prototype.onStart.call(this,e);var t=this.viewport;if(t.getWorldFrustum(this.frustum),this.doing2dRotation=this.rotatePrevented=!1,this.startPtWorld.copyFrom(e.point),this.startPtView.copyFrom(e.viewPoint),this.synchViewBallInfo(!this.rotateInitialized),this.rotateInitialized=!0,this.viewPtToSpherePt(this.startPtView,!0,this.ballVector0),t.isCameraOn){var n=t.worldToView(this.targetCenterWorld);this.startPtView.z=n.z,t.viewToWorld(this.startPtView,this.startPtWorld)}this.lastPtView.copyFrom(this.startPtView),this.startTime=Date.now();var r=t.pickDepthBuffer(e.viewPoint);Cesium.defined(r)&&(this.startPtWorld.copyFrom(r),t.worldToView(this.startPtWorld,this.startPtView),this.lastPtView.copyFrom(this.startPtView))},u.prototype.handleEvent=function(t){if(this.is3dRotateGesture(t))return this.handle3dRotate(t);if(this.is2dRotateGesture(t))return this.handle2dRotate(t);var r=this.viewport,i=t.gestureInfo,o=this.computeZoomRatio(i);if(!r.setupFromFrustum(this.frustum))return!0;var a=r.isCameraOn?r.view:void 0;if(Cesium.defined(a)){var s=t.viewPoint.clone();s.z=this.startPtView.z;var u=r.viewToWorld(s);u.negate();var c=n.fromTranslation(u),l=n.fromTranslation(this.startPtWorld),f=new n;f.scaleCompleteRows(c,o,o,o),f.initProduct(l,f);var h=a.eyePoint.clone(),p=new e;f.multiply(h,p);var m=e.fromDifferenceOf(p,h),d=n.fromTranslation(m),v=this.frustum.transformBy(d);r.setupFromFrustum(v)}else{var g=r.viewToNpc(t.viewPoint);g.z=.5;var y=n.fromFixedPointAndScaleFactors(g,o,o,1),w=new e(.5,.5,.5),x=r.viewToNpc(this.startPtView),b=e.fromDifferenceOf(x,g);b.z=0;var m=n.fromTranslation(b);y.initProduct(m,y),y.multiply(w),r.npcToWorld(w,w),r.zoom(w,o,!1)}return this.saveTouchStopData(i),this.doUpdate(!0),!0},u.prototype.onMultiFingerMove=function(e){var t=e.gestureInfo;return t.numberTouches!=this.startInfo.numberTouches?(this.onStart(e),!0):this.handleEvent(e)},u.prototype.onSingleFingerMove=function(e){return this.onMultiFingerMove(e)},u.prototype.onEndGesture=function(e){return this.clearTouchStopData(),this.endGesture()},u}),define("scripts/Bentley/Tools/ViewIdleTool",["./Tool","../Util/extend","../Util/dynamicCast","./Button","./ViewManip","./ViewHandleType","./FitViewTool","./ToolId","./RotatePanZoomGestureTool"],function(e,t,n,r,i,o,a,s,u){function c(t){e.call(this,t,s.Idle)}return t(e,c),c.prototype.onMiddleButtonDown=function(e){var t=this.viewport.toolAdmin,s=t.currentInputState;if(s.isDragging(r.Data)||s.isDragging(r.Reset))return!1;var u;if(e.isDoubleClick)u=new a(this.viewport,!0);else if(e.isShiftKey)u=new i(this.viewport,o.Rotate,!0,!1,!0);else{var c=n(t.activeTool,i);if(Cesium.defined(c))return!c.isDragging&&c.viewHandles.hasHandle(o.ViewPan)&&(c.forcedHandle=o.ViewPan),!0;u=new i(this.viewport,o.ViewPan,!0,!1,!0)}return u.installTool()},c.prototype.onMiddleButtonUp=function(e){if(this.viewport.toolAdmin.resetViewCursor(),e.isDoubleClick||e.isControlKey||e.isShiftkey)return!1;var t=n(this.viewport.toolAdmin.activeTool,i);return Cesium.defined(t)&&(t.viewHandles.hasHandle(o.ViewPan)&&(t.forcedHandle=o.ViewNone),t.viewHandles.hasHandle(o.TargetCenter)&&t.invalidateTargetCenter()),!0},c.prototype.onMouseWheel=function(e){return this.viewport.toolAdmin.processMouseWheelEvent(e,!0)},c.prototype.installToolImplementation=function(){return!0},c.prototype.exitTool=function(){},c.prototype.onDataButtonDown=function(e){return!1},c.prototype.onMultiFingerMove=function(e){var t=new u(e,!0);return t.installTool(),!0},c.prototype.onSingleFingerMove=function(e){return this.onMultiFingerMove(e)},c.prototype.onSingleTap=function(e){return this.toolAdmin.convertGestureSingleTapToButtonDownAndUp(e),!0},c.prototype.onDoubleTap=function(e){var t=new a(this.viewport,!0);return t.installTool(),!0},c.prototype.onTwoFingerTap=function(e){this.toolAdmin.convertGestureToResetButtonDownAndUp(e)},c}),define("scripts/Bentley/Tools/GestureEvent",["./ButtonEvent","./GestureInfo","../Util/extend","../Math/Cartesian3","./GestureInfo"],function(e,t,n,r,t){function i(){e.call(this),this.gestureInfo=new t}return i.prototype.initGestureEvent=function(e,t){return this.gestureInfo.copyFrom(t),e.toolAdmin.currentInputState.fromGesture(t,!0),e.toolAdmin.currentInputState.toEvent(this,!1),this.gestureInfo.isFromMouse&&(this.actualInputSource=InputSource.Mouse),this},i.prototype.getDisplayPoint=function(e){var t=Cesium.defined(e)?e:new Cesium.Cartesian2;return t.x=Math.floor(this.viewPoint.x),t.y=Math.floor(this.viewPoint.y),t},n(e,i),i}),define("scripts/Bentley/Scene/CameraController",["../Bim/InputEventModifiers","../Math/Cartesian2","../Tools/InputSource","../Tools/GestureId","../Tools/GestureInfo"],function(e,t,n,r,i){function o(e,t,n){var r=n.pixelsFromInches(t);return e>=r}function a(e,t){if(p.DEBUG_TRACE){var n="UNRECOGNIZED";for(var r in m)if(m[r]===e){n=r;break}console.log("TouchHandler new state: "+n)}}function s(e,t,n,r){this.x=Cesium.defaultValue(e,0),this.y=Cesium.defaultValue(t,0),this.initialX=this.x,this.initialY=this.y,this.pointID=n,this.downTime=Cesium.defaultValue(r,0),this.previousTime=this.downTime,this.velocityX=0,this.velocityY=0,this.updated=!1}function u(e){this.queue=[]}function c(e){this.cameraController=e,this.touchPoints=[],this.previousNumberTouches=0,this.firstDown=new s,this.lastUp=new s,this.firstTap1=new s,this.firstTap2=new s,this.secondTap1=new s,this.secondTap2=new s,this.queue=new u,this.lastTouchEventTime=0,this.timerTime=Date.now(),this.initializeHandler()}function l(e,t,n,r){return g.init(e,t),y.init(n,r),g.distance(y)}function f(e){this.toolAdmin=e,this.element=e.viewport.canvas,this.touchHandler=new c(this),this.removalFunctions=[],this.registerListeners()}var h={LEFT:0,MIDDLE:1,RIGHT:2},p={TAP_LIMIT:800,TAP_CONFIRM_SINGLE_LIMIT:200,TAP_INVALID_UP_TIME:4294967295,LONG_PRESS_LIMIT:500,INITIAL_MOVE_THRESHOLD:.09,DOUBLE_TAP_DIST_THRESHOLD:.25,TICK:.016,DEBUG_TRACE:!1},m={Invalid:0,Initial:1,FirstDown:2,SecondDown:3,TapPending:4,SecondTapDown:5,SecondDownOneUp:6,MovePending:7,Moving:8,InLongPress:9,InLongPressAwaitingTap:10},d={OneFingerSingleTap:0,OneFingerDoubleTap:1,TwoFingerSingleTap:2};s.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y,this.initialX=e.initialX,this.initialY=e.initialY,this.pointID=e.pointID,this.downTime=e.downTime,this.previousTime=e.previousTime,this.velocityX=e.velocityX,this.velocityY=e.velocityY,this.updated=e.updated},s.prototype.clone=function(e){var t=Cesium.defined(e)?e:new s;return t.copyFrom(this),t},Cesium.defineProperties(s.prototype,{changed:{get:function(){return this.updated}}}),s.prototype.update=function(e,t,n){var r=p.INITIAL_MOVE_THRESHOLD;if(!this.updated&&!o(Math.abs(e-this.initialX),r,n)&&!o(Math.abs(t-this.initialY),r,n))return!1;var i=Date.now(),a=i-this.previousTime;if(a>2){this.previousTime=i;var s=(e-this.x)/a,u=(t-this.y)/a;if(0!=this.velocityX){var c=.2,l=.8;this.velocityX=c*this.velocityX+l*s,this.velocityY=c*this.velocityY+l*u}else this.velocityX=s,this.velocityY=u}return this.updated=!0,this.x=e,this.y=t,!0},u.prototype.push=function(e){0!=this.queue.length&&this.tryReplace(this.queue[this.queue.length-1],e)||this.queue.push(e.clone())},u.prototype.tryReplace=function(e,t){if(e.isEndGesture)return!1;var n=e.gestureId;if(t.gestureId!=n)return!1;switch(n){case r.SingleFingerMove:case r.MultiFingerMove:if(e.numberTouches==t.numberTouches&&e.previousNumberTouches==t.previousNumberTouches)return t.copyFrom(e),!0}return!1},u.prototype.process=function(e){var t=this.queue.length;if(t>0){for(var n=0;n<t;n++)this.dispatch(this.queue[n],e);this.queue.length=0}},u.prototype.dispatch=function(e,t){if(e.isEndGesture)return void t.onEndGesture(e);switch(e.gestureId){case r.MultiFingerMove:return t.onMultiFingerMove(e);case r.SingleFingerMove:return t.onSingleFingerMove(e);case r.TwoFingerTap:return t.onTwoFingerTap(e);case r.PressAndTap:return t.onPressAndTap(e);case r.SingleTap:return t.onSingleTap(e);case r.DoubleTap:return t.onDoubleTap(e);case r.LongPress:return t.onLongPress(e)}},Cesium.defineProperties(c.prototype,{viewport:{get:function(){return this.toolAdmin.viewport}},toolAdmin:{get:function(){return this.cameraController.toolAdmin}}}),c.prototype.initializeHandler=function(){this.tapDownTime=0,this.tapUpTime=0,this.touchPoints.length=0,this.state=m.Initial,this.interpretingDataButtonAsTouch=!1,this.endGestureId=r.None},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return Cesium.destroyObject(this)},c.prototype.update=function(){var e=Date.now();e-this.timerTime>=p.TICK&&(this.timerTime=e,this.timerExpired())},c.prototype.getPreviousNumberTouches=function(e){var t=this.previousNumberTouches;return e&&(this.previousNumberTouches=this.touchPoints.length),t},c.prototype.setState=function(e){a(e,this.state),m.Invalid==e&&(!Cesium.defined(this.gestureId)||0==this.touchPoints.length&&0==this.previousNumberTouches||this.sendEndGestureEvent(this.endGestureId,this.touchPoints[0].x,this.touchPoints[0].y,this.touchPoints,this.interpretingDataButtonAsTouch),this.previousNumberTouches=0),m.Initial!=e&&m.Invalid!=e||this.initializeHandler(),this.state=e};var v=new i;c.prototype.initGestureInfo=function(e,t,n,r,i,o,a){var s=v;return s.init(e,t,n,r,i,o,a,this.getPreviousNumberTouches(!0)),s},c.prototype.sendEvent=function(e){this.queue.push(e)},c.prototype.sendEndGestureEvent=function(e,t,n,r,i){var o=this.initGestureInfo(e,t,n,0,r,!0,i);this.sendEvent(o)},c.prototype.touchCanceled=function(){this.setState(m.Invalid)},c.prototype.onTouchEvent=function(){this.lastTouchEventTime=Date.now()},c.prototype.getPoint=function(e){for(var t=0;t<this.touchPoints.length;t++){var n=this.touchPoints[t];if(n.pointID==e)return n}},c.prototype.removePoint=function(e){for(var t=0;t<this.touchPoints.length;t++){var n=this.touchPoints[t];if(n.pointID==e)return this.touchPoints.splice(t,1),!0}return!1},c.prototype.touchDown=function(e,t,n,r,i){this.onTouchEvent(),r<=this.touchPoints.length&&this.setState(m.Invalid),this.state==m.Invalid&&this.setState(m.Initial),this.interpretingDataButtonAsTouch|=i;var o=Date.now();switch(this.touchPoints.push(new s(e,t,n,o)),1==this.touchPoints.length&&this.firstDown.copyFrom(this.touchPoints[0]),this.lastDown=n,this.state){case m.Initial:this.previousNumberTouches=0,this.tapDownTime=o,this.tapUpTime=p.TAP_INVALID_UP_TIME,this.setState(m.FirstDown);break;case m.FirstDown:this.setState(m.SecondDown);break;case m.SecondDown:this.setState(m.MovePending);break;case m.TapPending:this.setState(m.SecondTapDown);break;case m.SecondTapDown:this.setState(m.Invalid);break;case m.SecondDownOneUp:this.setState(m.Moving);break;case m.Moving:break;case m.InLongPress:this.firstTap1.copyFrom(this.touchPoints[0]),this.setState(m.InLongPressAwaitingTap);break;case m.InLongPressAwaitingTap:this.setState(m.Invalid)}},c.prototype.touchUp=function(e,t){this.onTouchEvent();var n=this.interpretingDataButtonAsTouch,i=this.getPoint(e);Cesium.defined(i)||this.setState(m.Invalid);var o=this.state;if(m.Invalid!=o){var a=Date.now();switch(o){case m.Initial:case m.TapPending:break;case m.FirstDown:var s=a-this.tapDownTime;s<p.TAP_LIMIT?(this.setState(m.TapPending),this.tapUpTime=a,this.firstTap1.copyFrom(i)):this.setState(m.Initial);break;case m.SecondTapDown:var s=a-this.tapDownTime;s<p.TAP_LIMIT&&(this.tapUpTime=a,this.secondTap1.copyFrom(i),this.handleTaps(!0)),this.setState(m.Initial);break;case m.SecondDown:var s=a-this.tapDownTime;if(s>p.TAP_LIMIT){this.setState(m.Invalid);break}this.firstTap1.copyFrom(i),this.setState(m.SecondDownOneUp);break;case m.SecondDownOneUp:var s=a-this.tapDownTime;if(s>p.TAP_LIMIT){this.setState(m.Invalid);break}this.firstTap2.copyFrom(i),this.handle2FingerTap(),this.setState(m.Initial);break;case m.MovePending:1==this.touchPoints.length&&this.setState(m.Initial);break;case m.Moving:if(1==this.touchPoints.length){var u=this.endGestureId,c=this.touchPoints[0];this.setState(m.Initial),this.sendEndGestureEvent(u,c.x,c.y,this.touchPoints,n)}break;case m.InLongPress:var u=r.PressAndTap!=this.endGestureId?r.LongPress:this.endGestureId,c=this.touchPoints[0];this.setState(m.Initial),this.sendEndGestureEvent(u,c.x,c.y,this.touchPoints,n);break;case m.InLongPressAwaitingTap:if(i.pointID==this.firstTap1.pointID){this.setState(m.Invalid);break}this.handlePressAndTap(),this.setState(m.InLongPress),this.endGestureid=r.PressAndTap}this.removePoint(e)}};var g=new t,y=new t;c.prototype.touchMove=function(e,t,n,r){this.onTouchEvent();var i=this.getPoint(n);if(Cesium.defined(i)||this.setState(m.Invalid),m.Invalid!=this.state&&i.update(e,t,this.viewport)){switch(this.state){case m.Initial:case m.TapPending:break;case m.SecondDownOneUp:case m.MovePending:case m.FirstDown:case m.SecondDown:this.setState(m.Moving);break;case m.SecondTapDown:this.setState(m.Moving);break;case m.Moving:case m.InLongPress:break;case m.InLongPressAwaitingTap:this.setState(m.Invalid)}var o=this.state;m.InLongPress!=o&&m.Moving!=o||this.handleMove(this.touchPoints)}},c.prototype.tryLongPress=function(){return(m.FirstDown==this.state||1==this.touchPoints.length)&&(!(Date.now()-this.touchPoints[0].previousTime<p.LONG_PRESS_LIMIT)&&(this.sendLongPressEvent(this.touchPoints,this.interpretingDataButtonAsTouch),!0))},c.prototype.sendLongPressEvent=function(e,t){var n=this.initGestureInfo(r.LongPress,e[0].initialX,e[0].initialY,0,e,!1,t);this.sendEvent(n)},c.prototype.timerExpired=function(){switch(this.queue.process(this.toolAdmin),this.state){case m.FirstDown:this.tryLongPress()&&this.setState(m.InLongPress);break;case m.TapPending:this.handleTaps(!1)&&this.setState(m.Initial)}},c.prototype.handle2FingerTap=function(){var e=(this.firstTap1.x+this.firstTap2.x)/2,t=(this.firstTap1.y+this.firstTap2.y)/2;this.sendTapEvent(e,t,d.TwoFingerSingleTap,this.touchPoints,this.interpretingDataButtonAsTouch)},c.prototype.sendTapEvent=function(e,t,n,i,o){var a=r.SingleTap;switch(n){case d.OneFingerDoubleTap:a=r.DoubleTap;break;case d.TwoFingerSingleTap:a=r.TwoFingerTap}var s=this.initGestureInfo(a,e,t,0,i,!1,o);this.sendEvent(s)},c.prototype.handlePressAndTap=function(){this.sendPressAndTapEvent(this.touchPoints,this.interpretingDataButtonAsTouch)},c.prototype.sendPressAndTapEvent=function(e,t){var n=e[0],i=e[1],o=l(i.x,i.y,n.x,n.y),a=this.initGesture(r.PressAndTap,n.x,n.y,o,e,!1,t);this.sendEvent(a)},c.prototype.handleTap=function(e,t,n){this.sendTapEvent(e,t,n?d.OneFingerDoubleTap:d.OneFingerSingleTap,this.touchPoints,this.interpretingDataButtonAsTouch)},c.prototype.handleTaps=function(e){if(!e){var t=Date.now()-this.tapUpTime;return!(t<p.TAP_CONFIRM_SINGLE_LIMIT)&&(this.handleTap(this.firstTap1.x,this.firstTap1.y,!1),!0)}var n=l(this.firstTap1.x,this.firstTap1.y,this.secondTap1.x,this.secondTap1.y);return o(n,p.DOUBLE_TAP_DIST_THRESHOLD,this.viewport)?(this.handleTap(this.firstTap1.x,this.firstTap1.y,!1),this.handleTap(this.secondTap1.x,this.secondTap1.y,!1)):this.handleTap(this.firstTap1.x,this.firstTap1.y,!0),!0},c.prototype.handleMultiFingerMove=function(e){if(e.length<2)return!1;r.SingleFingerMove==this.endGestureId&&this.sendEndGestureEvent(this.endGestureId,this.touchPoints[0].x,this.touchPoints[0].y,this.touchPoints,this.interpretingDataButtonAsTouch);var t=e[0],n=e[1],i=l(t.x,t.y,n.x,n.y),o=(t.x+n.x)/2,a=(t.y+n.y)/2;return this.sendMultiFingerMoveEvent(o,a,i,e,this.interpretingDataButtonAsTouch),this.endGestureId=r.MultiFingerMove,!0},c.prototype.sendMultiFingerMoveEvent=function(e,t,n,i,o){var a=this.initGestureInfo(r.MultiFingerMove,e,t,n,i,!1,o);this.sendEvent(a)},c.prototype.handleSingleFingerMove=function(e){if(1!=e.length)return!1;if(r.MultiFingerMove==this.endGestureId&&this.sendEndGestureEvent(this.endGestureId,this.touchPoints[0].x,this.touchPoints[0].y,this.touchPoints,this.interpretingDataButtonAsTouch),0==this.previousNumberTouches){var t=[this.firstDown];this.sendSingleFingerMoveEvent(!1,t,this.interpretingDataButtonAsTouch)}return this.sendSingleFingerMoveEvent(!1,e,this.interpretingDataButtonAsTouch),this.endGestureId=r.SingleFingerMove,!0},c.prototype.sendSingleFingerMoveEvent=function(e,t,n){var i=this.initGestureInfo(r.SingleFingerMove,t[0].x,t[0].y,1,t,!1,n);this.sendEvent(i)},c.prototype.handleMove=function(e){return this.handleSingleFingerMove(e)||this.handleMultiFingerMove(e)},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this.unregisterListeners(),this.touchHandler=this.touchHandler&&this.touchHandler.destroy(),Cesium.destroyObject(this)},f.prototype.unregisterListeners=function(){for(var e=this.removalFunctions,t=0;t<e.length;t++)e[t]();e.length=0},f.prototype.registerListener=function(e,t,n){function r(e){n.call(i,e)}var i=this;t.addEventListener(e,r,!1),this.removalFunctions.push(function(){t.removeEventListener(e,r,!1)})},f.prototype.registerListeners=function(){var e=this.element;this.registerListener("mousedown",e,this.handleMouseDown),this.registerListener("mouseup",e,this.handleMouseUp),this.registerListener("mousemove",e,this.handleMouseMove);var t;t="onwheel"in e?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",this.registerListener(t,e,this.handleMouseWheel),this.registerListener("touchstart",e,this.handleTouchStart),this.registerListener("touchend",e,this.handleTouchEnd),this.registerListener("touchmove",e,this.handleTouchMove),this.registerListener("touchcancel",e,this.handleTouchCancel)},f.prototype.recordShiftKey=function(){this.toolAdmin.currentInputState.setKeyQualifier(e.Shift,!0)},f.prototype.recordControlKey=function(){this.toolAdmin.currentInputState.setKeyQualifier(e.Control,!0)},f.prototype.clearKeyboardModifiers=function(){this.toolAdmin.currentInputState.clearKeyQualifiers()},f.prototype.handleMiddleDown=function(e){this.toolAdmin.onMiddleButtonDown(e)},f.prototype.handleMiddleUp=function(e){this.toolAdmin.onMiddleButtonUp(e)},f.prototype.handleMouseWheel=function(e){this.toolAdmin.onMouseWheel(e,this.toolAdmin.currentInputState.lastMotion)},f.prototype.handleLeftDown=function(e){this.toolAdmin.onDataButtonDown(e,n.Mouse)},f.prototype.handleLeftUp=function(e){this.toolAdmin.onDataButtonUp(e,n.Mouse)},f.prototype.handleRightDown=function(e){this.toolAdmin.onResetButtonDown(e)},f.prototype.handleRightUp=function(e){this.toolAdmin.onResetButtonUp(e)},f.prototype.getMouseButtonHandler=function(e,t){switch(e){case h.LEFT:return t?this.handleLeftDown:this.handleLeftUp;case h.MIDDLE:return t?this.handleMiddleDown:this.handleMiddleUp;case h.RIGHT:return t?this.handleRightDown:this.handleRightUp;default:return}},f.prototype.recordKeyboardModifiers=function(e){this.clearKeyboardModifiers(),e.shiftKey&&this.recordShiftKey(),e.ctrlKey&&this.recordControlKey()},f.prototype.getPosition=function(e,t){var n=this.element;if(n===document)return t.x=e.clientX,t.y=e.clientY,t;var r=n.getBoundingClientRect();return t.x=e.clientX-r.left,t.y=e.clientY-r.top,t};var w=new t;return f.prototype.handleMouseUpDown=function(e,t){var n=this.getMouseButtonHandler(e.button,t);if(Cesium.defined(n)){this.recordKeyboardModifiers(e);var r=this.getPosition(e,w);n.call(this,r),e.preventDefault()}},f.prototype.handleMouseDown=function(e){this.handleMouseUpDown(e,!0)},f.prototype.handleMouseUp=function(e){this.handleMouseUpDown(e,!1)},f.prototype.handleMouseMove=function(e){this.recordKeyboardModifiers(e);var t=this.getPosition(e,w);this.toolAdmin.onMouseMotion(t,n.Mouse),e.preventDefault()},f.prototype.handleMouseWheel=function(e){this.recordKeyboardModifiers(e);var t;if(Cesium.defined(e.deltaY)){var n=e.deltaMode;t=n===e.DOM_DELTA_PIXEL?-e.deltaY:n===e.DOM_DELTA_LINE?40*-e.deltaY:120*-e.deltaY}else t=e.delta>0?e.detail*-120:e.wheelDelta;Cesium.defined(t)&&(this.toolAdmin.onMouseWheel(t,this.toolAdmin.currentInputState.lastMotion),e.preventDefault())},f.prototype.processTouches=function(e,t){for(var n=e.changedTouches,r=e.touches.length,i=0;i<n.length;i++){var o=n[i],a=o.identifier,s=this.getPosition(o,w);t(this.touchHandler,a,r,s.x,s.y)}e.preventDefault()},f.prototype.handleTouchStart=function(e){this.processTouches(e,function(e,t,n,r,i){e.touchDown(r,i,t,n,!1)})},f.prototype.handleTouchEnd=function(e){this.processTouches(e,function(e,t,n){e.touchUp(t,n)})},f.prototype.handleTouchMove=function(e){this.processTouches(e,function(e,t,n,r,i){e.touchMove(r,i,t,n)})},f.prototype.handleTouchCancel=function(e){this.touchHandler.touchCanceled()},f.prototype.update=function(){this.touchHandler.update(),this.toolAdmin.onTimerEvent(),this.toolAdmin.viewport.apply()},f}),define("scripts/Bentley/Util/getFunction",[],function(){var e=function(e,t){if(Cesium.defined(e)&&"object"==typeof e&&"string"==typeof t){var n=e[t];return"function"==typeof n?n:void 0}};return e}),define("scripts/Bentley/Tools/ToolAdmin",["../Math/Cartesian3","../Bim/InputEventModifiers","./Button","./InputSource","./MouseWheelEvent","./ViewIdleTool","./ButtonEvent","../Math/Constants","../Math/Matrix4","./Tool","../Util/extend","./Cursor","./ViewManip","./ViewHandleType","./ToolId","./ViewTool","./PrimitiveTool","../Math/Cartesian2","./GestureEvent","../Scene/CameraController","../Util/getFunction","../Bim/SelectionSet","./ViewToolSettings"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m,d,v,g,y,w,x,b,C){
function M(){this.downPoint=new e,this.init()}function T(i){this.viewport=i,this.rawPoint=new e,this.viewPoint=new e,this.inputOffset=new Cesium.Cartesian2,this.qualifiers=t.None,this.motionTime=0,this.inputSource=r.Unknown,this.lastButton=n.Data,this.buttonDownTool=void 0,this.button=[new M,new M,new M],this.lastMotion=new Cesium.Cartesian2,this.wantIgnoreTest=!1,this.numberTouches=0,this.touches=[new g,new g,new g],this.touchMotionTime=0}function N(e){this.viewport=e,this.selectionSet=new b(e.bim),this.currentInputState=new T(e),this.activeToolChanged=new Cesium.Event,this._viewTool=void 0,this._primitiveTool=void 0,this.idleTool=new o(e),this.gesturePending=!1,this.touchBridgeMode=!1;var t=this;e.resized.addEventListener(function(){t.onViewportResized()})}function E(e){this.init(e)}M.prototype.init=function(e,t,n,i,o,a){Cesium.defined(e)?this.downPoint.copyFrom(e):this.downPoint.init(0,0,0),this.downTime=Cesium.defaultValue(t,0),this.isDown=Cesium.defaultValue(n,!1),this.isDoubleClick=Cesium.defaultValue(i,!1),this.isDragging=Cesium.defaultValue(o,!1),this.inputSource=Cesium.defaultValue(a,r.Unknown)},T.prototype.clearTouch=function(){this.numberTouches=0,this.touchMotionTime=0,this.wantIgnoreTest=!1},T.prototype.onMotion=function(e){this.motionTime=Date.now(),this.lastMotion.x=e.x,this.lastMotion.y=e.y},T.prototype.isDragging=function(e){return this.button[e].isDragging},T.prototype.onStartDrag=function(e){this.button[e].isDragging=!0},T.prototype.setKeyQualifier=function(e,t){this.qualifiers=t?this.qualifiers|e:this.qualifiers&~e},T.prototype.clearKeyQualifiers=function(){this.qualifiers=t.None},T.prototype.disableIgnoreTouchMotionTest=function(){this.wantIgnoreTest=!1},Cesium.defineProperties(T.prototype,{wasMotion:{get:function(){return 0!=this.motionTime}},hasMotionStopped:{get:function(){return this._hasMotionStopped()}},wasTouchMotion:{get:function(){return 0!=this.touchMotionTime}},hasTouchMotionPaused:{get:function(){return this._hasTouchMotionPaused()}},isShiftDown:{get:function(){return 0!=(this.qualifiers&t.Shift)}},isControlDown:{get:function(){return 0!=(this.qualifiers&t.Control)}}});var A={changeButtonToDownPoint:{viewPoint:new e},onButtonDown:{viewPt:new e,npcCenter:new e(.5,.5,.5),viewCenter:new e},toEventFromLastDataPoint:{viewPt:new e},fromPoint:{npcCenter:new e(.5,.5,.5),viewCenter:new e},isStartDrag:{viewPt:new e},onMouseWheel:{wheelEvent:new i(0)},onTimerEvent:{buttonEvent:new a}};T.prototype.changeButtonToDownPoint=function(e){e.setPoint(this.button[e.button].downPoint);var t=this.viewport.worldToView(e.point,A.changeButtonToDownPoint.viewPoint);e.setViewPoint(t)},T.prototype.updateDownPoint=function(e){this.button[e.button].downPoint.copyFrom(e.point)};var S=500,P=4;T.prototype.onButtonDown=function(e){var t=this.viewport.worldToView(this.button[e].downPoint,A.onButtonDown.viewPt),n=this.viewport.npcToView(A.onButtonDown.npcCenter,A.onButtonDown.viewCenter);t.z=n.z;var r=Date.now()-this.button[e].downTime<S&&t.distance(this.viewPoint)<P;this.button[e].init(this.rawPoint,Date.now(),!0,r,!1,this.inputSource),this.lastButton=e},T.prototype.onButtonUp=function(e){this.button[e].isDown=!1,this.button[e].isDragging=!1,this.lastButton=e},T.prototype.hasEventInputStopped=function(e,t){var n=!1;return 0!=e&&Date.now()-e>=t&&(n=!0,e=0),{eventTimer:e,stopped:n}},T.prototype._hasMotionStopped=function(){var e=this.hasEventInputStopped(this.motionTime,48);return e.stopped&&(this.motionTime=e.eventTimer),e.stopped},T.prototype._hasTouchMotionPaused=function(){var e=this.hasEventInputStopped(this.touchMotionTime,48);return e.stopped&&(this.touchMotionTime=e.eventTimer),e.stopped},T.prototype.toEvent=function(e){var t=this.button[this.lastButton];e.initEvent(this.rawPoint,this.viewPoint,this.viewport,this.qualifiers,this.lastButton,t.isDown,t.isDoubleClick,this.inputSource)},T.prototype.adjustLastDataPoint=function(e){var t=this.button[n.Data];t.downPoint.copyFrom(e.point)},T.prototype.toEventFromLastDataPoint=function(e){var t=this.button[n.Data],r=t.downPoint,i=this.viewport.worldToView(r,A.toEventFromLastDataPoint.viewPt);e.initEvent(r,i,this.viewport,this.qualifiers,n.Data,t.isDown,t.isDoubleClick,t.inputSource)},T.prototype.fromPoint=function(e,t){this.viewPoint.x=e.x+this.inputOffset.x,this.viewPoint.y=e.y+this.inputOffset.y;var n=this.viewport.npcToView(A.fromPoint.npcCenter,A.fromPoint.viewCenter);this.viewPoint.z=n.z,this.rawPoint=this.viewport.viewToWorld(this.viewPoint,this.rawPoint),this.inputSource=t},T.prototype.fromButton=function(e,t){this.fromPoint(e,t)},T.prototype.fromGesture=function(e){this.disableIgnoreTouchMotionTest(),this.fromButton(e.ptsLocation,r.Touch)},T.prototype.isAnyDragging=function(){for(var e=0;e<this.button.length;e++)if(this.button[e].isDragging)return!0;return!1},T.prototype.isStartDrag=function(e){if(this.isAnyDragging())return!1;var t=this.button[e];if(!t.isDown)return!1;if(Date.now()-t.downTime<=112)return!1;var n=this.viewport.worldToView(t.downPoint,A.isStartDrag.viewPt),r=Math.abs(this.viewPoint.x-n.x),i=Math.abs(this.viewPoint.y-n.y);return r+i>15},T.prototype.ignoreTouchMotion=function(e,t){if(!this.wantIgnoreTest)return!1;if(e=Math.min(e,this.touches.length),e!=this.numberTouches)return!1;for(var n=this.viewport.pixelsFromInches(.05),r=0;r<e;r++){var i=Math.abs(t[r].x-this.touches[r].x),o=Math.abs(t[r].y-this.touches[r].y);if(i>n||o>n)return!1}return!0},T.prototype.onTouchMotionChange=function(e,t){if(0==e)return void this.clearTouch();this.wantIgnoreTest=!0,this.touchMotionTime=Date.now(),this.numberTouches=e;for(var n=0;n<this.touches.length;n++)this.touches[n].x=t[n].x,this.touches[n].y=t[n].y},Cesium.defineProperties(N.prototype,{activeTool:{get:function(){return Cesium.defined(this._viewTool)?this._viewTool:this._primitiveTool}}}),N.prototype.setInputOffset=function(e){var t=this.currentInputState.inputOffset;Cesium.defined(e)?(t.x=e.x,t.y=e.y):(t.x=0,t.y=0)},N.prototype.onMouseWheel=function(e,t){this.viewport.removeAnimator(),this.currentInputState.fromButton(t,r.Mouse);var n=A.onMouseWheel.wheelEvent;n.wheelDelta=e,this.currentInputState.toEvent(n),this._onMouseWheel(n)},N.prototype._onMouseWheel=function(e){var t=this.activeTool;Cesium.defined(t)&&t.onMouseWheel(e)||this.idleTool.onMouseWheel(e)},N.prototype.onTimerEvent=function(){var e=this.activeTool,t=this.currentInputState;if(0!=t.numberTouches&&!this.touchBridgeMode){var n=t.hasTouchMotionPaused;return!n||(Cesium.defined(e)&&e.onTouchMotionPaused(),!0)}var r=A.onTimerEvent.buttonEvent;t.toEvent(r);var i=t.wasMotion;return!i&&Cesium.defined(e)&&e.onModelNoMotion(r),t.hasMotionStopped&&Cesium.defined(e)&&e.onModelMotionStopped(r),Cesium.defined(e)&&e.updateDynamics(r),r.reset(),!i};var O=new a;N.prototype.onMouseMotion=function(e,t){var n=this.currentInputState;n.onMotion(e);var r=this.activeTool;if(Cesium.defined(r)){var i=O;n.fromPoint(e,t),n.toEvent(i),n.isStartDrag(i.button)?(n.onStartDrag(i.button),n.changeButtonToDownPoint(i),r.onModelStartDrag(i)):r.onModelMotion(i),i.reset()}},N.prototype.sendDataPoint=function(e){var t=this.activeTool,n=this.currentInputState;if(!e.isDown){if(t!=n.buttonDownTool)return;return void(Cesium.defined(t)&&t.onDataButtonUp(e))}n.buttonDownTool=t,Cesium.defined(t)&&t.onDataButtonDown(e)},N.prototype.onDataButtonDown=function(e,t){this.viewport.removeAnimator();var r=O,i=this.currentInputState;i.fromButton(e,t),i.onButtonDown(n.Data),i.toEvent(r),i.updateDownPoint(r),this.sendDataPoint(r),r.reset()},N.prototype.onDataButtonUp=function(e,t){var r=this.currentInputState,i=r.isDragging(n.Data),o=O;r.fromButton(e,t),r.onButtonUp(n.Data),r.toEvent(o);var a=this.activeTool;if(a==r.buttonDownTool){if(i)return Cesium.defined(a)&&a.onModelEndDrag(o),void o.reset();r.changeButtonToDownPoint(o),this.sendDataPoint(o),o.reset()}},N.prototype.onMiddleButtonDown=function(e){this.viewport.removeAnimator();var t=O,i=this.currentInputState;i.fromButton(e,r.Mouse),i.onButtonDown(n.Middle),i.toEvent(t),i.updateDownPoint(t);var o=this.activeTool;if(i.buttonDownTool=o,(!Cesium.defined(o)||!o.onMiddleButtonDown(t))&&this.idleTool.onMiddleButtonDown(t)){var a=this.activeTool;a!=o&&(i.buttonDownTool=a)}t.reset()},N.prototype.onMiddleButtonUp=function(e){var t=this.currentInputState,i=t.isDragging(n.Middle),o=O;t.fromButton(e,r.Mouse),t.onButtonUp(n.Middle),t.toEvent(o);var a=this.activeTool;return a!=t.buttonDownTool?void o.reset():i?(Cesium.defined(a)&&a.onModelEndDrag(o),void o.reset()):(t.changeButtonToDownPoint(o),Cesium.defined(a)&&a.onMiddleButtonUp(o)||this.idleTool.onMiddleButtonUp(o),void o.reset())},N.prototype.onResetButtonDown=function(e){this.viewport.removeAnimator();var t=O,i=this.currentInputState;i.fromButton(e,r.Mouse),i.onButtonDown(n.Reset),i.toEvent(t),i.updateDownPoint(t);var o=this.activeTool;i.buttonDownTool=o,Cesium.defined(o)&&o.onResetButtonDown(t),t.reset()},N.prototype.onResetButtonUp=function(e){var t=this.currentInputState,i=t.isDragging(n.Reset),o=O;t.fromButton(e,r.Mouse),t.onButtonUp(n.Reset),t.toEvent(o);var a=this.activeTool;return a!=t.buttonDownTool?void o.reset():i?(Cesium.defined(a)&&a.onModelEndDrag(o),void o.reset()):(t.changeButtonToDownPoint(o),Cesium.defined(a)&&a.onResetButtonUp(o),void o.reset())};var _=new y;N.prototype.onEndGesture=function(e){this.viewport.removeAnimator(),this.gesturePending=!1;var t=_;t.initGestureEvent(this.viewport,e);var n=this.activeTool;Cesium.defined(n)&&n.onEndGesture(t)||this.idleTool.onEndGesture(t),this.currentInputState.clearTouch(),t.reset()},N.prototype.onSingleFingerMove=function(e){this.gesturePending=!1;var t=this.currentInputState;if(!t.ignoreTouchMotion(e.numberTouches,e.touches)){this.viewport.removeAnimator();var n=_.initGestureEvent(this.viewport,e),r=this.activeTool;Cesium.defined(r)&&r.onSingleFingerMove(n)||this.idleTool.onSingleFingerMove(n),t.onTouchMotionChange(e.numberTouches,e.touches),n.reset()}},N.prototype.onMultiFingerMove=function(e){this.gesturePending=!1;var t=this.currentInputState;if(!t.ignoreTouchMotion(e.numberTouches,e.touches)){this.viewport.removeAnimator();var n=_.initGestureEvent(this.viewport,e),r=this.activeTool;Cesium.defined(r)&&r.onMultiFingerMove(n)||this.idleTool.onMultiFingerMove(n),t.onTouchMotionChange(e.numberTouches,e.touches),n.reset()}},N.prototype.processGestureInfo=function(e,t){this.viewport.removeAnimator(),this.gesturePending=!1;var n=_.initGestureEvent(this.viewport,e),r=this.activeTool,i=x(r,t);Cesium.defined(i)&&i.call(r,n)||x(this.idleTool,t).call(this.idleTool,n),n.reset()},N.prototype.onTwoFingerTap=function(e){this.processGestureInfo(e,"onTwoFingerTap")},N.prototype.onPressAndTap=function(e){this.processGestureInfo(e,"onPressAndTap")},N.prototype.onSingleTap=function(e){this.processGestureInfo(e,"onSingleTap")},N.prototype.onDoubleTap=function(e){this.processGestureInfo(e,"onDoubleTap")},N.prototype.onLongPress=function(e){this.processGestureInfo(e,"onLongPress")},N.prototype.setPrimitiveTool=function(e){var t=this.activeTool;Cesium.defined(this._primitiveTool)&&this._primitiveTool.onCleanup(),this.invalidateLastWheelEvent(),this._primitiveTool=e;var n=this.activeTool;n!=t&&this.activeToolChanged.raiseEvent()},N.prototype.setViewTool=function(e){Cesium.defined(this._viewTool)&&this._viewTool.onCleanup(),this.invalidateLastWheelEvent(),this._viewTool=e;var t=this._primitiveTool;Cesium.defined(t)?Cesium.defined(e)?t.onSuspended():t.onResumed():Cesium.defined(e)||this.setViewCursor(f.Default),this.activeToolChanged.raiseEvent()},N.prototype.exitViewTool=function(){this.setViewCursor(this.suspendedCursor),this.suspendedCursor=void 0,this.setViewTool(void 0)},N.prototype.startViewTool=function(e){Cesium.defined(this.viewTool)?this.setViewTool(void 0):this.suspendedCursor=this.viewCursor,this.setViewCursor(f.CrossHair)},N.prototype.startPrimitiveTool=function(e){this.exitViewTool(),this.setPrimitiveTool(void 0),this.setViewCursor(f.Arrow)},N.prototype.startDefaultTool=function(){Cesium.defined(this.defaultTool)&&this.activeTool!=this.defaultTool?this.defaultTool.installTool():(this.setPrimitiveTool(void 0),this.setViewCursor(f.Default))},N.prototype.fillEventFromCursorLocation=function(e){this.currentInputState.toEvent(e)},N.prototype.fillEventFromDataButton=function(e){this.currentInputState.toEventFromLastDataPoint(e)},N.prototype.fillEventFromLastDataButton=function(e){this.currentInputState.toEventFromLastDataPoint(e)},N.prototype.setAdjustedDataPoint=function(e){this.currentInputState.adjustLastDataPoint(e)};var I=new g;N.prototype.convertGestureSingleTapToButtonDownAndUp=function(e){this.touchBridgeMode=!0;var t=e.getDisplayPoint(I);this.onDataButtonDown(t,r.Touch),this.onDataButtonUp(t,r.Touch),this.touchBridgeMode=!1},N.prototype.convertGestureToResetButtonDownAndUp=function(e){this.touchBridgeMode=!0;var t=e.getDisplayPoint(I);this.onResetButtonDown(t),this.onResetButtonUp(t),this.touchBridgeMode=!1},N.prototype.convertGestureMoveToButtonDownAndMotion=function(e){this.touchBridgeMode=!0,0==e.gestureInfo.previousNumberTouches?this.onDataButtonDown(e.getDisplayPoint(),r.Touch):this.onMouseMotion(e.getDisplayPoint(),r.Touch)},N.prototype.convertGestureEndToButtonUp=function(e){this.onDataButtonUp(e.getDisplayPoint(),r.Touch),this.touchBridgeMode=!1};var B={zoomRatio:1.75,navigateDistPct:3,navigateMouseDistPct:10};E.prototype.init=function(e){this.ev=e},E.prototype.cleanup=function(){this.ev=void 0},E.prototype.process=function(e){return this.doZoom(!1),!0},E.prototype.doZoom=function(t){var n=this.ev,r=B.zoomRatio;r=Math.max(1,r);var i=n.wheelDelta;i>0&&(r=1/r);var o=n.point.clone(),a=o.clone(),c=n.viewport,l=c.view,f=c.getFrustum(),h=this._lastWheelEvent,p=Cesium.defined(h)&&h.viewPoint.distanceSquaredXY(n.viewPoint)<s.mgds_fc_epsilon;if(c.isCameraOn){a=c.worldToNpc(a,a);var m;p?(m=c.worldToNpc(h.worldPoint),a.z=m.z):(m=c.pickDepthBuffer(n.viewPoint),Cesium.defined(m)?c.worldToNpc(m,a):(m=c.determineDefaultRotatePoint(),c.worldToNpc(m,m),a.z=m.z)),c.npcToWorld(a,a);var v=u.fromFixedPointAndScaleFactors(a,r,r,r),g=l.cameraInfo.eyePoint.clone(),y=v.multiplyByPoint(g),w=e.fromDifferenceOf(y,g);w.magnitude()<s.oneCentimeter&&(w.scaleToLength(s.oneMeter/3),a.add(w));var o=l.targetPoint;o.add(w),y.sumOf(g,w,1),c.pointIsBelowSurface(y)&&(c.pushPtToSurface(y),w=e.fromDifferenceOf(y,g),o.copyFrom(l.targetPoint),o.add(w));var x=l.lookAt(y,o,l.yVector);return c.synchWithView(!0),C.animateZoom&&d.animateFrustumChange(c,f,c.getFrustum(),100),x}p&&(a=h.worldPoint.clone());var b=c.worldToNpc(a),M=u.fromFixedPointAndScaleFactors(b,r,r,1),T=new e(.5,.5,.5);if(t){var N=e.fromDifferenceOf(b,T);N.z=0;var w=u.fromMatrixAndTranslation(void 0,N);M.initProduct(M,w)}return M.multiplyByPoint(T,T),T=c.npcToWorld(T,T),c.zoom(T,r,!0)},E.prototype.invalidateLastEvent=function(){this._lastWheelEvent=void 0},E.prototype.doWheelPan=function(e){},E.prototype.doWheelSlide=function(e){},E.prototype.doWheelNavigate=function(e){};var k=new E;return N.prototype.processMouseWheelEvent=function(e,t){k.init(e);var n=k.process(t);return k.cleanup(),n},N.prototype.invalidateLastWheelEvent=function(){k.invalidateLastEvent()},N.prototype._createCameraController=function(){return new w(this)},N.prototype.onPostInstallTool=function(e){e.onPostInstall()},N.prototype.onInstallTool=function(e){return this.currentInputState.clearKeyQualifiers(),e.onInstall()},N.prototype.setViewCursor=function(e){e=Cesium.defaultValue(e,f.Default),this.viewCursor=e;var t=this.viewport.canvas;t.style.cursor=e},N.prototype.resetViewCursor=function(){this.setViewCursor(f.Default)},N.prototype.onViewportResized=function(){var e=this.activeTool;Cesium.defined(e)&&e.onViewportResized()},N}),define("scripts/Bentley/Util/functionDefined",["./getFunction"],function(e){var t=function(t,n){return void 0!=e(t,n)};return t}),define("scripts/Bentley/Scene/SelectionSetStyler",["../Util/foreach"],function(e){function t(e){this.viewport=e,this.showRuleAlwaysApplies=!0,this._isolate=!1;var t=this,n=e.selectionSet;n.changed.addEventListener(function(){t.update()}),n.flashChanged.addEventListener(function(){t.update()}),e.styler.register(this)}return Cesium.defineProperties(t.prototype,{selectionSet:{get:function(){return this.viewport.selectionSet}}}),t.prototype.update=function(){this.viewport.styler.update()},t.prototype.setIsolate=function(e){this._isolate!=e&&(this._isolate=e,this.update())},t.prototype.getShowRule=function(){if(!this.selectionSet.isEmpty()||Cesium.defined(this.selectionSet.flashed)){var t="(",n=!0;return e(this.selectionSet.elements,function(e){n?n=!1:t+="||",t+='${element}==="'+e.elementId+'"'}),Cesium.defined(this.selectionSet.flashed)&&(n||(t+="||"),t+='${element}==="'+this.selectionSet.flashed.elementId+'"'),t+=")"}},t.prototype.getColorRule=function(){var e=this.getShowRule();if(!Cesium.defined(e))return this._isolate?'color("#ffffff", 0.025)':void 0;var t;return t=this._isolate?' ? color("#ffffff") : color("#ffffff", 0.025)':' ?color("#808080") : color("#ffffff")',e+t},t}),define("scripts/Bentley/Scene/TilesetStyler",["../Util/functionDefined"],function(e){function t(e){this.geometry=e,this.stylers=[],this.dirty=!1}return t.prototype.register=function(e){this.stylers.indexOf(e)==-1&&this.stylers.push(e)},t.prototype.unregister=function(e){var t=this.stylers.indexOf(e);-1!=t&&this.stylers.splice(t,1)},t.prototype.update=function(){this.dirty=!0},t.prototype._update=function(){if(this.dirty){this.dirty=!1;for(var t=void 0,n=[],r=[],i=0;i<this.stylers.length;i++){var o=this.stylers[i],a=e(o,"getColorRule")?o.getColorRule():void 0,s=e(o,"getShowRule")?o.getShowRule():void 0;Cesium.defined(a)&&(t=a),Cesium.defined(s)&&(o.showRuleAlwaysApplies?r.push(s):n.push(s))}var u=void 0;if(Cesium.defined(t)||0!=n.length||0!=r.length){var c=0!=n.length?"(("+n.join(")&&(")+"))":void 0,l=0!=r.length?"("+r.join(")||(")+")":void 0,f=void 0;Cesium.defined(c)&&(f=Cesium.defined(l)?l+"||"+c:c),u=new Cesium.Cesium3DTileStyle({color:t,show:f})}this.geometry.style=u}},t}),define("scripts/Bentley/Scene/PropertyVisibilityStyler",[],function(){function e(e,t,n){this.viewport=e,this.propertyName=t,this.enabled={},this.numValues=0;for(var r in n)++this.numValues,this.enabled[r]=!0;this.numDisabled=0,e.styler.register(this),this.enabledChanged=new Cesium.Event}return e.prototype.raiseEnabledChanged=function(){this.enabledChanged.raiseEvent(this)},e.prototype.getColorRule=function(){},e.prototype.update=function(){this.viewport.styler.update()},e.prototype.setEnabled=function(e,t,n){var r=this.enabled[e];return!(!Cesium.defined(r)||r===t)&&(this.enabled[e]=t,this.numDisabled+=t?-1:1,this.update(),n||this.raiseEnabledChanged(),!0)},e.prototype.toggle=function(e){var t=this.enabled[e];Cesium.defined(t)&&this.setEnabled(e,!t)},e.prototype.getShowRule=function(){if(0!=this.numDisabled){if(this.numValues==this.numDisabled)return"false";var e=this.numDisabled>this.numValues/2,t="";for(var n in this.enabled){var r=this.enabled[n];r==e&&(t.length>0&&(t+=e?"||":"&&"),t+="${"+this.propertyName+"}"+(e?"===":"!==")+'"'+n+'"')}return t}},e.prototype.setAll=function(e,t){var n=!1;for(var r in this.enabled)this.setEnabled(r,e,!0)&&(n=!0);return n&&!t&&this.raiseEnabledChanged(),n},e.prototype.setForValues=function(e,t){for(var n=this.setAll(!t,!0),r=0;r<e.length;r++)this.setEnabled(e[r],t,!0)&&(n=!0);return n&&this.raiseEnabledChanged(),n},e}),define("scripts/Bentley/Bim/Viewport",["./View","../Tools/ViewTool","./ViewRect","./Frustum","../Math/Cartesian3","../Math/Matrix3","../Math/Matrix4","../Math/Map4","../Math/Range3","./NpcCorners","./CoordSystem","../Math/Constants","../Tools/ToolAdmin","./Element","../Util/functionDefined","../Math/Cartesian2","../Scene/SelectionSetStyler","../Scene/TilesetStyler","../Scene/PropertyVisibilityStyler","../Tools/ViewToolSettings"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m,d,v,g,y,w){function x(e,t,n){this.scene=e,this.geometry=t,this.viewOrg=new i,this.viewDelta=new i,this.viewOrgUnexpanded=new i,this.viewDeltaUnexpanded=new i,this.rotMatrix=new o,this.rootToView=new s,this.rootToNpc=new s,this.frustFraction=0,this.zClipAdjusted=!1,this.screenOrigin=new d(0,0),this.resized=new Cesium.Event;var r=t.bim;if(this.viewActivated=new Cesium.Event,this.activeView=r.defaultView,this.toolAdmin=new h(this),this.styler=new g(t),this.categoryStyler=new y(this,"category",r.categories),this.selectionSetStyler=new v(this),this.forwardStack=[],this.backStack=[],this.maxUndoSteps=20,this.currentBaseline=void 0,this.historyApplied=new Cesium.Event,this.historyChanged=new Cesium.Event,this.isGlobeVisibleChanged=new Cesium.Event,this.activateView(Cesium.defaultValue(n,r.defaultView)),Cesium.defined(r.groundPoint)){e.globe.depthTestAgainstTerrain=!1,this.needHeightAdjustment=1;var a=this;e.terrainProviderChanged.addEventListener(function(){a.adjustHeight()})}e.pickTranslucentDepth=!0}function b(e){if(e.camera.frustum instanceof Cesium.OrthographicFrustum){var t=e.getFrustum(l.World,!1,A),n=t.pts[c.LeftBottomRear],r=t.pts[c.RightBottomRear];e.camera.frustum.width=r.distance(n)}}function C(e){var t=e.view,n=e.camera.frustum instanceof Cesium.OrthographicFrustum;if(n==t.isCameraOn){var r=e.camera=t.isCameraOn?new Cesium.PerspectiveFrustum:new Cesium.OrthographicFrustum,i=e.getViewRect();r.aspectRatio=i.aspect,e.camera.frustum=r,t.isCameraOn||(r.width=e.camera.positionCartographic.height)}}function M(e,t,n,r){e.position.copyFrom(t),e.direction.copyFrom(n),e.up.copyFrom(r),i.cross(e.direction,e.up,e.right),i.cross(e.right,e.direction,e.up),e.up.normalize(),e.right.normalize()}function T(e,t,n,r){r=Cesium.defaultValue(r,t);for(var i=0;i<t.length;i++)n.call(e,t[i],r[i])}function N(e,t,n,r){var o=e.geometry,a=o.modelMatrix;if(Cesium.defined(a)){var s=n-t,u=s/i.magnitude(r),c=new i;i.multiplyByScalar(r,u,c);var l=new i(c.x-a[12],c.y-a[13],c.z-a[14]);o.adjustTranslation(c),e.camera.worldToCameraCoordinatesVector(l,l);var f=e.view,h=f.cameraInfo.eyePoint.clone();h.add(l);var p=i.fromSumOf(h,f.dir,f.cameraInfo.focusDistance);f.lookAt(h,p,f.up)&&e.synchWithView(!0)}}Cesium.defineProperties(x.prototype,{bim:{get:function(){return this.geometry.bim}},camera:{get:function(){return this.scene.camera}},canvas:{get:function(){return this.scene.canvas}},clientWidth:{get:function(){return this.canvas.clientWidth}},clientHeight:{get:function(){return this.canvas.clientHeight}},isUndoPossible:{get:function(){return 0<this.backStack.length}},isRedoPossible:{get:function(){return 0<this.forwardStack.length}},selectionSet:{get:function(){return this.toolAdmin.selectionSet}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},pixelsPerInch:{get:function(){return 96}},allow3dManipulations:{get:function(){return this.view.is3d}},isGlobeDefined:{get:function(){return this.view.isSpatialView&&this.bim.displayInPlace}},isGlobeVisible:{get:function(){return this.isGlobeDefined&&this.scene.globe.show},set:function(e){var t=this.scene;if(Cesium.defined(t.globe)&&t.globe.show!==e){t.globe.show=e;var n=e?this:t,r=e?t:this;r.skyBox=n.skyBox,r.skyAtmosphere=n.skyAtmosphere,r.sun=n.sun,r.moon=n.moon,n.skyBox=n.skyAtmosphere=n.sun=n.moon=void 0,this.isGlobeVisibleChanged.raiseEvent(this),this._cameraDirty=!0}}},isCameraOn:{get:function(){return this.view.isCameraOn}}});var E=3e-4,A=new r;x.prototype.activateView=function(e){var t=this.activeView;this.activeView=e,this.view=e.clone(),this.geometry.models=this.activeView.models,this.categoryStyler.setForValues(e.categories,!0),this.isGlobeVisible=this.isGlobeDefined,this.isGlobeVisibleChanged.raiseEvent(this),this.setupFromView(),this._changeFov=!0,e.init(),C(this),this.viewActivated.raiseEvent(this,this.activeView!=t),this.toolAdmin.startDefaultTool(),this.clearUndo(),this.saveViewUndo(),this.historyChanged.raiseEvent(),this._cameraDirty=!0},x.prototype.getActiveViewId=function(e){var t=this.geometry.bim.views,n=this;return Object.keys(t).filter(function(e){return t[e].name===n.activeView.name})[0]},x.prototype.animate=function(){Cesium.defined(this.animator)&&this.animator.animate(this)&&(this.animator.destroy(),this.animator=void 0)},x.prototype.removeAnimator=function(){Cesium.defined(this.animator)&&(this.animator.interrupt(this),this.animator=void 0)},x.prototype.setAnimator=function(e){this.removeAnimator(),this.animator=e},x.prototype.synchWithView=function(e){this.setupFromView(),e&&this.saveViewUndo()},x.prototype.saveViewUndo=function(){var e=this.view.clone();return Cesium.defined(this.currentBaseline)?void(e.equals(this.currentBaseline)||(this.backStack.length>=this.maxUndoSteps&&this.backStack.shift(),this.backStack.push(this.currentBaseline),this.forwardStack.length=0,this.currentBaseline=e,this.historyChanged.raiseEvent())):void(this.currentBaseline=e)},x.prototype.clearUndo=function(){this.currentBaseline=void 0,this.forwardStack.length=0,this.backStack.length=0},x.prototype.applyPrevious=function(e){var t=this.backStack.length;0!=t&&(this.forwardStack.push(this.currentBaseline),this.currentBaseline=this.backStack[t-1],this.backStack.pop(),this.applyViewState(this.currentBaseline,e),this.historyApplied.raiseEvent(!0))},x.prototype.applyNext=function(e){var t=this.forwardStack.length;0!=t&&(this.backStack.push(this.currentBaseline),this.currentBaseline=this.forwardStack[t-1],this.forwardStack.pop(),this.applyViewState(this.currentBaseline,e),this.historyApplied.raiseEvent(!1))},x.prototype.applyViewState=function(e,n){var r=this.getFrustum();this.view=e.clone(),this.synchWithView(!1),this._changeFov=!0;var i=this.getFrustum();t.animateFrustumChange(this,r,i,n)},x.prototype.adjustFrustumPlanes=function(){var e,t,n=this.view;if(this.isGlobeVisible)t=5e8,e=1;else{var r=i.subtract(n.dest,n.is3d?this.viewOrg:n.origin,S);if(this.rotMatrix.multiply(r),n.is3d)t=r.z,e=t-this.viewDelta.z;else{var o=n.getViewedExtents(O),a=o.high.z-o.low.z,s=r.z;e=s-a,t=s+a}}e=Math.max(e,1e-6),e>=t&&(t=e+1),this.camera.frustum.far=t,this.camera.frustum.near=e};var S=new i,P=new i,O=new u;x.prototype.apply=function(){this.styler._update(),Cesium.defined(this.needHeightAdjustment)&&(this.needHeightAdjustment+=1,this.needHeightAdjustment>5&&(this.needHeightAdjustment=void 0,this.adjustHeight()));var e=this.view;if(this.animate(),e.init(this.cameraInfo)||this._cameraDirty){this._cameraDirty=!1;var t=(this.geometry,e.dest.clone(P));this.camera.constrainedAxis=void 0,M(this.camera,t,e.dir,e.up);var n=this._changeFov;if(this._changeFov=!1,n&&(this.camera.frustum.fov=e.isCameraOn?e.fov:void 0),Cesium.defined(e.backgroundColor)){var r=this.scene;r.backgroundColor.red=e.backgroundColor.red,r.backgroundColor.green=e.backgroundColor.green,r.backgroundColor.blue=e.backgroundColor.blue}b(this),this.adjustFrustumPlanes()}},x.prototype.determineVisibleDepthNpc=function(e){Cesium.defined(e)||(e=new u(new i(0,1,0),new i(1,0,1)));var t=this.npcToView(e.low),n=this.npcToView(e.high);return n.subtract(t),this.pickRange(t,n)};var _=new i,I=new i;x.prototype.determineDefaultRotatePoint=function(e){Cesium.defined(e)||(e=new i);var t=void 0,n=0,r=1;if(Cesium.defined(t))n=this.npcToWorld(new i(.5,.5,t.minDepth)),r=this.npcToWorld(new i(.5,.5,t.maxDepth));else if(this.view.isCameraOn)return this.getCameraTarget(e),e;var o=_,a=I;return o.init(.5,.5,n),a.init(.5,.5,r),this.npcToWorld(o,o),this.npcToWorld(a,a),e.interpolate(o,.5,a),e},x.prototype.getCameraTarget=function(e){Cesium.defined(e)||(e=new i);var t=this.rotMatrix.getRow(2);return e.sumOf(this.cameraInfo.eyePoint,t,-1*this.cameraInfo.focusDistance),e},x.prototype.setupFromView=function(){var e=this.view;if(!Cesium.defined(e))return!1;this.adjustAspectRatio(!1),this.zClipAdjusted=!1;var t=e.origin.clone(),n=e.extents.clone();if(o.clone(e.rotation,this.rotMatrix),i.clone(t,this.viewOrg),i.clone(t,this.viewOrgUnexpanded),i.clone(n,this.viewDelta),i.clone(n,this.viewDeltaUnexpanded),e.is3d){if(this.view.isCameraOn?(this.cameraInfo=e.cameraInfo.clone(),this.validateCamera()):this.cameraInfo=void 0,this.adjustZPlanes(t,n),(!t.equals(this.viewOrgUnexpanded)||!n.equals(this.viewDeltaUnexpanded))&&(this.zClipAdjusted=!0,this.view.isCameraOn)){var r=new i;r.differenceOf(this.cameraInfo.eyePoint,t),this.rotMatrix.multiply(r);var a=r.z-15.2*f.oneCentimeter;n.z>a&&(n.z=a)}}else this.alignWithRootZ(),n.z=200*f.oneMillimeter,t.z=-100*f.oneMillimeter;i.clone(t,this.viewOrg),i.clone(n,this.viewDelta);var s=this.rootToNpcFromViewDef(this.cameraInfo,this.viewOrg,this.viewDelta,this.rotMatrix,this.rootToNpc);if(!Cesium.defined(s))return!1;this.frustFraction=s;var u=this.calcNpcToView();return this.rootToView.initProduct(u,this.rootToNpc),!0},x.prototype.validateCamera=function(){var e=this.cameraInfo;if(e.validateLens(),!e.isFocusValid){var t=this.view,n=t.extents,r=n.x>n.y?n.x:n.y,o=r/(2*Math.tan(e.lensAngle/2));o<n.z/2&&(o=n.z/2);var a=new i(n.x/2,n.y/2,n.z/2+o);t.rotation.multiplyTransposeInPlace(a),a.add(t.origin),i.clone(a,e.eyePoint),e.focusDistance=o}},x.prototype.adjustZPlanes=function(e,t){var n=e.clone(),o=t.clone();this.rotMatrix.multiply(e);var s=a.fromRotationTranslation(this.rotMatrix),u=this.cameraInfo,c=this.view,l=c.getViewedExtents(),h=r.fromRange(l);h.multiply(s),l=h.toRange(),e.z=l.low.z,t.z=l.high.z-e.z;var p=1;if(this.view.isCameraOn){var m=e.clone();this.rotMatrix.multiplyTransposeInPlace(m);var d=new i;if(d.differenceOf(u.eyePoint,m),this.rotMatrix.multiply(d),p=d.z/u.focusDistance,p<=0)return i.clone(n,e),void i.clone(o,t)}t.z=Math.max(t.z,f.oneMeter);var v=Math.max(t.x,t.y)*p;if(v>t.z){var g=v-t.z;e.z-=g/2,t.z+=g}this.rotMatrix.multiplyTransposeInPlace(e)},x.prototype.adjustAspectRatio=function(e){var t=this.getViewRect();this.view.adjustAspectRatio(t.aspect,e)},x.prototype.rootToNpcFromViewDef=function(e,t,n,r,o){var a,u=r.getRow(0),c=r.getRow(1),l=r.getRow(2),h=new i,p=new i,m=new i,d=new i;if(Cesium.defined(e)){var v=i.fromStartEnd(e.eyePoint,t);r.multiply(v);var g=e.focusDistance,y=n.z,w=v.z,x=w+y,b=E;if(x/w<b){var C=1e4*f.oneKilometer;-w>C&&(w=-C,v.z=w),x=w*b,y=x-v.z}var M=-w/g,T=-x/g;a=T/M,h.scaleByVector(u,n.x*M),p.scaleByVector(c,n.y*M),m.x=v.x*(T-M),m.y=v.y*(T-M),m.z=y,r.multiplyTransposeInPlace(m),d.x=v.x*M,d.y=v.y*M,d.z=v.z,r.multiplyTransposeInPlace(d),d.add(e.eyePoint)}else a=1,d=t.clone(),h.scaleByVector(u,n.x),p.scaleByVector(c,n.y),m.scaleByVector(l,n.z);var N=new s;return!!N.initFromVectorFrustum(d,h,p,m,a)&&(s.clone(N,o),!0)},x.prototype.getViewCorners=function(e){var t=this.getViewRect();return Cesium.defined(e)||(e=new u),e.low.x=t.origin.x,e.high.x=t.corner.x,e.low.y=t.corner.y,e.high.y=t.origin.y,e.low.z=-32767,e.high.z=32767,e},x.prototype.getViewRect=function(){return n.from4Points(0,0,this.clientWidth,this.clientHeight)},x.prototype.calcNpcToView=function(){var e=this.getViewCorners();return s.fromRanges(c.Corners[c.LeftBottomRear],c.Corners[c.RightTopFront],e.low,e.high)},x.prototype.getContrastToBackgroundColor=function(){var e="white",t=this.view.backgroundColor;if(Cesium.defined(t)){var n=t.red+t.green+t.blue;n>1.5&&(e="black")}return e},x.prototype.fitView=function(e,t){var n=this.computeViewRange(),r=this.getViewRect().aspect;this.view.lookAtViewAlignedVolume(n,r,e),this.synchWithView(t)},x.prototype.fitBoundingSphere=function(e){var t=this.camera,n=t.frustum,r=Math.tan(.5*n.fovy),o=n.aspectRatio*r,s=Math.max(e.radius/o,e.radius/r),u=new i;i.multiplyByScalar(t.direction,-s,u);var c=new i;i.add(e.center,u,c),u.differenceOf(c,t.position);var l=a.fromTranslation(u),n=this.getWorldFrustum();n.multiply(l),this.setupFromFrustum(n)&&this.saveViewUndo()},x.prototype.computeViewRange=function(){this.setupFromView();var e=this.geometry.range,t=this.geometry.modelMatrix;t.multiply(e.low),t.multiply(e.high);var n=e.getCenter(),r=e.high,s=i.fromDifferenceOf(r,n),c=o.fromScaleFactors(s.x,s.y,s.z),l=a.fromRotationTranslation(c,n),f=1,h=new u(new i(-f,-f,-f),new i(f,f,f));l.multiplyByPoint(h.low,h.low),
l.multiplyByPoint(h.high,h.high);var p=h.get8Corners();this.rotMatrix.multiplyArray(p);var m=u.fromArray(p);return m},x.prototype.viewToScreen=function(e,t){var n=Cesium.defined(t)?t:new i,r=this.screenOrigin;return n.init(r.x+e.x,r.y+e.y,0),n},x.prototype.viewToScreenArray=function(e,t){T(this,e,this.viewToScreen,t)};var B=new u,k=new a;x.prototype.npcToView=function(e,t){Cesium.defined(t)||(t=new i);var n=this.getViewCorners(B),r=k;return a.initFromRange(r,void 0,n.low,n.high),r.multiplyByPoint(e,t)},x.prototype.npcToViewArray=function(e,t){T(this,e,this.npcToView,t)},x.prototype.viewToNpc=function(e,t){Cesium.defined(t)||(t=new i);var n=this.getViewCorners(B),r=k;return a.initFromRange(void 0,r,n.low,n.high),r.multiplyByPoint(e,t)},x.prototype.viewToNpcArray=function(e,t){T(this,e,this.viewToNpc,t)},x.prototype.worldToView=function(e,t){return this.rootToView.m0.multiplyAndRenormalize(e,t)},x.prototype.worldToViewArray=function(e,t){T(this,e,this.worldToView,t)},x.prototype.viewToWorld=function(e,t){return this.rootToView.m1.multiplyAndRenormalize(e,t)},x.prototype.viewToWorldArray=function(e,t){T(this,e,this.viewToWorld,t)},x.prototype.worldToNpc=function(e,t){return this.rootToNpc.m0.multiplyAndRenormalize(e,t)},x.prototype.worldToNpcArray=function(e,t){T(this,e,this.worldToNpc,t)},x.prototype.npcToWorld=function(e,t){return this.rootToNpc.m1.multiplyAndRenormalize(e,t)},x.prototype.npcToWorldArray=function(e,t){T(this,e,this.npcToWorld,t)},x.prototype.getFocusPlaneNpc=function(){var e=this.getCameraTarget(),t=this.worldToNpc(e,e).z;if(t<0||t>1){var n=this.npcToWorld(new i(.5,.5,1)),r=this.npcToWorld(new i(.5,.5,0)),o=i.fromInterpolate(n,.5,r);o=this.worldToNpc(o,o),t=o.z}return t},x.prototype.getCameraTarget=function(e){Cesium.defined(e)||(e=new i);var t=this.rotMatrix.getRow(2),n=this.cameraInfo;return e.sumOf(n.eyePoint,t,-1*n.focusDistance),e},x.prototype.getWorldFrustum=function(e){return this.getFrustum(void 0,void 0,e)},x.prototype.getFrustum=function(e,t,n){if(e=Cesium.defaultValue(e,l.World),t=Cesium.defaultValue(t,!0),Cesium.defined(n)||(n=new r),!t&&this.zClipAdjusted){var o=new s,a=this.rootToNpcFromViewDef(this.view.isCameraOn?this.cameraInfo:void 0,this.viewOrgUnexpanded,this.viewDeltaUnexpanded,this.rotMatrix,o);if(!Cesium.defined(a))return;for(var u=[],f=0;f<c.CornerCount;f++)u.push(new i);o.m1.multiplyAndRenormalizeArray(c.Corners,u),this.worldToNpcArray(u,n.pts)}else for(var f=0;f<c.CornerCount;f++)n.pts[f].copyFrom(c.Corners[f]);switch(e){case l.View:this.npcToViewArray(n.pts);break;case l.World:this.npcToWorldArray(n.pts);break;case l.Screen:this.npcToViewArray(n.pts),this.viewToScreenArray(n.pts)}return n},x.prototype.setupFromFrustum=function(e){var t=this.view.setupFromFrustum(e);return!!this.setupFromView()&&(this.view.setRotation(this.rotMatrix),t)},x.prototype.zoom=function(n,r,s){var u=this.view,c=!1;if(!Cesium.defined(u))return!1;if(this.view.isCameraOn){var f=new i(.5,.5,.5),h=Cesium.defined(n)?this.worldToNpc(n):f.clone(),p=a.fromMatrixAndFixedPoint(o.fromScaleFactors(r,r,1),f),m=i.fromDifferenceOf(h,f);m.z=0;var d=a.fromTranslation(m),v=a.fromProduct(d,p),g=this.getFrustum(l.Npc,!1);return v.multiplyArray(g.pts),this.npcToWorldArray(g.pts),u.setupFromFrustum(g),u.centerEyePoint(),c=this.synchWithView(s),w.animateZoom&&t.animateFrustumChange(this,g,this.getFrustum(),100),c}var y=this.getFrustum(),x=u.extents.clone();if(x.x*=r,x.y*=r,!e.validateViewDelta(x))return!1;var b=Cesium.defined(n)?n.clone():u.center;this.allow3dManipulations||(b.z=0);var C=u.origin.clone(),M=C.clone(),T=u.rotation.clone();T.multiply(M),T.multiply(b),u.setExtents(x),M.x=b.x-x.x/2,M.y=b.y-x.y/2,T.multiplyTransposeInPlace(M),u.setOrigin(M);var N=M.distance(C);return this._zoomDelta=N,c=this.synchWithView(s),w.animateZoom&&t.animateFrustumChange(this,y,this.getFrustum(),100),c},x.prototype.scroll=function(e,t){e=Math.round(e),t=Math.round(t);var n=new i(e,t,0);if(this.view.isCameraOn)return!1;var r=i.clone(i.ZERO);this.viewToWorld(r,r),this.viewToWorld(n,n);var o=i.fromDifferenceOf(n,r),a=this.view,s=a.origin.clone(),u=i.fromSumOf(s,o);return a.setOrigin(u),this.setupFromView()};var V=new i,z=new i;new i;x.prototype.pickDepthBuffer=function(e,t){var n;if(this.scene.pickPositionSupported&&(n=this.scene.pickPosition(e,V)),Cesium.defined(n)){var r=this.worldToNpc(n,z),i=this.npcToView(r);return i.x=e.x,i.y=e.y,this.viewToWorld(i,n),n}},x.prototype.pickEntity=function(e){return this.scene.pick(e)},x.prototype.getPropertyOfEntity=function(e,t,n){var r=m(e,"getProperty")?e.getProperty(t):void 0;return!n&&Cesium.defined(r)&&0==r&&(r=void 0),r},x.prototype.pickedEntityToModel=function(e){var t=Cesium.defined(e)?this.geometry.findModelGeometryForTileset(e.primitive):void 0;return Cesium.defined(t)?t.model:void 0},x.prototype.pickedEntityToModelId=function(e){var t=this.pickedEntityToModel(e);return Cesium.defined(t)?t.id:void 0},x.prototype.pickedEntityToElement=function(e){var t=Cesium.defined(e)?this.getPropertyOfEntity(e,"element"):void 0;return Cesium.defined(t)?new p(t,this.pickedEntityToModelId(e),this.getPropertyOfEntity(e,"category")):void 0},x.prototype.pickElement=function(e){var t=this.pickEntity(e);return this.pickedEntityToElement(t)},x.prototype.getPickDepth=function(e){var t=this.scene,n=t._pickDepths[e];return Cesium.defined(n)||(n=new Cesium.PickDepth,t._pickDepths[e]=n),n};var F=new Cesium.Cartesian4,D=new Cesium.Cartesian4(1,1/255,1/65025,1/160581375),R={perspective:new Cesium.PerspectiveFrustum,perspectiveOC:new Cesium.PerspectiveOffCenterFrustum,ortho:new Cesium.OrthographicFrustum,orthoOC:new Cesium.OrthographicOffCenterFrustum};return x.prototype.pickRange=function(e,t){var n=this.scene;if(n.useDepthPicking){if(!Cesium.defined(e))throw new Cesium.DeveloperError("origin is undefined.");if(!Cesium.defined(t))throw new Cesium.DeveloperError("extents is undefined.");if(!Cesium.defined(n._globeDepth))throw new DeveloperError("Picking from the depth buffer is not supported. Check pickPositionSupported.");t.x=Math.round(t.x),t.y=Math.round(t.y);var r=n._context,i=r.uniformState,o=this.windowToDrawingBufferFlipY(e);o.y-=t.y;var a,s=this.camera;a=Cesium.defined(s.frustum.fov)?s.frustum.clone(R.perspective):Cesium.defined(s.frustum.infiniteProjectionMatrix)?s.frustum.clone(R.perspectiveOC):Cesium.defined(s.frustum.width)?s.frustum.clone(R.ortho):s.frustum.clone(R.orthoOC);for(var u=1,c=0,l=n.numberOfFrustums,f=0;f<l;++f){for(var h=this.getPickDepth(f),p=r.readPixels({x:o.x,y:o.y,width:t.x,height:t.y,framebuffer:h.framebuffer}),m=0;m<t.x;m++)for(var d=0;d<t.y;d++){var v=Cesium.Cartesian4.unpack(p,4*(m*t.y+d),F);Cesium.Cartesian4.divideByScalar(v,255,v);var g=Cesium.Cartesian4.dot(v,D);g>0&&g<1&&(g<u&&(u=g),g>c&&(c=g))}if(u<=c){var y=n._frustumCommandsList[f];a.near=y.near*(0!==f?.99:1),a.far=y.far,i.updateFrustum(a);var w={minDepth:u,maxDepth:c};return w}}}},x.prototype.windowToDrawingBuffer=function(e,t){return Cesium.SceneTransforms.transformWindowToDrawingBuffer(this.scene,e,t)},x.prototype.flipDrawingBufferY=function(e,t){return Cesium.defined(t)||(t=new d),t.x=e.x,t.y=this.scene.drawingBufferHeight-e.y,t},x.prototype.windowToDrawingBufferFlipY=function(e,t){var n=this.windowToDrawingBuffer(e,t);return this.flipDrawingBufferY(n,n)},x.prototype.drawingBufferToWorld=function(e,t,n){return Cesium.SceneTransforms.drawingBufferToWgs84Coordinates(this.scene,e,t,n)},x.prototype.worldToDrawingBuffer=function(e,t){return Cesium.SceneTransforms.wgs84ToDrawingBufferCoordinates(this.scene,e,t)},x.prototype.worldToWindow=function(e,t){return Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.scene,e,t)},x.prototype.windowToWorld=function(e,t,n){var r=Cesium.defined(n)?n:new i,o=this.windowToDrawingBufferFlipY(e);return this.drawingBufferToWorld(o,t,r)},x.prototype.changeArea=function(t){this.setupFromView();var n=[t[0].clone(),t[1].clone(),this.view.origin.clone()],r=[new i,new i,new i];this.rotMatrix.multiplyArray(n,r);var o=u.from2Points(r[0],r[1]),a=i.fromDifferenceOf(o.high,o.low);if(this.view.isCameraOn){var s=[new i,new i];this.worldToNpc(n[0],s[0]),this.worldToNpc(n[1],s[1]);var c=u.fromArray(s),l=this.determineVisibleDepthNpc(c),f=Cesium.defined(l)?l.minDepth:.5;f=Math.max(0,f),f=Math.min(1,f),s[0].z=s[1].z=f,this.npcToWorld(s[0],n[0]),this.npcToWorld(s[1],n[1]);var h=this.view.cameraInfo,p=h.lensAngle,m=Math.max(a.x,a.y)/(2*Math.tan(p/2)),d=i.fromInterpolate(n[0],.5,n[1]),v=i.fromSumOf(d,this.view.zVector,m);if(!this.view.lookAtUsingLensAngle(v,d,this.view.yVector,p))return!1}else{if(a.z=this.view.extents.z,!e.validateViewDelta(a))return!1;this.view.setExtents(a),o.low.z=r[2].z;var g=this.view.origin.clone();this.rotMatrix.multiplyTranspose(g,o.low),this.view.setOrigin(g)}return this.synchWithView(!0),!0},x.prototype.onResized=function(){this.setupFromView(),this.resized.raiseEvent()},x.prototype.pixelsFromInches=function(e){return e*this.pixelsPerInch},x.prototype.alignWithRootZ=function(){var e=this.rotMatrix.getRow(2),t=i.UNIT_Z;if(!e.equals(t)){var n=o.fromTranspose(this.rotMatrix);n.setColumn(2,t),n.squareAndNormalizeColumns(n,2,0),this.rotMatrix.transposeOf(n)}},x.prototype.turnCameraOn=function(e){var t=this.view;if(!t.supportsCamera)return!1;if(t.isCameraOn)return t.lookAtUsingLensAngle(t.cameraInfo.eyePoint,t.cameraInfo.targetPoint,t.yVector,e);var n=void 0,r=0,o=1;Cesium.defined(n)&&(r=this.npcToWorld(new i(.5,.5,n.minDepth)),o=this.npcToWorld(new i(.5,.5,n.maxDepth)));var a=r+(o-r)/2,s=[new i(0,0,a),new i(1,1,a),new i(0,0,o),new i(1,1,o)];this.npcToWorldArray(s);var u=i.fromInterpolate(s[2],.5,s[3]),c=i.fromInterpolate(s[0],.5,s[1]),l=2*u.distance(c),h=300*f.oneMillimeter,p=t.lookAtUsingLensAngle(u,c,t.yVector,e,h,l);return this.setupFromView(),t.init(),C(this),this._changeFov=!0,this._cameraDirty=!0,p},x.prototype.turnCameraOff=function(){var e=this.view;return e.supportsCamera&&e.isCameraOn?(e.turnCameraOff(),this.setupFromView(),e.init(),C(this),this._changeFov=!0,this._cameraDirty=!0,!0):!e.isCameraOn},x.prototype.synchWithCesiumCamera=function(){if(this.view.isCameraOn){var e=this.view,t=this.scene.camera,n=t.position,r=i.fromSumOf(n,t.direction,e.cameraInfo.focusDistance);e.lookAt(n,r,t.up)&&this.synchWithView(!0)}},x.prototype.adjustHeight=function(){var e=this.geometry,t=this.terrainProvider,n=e.bim.groundPoint;if(Cesium.defined(t)&&Cesium.defined(n)){var r=Cesium.Cartographic.fromCartesian(n),i=[r],o=r.height,a=this;Cesium.sampleTerrain(t,15,i).then(function(){N(a,o,i[0].height,n)})}},x.prototype.pointIsBelowSurface=function(e){return!!this.isGlobeVisible&&Cesium.Cartographic.fromCartesian(e).height<w.minDistanceToSurface},x.prototype.pushPtToSurface=function(e){if(this.isGlobeVisible){var t=Cesium.Cartographic.fromCartesian(e);t.height=w.minDistanceToSurface,i.fromRadians(t.longitude,t.latitude,t.height,this.scene.globe.ellipsoid,e)}return e},x.prototype.moveViewToSurface=function(e,t){var n=this.view;this.isGlobeVisible&&n.isCameraView&&(e=Cesium.defaultValue(e,n.targetPoint),t=Cesium.defaultValue(t,n.yVector),n.lookAt(this.pushPtToSurface(n.eyePoint),e,t),this.synchWithView(!1))},x.prototype.moveViewToSurfaceIfRequired=function(e,t){var n=this.view;this.pointIsBelowSurface(n.eyePoint)&&this.moveViewToSurface()},x}),define("scripts/Bentley/Bim/Model",["../Math/Matrix4","../Math/Range3","../Math/Cartesian3"],function(e,t,n){function r(n,r,i,o,a){a=Cesium.defaultValue(a,{}),this.bim=n,this.name=r,this.id=i,this.tilesetUrl=o,this.transform=new e,this.transform.copyFrom(Cesium.defaultValue(a.transform,e.IDENTITY)),this.extents=new t,Cesium.defined(a.extents)&&this.extents.copyFrom(a.extents),this.isSpatialModel=this.isDrawingModel=!1}return r}),define("scripts/Bentley/Bim/DrawingModel",["./Model","../Util/extend"],function(e,t){function n(t,n,r,i,o){e.call(this,t,n,r,i,o),this.isDrawingModel=!0}return t(e,n),n}),define("scripts/Bentley/Bim/SpatialModel",["./Model","../Util/extend"],function(e,t){function n(t,n,r,i,o){o.transform=t.projectTransform,e.call(this,t,n,r,i,o),this.isSpatialModel=!0}return t(e,n),n}),define("scripts/Bentley/Bim/ModelFactory",["./DrawingModel","./SpatialModel","../Math/Range3","../Math/Matrix4","../Math/Cartesian3"],function(e,t,n,r,i){var o={};return o.createModel=function(o,a,s){var u={};return Cesium.defined(s.transform)&&(u.transform=r.fromArray(s.transform)),Cesium.defined(s.extents)&&(u.extents=new n(i.fromObject(s.extents.low),i.fromObject(s.extents.high))),"drawing"==s.type?new e(o,s.name,a,s.tilesetUrl,u):"spatial"==s.type?new t(o,s.name,a,s.tilesetUrl,u):void 0},o}),define("scripts/Bentley/Bim/Bim",["../Util/requestJson","../Math/Cartesian3","../Math/Matrix4","./ViewFactory","../Math/Range3","./ModelFactory"],function(e,t,n,r,i,o){function a(t){if(this.readyPromise=Cesium.when.defer(),"string"==typeof t){var n=this;e(t,function(e,t){n._load(t)})}else this._load(t)}return a.prototype._load=function(e){this.categories=e.categories,this.modelSelectors=e.modelSelectors,this.categorySelectors=e.categorySelectors,this.displayStyles=e.displayStyles,this.name=e.name,this.projectExtents=new i(t.fromObject(e.projectExtents.low),t.fromObject(e.projectExtents.high)),this.projectTransform=n.fromArray(e.projectTransform),this.models={};var a,s,u=e.models;for(a in u)s=u[a],this.models[a]=o.createModel(this,a,s);this.views={};var c,l,f=e.views;for(c in f){l=f[c];var h=r.createView(l,this);h.viewId=c,this.views[c]=h}this.defaultView=this.views[e.defaultView];var p=e.bimOrigin;Cesium.defined(p)&&(this.bimToTile=n.fromTranslation(t.fromObject(p))),this.geolocated=Cesium.defaultValue(e.geolocated,!0);var m=e.groundPoint;Cesium.defined(m)&&(this.groundPoint=t.fromObject(m)),this.baseLayerPicker=Cesium.defaultValue(e.timeline,!0),this.modelMarker=Cesium.defaultValue(e.modelMarker,!1);var d=e.viewerOptions;Cesium.defined(d)&&(0==(this.displayInPlace=Cesium.defaultValue(d.displayInPlace,!1))?(this.groundPoint=void 0,this.baseLayerPicker=!1,this.geolocated=!1,this.modelMarker=!1):(this.selectedImageryProvider=d.imageryProvider,this.selectedTerrainProvider=d.terrainProvider)),this.geocoder=this.geolocated,this.timeline=Cesium.defaultValue(e.timeline,!0),this.timelineVisible=Cesium.defaultValue(e.timelineVisible,!1),this.tileLoadIndicator=Cesium.defaultValue(e.timelineVisible,!0),Cesium.defined(e.tileLoadIndicatorClass)&&(this.tileLoadIndicatorClass=e.tileLoadIndicatorClass),this.fullscreenButton=Cesium.defaultValue(e.fullscreenButton,!0),Cesium.defined(e.fullscreenElement)&&(this.fullscreenElement=e.fullscreenElement),this.infoBox=Cesium.defaultValue(e.infoBox,!1),this.sceneModePicker=Cesium.defaultValue(e.sceneModePicker,!1),this.navigationInstructionsInitiallyVisible=Cesium.defaultValue(e.navigationInstructionsInitiallyVisible,!1),this.navigationHelpButton=Cesium.defaultValue(e.selectionIndicator,!1),this.selectionIndicator=Cesium.defaultValue(e.selectionIndicator,!1),this.animation=Cesium.defined(e.animation,!1),this.homeButton=Cesium.defined(e.homeButton,!1),this.readyPromise.resolve(this)},a.prototype.createBentleyViewerOptions=function(){var e={selectedImageryProvider:this.selectedImageryProvider,selectedTerrainProvider:this.selectedTerrainProvider,baseLayerPicker:this.baseLayerPicker,timeline:this.timeline,timelineVisible:this.timelineVisible,fullscreenButton:this.fullscreenButton,fullscreenElement:this.fullscreenElement,tileLoadIndicator:this.tileLoadIndicator,tileLoadIndicatorClass:this.tileLoadIndicatorClass,geocoder:this.geocoder,infoBox:this.infoBox,sceneModePicker:this.sceneModePicker,navigationInstructionsInitiallyVisible:this.navigationInstructionsInitiallyVisible,navigationHelpButton:this.navigationHelpButton,selectionIndicator:this.selectionIndicator,homeButton:this.homeButton,modelMarker:this.modelMarker,cesiumWidgetOptions:this.createCesiumWidgetOptions()};return e},a.prototype.createCesiumWidgetOptions=function(){var e=Cesium.JulianDate.now();e.secondsOfDay=0,Cesium.JulianDate.addHours(e,-12,e);var t=e.clone();Cesium.JulianDate.addHours(t,24,t);var n=e.clone();Cesium.JulianDate.addHours(n,15,n);var r={shadows:!1,targetFrameRate:60,contextOptions:{webgl:{alpha:!0}},clock:new Cesium.Clock({startTime:e,currentTime:n,stopTime:t,clockRange:Cesium.ClockRange.LOOP_STOP,clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,shouldAnimate:!1,canAnimate:!1}),imageryProvider:!1};return this.displayInPlace||(r.scene3DOnly=!0,r.globe=!1,r.skyBox=!1,r.skyAtmosphere=!1),r},a.prototype.createCesiumViewerOptions=function(){var e=Cesium.JulianDate.now();e.secondsOfDay=0,Cesium.JulianDate.addHours(e,-12,e);var t=e.clone();Cesium.JulianDate.addHours(t,24,t);var n=e.clone();Cesium.JulianDate.addHours(n,15,n);var r={infoBox:!1,shadows:!1,sceneModePicker:!1,navigationInstructionsInitiallyVisible:!1,targetFrameRate:60,geocoder:!1,selectionIndicator:!1,timeline:!0,navigationHelpButton:!1,animation:!1,homeButton:!1,contextOptions:{webgl:{alpha:!0}},clock:new Cesium.Clock({startTime:e,currentTime:n,stopTime:t,clockRange:Cesium.ClockRange.LOOP_STOP,clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,shouldAnimate:!1,canAnimate:!1}),baseLayerPicker:!0,imageryProvider:!1,selectedImageryProvider:this.selectedImageryProvider,selectedTerrainProvider:this.selectedTerrainProvider};return this.displayInPlace||(r.scene3DOnly=!0,r.globe=!1,r.skyBox=!1,r.skyAtmosphere=!1),{cesiumViewerOptions:r}},a}),define("scripts/Bentley/Tools/ElementSetTool",["./PrimitiveTool","../Bim/InputEventModifiers","../Bim/Element","../Util/extend","./Cursor"],function(e,t,n,r,i){function o(t,n){e.call(this,t,n)}return r(e,o),o}),define("scripts/Bentley/Tools/StandardViewRotationTool",["./ViewTool","./ToolId","../Math/Cartesian3","../Math/Matrix3","../Util/extend","../Bim/Frustum","../Math/Matrix4","../Bim/StandardView"],function(e,t,n,r,i,o,a,s){function u(n,r){e.call(this,n,t.StandardViewRotation),this.stdView=r}i(e,u),u.prototype.onDataButtonDown=function(e){return this.updateViewRotation(),!0},u.prototype.onPostInstall=function(){return this.updateViewRotation(),!0};var c=new n,l=new n,f=new n;u.prototype.getStandardViewRotation=function(e){Cesium.defined(e)||(e=new r),e.copyFrom(this.stdView);var t=c,n=l,i=f;t.init(0,0,-1),n.init(0,1,0),i.init(1,0,0),r.multiplyByVector(e,t,t),r.multiplyByVector(e,n,n),r.multiplyByVector(e,i,i);var o=this.viewport.geometry.rootTransform;return a.multiplyByPointAsVector(o,t,t),a.multiplyByPointAsVector(o,n,n),a.multiplyByPointAsVector(o,i,i),t.normalize(),t.negate(),n.normalize(),i.normalize(),e.setRow(0,i),e.setRow(1,n),e.setRow(2,t),e};var h=new r,p=new o,m=new a,d=new a;return u.prototype.updateViewRotation=function(){if(this.viewport.allow3dManipulations||this.stdView==s.Top){var t=this.viewport.getWorldFrustum(),n=this.viewport.getWorldFrustum(p),r=this.viewport.determineDefaultRotatePoint(),i=a.fromMatrixAndFixedPoint(this.viewport.rotMatrix,r,m);n.multiply(i);var o=this.getStandardViewRotation(h),u=a.fromMatrixAndFixedPoint(o,r,d);u.inverseOf(u),n.multiply(u);var c=this.viewport.setupFromFrustum(n);this.viewport.synchWithView(!1),this.viewport.fitView(!0,c),e.animateFrustumChange(this.viewport,t,this.viewport.getWorldFrustum()),this.exitTool()}},u}),define("scripts/Bentley/Widgets/PropertyGrid",[],function(){function e(e,t){this.noPropertiesMessage=e,this.element=document.createElement("div"),this.hideNull=Cesium.defaultValue(t,!0),this.collapsedCategories={},this.contentChanged=new Cesium.Event,this.update(void 0)}return e.prototype.raiseContentChanged=function(){this.contentChanged.raiseEvent(this)},e.prototype.update=function(e){if("string"==typeof e)return this.element.innerHTML=e,void this.raiseContentChanged();if(!Cesium.defined(e)||!Array.isArray(e)||e.length<=0||!Cesium.defined(e[0].category)||!Cesium.defined(e[0].properties))return this.element.innerHTML=this.noPropertiesMessage,void this.raiseContentChanged();for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);var t=document.createElement("table");t.className="bim-propgrid";for(var n=[],r=0;r<e.length;r++){var i=e[r],o=i.category,a=this.createGroupRow(t,o);t.appendChild(a),Cesium.defined(this.collapsedCategories[o])&&n.push(a);for(var s=i.properties,u=0;u<s.length;u++){var c=s[u],l=c.value;if("object"==typeof l&&"Code"===c.label){var f=c.value;l=null!=f&&void 0!=f?f.Value:null}if(!this.hideNull||null!==l&&void 0!==l){var h=document.createElement("tr");h.className="bim-propgrid-row",t.appendChild(h);var p=document.createElement("td");p.className="bim-propgrid-cell-label",p.textContent=c.label,h.appendChild(p);var m=document.createElement("td");m.className="bim-propgrid-cell-value",m.textContent=l,h.appendChild(m)}}}for(var r=0;r<n.length;r++)this.expandOrCollapseCategory(t,n[r]);this.element.appendChild(t),this.raiseContentChanged()},e.prototype.createGroupRow=function(e,t){var n=document.createElement("tr");n.className="bim-propgrid-row-group",e.appendChild(n);var r=document.createElement("td");r.className="bim-propgrid-cell-group",r.setAttribute("colspan",2);var i=document.createElement("span");i.className="bim-expand-collapse-icon",r.appendChild(i),r.appendChild(document.createTextNode(t)),n.appendChild(r);var o=this;return n.onclick=function(){o.expandOrCollapseCategory(e,n)},n.setAttribute("title","Click to collapse"),n},e.prototype.expandOrCollapseCategory=function(e,t){var n="bim-propgrid-row-group"==t.className;t.className=n?"bim-propgrid-row-group-collapsed":"bim-propgrid-row-group",t.setAttribute("title",n?"Click to expand":"Click to collapse");for(var r=n?"bim-propgrid-row":"bim-hidden",i=t.nextSibling,o=!0;i;){if(i.className!=r){o=!1;break}i.className=n?"bim-hidden":"bim-propgrid-row",i=i.nextSibling}var a=t.firstChild.textContent;n?this.collapsedCategories[a]=a:delete this.collapsedCategories[a],this.raiseContentChanged()},e}),define("scripts/Bentley/Widgets/PropertyVisibilityList",[],function(){function e(e,t,n){this.value=t,this.name=n,this.enabled=!0,this.hidden=!1,this.styler=e,Cesium.knockout.track(this,["enabled","hidden"]);var r=this;this._toggle=Cesium.createCommand(function(){r.enabled=!r.enabled,r._apply()}),this._apply=Cesium.createCommand(function(){r.styler.setEnabled(r.value,r.enabled)})}function t(t,n,r,i){this.viewModel=new e(t,n,r),this.container=i;var o=document.createElement("div");this.element=o;var a=document.createElement("div");a.textContent=r,a.className="bim-toggle-entry",a.setAttribute("data-bind",'click: toggle, css: { "bim-toggle-entry-enabled" : enabled, "bim-toggle-entry-disabled" : !enabled, "bim-hidden" : hidden }'),a.setAttribute("title","Click to toggle visibility"),o.appendChild(a),i.appendChild(o),Cesium.knockout.applyBindings(this.viewModel,o)}function n(e,n){this.entries={};var r=document.createElement("div");r.className="bim-toggle-list",this.element=r,this.styler=e;var i=this,o=document.createElement("div");o.textContent="All",o.setAttribute("title","Enable all"),o.className="bim-toggle-entry",o.onclick=function(){i.setAll(!0)},r.appendChild(o);var a=document.createElement("div");a.textContent="None",a.setAttribute("title","Disable all"),a.className="bim-toggle-entry",a.onclick=function(){i.setAll(!1)},r.appendChild(a);var s=document.createElement("div");s.textContent="Invert",s.setAttribute("title","Invert the sets of enabled and disabled items"),s.className="bim-toggle-entry-ruled",s.onclick=function(){i.invert()},r.appendChild(s);for(var u in n)this.entries[u]=new t(e,u,n[u],r);var i=this;e.enabledChanged.addEventListener(function(){i.onEnabledChanged()})}return Cesium.defineProperties(e.prototype,{toggle:{get:function(){return this._toggle}},apply:{get:function(){return this._apply}}}),n.prototype.onEnabledChanged=function(){for(var e in this.styler.enabled){var t=this.entries[e];Cesium.defined(t)&&!t.viewModel.hidden&&(t.viewModel.enabled=this.styler.enabled[e])}},n.prototype.updateHiddenStates=function(e){for(var t in this.entries)this.entries[t].viewModel.hidden=!0,this.entries[t].viewModel.enabled=!0;for(var n=0;n<e.length;n++){var t=this.entries[e[n]];Cesium.defined(t)&&(t.viewModel.hidden=!1)}},n.prototype.setAll=function(e){for(var t in this.entries)this.entries[t].viewModel.enabled=e,this.entries[t].viewModel.apply()},n.prototype.invert=function(){for(var e in this.entries){var t=this.entries[e].viewModel;t.hidden||t.toggle()}},n}),define("scripts/Bentley/Widgets/ModelVisibilityList",[],function(){function e(e,t,n){this.value=t,this.name=n,this.geometry=e,this.enabled=!0,this.hidden=!1,Cesium.knockout.track(this,["enabled","hidden"]);var r=this;this._toggle=Cesium.createCommand(function(){r.enabled=!r.enabled,r._apply()}),this._apply=Cesium.createCommand(function(){r.geometry.setModelInScene(r.value,r.enabled)})}function t(t,n,r,i){this.viewModel=new e(t,n,r),this.container=i;var o=document.createElement("div");this.element=o;var a=document.createElement("div");a.textContent=r,a.className="bim-toggle-entry",a.setAttribute("data-bind",'click: toggle, css: { "bim-toggle-entry-enabled" : enabled, "bim-toggle-entry-disabled": !enabled, "bim-hidden" : hidden }'),a.setAttribute("title","Click to toggle visibility"),o.appendChild(a),i.appendChild(o),Cesium.knockout.applyBindings(this.viewModel,o)}function n(e,n){this.entries={};var r=document.createElement("div");r.className="bim-toggle-list",this.element=r,this.geometry=e;var i=this,o=document.createElement("div");o.textContent="All",o.setAttribute("title","Enable all"),o.className="bim-toggle-entry",o.onclick=function(){i.setAll(!0)},r.appendChild(o);var a=document.createElement("div");a.textContent="None",a.setAttribute("title","Disable all"),a.className="bim-toggle-entry",a.onclick=function(){i.setAll(!1)},r.appendChild(a);var s=document.createElement("div");s.textContent="Invert",s.setAttribute("title","Invert the sets of enabled and disabled models"),s.className="bim-toggle-entry-ruled",s.onclick=function(){i.invert()},r.appendChild(s);for(var u in n)this.entries[u]=new t(e,u,n[u].name,r);var i=this;e.modelSetChanged.addEventListener(function(){i.onEnabledChanged()})}return Cesium.defineProperties(e.prototype,{toggle:{get:function(){return this._toggle}},apply:{get:function(){return this._apply}}}),n.prototype.onEnabledChanged=function(){this.setAll(!1,!0);for(var e in this.geometry.models){var t=this.entries[e];Cesium.defined(t)&&!t.viewModel.hidden&&(t.viewModel.enabled=!0)}},n.prototype.updateHiddenStates=function(e){for(var t in this.entries)this.entries[t].viewModel.hidden=!0,this.entries[t].viewModel.enabled=!0;for(var n=0;n<e.length;n++){var t=this.entries[e[n]];Cesium.defined(t)&&(t.viewModel.hidden=!1)}},n.prototype.setAll=function(e,t){for(var n in this.entries)this.entries[n].viewModel.enabled=e,t||this.entries[n].viewModel.apply()},n.prototype.invert=function(){for(var e in this.entries){var t=this.entries[e].viewModel;t.hidden||t.toggle()}},n}),define("scripts/Bentley/Widgets/SettingsWidget",["../Tools/ViewToolSettings"],function(e){function t(t,n){t.scene;this.shadows=t.shadows,this.camera=t.viewport.isCameraOn,this.boundingVolumes=!1,this.globe=t.viewport.isGlobeVisible,this.renderingQualityVisible=!0,this.renderingQualitySwitchText="+",this.renderingQualityTitle="Click to expand",this.advancedVisible=!1,this.advancedSwitchText="+",this.advancedTitle="Click to expand",this.generalVisible=!0,this.generalSwitchText="-",this.generalTitle="Click to collapse",this.freezeFrame=!1,this.viewer=t,this.performance=!1,this._performanceContainer=n,this._lastFpsSampleTime=void 0,this._frameCount=0,this._time=void 0,this._fps=0,this._frameTime=0,this.inspectorVisible=!1,this.animationVisible=!0,this.animationTitle="Click to expand",this.animationSwitchText="+",this.animationTime=e.animationTime/1e3,Cesium.knockout.track(this,["shadows","camera","boundingVolumes","advancedVisible","advancedSwitchText","inspectorVisible","renderingQualityVisible","renderingQualitySwitchText","renderingQualityTitle","generalVisible","generalSwitchText","freezeFrame","globe","mapTiles","generalTitle","advancedTitle","maximumSSE","modelMarkerVisible","animationVisible","animationTime","animationTitle","animationSwitchText"]);var r=this;this._toggleAnimation=Cesium.createCommand(function(){r.animationVisible=!r.animationVisible,r.animationSwitchText=r.animationVisible?"-":"+",r.animationTitle=r.animationTitle?"Click to collapse":"Click to expand"}),this._updateMaxSSE=Cesium.knockout.getObservable(this,"animationTime").subscribe(function(t){e.animationTime=parseFloat(1e3*t)}),this._showBoundingVolumes=Cesium.createCommand(function(){return r.viewer.geometry.debugShowBoundingVolume=r.boundingVolumes,!0}),this._showShadows=Cesium.createCommand(function(){return r.viewer.shadows=r.shadows,r.viewer.setTimelineVisible(r.shadows),!0}),this._toggleCamera=Cesium.createCommand(function(){return r.camera?r.turnCameraOn():r.viewer.viewport.turnCameraOff()}),this._toggleAdvanced=Cesium.createCommand(function(){r.advancedVisible=!r.advancedVisible,r.advancedSwitchText=r.advancedVisible?"-":"+",r.advancedTitle=r.advancedVisible?"Click to collapse":"Click to expand"}),this._toggleRenderingQuality=Cesium.createCommand(function(){r.renderingQualityVisible=!r.renderingQualityVisible,r.renderingQualitySwitchText=r.renderingQualityVisible?"-":"+",r.renderingQualityTitle=r.renderingQualityVisible?"Click to collapse":"Click to expand"}),this._toggleGeneral=Cesium.createCommand(function(){r.generalVisible=!r.generalVisible,r.generalSwitchText=r.generalVisible?"-":"+",r.generalTitle=r.generalVisible?"Click to collapse":"Click to expand"}),this._freezeFrame=Cesium.createCommand(function(){return r.viewer.geometry.debugFreezeFrame=r.freezeFrame,!0}),this._toggleInspector=Cesium.createCommand(function(){return r.inspectorVisible?r._enableInspector():r._disableInspector(),!0}),this._showPerformance=Cesium.createCommand(function(){return r.performance?r._createPerformanceDisplay():(r._performanceContainer.innerHTML="",r._unregisterPerformanceUpdate(),r._unregisterPerformanceUpdate=void 0),!0}),t.viewport.bim.displayInPlace&&(this._showGlobe=Cesium.createCommand(function(){if(r.viewer.viewport.isGlobeVisible=r.globe,Cesium.defined(r.modelMarkerVisible)){var e=r.modelMarkerVisible;r.modelMarkerVisible=!!r.globe&&r.prevModelMarkerVisiblity,r.prevModelMarkerVisiblity=e,r._showModelMarker()}return!0}),t.viewport.bim.modelMarker&&(this.modelMarkerVisible=this.prevModelMarkerVisiblity=t.modelMarker.isModelMarkerVisible,this._showModelMarker=Cesium.createCommand(function(){return r.viewer.modelMarker.isModelMarkerVisible=r.modelMarkerVisible,!0}))),this._updateMaxSSE=Cesium.knockout.getObservable(this,"maximumSSE").subscribe(function(e){r.viewer.geometry.maximumScreenSpaceError=parseInt(e)})}function n(e,t,n,r,i,o){var a=document.createElement("span");a.innerText=n,a.style.fontSize="10px",a.style.float="left";var s=document.createElement("span");s.innerText=i,s.style.fontSize="10px",s.style.float="right";var u=document.createElement("div");u.appendChild(a),u.appendChild(s),u.style.width="130px",u.className="clearfix";var c=document.createElement("input");c.type="range",c.min=t,c.max=r,c.step=o,c.style.margin="0",c.setAttribute("data-bind",'valueUpdate: "input", value: '+e);var l=document.createElement("div");return l.className="cesium-cesiumInspector-slider",l.style.marginTop="3px",l.appendChild(u),l.appendChild(c),l}function r(e){var r=document.createElement("div"),i=new t(e,r);this.viewModel=i;var o=document.createElement("div");o.className="bim-settings",this._element=o;var a=document.createElement("div");a.className="bim-groupbox",a.setAttribute("data-bind",'css: {"bim-settings-show" : generalVisible, "bim-settings-hide" : !generalVisible}'),o.appendChild(a);var s=document.createElement("div");s.className="bim-groupbox-header",s.setAttribute("data-bind","click: toggleGeneral, attr: {title: generalTitle}");var u=document.createElement("span");u.className="bim-expand-collapse-icon",s.appendChild(u),s.appendChild(document.createTextNode("View")),a.appendChild(s);var c=document.createElement("div");c.className="bim-groupbox-content",
a.appendChild(c);var l=document.createElement("div");c.appendChild(l);var f=document.createElement("input");if(f.type="checkbox",f.setAttribute("data-bind","checked: shadows, click: showShadows"),l.appendChild(f),l.appendChild(document.createTextNode("Shadows")),e.viewport.bim.displayInPlace){var h=document.createElement("div");c.appendChild(h);var p=document.createElement("input");if(p.type="checkbox",p.setAttribute("data-bind","checked: globe, click: showGlobe"),h.appendChild(p),h.appendChild(document.createTextNode("Globe")),e.viewport.isGlobeDefined||(h.className="bim-hidden"),e.viewport.isGlobeVisibleChanged.addEventListener(function(e){i.globe=e.isGlobeVisible;var t=e.isGlobeDefined?void 0:"bim-hidden";h.className=t}),e.viewport.bim.modelMarker){var m=document.createElement("div");m.setAttribute("data-bind",'css: {"bim-show" : globe, "bim-hide" : !globe}'),c.appendChild(m);var d=document.createElement("input");d.type="checkbox",d.setAttribute("data-bind","checked: modelMarkerVisible, click: showModelMarker"),m.appendChild(d),m.appendChild(document.createTextNode("Model Marker"))}}var v=document.createElement("div");c.appendChild(v);var g=document.createElement("input");g.type="checkbox",g.setAttribute("data-bind","checked: camera, click: toggleCamera"),v.appendChild(g),v.appendChild(document.createTextNode("Camera")),e.viewport.viewActivated.addEventListener(function(e){i.camera=e.isCameraOn,v.className=e.view.supportsCamera?void 0:"bim-hidden"});var y=document.createElement("div");y.className="bim-groupbox",y.setAttribute("data-bind",'css: {"bim-settings-show" : renderingQualityVisible, "bim-settings-hide" : !renderingQualityVisible}'),o.appendChild(y);var w=document.createElement("div");w.className="bim-groupbox-header",w.setAttribute("data-bind","click: toggleRenderingQuality, attr: {title: renderingQualityTitle}");var x=document.createElement("span");x.className="bim-expand-collapse-icon",w.appendChild(x),w.appendChild(document.createTextNode("Rendering Quality")),y.appendChild(w);var b=document.createElement("div");b.className="bim-groupbox-content",y.appendChild(b),b.appendChild(n("maximumSSE",i.maximumSSE,"Quality",64*i.maximumSSE,"Performance",1));var C=document.createElement("div");C.className="bim-groupbox",C.setAttribute("data-bind",'css: {"bim-settings-show" : animationVisible, "bim-settings-hide" : !animationVisible}'),o.appendChild(C);var M=document.createElement("div");M.className="bim-groupbox-header",M.setAttribute("data-bind","click: toggleAnimation, attr: {title: animationTitle}");var T=document.createElement("span");T.className="bim-expand-collapse-icon",M.appendChild(T),M.appendChild(document.createTextNode("Animation Duration")),C.appendChild(M);var N=document.createElement("div");N.className="bim-groupbox-content",C.appendChild(N),N.appendChild(n("animationTime",0,"Shorter",5,"Longer",.05));var E=document.createElement("div");E.className="bim-groupbox",E.setAttribute("data-bind",'css: {"bim-settings-show" : advancedVisible, "bim-settings-hide" : !advancedVisible}'),o.appendChild(E);var A=document.createElement("div");A.className="bim-groupbox-header",A.setAttribute("data-bind","click: toggleAdvanced, attr: {title: advancedTitle}");var S=document.createElement("span");S.className="bim-expand-collapse-icon",A.appendChild(S),A.appendChild(document.createTextNode("Advanced")),E.appendChild(A);var P=document.createElement("div");P.className="bim-groupbox-content",E.appendChild(P);var O=document.createElement("div");P.appendChild(O);var _=document.createElement("input");_.type="checkbox",_.setAttribute("data-bind","checked: boundingVolumes, click: showBoundingVolumes"),O.appendChild(_),O.appendChild(document.createTextNode("Bounding volumes"));var I=document.createElement("div");P.appendChild(I);var B=document.createElement("input");B.type="checkbox",B.setAttribute("data-bind","checked: freezeFrame, click: debugFreezeFrame"),I.appendChild(B),I.appendChild(document.createTextNode("Freeze LOD"));var k=document.createElement("div");P.appendChild(k);var V=document.createElement("input");V.type="checkbox",V.setAttribute("data-bind","checked: inspectorVisible, click: toggleInspector"),k.appendChild(V),k.appendChild(document.createTextNode("Inspect"));var z=document.createElement("div");P.appendChild(z);var F=document.createElement("input");F.type="checkbox",F.setAttribute("data-bind","checked: performance, click: showPerformance"),z.appendChild(F),z.appendChild(document.createTextNode("Track FPS")),P.appendChild(r),Cesium.knockout.applyBindings(i,this._element)}return t.prototype.turnCameraOn=function(){var t=e.walkCameraAngle*(Math.PI/180),n=this.viewer.viewport,r=n.geometry.bim.views[n.activeView.viewId];return Cesium.defined(r)&&r.isCameraOn&&(t=r.lensAngle),n.turnCameraOn(e.walkCameraAngle*(Math.PI/180))},Cesium.defineProperties(t.prototype,{updateAnimationTime:{get:function(){return this._updateAnimationTime}},showBoundingVolumes:{get:function(){return this._showBoundingVolumes}},showShadows:{get:function(){return this._showShadows}},toggleCamera:{get:function(){return this._toggleCamera}},showGlobe:{get:function(){return this._showGlobe}},showMapTiles:{get:function(){return this._showMapTiles}},showModelMarker:{get:function(){return this._showModelMarker}},toggleAdvanced:{get:function(){return this._toggleAdvanced}},toggleAnimation:{get:function(){return this._toggleAnimation}},toggleRenderingQuality:{get:function(){return this._toggleRenderingQuality}},toggleGeneral:{get:function(){return this._toggleGeneral}},debugFreezeFrame:{get:function(){return this._freezeFrame}},showPerformance:{get:function(){return this._showPerformance}},toggleInspector:{get:function(){return this._toggleInspector}},maximumSSE:{get:function(){return this.viewer.geometry.maximumScreenSpaceError}},update:{get:function(){var e=this;return function(){e.performance&&e.updatePerformanceDisplay()}}}}),t.prototype._createPerformanceDisplay=function(){var e=document.createElement("div");e.className="bim-settings-performance";var t=document.createElement("div");t.className="bim-settings-performance-fps",this._fpsText=document.createTextNode("Calculating..."),t.appendChild(this._fpsText),e.appendChild(t),this._performanceContainer.appendChild(e),this._lastFpsSampleTime=void 0,this._frameCount=0,this._time=void 0,this._fps=0,this._frameTime=0;var n=this;this._unregisterPerformanceUpdate=this.viewer.scene.postRender.addEventListener(function(){n.update()})},t.prototype.updatePerformanceDisplay=function(){if(!Cesium.defined(this._time))return this._lastFpsSampleTime=Cesium.getTimestamp(),this._time=Cesium.getTimestamp(),void(this._fpsText.nodeValue="Calculating...");var e=this._time,t=Cesium.getTimestamp();this._time=t;var n=t-e;this._frameCount++;var r=this._fps,i=t-this._lastFpsSampleTime;i>1e3&&(r=1e3*this._frameCount/i|0,this._lastFpsSampleTime=t,this._frameCount=0),r!==this._fps&&(this._fpsText.nodeValue=r+" FPS",this._fps=r),n!==this._frameTime&&(this._frameTime=n)},t.prototype._disableInspector=function(){Cesium.defined(this._removeInspector)&&(this._removeInspector(),this._inspector=this._inspector.destroy(),this._removeInspector=void 0)},t.prototype._enableInspector=function(){this._disableInspector();var e=document.createElement("div");e.className="cesium-viewer-cesium3DTilesInspectorContainer",this.viewer._container.appendChild(e);var t=new Cesium.Cesium3DTilesInspector(e,this.viewer.scene);this._removeInspector=this.viewer.scene.postRender.addEventListener(function(){t.viewModel.update()}),this._inspector=t},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return Cesium.knockout.cleanNode(this._element),this.viewModel.destroy(),Cesium.destroyObject(this)},r}),define("scripts/Bentley/Widgets/Toolbar",[],function(){function e(e){this.viewer=e,this.toolbarButtons=[],this.actions=[];var t=document.createElement("div");t.className="bim-toolzone",this.container=t;var n=document.createElement("div");n.className="bim-app-button",t.appendChild(n),this.cornerContainer=n;var r=document.createElement("i");r.className="bim-icon-appicon",n.appendChild(r);var i=document.createElement("div");i.className="bim-toolbar bim-toolbar-horizontal",t.appendChild(i),this.topContainer=i;var o=document.createElement("div");o.className="bim-toolbar bim-toolbar-vertical",t.appendChild(o),this.leftContainer=o;var a=document.createElement("div");a.className="bim-toolzone-content-container",t.appendChild(a),this.contentContainer=a,e.element.appendChild(t),this.container=t,this.activeContentChanged=new Cesium.Event}return e.prototype.addToolbarButton=function(e,t){this.toolbarButtons.push(e)},e.prototype.setPanelPosition=function(e){var t=this.topContainer.offsetLeft,n=this.toolbarButtons.indexOf(e),r=t+38*n+1,i=e.content.parentElement.offsetLeft,o=r-i;e.content.style.left=o+"px";var a=o+19-e.content.clientWidth/2;a<=0&&(a=o),e.content.style.marginLeft="-"+a+"px"},e.prototype.closeActiveContent=function(){for(var e=0;e<this.toolbarButtons.length;e++){var t=this.toolbarButtons[e];t.dropDownVisible=!1,t.content.className="bim-panel bim-toolzone-content-wrapper-inactive"}},e.prototype.toggleActiveContent=function(e){e.dropDownVisible?e.content.className="bim-panel bim-toolzone-content-wrapper-inactive":(this.closeActiveContent(),e.content.className="bim-panel bim-toolzone-content-wrapper",this.setPanelPosition(e)),e.dropDownVisible=!e.dropDownVisible,this.activeContentChanged.raiseEvent(this,e.dropDownVisible?e:void 0)},e.prototype.createActionButton=function(e){var t=document.createElement("i");t.className=e.icon;var n=document.createElement("div");n.appendChild(t),n.className="bim-toolbar-tool",n.setAttribute("data-bind",'attr: {title: tooltipText}, css: { "bim-toolbar-disabled": !enabled, "bim-active": active }');var r=this;return n.onclick=function(){r.onActionClick(e)},Cesium.knockout.applyBindings(e,n),n},e.prototype.addActionButton=function(e){var t=this.createActionButton(e);return this.leftContainer.appendChild(t),this.actions.push(e),t},e.prototype.onActionClick=function(e){if(e.enabled)return e.active?(e.deactivate(),void(e.active=!1)):void(e.active=e.activate())},e}),define("scripts/Bentley/Widgets/ToolbarButton",[],function(){function e(e,t,n){this.dropDownVisible=!1,this.toolbar=e,this.content=t,e.addToolbarButton(this,n),Cesium.knockout.track(this,["dropDownVisible"]);var r=this;this._toggleDropDown=Cesium.createCommand(function(){r.toolbar.toggleActiveContent(r)})}function t(t,n,r,i,o){var a=document.createElement("div");a.className="bim-panel bim-toolzone-content-wrapper-inactive",a.id="bim-panel-id-"+n.toLowerCase();var s=document.createElement("div");s.className="bim-panel-content";var u=document.createElement("div");u.className="bim-panel-chrome",a.appendChild(u),a.appendChild(s);var c=document.createElement("div");c.textContent=n,c.className="bim-panel-title",s.appendChild(c),s.appendChild(i),t.contentContainer.appendChild(a);var l=new e(t,a,o);this._viewModel=l,this._container=t.container;var f=document.createElement("div"),h=document.createElement("i");h.className=r,f.appendChild(h),f.className="bim-toolbar-group",f.setAttribute("data-bind",'click: toggleDropDown, css: { "bim-active" : dropDownVisible }'),f.setAttribute("title",n),t.topContainer.appendChild(f),this._element=f,Cesium.knockout.applyBindings(l,this._element)}return Cesium.defineProperties(e.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}}}),e.prototype.destroy=function(){return Cesium.destroyObject(this)},e.prototype.isDestroyed=function(){return!1},Cesium.defineProperties(t.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),t.prototype.isDestroyed=function(){return!1},t.prototype.destroy=function(){return Cesium.knockout.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),Cesium.destroyObject(this)},t}),define("scripts/Bentley/Widgets/ViewList",[],function(){function e(e,t){var n=e.viewport;this.viewport=n,this.view=t,this.isActive=n.activeView==t,this.closeEvent=e.onCloseActiveTools;var r=this;this._activate=Cesium.createCommand(function(){n.activeView,Cesium.Camera.clone(e.camera);return n.activateView(r.view),!0}),Cesium.knockout.track(this,["isActive"]),n.viewActivated.addEventListener(function(e,t){t&&(r.isActive=r.viewport.activeView==r.view,r.closeEvent.raiseEvent())})}function t(t,n,r){this.viewModel=new e(t,n),this.container=r;var i=document.createElement("div"),o=document.createElement("div");o.className="bim-toggle-entry",o.textContent=n.name,o.setAttribute("data-bind",'click: activate, css: { "bim-toggle-entry-enabled" : isActive, "bim-toggle-entry-disabled" : !isActive }'),o.setAttribute("title","Click to activate view"),i.appendChild(o),r.appendChild(i),Cesium.knockout.applyBindings(this.viewModel,o)}return Cesium.defineProperties(e.prototype,{activate:{get:function(){return this._activate}}}),t}),define("scripts/Bentley/Widgets/ZoneWidget",[],function(){function e(e,t,n){var r=document.createElement(e);return"string"==typeof t?r.className=t:n=t,"object"==typeof n?r.appendChild(n):"string"==typeof n?r.appendChild(document.createTextNode(n)):"array"==typeof n&&n.forEach(function(e){r.appendChild(e)}),r}function t(e,t,n){return this.isMinimized=!0,this.name=e,this.minimizedChanged=new Cesium.Event,this._toggleState=Cesium.createCommand(function(){this.isMinimized=!this.isMinimized,this.raiseMinimizedChanged()}.bind(this)),Cesium.knockout.track(this,["isMinimized"]),this}function n(n,r,i,o,a){var s=e("div","bim-zonewidget-content",o),u=e("div","bim-zonewidget-tab");u.appendChild(e("i",i)),u.setAttribute("data-bind","click: toggleState");var c=e("div","bim-zonewidget");c.id="bim-zonewidget-id-"+r.toLowerCase(),c.appendChild(u),c.appendChild(s),c.setAttribute("data-bind","css: cssClassForState");var l=new t(r,o,a);return this.viewModel=l,this._element=c,n.element.appendChild(this._element),Cesium.knockout.applyBindings(this.viewModel,this._element),this}return Cesium.defineProperties(t.prototype,{toggleState:{get:function(){return this._toggleState}},cssClassForState:{get:function(){return"bim-zonewidget "+(this.isMinimized?"bim-minimized":"bim-open")}}}),t.prototype.raiseMinimizedChanged=function(){this.minimizedChanged.raiseEvent(this)},t.prototype.destroy=function(){return Cesium.destroyObject(this)},t.prototype.isDestroyed=function(){return!1},n}),define("scripts/Bentley/Widgets/Action",[],function(){function e(e,t,n,r){this.name=e,this.icon=t,this.tooltipText=e,this.enabled=!0,this.active=!1,this._activate=n,this._deactivate=r,Cesium.knockout.track(this,this.getBindings())}return e.prototype.getBindings=function(){return["tooltipText","enabled","active"]},e.prototype.activate=function(){if(!Cesium.defined(this._activate))throw new Cesium.DeveloperError("Must implement Action.activate()");return this._activate()},e.prototype.deactivate=function(){if(!Cesium.defined(this._deactivate))throw new Cesium.DeveloperError("Must implement Action.deactivate()");this._deactivate()},e}),define("scripts/Bentley/Widgets/ToolAction",["./Action","../Util/extend","../Tools/ToolFactory"],function(e,t,n){function r(t,n,r,i,o){e.call(this,t,n),this.toolId=i,this.viewport=r,this._createTool=o;var a=this,s=r.toolAdmin;s.activeToolChanged.addEventListener(function(){a.active=Cesium.defined(s.activeTool)&&s.activeTool.id==a.toolId})}return t(e,r),r.prototype.activate=function(){var e=this.createTool();return!(!Cesium.defined(e)||!e.installTool()||e!=this.viewport.toolAdmin.activeTool)&&(this.tool=e,!0)},r.prototype.deactivate=function(){Cesium.defined(this.tool)&&(this.tool.exitTool(),this.tool=void 0)},r.prototype.createTool=function(){return Cesium.defined(this._createTool)?this._createTool():n.createTool(this.viewport,this.toolId)},r}),define("scripts/Bentley/Widgets/ViewHistoryAction",["../Util/extend","./Action"],function(e,t){function n(e,n){var r=n?"Undo":"Redo",i=n?"bim-icon-viewprevious":"bim-icon-viewnext";t.call(this,r,i),this.viewport=e,this.isUndo=n,this.evaluateMembers();var o=this;e.historyApplied.addEventListener(function(){o.evaluateMembers()}),e.historyChanged.addEventListener(function(){o.evaluateMembers()})}return e(t,n),n.prototype.evaluateMembers=function(){var e=this.viewport;this.enabled=this.isUndo?e.isUndoPossible:e.isRedoPossible,this.tooltipText=this.enabled?this.name:"Nothing to "+this.name},n.prototype.activate=function(){return this.isUndo?this.viewport.applyPrevious():this.viewport.applyNext(),!1},n}),define("scripts/Bentley/Widgets/Spinner",[],function(){function e(e){this.spinnerVisible=!1,this.className=e,this.content=t(e),Cesium.knockout.track(this,["spinnerVisible"])}function t(e){var t=document.createElement("div");return t.className=e,t}function n(e){var t=window.getComputedStyle(document.querySelector("."+e));return{bottom:parseFloat(t.getPropertyValue("bottom").replace("px","")),right:parseFloat(t.getPropertyValue("right").replace("px",""))}}return Cesium.defineProperties(e.prototype,{isVisible:{get:function(){return this.spinnerVisible}},element:{get:function(){return this.content}}}),e.prototype.setOriginIfUndefined=function(){Cesium.defined(this.origin)||(this.origin=n(this.className))},e.prototype.toggle=function(e){this.spinnerVisible!=e&&(this.content.style.visibility=e?"hidden":"visible",this.spinnerVisible=e)},e.prototype.updatePosition=function(e,t){if("top"!==e&&"bottom"!==e&&"right"!==e&&"left"!==e)throw new Cesium.DeveloperError("direction must be top,left,bottom or right");this.setOriginIfUndefined();var n="top"===e||"left"===e?-1*parseFloat(t):parseFloat(t);e="top"===e?"bottom":"left"===e?"right":e,this.content.style[e]=this.origin[e]+n+"px"},e.prototype.resetPosition=function(){this.setOriginIfUndefined(),this.content.style.bottom=this.origin.bottom+"px",this.content.style.right=this.origin.right+"px"},e.prototype.destroy=function(){return Cesium.destroyObject(this)},e.prototype.isDestroyed=function(){return!1},e}),define("scripts/Bentley/Widgets/BaseLayerPickerWidget",[],function(){function e(e,t){var n=this._createBaseLayerPickerOptions(t);this.baseLayerPicker=new Cesium.BaseLayerPicker(e,n)}function t(e){switch(e){case"stk":return new Cesium.CesiumTerrainProvider({url:"https://assets.agi.com/stk-terrain/world",requestVertexNormals:!0});default:return new Cesium.EllipsoidTerrainProvider({ellipsoid:Cesium.Ellipsoid.WGS84})}}function n(e){switch(e){case"stk":return new Cesium.ProviderViewModel({name:"STK World Terrain Meshes",iconUrl:Cesium.buildModuleUrl("Widgets/Images/TerrainProviders/STK.png"),tooltip:"High-resolution, mesh-based terrain for the entire globe. Free for use on the Internet. Closed-network options are available. http://www.agi.com",creationFunction:function(){return t("stk")}});default:return new Cesium.ProviderViewModel({name:"WGS84 Ellipsoid",iconUrl:Cesium.buildModuleUrl("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",creationFunction:function(){return t("ellipsoid")}})}}function r(e){switch(e){case"NaturalEarth":return Cesium.createTileMapServiceImageryProvider({url:Cesium.buildModuleUrl("Assets/Textures/NaturalEarthII")});case"BlackMarble":return Cesium.createTileMapServiceImageryProvider({url:"https://cesiumjs.org/blackmarble",credit:"Black Marble imagery courtesy NASA Earth Observatory",flipXY:!0});case"BingMapsRoads":return new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",mapStyle:Cesium.BingMapsStyle.ROAD});case"BingMapsAerial":return new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",mapStyle:Cesium.BingMapsStyle.AERIAL});case"BingMapsAerialWithLabels":return new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",mapStyle:Cesium.BingMapsStyle.AERIAL_WITH_LABELS});case"MapboxSatellite":return new Cesium.MapboxImageryProvider({mapId:"mapbox.satellite"});case"MapboxTerrain":return new Cesium.MapboxImageryProvider({mapId:"mapbox.terrain"});case"MapboxStreets":return new Cesium.MapboxImageryProvider({mapId:"mapbox.streets"});case"MapboxStreetsClassic":return new Cesium.MapboxImageryProvider({mapId:"mapbox.streets.basic"});case"StamenWatercolor":return Cesium.createOpenStreetMapImageryProvider({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."});case"StamenToner":return Cesium.createOpenStreetMapImageryProvider({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."});case"ESRIWorldStreetMap":return new Cesium.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:!1});case"ESRINationalGeographic":return new Cesium.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",enablePickFeatures:!1});case"OpenStreetMap":return new Cesium.createOpenStreetMapImageryProvider({url:"https://a.tile.openstreetmap.org/"});default:return new Cesium.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:!1})}}function i(e){switch(e){case"NaturalEarth":return new Cesium.ProviderViewModel({name:"Natural Earth II",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast. http://www.naturalearthdata.com/",creationFunction:function(){return r("NaturalEarth")}});case"BlackMarble":return new Cesium.ProviderViewModel({name:"The Black Marble",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/blackMarble.png"),tooltip:"The lights of cities and villages trace the outlines of civilization in this global view of the Earth at night as seen by NASA/NOAA's Suomi NPP satellite.",creationFunction:function(){return r("BlackMarble")}});case"BingMapsRoads":return new Cesium.ProviderViewModel({name:"Bing Maps Roads",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps aerial imagery with label overlays http://www.bing.com/maps",creationFunction:function(){return r("BingMapsRoads")}});case"BingMapsAerial":return new Cesium.ProviderViewModel({name:"Bing Maps Aerial",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery http://www.bing.com/maps",creationFunction:function(){return r("BingMapsAerial")}});case"BingMapsAerialWithLabels":return new Cesium.ProviderViewModel({name:"Bing Maps Aerial with Labels",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps standard road mapshttp://www.bing.com/maps",creationFunction:function(){return r("BingMapsAerialWithLabels")}});case"MapboxSatellite":return new Cesium.ProviderViewModel({name:"Mapbox Satellite",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/mapboxSatellite.png"),tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",creationFunction:function(){return r("MapboxSatellite")}});case"MapboxTerrain":return new Cesium.ProviderViewModel({name:"Mapbox Satellite",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/mapboxTerrain.png"),tooltip:"Mapbox terrain imagery https://www.mapbox.com/maps/",creationFunction:function(){return r("MapboxTerrain")}});case"MapboxStreets":return new Cesium.ProviderViewModel({name:"Mapbox Streets",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/mapboxStreets.png"),tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",creationFunction:function(){return r("MapboxStreets")}});case"MapboxStreetsClassic":return new Cesium.ProviderViewModel({name:"Mapbox Streets Classic",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/mapboxTerrain.png"),tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",creationFunction:function(){return r("MapboxStreetsClassic")}});case"StamenWatercolor":return new Cesium.ProviderViewModel({name:"Stamen Watercolor",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map. http://maps.stamen.com",creationFunction:function(){return r("StamenWatercolor")}});case"StamenToner":return new Cesium.ProviderViewModel({name:"Stamen Toner",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map. http://maps.stamen.com",creationFunction:function(){return r("StamenToner")}});case"ESRIWorldStreetMap":return new Cesium.ProviderViewModel({name:"ESRI World Street Map",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.http://www.esri.com",creationFunction:function(){return r("ESRIWorldStreetMap")}});case"ESRINationalGeographic":return new Cesium.ProviderViewModel({name:"ESRI National Geographic",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.http://www.esri.com",creationFunction:function(){return r("ESRINationalGeographic")}});case"OpenStreetMap":return new Cesium.ProviderViewModel({name:"Open Street Map",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.http://www.openstreetmap.org",creationFunction:function(){return r("OpenStreetMap")}});default:return new Cesium.ProviderViewModel({name:"ESRI World Imagery",iconUrl:Cesium.buildModuleUrl("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.http://www.esri.com",creationFunction:function(){return r("ESRIWorldImagery")}})}}return e.prototype._createBaseLayerPickerOptions=function(e){this.terrainProviderViewModels=this._createAllTerrainViewModels(),this.imageryProviderViewModels=this._createRelevantImageryViewModels();var t={globe:e.globe,imageryProviderViewModels:this.imageryProviderViewModels,selectedImageryProviderViewModel:this._getDefaultProviderViewModel(e.imageryProvider,!0),terrainProviderViewModels:this.terrainProviderViewModels,selectedTerrainProviderViewModel:this._getDefaultProviderViewModel(e.terrainProvider,!1)};return t},e.prototype._getDefaultProviderViewModel=function(e,t){if(t){var r=i(e);return this.imageryProviderViewModels.filter(function(e){return e.name===r.name})[0]}var o=n(e);return this.terrainProviderViewModels.filter(function(e){return e.name===o.name})[0]},e.prototype._createAllTerrainViewModels=function(){var e=[n("ellipsoid"),n("stk")];return e},e.prototype._createAllImageryViewModels=function(){var e=[i("BingMapsAerial"),i("BingMapsRoads"),i("BingMapsAerialWithLabels"),i("MapboxSatellite"),i("MapboxStreets"),i("MapboxStreetsClassic"),i("ESRIWorldImagery"),i("ESRIWorldStreetMap"),i("ESRINationalGeographic"),i("OpenStreetMap"),i("StamenWatercolor"),i("StamenToner"),i("BlackMarble"),i("NaturalEarth")];return e},e.prototype._createRelevantImageryViewModels=function(){var e=[i("ESRIWorldImagery"),i("ESRIWorldStreetMap"),i("ESRINationalGeographic"),i("OpenStreetMap")];return e},e.prototype.destroy=function(){return Cesium.destroyObject(this)},e.prototype.isDestroyed=function(){return!1},e}),define("scripts/Bentley/Widgets/ModelMarker",["../Math/Cartesian3","../Math/Matrix4","../Bim/StandardView"],function(e,t,n){function r(e,t){var n=o(Cesium.defaultValue(t,{})),r=i(e.geometry,n);this.marker=a(e.scene,r,n),this.ellipsoid=e.scene.globe.ellipsoid,this.isModelMarkerVisibleChanged=new Cesium.Event;var s=this;this._eventHandler=new Cesium.ScreenSpaceEventHandler(e.scene.canvas),this._eventHandler.setInputAction(function(t){s.pickBillboard(t,e)},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.scene.terrainProviderChanged.addEventListener(function(e){s.placeMarkerOnSurface(e)})}function i(t,n){var r=e.clone(t.range.high);return r.add(new e(n.offset,n.offset,n.offset)),r}function o(e){var t={image:Cesium.defaultValue(e.imageUrl,Cesium.buildModuleUrl("../Bentley/Assets/Icons/map-marker-icon.png")),height:Cesium.defaultValue(e.height,50),width:Cesium.defaultValue(e.width,50),offset:Cesium.defaultValue(e.offset,10),isVisible:Cesium.defaultValue(e.isVisible,!0)};return t}function a(e,t,n){var r=e.primitives.add(new Cesium.BillboardCollection),i={position:t,image:n.image,height:n.height,width:n.width,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,imageIndex:0,show:n.isVisible};return r.add(i)}function s(t,n){var r=new e;e.fromRadians(n.longitude,n.latitude,n.height,t.ellipsoid,r),t.marker.position=r}return Cesium.defineProperties(r.prototype,{isModelMarkerVisible:{get:function(){return this.marker.show},set:function(e){this.marker.show!==e&&(this.marker.show=e,this.isModelMarkerVisibleChanged.raiseEvent(e))}}}),r.prototype.pickBillboard=function(e,t){var n=t.scene.pick(e.position);Cesium.defined(n)&&n.primitive instanceof Cesium.Billboard&&t.fitView(!0)},r.prototype.placeMarkerOnSurface=function(e){if(Cesium.defined(e)){var t=Cesium.Cartographic.fromCartesian(this.marker.position),n=[t],r=this;Cesium.sampleTerrain(e,15,n).then(function(){s(r,n[0])})}},r.prototype.destroy=function(){return Cesium.destroyObject(this)},r.prototype.isDestroyed=function(){return!1},r}),define("scripts/Bentley/Widgets/ViewLinkWidget",["../Bim/ViewFactory"],function(e){function t(e){var t,n=/([^&=]+)=?([^&]*)/g;for(urlParams={};t=n.exec(e);)urlParams[t[1]]=t[2];return urlParams}function n(e){this.url="";var n=this;this._activate=Cesium.createCommand(function(e,r){var i=t(window.location.search.substring(1)),o=t("viewId="+e+"&"+r.toUrl());for(var a in o)i[a]=o[a];var s="";for(var a in i)""!==s&&(s+="&"),s+=a+"="+i[a];return n.url=window.location.origin+window.location.pathname+"?"+s,!0}),this._copyUrl=Cesium.createCommand(function(e,t){return r(n.url)}),Cesium.knockout.track(this,["url"])}function r(e){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return console.warn("Copy to clipboard failed.",e),!1}finally{document.body.removeChild(t)}}}function i(e){var t=new n(e);this.viewModel=t;
var r=document.createElement("div");r.className="bim-view-link",this._element=r;var i=document.createElement("div");i.className="bim-view-link-wrapper clearfix";var o=document.createElement("div");o.className="bim-groupbox";var a=document.createElement("input");a.setAttribute("data-bind","attr: {value: url}"),a.className="bim-view-link-copy-input",o.appendChild(a);var s=document.createElement("div");s.className="bim-toolbar bim-view-link-copy-btn";var u=document.createElement("div"),c=document.createElement("i");c.className="bim-icon-paste",u.appendChild(c),s.appendChild(u),u.setAttribute("data-bind","click: copyUrl"),u.setAttribute("title","copy url to clipboard"),i.appendChild(o),i.appendChild(s),r.appendChild(i),Cesium.knockout.applyBindings(t,this._element)}return Cesium.defineProperties(n.prototype,{activate:{get:function(){return this._activate}},copyUrl:{get:function(){return this._copyUrl}}}),i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return Cesium.knockout.cleanNode(this._element),this.viewModel.destroy(),Cesium.destroyObject(this)},i}),define("scripts/Bentley/Widgets/Viewer",["../Bim/Element","./PropertyVisibilityList","./ViewList","../Bim/StandardView","../Math/Cartesian3","../Math/Matrix4","../Math/Matrix3","./ToolbarButton","./Toolbar","../Tools/FitViewTool","./ZoneWidget","./PropertyGrid","../Bim/Viewport","./SettingsWidget","../Util/functionDefined","../Tools/ToolId","./Action","./ToolAction","./ViewHistoryAction","../Tools/StandardViewRotationTool","./ModelVisibilityList","./Spinner","./BaseLayerPickerWidget","./ModelMarker","../Bim/ViewFactory","./ViewLinkWidget"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m,d,v,g,y,w,x,b,C,M,T,N){function E(e,t,n){var r=this;this.fixupSandboxAttributes(),n=Cesium.defaultValue(n,{}),this._debugElementRanges=Cesium.defaultValue(n.debugElementRanges,!1),this._debugCameraTarget=Cesium.defaultValue(n.debugCameraTarget,!1),this._debugWindowArea=Cesium.defaultValue(n.debugWindowArea,!1),e=Cesium.getElement(e),this._container=e,this.element=document.createElement("div"),this.element.className="cesium-viewer",e.appendChild(this.element);var o=document.createElement("div");o.className="cesium-viewer-cesiumWidgetContainer",this.element.appendChild(o);var a=Cesium.defaultValue(n.cesiumWidgetOptions,{});this.cesiumWidget=new Cesium.CesiumWidget(o,a);var s;if(n.timeline!==!1){var u=document.createElement("div");u.className="cesium-viewer-timelineContainer",this.element.appendChild(u),this.timelineContainer=u;var c=this.cesiumWidget.clock;s=new Cesium.Timeline(u,c),s.addEventListener("settime",function(e){r.onTimelineScrubFunction(e)},!1),s.zoomTo(c.startTime,c.stopTime),this.timeline=s,n.timelineVisible!==!0&&window.setTimeout(function(){r.setTimelineVisible(!1)},100)}var l,f;if(n.fullscreenButton!==!1){var p=document.createElement("div");p.className="cesium-viewer-fullscreenContainer",this.element.appendChild(p),l=new Cesium.FullscreenButton(p,n.fullscreenElement),f=Cesium.subscribeAndEvaluate(l.viewModel,"isFullscreenEnabled",function(e){Cesium.defined(s)&&(s.container.style.right=p.clientWidth+"px",s.resize())}),this.fullscreenButton=l}var m=this.cesiumWidget.scene;t.addToScene(m),this.viewport=new h(m,t,this.getInitialViewFromUrl(t.bim));var d=!1,v=document.createElement("div");v.className="cesium-viewer-toolbar",v.style.visibility=d||this.viewport.isGlobeVisible?"visible":"hidden",this.element.appendChild(v);var g=this.viewport;if(d||(g.isGlobeVisibleChanged.addEventListener(function(e){v.style.visibility=g.isGlobeVisible&&g.view.isCameraView?"visible":"hidden"}),g.viewActivated.addEventListener(function(e){v.style.visibility=g.isGlobeVisible&&g.view.isCameraView?"visible":"hidden"})),n.modelMarker&&(this.modelMarker=new M(this.viewport)),n.geocoder!==!1){var y=document.createElement("div");y.className="cesium-viewer-geocoderContainer",v.appendChild(y);var w=new Cesium.Geocoder({container:y,scene:m});w.viewModel.complete.addEventListener(function(){g.synchWithCesiumCamera()})}if(n.baseLayerPicker!==!1){var x={globe:this.viewport.scene.globe,imageryProvider:n.selectedImageryProvider,terrainProvider:n.selectedTerrainProvider};this.baseLayerPicker=new C(v,x)}d&&(this._projectionPicker=this.projectionPicker=new Cesium.ProjectionPicker(v,m)),this._lastWidth=0,this._lastHeight=0,m.preRender.addEventListener(function(){r.resize()});var b=t.boundingSphere,T=new i(b.center.x-b.radius,b.center.y-b.radius,b.center.z-b.radius),N=new i(b.center.x+b.radius,b.center.y+b.radius,b.center.z+b.radius);if(Cesium.Camera.DEFAULT_VIEW_RECTANGLE=new Cesium.Rectangle.fromCartesianArray([T,N],Cesium.Ellipsoid.WGS84),Cesium.Camera.DEFAULT_VIEW_FACTOR=0,m._screenSpaceCameraController=m._screenSpaceCameraController.destroy(),m._screenSpaceCameraController=this.viewport.toolAdmin._createCameraController(),n.tileLoadIndicator!==!1){var E=Cesium.defaultValue(n.tileLoadIndicatorClass,"cesium-viewer-spinner");this.element.appendChild(this.createTileLoadIndicator(E))}this.viewport.toolAdmin.startDefaultTool()}function A(e,t){var n=e.allow3dManipulations;t._is3dView=n;for(var r=n?"bim-view-rotation-entry":"bim-hidden",i=t.children,o=1;o<i.length;o++)i[o].className=r;t.style.width=n?"290px":"auto"}return Cesium.defineProperties(E.prototype,{geometry:{get:function(){return this.viewport.geometry}},scene:{get:function(){return this.viewport.scene}},camera:{get:function(){return this.viewport.camera}},canvas:{get:function(){return this.viewport.canvas}},clientWidth:{get:function(){return this.viewport.clientWidth}},clientHeight:{get:function(){return this.viewport.clientHeight}},isCameraTargetLocked:{get:function(){return Cesium.defined(this._lockedCameraTarget)}},lockedCameraTarget:{get:function(){return this._lockedCameraTarget},set:function(e){this._lockedCameraTarget=e,Cesium.defined(e)&&this._setCameraTarget(e)}},terrainProvider:{get:function(){return this.viewport.terrainProvider},set:function(e){this.viewport.terrainProvider=e}},shadows:{get:function(){return this.viewport.shadows},set:function(e){this.viewport.shadows=e}}}),E.prototype.getInitialViewFromUrl=function(e){var t=window.location.search.replace("?","");if(t.length>0)return T.cloneViewFromUrl(t,e)},E.prototype.setTimelineVisible=function(e){var t=this.timeline;Cesium.defined(t)&&(t._topDiv.style.display=e?"block":"none",this.timelineContainer.style.pointerEvents=e?"auto":"none",this.adjustTileLoadIndicatorPosition(!e,"bottom",this.timeline.container.clientHeight))},E.prototype.resize=function(){var e=this.element.clientWidth,t=this.element.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){if(this.cesiumWidget.resize(),Cesium.defined(this.timeline)&&"hidden"!==window.getComputedStyle(this.timeline.container).visibility){var n=this.timeline.container.style;n.left="0px";var r=Cesium.defined(this.fullscreenButton)?this.fullscreenButton.container.clientWidth:0;n.right=r+"px",this.timeline.resize()}this._lastWidth=e,this._lastHeight=t,this.viewport.onResized()}},E.prototype.onTimelineScrubFunction=function(e){var t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1},E.prototype.fixupSandboxAttributes=function(){for(var e=document.getElementsByClassName("cesium-infoBox-iframe"),t=0;t<e.length;t++)e[t].removeAttribute("sandbox")},E.prototype._setCameraTarget=function(e){if(this.camera._setTransform(o.IDENTITY),Cesium.defined(e)&&this.camera._setTransform(Cesium.Transforms.eastNorthUpToFixedFrame(e,Cesium.Ellipsoid.WGS84,new o)),this._debugCameraTarget){if(Cesium.defined(this._debugCameraTargetGeom)&&this.scene.primitives.remove(this._debugCameraTargetGeom),Cesium.defined(e)){var t=Cesium.Material.fromType("Color");t.uniforms.color=new Cesium.Color(0,0,1,.15);var n=new Cesium.EllipsoidPrimitive({center:e,radii:new i(1,1,1),material:t});this.scene.primitives.add(n)}this._debugCameraTargetGeom=n}},E.prototype._getCameraEventInfo=function(e){if(!Cesium.defined(e))return{buttonDown:!1};Cesium.isArray(e)||(this._eventTypeArray[0]=e,e=this._eventTypeArray);for(var t=this.scene.screenSpaceCameraController._aggregator,n=0;n<e.length;n++){var r=e[n],i=Cesium.defined(r.eventType)?r.eventType:r,o=r.modifier;if(t.isButtonDown(i,o))return{buttonDown:!0,startPos:t.getStartMousePosition(i,o)}}return{buttonDown:!1}},E.prototype.createTileLoadIndicator=function(e){var t=new b(e);this._allTilesLoaded=this.geometry.allTilesLoaded;var n=this;return this.scene.postRender.addEventListener(function(){var e=n.geometry.allTilesLoaded;e!=n._allTilesLoaded&&(n._allTilesLoaded=e,t.toggle(e))}),this.tileLoadIndicator=t,t.element},E.prototype.adjustTileLoadIndicatorPosition=function(e,t,n){var r=this.tileLoadIndicator;Cesium.defined(r)&&(e?r.resetPosition():r.updatePosition(t,n))},E.prototype.createModelToggleWidget=function(){var e=this.geometry,t=e.bim,n=new x(this.viewport.geometry,t.models);return this.viewport.viewActivated.addEventListener(function(e,t){t&&n.updateHiddenStates(e.activeView.models)}),n.updateHiddenStates(this.viewport.activeView.models),n.element},E.prototype.createCategoryToggleWidget=function(){var e=this.geometry,n=e.bim,r=new t(this.viewport.categoryStyler,n.categories);return this.viewport.viewActivated.addEventListener(function(e,t){t&&r.updateHiddenStates(e.activeView.categories)}),r.updateHiddenStates(this.viewport.activeView.categories),r.element},E.prototype.createViewSelectionWidget=function(){var e=document.createElement("div");e.className="bim-toggle-list";var t=this.geometry.bim;for(var r in t.views)new n(this,t.views[r],e);return e},E.prototype.createViewRotationWidget=function(){var e=document.createElement("div");e.className="bim-view-rotation-list";for(var t=[[r.Top,"bim-icon-viewtop","Top"],[r.Bottom,"bim-icon-viewbottom","Bottom"],[r.Front,"bim-icon-viewfront","Front"],[r.Back,"bim-icon-viewback","Back"],[r.Left,"bim-icon-viewleft","Left"],[r.Right,"bim-icon-viewright","Right"],[r.Iso,"bim-icon-viewisoleft","Isometric"],[r.RightIso,"bim-icon-viewisoright","Right Isometric"]],n=0;n<t.length;n++){var i=this.createViewRotationEntry(t[n][0],t[n][1],t[n][2]);e.appendChild(i)}return this.viewport.viewActivated.addEventListener(function(t,n){n&&A(t,e)}),A(this.viewport,e),e},E.prototype.createViewRotationEntry=function(e,t,n){var r=document.createElement("div");r.className="bim-view-rotation-entry";var i=document.createElement("div");i.className="bim-view-rotation-button",r.appendChild(i);var o=document.createElement("i");o.className=t+" bim-view-rotation-image",i.appendChild(o);var a=document.createElement("div");a.className="bim-view-rotation-label",a.textContent=n,r.appendChild(a);var s=this;return r.onclick=function(){var t=new w(s.viewport,e);t.installTool(),s.onCloseActiveTools.raiseEvent()},r},E.prototype.fitView=function(e){var t=this.geometry.boundingSphere;return this.fitBoundingSphere(t,e)},E.prototype.distanceToBoundingSphere=function(e){var t=this.camera.frustum,n=Math.tan(.5*t.fovy),r=t.aspectRatio*n;return Math.max(e/r,e/n)},E.prototype.fitBoundingSphere=function(e,t,n){if(Cesium.defined(e)){var r=this.camera,s=!n&&this.isCameraTargetLocked?o.clone(r._transform,new o):void 0;r._setTransform(o.IDENTITY);var u=this.distanceToBoundingSphere(e.radius),c=new i;if(u=Math.max(u,2*this.scene.screenSpaceCameraController.minimumZoomDistance),Cesium.defined(t)){var l=new i(0,0,-1),f=new i(0,1,0);a.multiplyByVector(t,l,l),a.multiplyByVector(t,f,f);var h=this.geometry.rootTransform;o.multiplyByPointAsVector(h,l,r.direction),o.multiplyByPointAsVector(h,f,r.up),i.normalize(r.direction,r.direction),i.normalize(r.up,r.up)}i.multiplyByScalar(r.direction,-u,c),i.add(e.center,c,r.position),n?this.lockedCameraTarget=e.center:this.isCameraTargetLocked&&r._setTransform(s)}},E.prototype.fitSelectionSet=function(){var e=this.viewport.selectionSet;if(e.isEmpty())return void(this.lockedCameraTarget=void 0);var t=!0,n="";for(var r in e.elements)t?t=!1:n+=",",n+=r;var i=this;requestJson("/"+this.geometry.bim.name+"/range/"+n,function(e,t){Cesium.defined(e)||i.fitRange(t.union,!0)})},E.prototype.fitRange=function(e,t){var n=i.fromObject(e.low),r=i.fromObject(e.high),a=this.geometry.bim.bimToTile;Cesium.defined(a)&&(o.multiplyByPoint(a,n,n),o.multiplyByPoint(a,r,r));var s=this.geometry.modelMatrix,u=this.geometry.rootTransform;o.multiplyByPoint(u,n,n),o.multiplyByPoint(u,r,r),o.multiplyByPoint(s,n,n),o.multiplyByPoint(s,r,r);var c=Cesium.BoundingSphere.fromCornerPoints(n,r);if(this.fitBoundingSphere(c,void 0,t),this._debugElementRanges){Cesium.defined(this._debugElementRange)&&this.scene.primitives.remove(this._debugElementRange);var l=Cesium.Material.fromType("Color");l.uniforms.color=new Cesium.Color(1,0,0,.1);var f=new Cesium.EllipsoidPrimitive({center:c.center,radii:new i(c.radius,c.radius,c.radius),material:l});this._debugElementRange=f,this.scene.primitives.add(f)}},E.prototype.windowToDrawingBuffer=function(e,t){return Cesium.SceneTransforms.transformWindowToDrawingBuffer(this.scene,e,t)},E.prototype.flipDrawingBufferY=function(e,t){return Cesium.defined(t)||(t=new Cesium.Cartesian2),t.x=e.x,t.y=this.scene.drawingBufferHeight-e.y,t},E.prototype.windowToDrawingBufferFlipY=function(e,t){var n=this.windowToDrawingBuffer(e,t);return this.flipDrawingBufferY(n,n)},E.prototype.drawingBufferToWorld=function(e,t,n){return Cesium.SceneTransforms.drawingBufferToWgs84Coordinates(this.scene,e,t,n)},E.prototype.worldToDrawingBuffer=function(e,t){return Cesium.SceneTransforms.wgs84ToDrawingBufferCoordinates(this.scene,e,t)},E.prototype.worldToWindow=function(e,t){return Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.scene,e,t)},E.prototype.windowToWorld=function(e,t,n){var r=Cesium.defined(n)?n:new i,o=this.windowToDrawingBufferFlipY(e);return this.drawingBufferToWorld(o,t,r)},E.prototype.drawingBufferToNDC=function(e,t,n){var r=(this.scene.context.uniformState,this.scene._passState.viewport),o=Cesium.defined(n)?n:new i;return o.x=(e.x-r.x)/r.width*2-1,o.y=(e.y-r.y)/r.height*2-1,o.z=2*t-1,o},E.prototype.worldToNDC=function(e,t){var n=new Cesium.Cartesian4(e.x,e.y,e.z,1),r=new Cesium.Cartesian4,a=this.scene.context.uniformState.viewProjection;o.multiplyByVector(a,n,r);var s=1/r.w,u=Cesium.defined(t)?t:new i;return i.multiplyByScalar(r,s,u),u},E.prototype.ndcToWorld=function(e,t){var n=new Cesium.Cartesian4(e.x,e.y,e.z,1),r=new Cesium.Cartesian4,a=this.scene.context.uniformState.inverseViewProjection;o.multiplyByVector(a,n,r);var s=1/r.w,u=Cesium.defined(t)?t:new i;return i.multiplyByScalar(r,s,u),u},E.prototype.viewToNDC=function(e,t){var n=this.viewToWorld(e,t);return this.worldToNDC(n,t)},E.prototype.ndcToView=function(e,t){var n=this.ndcToWorld(e,t);return this.worldToView(n,t)},E.prototype.worldToView=function(e,t){var n=Cesium.defined(t)?t:new i,r=this.scene.context.uniformState.view3D;return o.multiplyByPoint(r,e,n)},E.prototype.viewToWorld=function(e,t){var n=Cesium.defined(t)?t:new i,r=this.scene.context.uniformState.inverseView3D;return o.multiplyByPoint(r,e,n)},E.prototype.createSettingsWidget=function(){return new p(this)._element},E.prototype.createViewLinkWidget=function(){var e=new N(this),t=this;return this.onToolbarContentActivated.addEventListener(function(n){n.match("link")&&e.viewModel.activate(t.viewport.getActiveViewId(),t.viewport.view)}),e._element},E.prototype.createElementPropertiesWidget=function(t){var n=new f("Select an element to view its properties"),r=new l(t,"Properties","bim-icon-properties",n.element,n.contentChanged);this.viewport.selectionSet.changed.addEventListener(function(t){if(!r.viewModel.isMinimized){var i=t.getSingleSelectedElement();return e.isValidElement(i)?void requestJson("/"+t.bim.name+"/elements/"+i.elementId,function(e,t){var r=Cesium.defined(e)?"Error retrieving properties.":t;n.update(r)}):void n.update(void 0)}});var i=this.viewport.selectionSet;r.viewModel.minimizedChanged.addEventListener(function(t){if(!t.isMinimized){var r=i.getSingleSelectedElement();if(n.update(e.isValidElement(r)?"Retrieving properties...":void 0),!e.isValidElement(r))return;requestJson("/"+i.bim.name+"/elements/"+r.elementId,function(e,t){var r=Cesium.defined(e)?"Error retrieving properties.":t;n.update(r)})}})},E.prototype.createToolbar=function(){var e=new u(this);this.onCloseActiveTools=new Cesium.Event,this.onCloseActiveTools.addEventListener(e.closeActiveContent,e),this.onToolbarContentActivated=new Cesium.Event;var t=this;return e.activeContentChanged.addEventListener(function(e,n){Cesium.defined(n)&&t.onToolbarContentActivated.raiseEvent(n.content.id)}),e},E.prototype.createIsolateAction=function(){var e=this.viewport;return new v("Isolate Selection","bim-icon-isolate",function(){return e.selectionSetStyler.setIsolate(!0),this.tooltipText="Clear Isolate",!0},function(){e.selectionSetStyler.setIsolate(!1),this.tooltipText="Isolate Selection"})},E}),define("scripts/Bentley/Scene/ModelGeometry",[],function(){function e(e,t){this.model=e,t=Cesium.defaultValue(t,Cesium.defaultValue.EMPTY_OBJECT),this.cesiumTileset=new Cesium.Cesium3DTileset({url:e.tilesetUrl,maximumScreenSpaceError:t.maximumScreenSpaceError,maximumNumberOfLoadedTiles:t.maximumNumberOfLoadedTiles,debugShowBoundingVolume:t.debugShowBoundingVolume,debugFreezeFrame:t.debugFreezeFrame,refineToVisible:Cesium.defaultValue(t.refineToVisible,!0)}),this.allTilesLoaded=!0;var n=this;this.cesiumTileset.loadProgress.addEventListener(function(e,t){n.allTilesLoaded=!1}),this.cesiumTileset.allTilesLoaded.addEventListener(function(){n.allTilesLoaded=!0})}return e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){return this.cesiumTileset=this.cesiumTileset&&this.cesiumTileset.destroy(),Cesium.destroyObject(this)},e.prototype.update=function(e){this.cesiumTileset.update(e)},e.prototype.makeStyleDirty=function(){this.cesiumTileset.makeStyleDirty()},e.prototype.adjustTranslation=function(e){this.modelMatrix[12]=e.x,this.modelMatrix[13]=e.y,this.modelMatrix[14]=e.z},Cesium.defineProperties(e.prototype,{asset:{get:function(){return this.cesiumTileset.asset}},properties:{get:function(){return this.cesiumTileset.properties}},ready:{get:function(){return this.cesiumTileset.ready}},readyPromise:{get:function(){return this.cesiumTileset.readyPromise}},url:{get:function(){return this.cesiumTileset.url}},baseUrl:{get:function(){return this.cesiumTileset.baseUrl}},boundingVolume:{get:function(){return this.cesiumTileset.boundingVolume}},boundingSphere:{get:function(){return this.cesiumTileset.boundingSphere}},styleEngine:{get:function(){return this.cesiumTileset.styleEngine}},modelMatrix:{get:function(){return this.cesiumTileset.modelMatrix}},rootTransform:{get:function(){return this.cesiumTileset._root.transform}},style:{get:function(){return this.cesiumTileset.style},set:function(e){this.cesiumTileset.style=e}},maximumScreenSpaceError:{get:function(){return this.cesiumTileset.maximumScreenSpaceError},set:function(e){this.cesiumTileset.maximumScreenSpaceError=e}},maximumNumberOfLoadedTiles:{get:function(){return this.cesiumTileset.maximumNumberOfLoadedTiles},set:function(e){this.cesiumTileset.maximumNumberOfLoadedTiles=e}},debugShowBoundingVolume:{get:function(){return this.cesiumTileset.debugShowBoundingVolume},set:function(e){this.cesiumTileset.debugShowBoundingVolume=e}},debugFreezeFrame:{get:function(){return this.cesiumTileset.debugFreezeFrame},set:function(e){this.cesiumTileset.debugFreezeFrame=e}}}),e}),define("scripts/Bentley/Scene/BimGeometry",["../Bim/Bim","./ModelGeometry","../Math/Matrix4","../Math/Range3"],function(e,t,n,r){function i(e,t){for(var n in e._sceneModels)if(t(e._sceneModels[n]))break}function o(e,t){for(var n in e._primitives)if(t(e._primitives[n]))break}function a(e,t){var n=0;return i(e,function(){++n}),n>0&&(t/=n,0!=t%n&&++t),t}function s(e,t){e._maximumNumberOfLoadedTiles=t,t=a(e,t),i(e,function(e){e.maximumNumberOfLoadedTiles=t})}function u(e,t){for(var n=0;n<t.length;n++)if(t[n].model.id==e)return!0;return!1}function c(e,t){t=Cesium.defined(t)&&Cesium.defined(t.length)?t:[];for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e._primitives[i];Cesium.defined(s)&&n.push(s)}var c=e._scene;if(!Cesium.defined(c)){e._sceneModels={};for(var r=0;r<n.length;r++){var s=n[r];e._sceneModels[s.model.id]=s}return void e.modelSetChanged.raiseEvent(e)}for(var r=0;r<n.length;r++){var s=n[r];Cesium.defined(e._sceneModels[s.model.id])||(e._sceneModels[s.model.id]=s,c.primitives.add(s))}for(var i in e._sceneModels)if(!u(i,n)){var s=e._sceneModels[i];c.primitives.remove(s),delete e._sceneModels[i]}var l=a(e,e.maximumNumberOfLoadedTiles);o(e,function(e){e.maximumNumberOfLoadedTiles=l}),e.modelSetChanged.raiseEvent(e)}function l(e){e.ready&&e._readyPromise.resolve(e)}function f(e,n,r){var i=new t(n,r);Cesium.when(i.readyPromise).then(function(){e._primitives[n.id]=i,++e._numLoadedModels,l(e)}).otherwise(function(){++e._numFailedModels,l(e)})}function h(e){var t={debugFreezeFrame:e.debugFreezeFrame,debugShowBoundingVolume:e.debugShowBoundingVolume,maximumScreenSpaceError:e.maximumScreenSpaceError,maximumNumberOfLoadedTiles:a(e,e.maximumNumberOfLoadedTiles),refineToVisible:e.refineToVisible},n=e.bim.models;for(var r in n){var i=n[r];f(e,i,t)}}function p(e,t,n){this.bim=e,this._primitives={},this._sceneModels={},this._numLoadedModels=this._numFailedModels=0,this._numModels=0;for(var r in e.models)++this._numModels;var i=m.any();n=Cesium.defaultValue(n,Cesium.defaultValue.EMPTY_OBJECT),this._debugShowBoundingVolume=Cesium.defaultValue(n.debugShowBoundingVolume,!1),this._debugFreezeFrame=Cesium.defaultValue(n.debugFreezeFrame,!1),this._maximumScreenSpaceError=Cesium.defaultValue(n.maximumScreenSpaceError,i?8:1),this._maximumNumberOfLoadedTiles=Cesium.defaultValue(n.maximumNumberOfLoadedTiles,i?10:1e3),this._refineToVisible=Cesium.defaultValue(n.refineToVisible,!0),this._readyPromise=Cesium.when.defer(),this.modelSetChanged=new Cesium.Event,h(this),this.models=t}var m={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return m.Android()||m.BlackBerry()||m.iOS()||m.Opera()||m.Windows()}};return p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){return Cesium.defined(this._sceneModels)&&(this.models=[],o(this,function(e){e.destroy()})),this._primitives=void 0,this._sceneModels=void 0,this.bim=void 0,this._scene=void 0,Cesium.destroyObject(this)},p.prototype.addToScene=function(e){this._scene=e,e.primitives.destroyPrimitives=!1,i(this,function(t){e.primitives.add(t)})},p.prototype.findModelGeometryForTileset=function(e){if(Cesium.defined(e)){var t=void 0;return o(this,function(n){if(n.cesiumTileset===e)return t=n,!0}),t}},p.prototype.setModelInScene=function(e,t){var n=[];for(var r in this.models)n.push(r);var i=n.indexOf(e),o=-1!=i;o!=t&&(o?n.splice(i,1):n.push(e),this.models=n)},p.prototype.adjustTranslation=function(e){o(this,function(t){t.adjustTranslation(e)})},Cesium.defineProperties(p.prototype,{ready:{get:function(){return this._numLoadedModels+this._numFailedModels==this._numModels}},readyPromise:{get:function(){return this._readyPromise.promise}},models:{get:function(){return this._sceneModels},set:function(e){c(this,e)}},style:{get:function(){return this._style},set:function(e){this._style=e,o(this,function(t){t.style=e})}},boundingVolume:{get:function(){var e;return i(this,function(t){e=t.boundingVolume}),e}},range:{get:function(){var e=new r,t=!0;return i(this,function(n){var r=n.model.extents;t?(e.copyFrom(r),t=!1):e.union(r)}),e}},boundingSphere:{get:function(){var e=[];return i(this,function(t){e.push(t.boundingSphere)}),Cesium.BoundingSphere.fromBoundingSpheres(e)}},maximumNumberOfLoadedTiles:{get:function(){return this._maximumNumberOfLoadedTiles},set:function(e){s(this,e)}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){this._maximumScreenSpaceError=e,o(this,function(t){t.maximumScreenSpaceError=e})}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume=e,o(this,function(t){t.debugShowBoundingVolume=e})}},debugFreezeFrame:{get:function(){return this._debugFreezeFrame},set:function(e){this._debugFreezeFrame=e,o(this,function(t){t.debugFreezeFrame=e})}},refineToVisible:{get:function(){return this._refineToVisible},set:function(e){this._refineToVisible=e,o(this,function(t){t.refineToVisible=e})}},modelMatrix:{get:function(){var e;return i(this,function(t){e=t.modelMatrix}),Cesium.defaultValue(e,Cesium.Matrix4.IDENTITY)}},rootTransform:{configurable:!0,get:function(){var e;return i(this,function(t){e=t.rootTransform}),Cesium.defaultValue(e,n.IDENTITY)}},allTilesLoaded:{get:function(){var e=!0;return i(this,function(t){e=e&&t.allTilesLoaded}),e}}}),p}),define("scripts/Bentley/Bentley",["./Bim/CameraInfo","./Bim/CameraView","./Bim/CoordSystem","./Bim/Element","./Bim/Frustum","./Bim/InputEventModifiers","./Bim/NpcCorners","./Bim/OrthoView","./Bim/DrawingView","./Bim/SpatialView","./Bim/View2d","./Bim/SelectionSet","./Bim/StandardView","./Bim/StandardViewMatrices","./Bim/View","./Bim/ViewFactory","./Bim/Viewport","./Bim/ViewRect","./Bim/Model","./Bim/DrawingModel","./Bim/SpatialModel","./Bim/ModelFactory","./Bim/Bim","./Math/Angle","./Math/Cartesian3","./Math/Cartesian2","./Math/Constants","./Math/Map4","./Math/Matrix3","./Math/Matrix4","./Math/Range3","./Tools/FitViewTool","./Tools/PrimitiveTool","./Tools/ElementSetTool","./Tools/SelectionTool","./Tools/Tool","./Tools/ViewTool","./Tools/WindowAreaTool","./Tools/Button","./Tools/ButtonEvent","./Tools/InputSource","./Tools/MouseWheelEvent","./Tools/ToolAdmin","./Tools/ViewIdleTool","./Tools/ViewHandleArray","./Tools/ViewHandleType","./Tools/ViewManip","./Tools/ViewToolSettings","./Tools/ViewingToolHandle","./Tools/Cursor","./Tools/ToolFactory","./Tools/ToolId","./Tools/PickTool","./Tools/StandardViewRotationTool","./Tools/GestureId","./Tools/GestureInfo","./Tools/GestureEvent","./Tools/ViewGestureTool","./Tools/RotatePanZoomGestureTool","./Tools/NavigateMode","./Tools/NavigateMotion","./Tools/OrientationResult","./Tools/ViewNavigate","./Tools/ViewWalk","./Tools/ViewWalkTool","./Util/extend","./Util/foreach","./Util/functionDefined","./Util/getFunction","./Util/isCollectionEmpty","./Util/requestJson","./Util/dynamicCast","./Widgets/PropertyGrid","./Widgets/PropertyVisibilityList","./Widgets/ModelVisibilityList","./Widgets/SettingsWidget","./Widgets/Toolbar","./Widgets/ToolbarButton","./Widgets/Viewer","./Widgets/ViewList","./Widgets/ZoneWidget","./Widgets/Action","./Widgets/ToolAction","./Widgets/ViewHistoryAction","./Scene/ModelGeometry","./Scene/BimGeometry","./Scene/PropertyVisibilityStyler","./Scene/SelectionSetStyler","./Scene/TilesetStyler"],function(e,t,n,r,i,o,a,s,u,c,l,f,h,p,m,d,v,g,y,w,x,b,C,M,T,N,E,A,S,P,O,_,I,B,k,V,z,F,D,R,U,L,q,j,W,G,H,$,Z,Y,X,J,Q,K,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,fe,he,pe,me,de,ve,ge,ye,we,xe,be,Ce,Me,Te,Ne,Ee,Ae,Se,Pe,Oe,_e,Ie,Be,ke){var Ve={CameraInfo:e,CameraView:t,CoordSystem:n,Element:r,Frustum:i,InputEventModifiers:o,NpcCorners:a,OrthoView:s,DrawingView:u,SpatialView:c,View2d:l,PropertyVisibilityStyler:Ie,SelectionSet:f,SelectionSetStyler:Be,StandardView:h,StandardViewMatrices:p,TilesetStyler:ke,View:m,ViewFactory:d,Viewport:v,ViewRect:g,Model:y,DrawingModel:w,SpatialModel:x,ModelFactory:b,Bim:C,Angle:M,Cartesian3:T,Cartesian2:N,Constants:E,Map4:A,Matrix3:S,Matrix4:P,Range3:O,FitViewTool:_,PrimitiveTool:I,ElementSetTool:B,SelectionTool:k,Tool:V,ViewTool:z,WindowAreaTool:F,Button:D,ButtonEvent:R,InputSource:U,MouseWheelEvent:L,ToolAdmin:q,ViewIdleTool:j,Cursor:Y,ToolFactory:X,ToolId:J,PickTool:Q,StandardViewRotationTool:K,GestureId:ee,GestureInfo:te,GestureEvent:ne,ViewGestureTool:re,RotatePanZoomGestureTool:ie,NavigateMode:oe,NavigateMotion:ae,OrientationResult:se,ViewNavigate:ue,ViewWalk:ce,ViewWalkTool:le,extend:fe,foreach:he,functionDefined:pe,getFunction:me,isCollectionEmpty:de,requestJson:ve,dynamicCast:ge,PropertyGrid:ye,PropertyVisibilityList:we,ModelVisibilityList:xe,SettingsWidget:be,Toolbar:Ce,ToolbarButton:Me,Viewer:Te,ViewList:Ne,ZoneWidget:Ee,Action:Ae,ToolAction:Se,ViewHistoryAction:Pe,ModelGeometry:Oe,BimGeometry:_e,test:function(){console.log("hi")}};return Ve}),define("scripts/App/MeasureToolsCommon",[],function(){var e={formatAngleDegrees:function(e){var t=5;return Cesium.Math.toDegrees(e).toFixed(t)+""},formatLengthNoUnit:function(e){var t=4;return e.toFixed(t)},formatLengthMeters:function(e){var t=2;return e.toFixed(t)+"m"},formatLengthFeet:function(e){var t=2;return(e/.3048).toFixed(t)+"ft"},formatAreaNoUnit:function(e){var t=4;return e.toFixed(t)},formatAreaSqMeters:function(e){var t=2;return e.toFixed(t)+"m"},formatAreaSqFeet:function(e){var t=2;return(e/.09290304).toFixed(t)+"ft"},paddingStringLeft:function(e,t){for(var n=e,r=0;r<t-e.length;r++)n=" "+n;return n.slice(-t)}};return e}),define("scripts/App/MeasurePositionTool",["../Bentley/Tools/PrimitiveTool","../Bentley/Util/extend","../Bentley/Bim/InputEventModifiers","./ToolId","./MeasureToolsCommon"],function(e,t,n,r,i){function o(t,n,o,a){e.call(this,t,r.MeasurePosition),this.referencing=n,this.formatLength=Cesium.defaultValue(a.formatLength,i.formatLengthMeters),this.formatAngle=Cesium.defaultValue(a.formatAngle,i.formatAngleDegrees),this.maxPickedPositions=3,this.markerUrl="resources/position.png",this.labelOffset=new Cesium.Cartesian2(0,-20),this.pickedPositions=[],this.dataSourceCollection=new Cesium.DataSourceCollection,this.dataSourceDisplay=new Cesium.DataSourceDisplay({scene:this.viewport.scene,dataSourceCollection:this.dataSourceCollection}),this.entities=this.dataSourceDisplay.defaultDataSource.entities,this.eventHelper=new Cesium.EventHelper,this.eventHelper.add(o.onTick,function(e){this.dataSourceDisplay.update(e)},this)}return t(e,o),o.prototype.clearPickedPositions=function(){for(var e=0;e<this.pickedPositions.length;e++)this.entities.remove(this.pickedPositions[e].marker),this.entities.remove(this.pickedPositions[e].label);this.pickedPositions.length=0},o.prototype.onDataButtonDown=function(e){if(n.None!=e.keyModifiers)return!1;var t=this.viewport.scene;if(!t.pickPositionSupported)return!1;var r=t.pickPosition(e.viewPoint);if(!Cesium.defined(r))return!1;var o=t.pick(e.viewPoint);if(!o)return!1;var a=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(this.referencing.globeToDataTransform,r,a);var s;if(this.referencing.isGeoreferenced){var u=Cesium.Cartographic.fromCartesian(a),c=this.formatAngle(u.longitude),l=this.formatAngle(u.latitude),f=this.formatLength(u.height),h=Math.max(Math.max(c.length,l.length),f.length);s="Lon:"+i.paddingStringLeft(c,h)+"\nLat:"+i.paddingStringLeft(l,h)+"\nAlt:"+i.paddingStringLeft(f,h)}else{var p=this.formatLength(a.x),m=this.formatLength(a.y),d=this.formatLength(a.z),h=Math.max(Math.max(p.length,m.length),d.length);s="x:"+i.paddingStringLeft(p,h)+"\ny:"+i.paddingStringLeft(m,h)+"\nz:"+i.paddingStringLeft(d,h)}var v=[];for(v.marker=this.entities.add({billboard:{heightReference:Cesium.HeightReference.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,image:this.markerUrl},position:r}),v.label=this.entities.add({label:{heightReference:Cesium.HeightReference.NONE,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:this.labelOffset,disableDepthTestDistance:Number.POSITIVE_INFINITY,text:s},position:r});this.pickedPositions.length>=this.maxPickedPositions;){var g=this.pickedPositions.shift();this.entities.remove(g.marker),this.entities.remove(g.label)}return this.pickedPositions.push(v),!0},o.prototype.onCleanup=function(){return this.clearPickedPositions(),this.eventHelper.removeAll(),this.dataSourceDisplay=this.dataSourceDisplay.destroy(),this.dataSourceCollection=this.dataSourceCollection.destroy(),
!0},o}),define("scripts/App/MeasureDistanceTool",["../Bentley/Tools/PrimitiveTool","../Bentley/Util/extend","../Bentley/Bim/InputEventModifiers","./ToolId","./MeasureToolsCommon"],function(e,t,n,r,i){function o(t,n,o,a){e.call(this,t,r.MeasureDistance),this.referencing=n,this.formatLength=Cesium.defaultValue(a.formatLength,i.formatLengthMeters),this.markerUrl="resources/position.png",this.labelOffset=new Cesium.Cartesian2(0,-20),this.firstDataPosition=null,this.secondDataPosition=null,this.firstPoint=null,this.secondPoint=null,this.firstBillboardEntity=null,this.secondBillboardEntity=null,this.lineEntity=null,this.labelEntity=null,this.dataSourceCollection=new Cesium.DataSourceCollection,this.dataSourceDisplay=new Cesium.DataSourceDisplay({scene:this.viewport.scene,dataSourceCollection:this.dataSourceCollection}),this.entities=this.dataSourceDisplay.defaultDataSource.entities,this.displayDepthFail=this.viewport.scene.context.fragmentDepth,this.eventHelper=new Cesium.EventHelper,this.eventHelper.add(o.onTick,function(e){this.dataSourceDisplay.update(e)},this)}return t(e,o),o.prototype.clearDistanceLine=function(){this.firstBillboardEntity&&(this.entities.remove(this.firstBillboardEntity),this.firstBillboardEntity=null),this.secondBillboardEntity&&(this.entities.remove(this.secondBillboardEntity),this.secondBillboardEntity=null),this.lineEntity&&(this.entities.remove(this.lineEntity),this.lineEntity=null),this.labelEntity&&(this.entities.remove(this.labelEntity),this.labelEntity=null),this.firstDataPosition=null,this.secondDataPosition=null,this.firstPoint=null,this.secondPoint=null},o.prototype.onDataButtonDown=function(e){if(n.None!=e.keyModifiers)return!1;var t=this.viewport.scene;if(!t.pickPositionSupported)return!1;var r=t.pickPosition(e.viewPoint);if(!Cesium.defined(r))return!1;var i=t.pick(e.viewPoint);if(!i)return!1;var o=new Cesium.Cartesian3;if(Cesium.Matrix4.multiplyByPoint(this.referencing.globeToDataTransform,r,o),this.secondPoint&&this.clearDistanceLine(),this.firstPoint){this.secondDataPosition=o,this.secondPoint=r;var a,s=Cesium.Cartesian3.distance(this.firstDataPosition,this.secondDataPosition);a=this.referencing.isGeoreferenced?Cesium.Cartographic.fromCartesian(this.secondDataPosition).height-Cesium.Cartographic.fromCartesian(this.firstDataPosition).height:this.secondDataPosition.z-this.firstDataPosition.z;var u=new Cesium.Cartesian3;Cesium.Cartesian3.add(this.firstPoint,this.secondPoint,u),Cesium.Cartesian3.divideByScalar(u,2,u),this.secondBillboardEntity=this.entities.add({billboard:{heightReference:Cesium.HeightReference.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,image:this.markerUrl},position:this.secondPoint}),this.lineEntity.polyline.positions=[this.firstPoint,this.secondPoint],this.labelEntity=this.entities.add({label:{heightReference:Cesium.HeightReference.NONE,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:this.labelOffset,disableDepthTestDistance:Number.POSITIVE_INFINITY,text:"Distance: "+this.formatLength(s)+"\nHeight difference: "+this.formatLength(a)},position:u})}else{this.firstDataPosition=o,this.firstPoint=r,this.firstBillboardEntity=this.entities.add({billboard:{heightReference:Cesium.HeightReference.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,image:this.markerUrl},position:this.firstPoint});var c={polyline:{positions:[this.firstPoint,this.firstPoint],width:2,material:Cesium.Color.STEELBLUE,followSurface:!1}};if(this.displayDepthFail){var l=new Cesium.Color(.67,.03,.03);c.polyline.depthFailMaterial=l}this.lineEntity=this.entities.add(c)}return!0},o.prototype.onModelMotion=function(e){if(n.None!=e.keyModifiers)return!1;if(!this.firstPoint||this.secondPoint)return!1;var t=this.viewport.scene;if(!t.pickPositionSupported)return!1;var r=t.pickPosition(e.viewPoint);if(!Cesium.defined(r))return!1;var i=t.pick(e.viewPoint);if(!i)return!1;var o=this;return this.lineEntity.polyline.positions=new Cesium.CallbackProperty(function(){return[o.firstPoint,r]},!1),!0},o.prototype.onCleanup=function(){return this.clearDistanceLine(),this.eventHelper.removeAll(),this.dataSourceDisplay=this.dataSourceDisplay.destroy(),this.dataSourceCollection=this.dataSourceCollection.destroy(),!0},o}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("scripts/App/math.min",[],t):"object"==typeof exports?exports.math=t():e.math=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=519)}([function(e,t,n){"use strict";function r(e,t,n,r){function i(t,n,r){var i=e.Matrix.storage(n||"default");return new i(t,r)}var o=r("matrix",{"":function(){return i([])},string:function(e){return i([],e)},"string, string":function(e,t){return i([],e,t)},Array:function(e){return i(e)},Matrix:function(e){return i(e,e.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o}t.name="matrix",t.factory=r},function(e,t,n){"use strict";e.exports=function e(t,n,r){return t&&"function"==typeof t.map?t.map(function(t){return e(t,n,r)}):n(t)}},function(e,t,n){"use strict";function r(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}t.isNumber=function(e){return"number"==typeof e},t.isInteger=function(e){return!!isFinite(e)&&e==Math.round(e)},t.sign=Math.sign||function(e){return e>0?1:e<0?-1:0},t.format=function(e,n){if("function"==typeof n)return n(e);if(e===1/0)return"Infinity";if(e===-(1/0))return"-Infinity";if(isNaN(e))return"NaN";var r="auto",i=void 0;switch(n&&(n.notation&&(r=n.notation),t.isNumber(n)?i=n:n.precision&&(i=n.precision)),r){case"fixed":return t.toFixed(e,i);case"exponential":return t.toExponential(e,i);case"engineering":return t.toEngineering(e,i);case"auto":return t.toPrecision(e,i,n&&n.exponential).replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},t.splitNumber=function(e){var t=String(e).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],r=t[2],i=parseFloat(t[4]||"0"),o=r.indexOf(".");i+=o!==-1?o-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(e){return i-=e.length,""}).replace(/0*$/,"").split("").map(function(e){return parseInt(e)});return 0===a.length&&(a.push(0),i++),{sign:n,coefficients:a,exponent:i}},t.toEngineering=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var i=t.roundDigits(t.splitNumber(e),n),o=i.exponent,a=i.coefficients,s=o%3===0?o:o<0?o-3-o%3:o-o%3,u=o>=0?o:Math.abs(s);a.length-1<u&&(a=a.concat(r(u-(a.length-1))));for(var c=Math.abs(o-s),l=1;--c>=0;)l++;var f=a.slice(l).join(""),h=f.match(/[1-9]/)?"."+f:"",p=a.slice(0,l).join("")+h+"e"+(o>=0?"+":"")+s.toString();return i.sign+p},t.toFixed=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var i=t.splitNumber(e),o=t.roundDigits(i,i.exponent+1+(n||0)),a=o.coefficients,s=o.exponent+1,u=s+(n||0);return a.length<u&&(a=a.concat(r(u-a.length))),s<0&&(a=r(-s+1).concat(a),s=1),n&&a.splice(s,0,0===s?"0.":"."),o.sign+a.join("")},t.toExponential=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var i=t.splitNumber(e),o=n?t.roundDigits(i,n):i,a=o.coefficients,s=o.exponent;a.length<n&&(a=a.concat(r(n-a.length)));var u=a.shift();return o.sign+u+(a.length>0?"."+a.join(""):"")+"e"+(s>=0?"+":"")+s},t.toPrecision=function(e,n,i){if(isNaN(e)||!isFinite(e))return String(e);var o=i&&void 0!==i.lower?i.lower:.001,a=i&&void 0!==i.upper?i.upper:1e5,s=t.splitNumber(e),u=Math.abs(Math.pow(10,s.exponent));if(u<o||u>=a)return t.toExponential(e,n);var c=n?t.roundDigits(s,n):s,l=c.coefficients,f=c.exponent;l.length<n&&(l=l.concat(r(n-l.length))),l=l.concat(r(f-l.length+1+(l.length<n?n-l.length:0))),l=r(-f).concat(l);var h=f>0?f:0;return h<l.length-1&&l.splice(h+1,0,"."),c.sign+l.join("")},t.roundDigits=function(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=n.coefficients;t<=0;)r.unshift(0),n.exponent++,t++;if(r.length>t){var i=r.splice(t,r.length-t);if(i[0]>=5){var o=t-1;for(r[o]++;10===r[o];)r.pop(),0===o&&(r.unshift(0),n.exponent++,o++),o--,r[o]++}}return n},t.digits=function(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},t.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,t.nearlyEqual=function(e,n,r){if(null==r)return e==n;if(e==n)return!0;if(isNaN(e)||isNaN(n))return!1;if(isFinite(e)&&isFinite(n)){var i=Math.abs(e-n);return i<t.DBL_EPSILON||i<=Math.max(Math.abs(e),Math.abs(n))*r}return!1}},function(e,t,n){"use strict";function r(e,t,n){var i,o=e.length;if(o!=t[n])throw new l(o,t[n]);if(n<t.length-1){var a=n+1;for(i=0;i<o;i++){var s=e[i];if(!Array.isArray(s))throw new l(t.length-1,t.length,"<");r(e[i],t,a)}}else for(i=0;i<o;i++)if(Array.isArray(e[i]))throw new l(t.length+1,t.length,">")}function i(e,n,r,o){var a,s,u=e.length,c=n[r],l=Math.min(u,c);if(e.length=c,r<n.length-1){var f=r+1;for(a=0;a<l;a++)s=e[a],Array.isArray(s)||(s=[s],e[a]=s),i(s,n,f,o);for(a=l;a<c;a++)s=[],e[a]=s,i(s,n,f,o)}else{for(a=0;a<l;a++)for(;Array.isArray(e[a]);)e[a]=e[a][0];if(o!==t.UNINITIALIZED)for(a=l;a<c;a++)e[a]=o}}function o(e,t){var n,r=[];if(0===t.length){if(0===e.length)throw new l(null,null,"!=");return e.shift()}for(n=0;n<t[0];n+=1)r.push(o(e,t.slice(1)));return r}function a(e,t,n){var r,i;if(n<t){var o=n+1;for(r=0,i=e.length;r<i;r++)e[r]=a(e[r],t,o)}else for(;Array.isArray(e);)e=e[0];return e}function s(e,t,n){var r,i;if(Array.isArray(e)){var o=n+1;for(r=0,i=e.length;r<i;r++)e[r]=s(e[r],t,o)}else for(var a=n;a<t;a++)e=[e];return e}var u=n(2),c=n(11),l=(n(5),n(63),n(9)),f=n(44);t.size=function(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t},t.validate=function(e,t){var n=0==t.length;if(n){if(Array.isArray(e))throw new l(e.length,0)}else r(e,t,0)},t.validateIndex=function(e,t){if(!u.isNumber(e)||!u.isInteger(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"==typeof t&&e>=t)throw new f(e,t)},t.UNINITIALIZED={},t.resize=function(e,t,n){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");t.forEach(function(e){if(!u.isNumber(e)||!u.isInteger(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+c.format(t)+")")});var r=void 0!==n?n:0;return i(e,t,0,r),e},t.reshape=function(e,n){var r,i=t.flatten(e),a=function(e){return e.reduce(function(e,t){return e*t})};if(!Array.isArray(e)||!Array.isArray(n))throw new TypeError("Array expected");if(0===n.length)throw new l(0,a(t.size(e)),"!=");try{r=o(i,n)}catch(r){if(r instanceof l)throw new l(a(n),a(t.size(e)),"!=");throw r}if(i.length>0)throw new l(a(n),a(t.size(e)),"!=");return r},t.squeeze=function(e,n){for(var r=n||t.size(e);Array.isArray(e)&&1===e.length;)e=e[0],r.shift();for(var i=r.length;1===r[i-1];)i--;return i<r.length&&(e=a(e,i,0),r.length=i),e},t.unsqueeze=function(e,n,r,i){var o=i||t.size(e);if(r)for(var a=0;a<r;a++)e=[e],o.unshift(1);for(e=s(e,n,0);o.length<n;)o.push(1);return e},t.flatten=function(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function e(n){Array.isArray(n)?n.forEach(e):t.push(n)}),t},t.map=function(e,t){return Array.prototype.map.call(e,t)},t.forEach=function(e,t){Array.prototype.forEach.call(e,t)},t.join=function(e,t){return Array.prototype.join.call(e,t)},t.isArray=Array.isArray},function(e,t,n){"use strict";t.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},t.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},t.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var r={deg:"^\\circ"};t.toSymbol=function(e,n){if(n="undefined"!=typeof n&&n)return r.hasOwnProperty(e)?r[e]:"\\mathrm{"+e+"}";if(t.symbols.hasOwnProperty(e))return t.symbols[e];if(e.indexOf("_")!==-1){var i=e.indexOf("_");return t.toSymbol(e.substring(0,i))+"_{"+t.toSymbol(e.substring(i+1))+"}"}return e}},function(e,t,n){"use strict";t.clone=function e(n){var r=typeof n;if("number"===r||"string"===r||"boolean"===r||null===n||void 0===n)return n;if("function"==typeof n.clone)return n.clone();if(Array.isArray(n))return n.map(function(t){return e(t)});if(n instanceof Number)return new Number(n.valueOf());if(n instanceof String)return new String(n.valueOf());if(n instanceof Boolean)return new Boolean(n.valueOf());if(n instanceof Date)return new Date(n.valueOf());if(n&&n.isBigNumber===!0)return n;if(n instanceof RegExp)throw new TypeError("Cannot clone "+n);return t.map(n,e)},t.map=function(e,n){var r={};for(var i in e)t.hasOwnProperty(e,i)&&(r[i]=n(e[i]));return r},t.extend=function(e,n){for(var r in n)t.hasOwnProperty(n,r)&&(e[r]=n[r]);return e},t.deepExtend=function e(n,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var i in r)if(t.hasOwnProperty(r,i))if(r[i]&&r[i].constructor===Object)void 0===n[i]&&(n[i]={}),n[i].constructor===Object?e(n[i],r[i]):n[i]=r[i];else{if(Array.isArray(r[i]))throw new TypeError("Arrays are not supported by deepExtend");n[i]=r[i]}return n},t.deepEqual=function(e,n){var r,i,o;if(Array.isArray(e)){if(!Array.isArray(n))return!1;if(e.length!=n.length)return!1;for(i=0,o=e.length;i<o;i++)if(!t.deepEqual(e[i],n[i]))return!1;return!0}if(e instanceof Object){if(Array.isArray(n)||!(n instanceof Object))return!1;for(r in e)if(!t.deepEqual(e[r],n[r]))return!1;for(r in n)if(!t.deepEqual(e[r],n[r]))return!1;return!0}return typeof e==typeof n&&e==n},t.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(e){}return!1},t.lazy=function(e,n,r){if(t.canDefineProperty()){var i,o=!0;Object.defineProperty(e,n,{get:function(){return o&&(i=r(),o=!1),i},set:function(e){i=e,o=!1},configurable:!0,enumerable:!0})}else e[n]=r()},t.traverse=function(e,t){var n=e;if(t)for(var r=t.split("."),i=0;i<r.length;i++){var o=r[i];o in n||(n[o]={}),n=n[o]}return n},t.hasOwnProperty=function(e,t){return e&&Object.hasOwnProperty.call(e,t)},t.isFactory=function(e){return e&&"function"==typeof e.factory}},function(e,t,n){"use strict";function r(e,t,n,r){var o=e.DenseMatrix,a=function(e,t,n,a){var u,c=e._data,l=e._size,f=e._datatype,h=n;"string"==typeof f&&(u=f,t=r.convert(t,u),h=r.find(n,[u,u]));var p=l.length>0?s(h,0,l,l[0],c,t,a):[];return new o({data:p,size:i(l),datatype:u})},s=function(e,t,n,r,i,o,a){var u=[];if(t===n.length-1)for(var c=0;c<r;c++)u[c]=a?e(o,i[c]):e(i[c],o);else for(var l=0;l<r;l++)u[l]=s(e,t+1,n,n[t+1],i[l],o,a);return u};return a}var i=n(5).clone;t.name="algorithm14",t.factory=r},function(e,t,n){function r(){function e(e,t){if(void 0!==n[e])throw new Error('Cannot register type "'+e+'": already exists');n[e]=t}function t(e,t,r){if(i(n,e.type)){var o=n[e.type];return o(e,t,r)}if("function"!=typeof e._compile||i(e,"_compile"))throw new Error('Cannot compile node: unknown type "'+e.type+'"');return e._compile(t,r)}var n={};return{register:e,compile:t}}var i=n(5).hasOwnProperty;t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=e.DenseMatrix,a=function(e,t,n){var a=e._data,u=e._size,c=e._datatype,l=t._data,f=t._size,h=t._datatype,p=[];if(u.length!==f.length)throw new o(u.length,f.length);for(var m=0;m<u.length;m++){if(u[m]!==f[m])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");p[m]=u[m]}var d,v=n;"string"==typeof c&&c===h&&(d=c,t=r.convert(t,d),v=r.find(n,[d,d]));var g=p.length>0?s(v,0,p,p[0],a,l):[];return new i({data:g,size:p,datatype:d})},s=function(e,t,n,r,i,o){var a=[];if(t===n.length-1)for(var u=0;u<r;u++)a[u]=e(i[u],o[u]);else for(var c=0;c<r;c++)a[c]=s(e,t+1,n,n[t+1],i[c],o[c]);return a};return a}var i=n(25),o=n(9),a=i.string;a.isString,t.name="algorithm13",t.factory=r},function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="DimensionError",r.prototype.isDimensionError=!0,e.exports=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("equalScalar",{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,n){return e===n||i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.eq(n)||o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return e.equals(t)},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return a(e.value,t.value)},"string, string":function(e,t){return e===t}});return a}var i=n(2).nearlyEqual,o=n(35);t.factory=r},function(e,t,n){"use strict";function r(e,n){if(Array.isArray(e)){for(var i="[",o=e.length,a=0;a<o;a++)0!=a&&(i+=", "),i+=r(e[a],n);return i+="]"}return t.format(e,n)}var i=n(2).format,o=n(506).format;t.isString=function(e){return"string"==typeof e},t.endsWith=function(e,t){var n=e.length-t.length,r=e.length;return e.substring(n,r)===t},t.format=function(e,n){if("number"==typeof e)return i(e,n);if(e&&e.isBigNumber===!0)return o(e,n);if(e&&e.isFraction===!0)return n&&"decimal"===n.fraction?e.toString():e.s*e.n+"/"+e.d;if(Array.isArray(e))return r(e,n);if(t.isString(e))return'"'+e+'"';if("function"==typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"==typeof e){if("function"==typeof e.format)return e.format(n);if(e&&e.toString()!=={}.toString())return e.toString();var a=[];for(var s in e)e.hasOwnProperty(s)&&a.push('"'+s+'": '+t.format(e[s],n));return"{"+a.join(", ")+"}"}return String(e)},t.stringify=function(e){for(var t=String(e),n="",r=0;r<t.length;){var i=t.charAt(r);"\\"===i?(n+=i,r++,i=t.charAt(r),""!==i&&'"\\/bfnrtu'.indexOf(i)!==-1||(n+="\\"),n+=i):n+='"'===i?'\\"':i,r++}return'"'+n+'"'}},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(20)),l=r(n(22)),f=r(n(10)),h=r(n(15)),p=r(n(6)),m=e.DenseMatrix,d=e.SparseMatrix,v=a("multiply",i({"Array, Array":function(e,t){g(o.size(e),o.size(t));var n=v(u(e),u(t));return n&&n.isMatrix===!0?n.valueOf():n},"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();return g(n,r),1===n.length?1===r.length?y(e,t,n[0]):w(e,t):1===r.length?b(e,t):C(e,t)},"Matrix, Array":function(e,t){return v(e,u(t))},"Array, Matrix":function(e,t){return v(u(e,t.storage()),t)},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=h(e,t,l,!1);break;case"dense":n=p(e,t,l,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=h(t,e,l,!0);break;case"dense":n=p(t,e,l,!0)}return n},"Array, any":function(e,t){return p(u(e),t,l,!1).valueOf()},"any, Array":function(e,t){return p(u(t),e,l,!0).valueOf()},"any, any":l,"any, any, ...any":function(e,t,n){for(var r=v(e,t),i=0;i<n.length;i++)r=v(r,n[i]);return r}},l.signatures)),g=function(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}},y=function(e,t,n){if(0===n)throw new Error("Cannot multiply two empty vectors");var r,i=e._data,o=e._datatype,s=t._data,u=t._datatype,f=c,h=l;o&&u&&o===u&&"string"==typeof o&&(r=o,f=a.find(c,[r,r]),h=a.find(l,[r,r]));for(var p=h(i[0],s[0]),m=1;m<n;m++)p=f(p,h(i[m],s[m]));return p},w=function(e,t){switch(t.storage()){case"dense":return x(e,t)}throw new Error("Not implemented")},x=function(e,t){var n,r=e._data,i=e._size,o=e._datatype,s=t._data,u=t._size,f=t._datatype,h=i[0],p=u[1],d=c,v=l;o&&f&&o===f&&"string"==typeof o&&(n=o,d=a.find(c,[n,n]),v=a.find(l,[n,n]));for(var g=[],y=0;y<p;y++){for(var w=v(r[0],s[0][y]),x=1;x<h;x++)w=d(w,v(r[x],s[x][y]));g[y]=w}return new m({data:g,size:[p],datatype:n})},b=function(e,t){switch(e.storage()){case"dense":return M(e,t);case"sparse":return E(e,t)}},C=function(e,t){switch(e.storage()){case"dense":switch(t.storage()){case"dense":return T(e,t);case"sparse":return N(e,t)}break;case"sparse":switch(t.storage()){case"dense":return A(e,t);case"sparse":return S(e,t)}}},M=function(e,t){var n,r=e._data,i=e._size,o=e._datatype,s=t._data,u=t._datatype,f=i[0],h=i[1],p=c,d=l;o&&u&&o===u&&"string"==typeof o&&(n=o,p=a.find(c,[n,n]),d=a.find(l,[n,n]));for(var v=[],g=0;g<f;g++){for(var y=r[g],w=d(y[0],s[0]),x=1;x<h;x++)w=p(w,d(y[x],s[x]));v[g]=w}return new m({data:v,size:[f],datatype:n})},T=function(e,t){var n,r=e._data,i=e._size,o=e._datatype,s=t._data,u=t._size,f=t._datatype,h=i[0],p=i[1],d=u[1],v=c,g=l;o&&f&&o===f&&"string"==typeof o&&(n=o,v=a.find(c,[n,n]),g=a.find(l,[n,n]));for(var y=[],w=0;w<h;w++){var x=r[w];y[w]=[];for(var b=0;b<d;b++){for(var C=g(x[0],s[0][b]),M=1;M<p;M++)C=v(C,g(x[M],s[M][b]));y[w][b]=C}}return new m({data:y,size:[h,d],datatype:n})},N=function(e,t){var n=e._data,r=e._size,i=e._datatype,o=t._values,s=t._index,u=t._ptr,h=t._size,p=t._datatype;if(!o)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var m,v=r[0],g=h[1],y=c,w=l,x=f,b=0;i&&p&&i===p&&"string"==typeof i&&(m=i,y=a.find(c,[m,m]),w=a.find(l,[m,m]),x=a.find(f,[m,m]),b=a.convert(0,m));for(var C=[],M=[],T=[],N=new d({values:C,index:M,ptr:T,size:[v,g],datatype:m}),E=0;E<g;E++){T[E]=M.length;var A=u[E],S=u[E+1];if(S>A)for(var P=0,O=0;O<v;O++){for(var _,I=O+1,B=A;B<S;B++){var k=s[B];P!==I?(_=w(n[O][k],o[B]),P=I):_=y(_,w(n[O][k],o[B]))}P!==I||x(_,b)||(M.push(O),C.push(_))}}return T[g]=M.length,N},E=function(e,t){var n=e._values,r=e._index,i=e._ptr,o=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,u=t._data,h=t._datatype,p=e._size[0],m=t._size[0],v=[],g=[],y=[],w=c,x=l,b=f,C=0;o&&h&&o===h&&"string"==typeof o&&(s=o,w=a.find(c,[s,s]),x=a.find(l,[s,s]),b=a.find(f,[s,s]),C=a.convert(0,s));var M=[],T=[];y[0]=0;for(var N=0;N<m;N++){var E=u[N];if(!b(E,C))for(var A=i[N],S=i[N+1],P=A;P<S;P++){var O=r[P];T[O]?M[O]=w(M[O],x(E,n[P])):(T[O]=!0,g.push(O),M[O]=x(E,n[P]))}}for(var _=g.length,I=0;I<_;I++){var B=g[I];v[I]=M[B]}return y[1]=g.length,new d({values:v,index:g,ptr:y,size:[p,1],datatype:s})},A=function(e,t){var n=e._values,r=e._index,i=e._ptr,o=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,u=t._data,h=t._datatype,p=e._size[0],m=t._size[0],v=t._size[1],g=c,y=l,w=f,x=0;o&&h&&o===h&&"string"==typeof o&&(s=o,g=a.find(c,[s,s]),y=a.find(l,[s,s]),w=a.find(f,[s,s]),x=a.convert(0,s));for(var b=[],C=[],M=[],T=new d({values:b,index:C,ptr:M,size:[p,v],datatype:s}),N=[],E=[],A=0;A<v;A++){M[A]=C.length;for(var S=A+1,P=0;P<m;P++){var O=u[P][A];if(!w(O,x))for(var _=i[P],I=i[P+1],B=_;B<I;B++){var k=r[B];E[k]!==S?(E[k]=S,C.push(k),N[k]=y(O,n[B])):N[k]=g(N[k],y(O,n[B]))}}for(var V=M[A],z=C.length,F=V;F<z;F++){var D=C[F];b[F]=N[D]}}return M[v]=C.length,T},S=function(e,t){var n,r=e._values,i=e._index,o=e._ptr,s=e._datatype,u=t._values,f=t._index,h=t._ptr,p=t._datatype,m=e._size[0],v=t._size[1],g=r&&u,y=c,w=l;s&&p&&s===p&&"string"==typeof s&&(n=s,y=a.find(c,[n,n]),w=a.find(l,[n,n]));for(var x,b,C,M,T,N,E,A,S=g?[]:void 0,P=[],O=[],_=new d({values:S,index:P,ptr:O,size:[m,v],datatype:n}),I=g?[]:void 0,B=[],k=0;k<v;k++){O[k]=P.length;var V=k+1;for(T=h[k],N=h[k+1],M=T;M<N;M++)if(A=f[M],g)for(b=o[A],C=o[A+1],x=b;x<C;x++)E=i[x],B[E]!==V?(B[E]=V,P.push(E),I[E]=w(u[M],r[x])):I[E]=y(I[E],w(u[M],r[x]));else for(b=o[A],C=o[A+1],x=b;x<C;x++)E=i[x],B[E]!==V&&(B[E]=V,P.push(E));if(g)for(var z=O[k],F=P.length,D=z;D<F;D++){var R=P[D];S[D]=I[R]}}return O[v]=P.length,_};return v.toTex={2:"\\left(${args[0]}"+s.operators.multiply+"${args[1]}\\right)"},v}var i=n(5).extend,o=n(3);t.name="multiply",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s,u){function c(){if(!(this instanceof c))throw new SyntaxError("Constructor must be called with the new operator")}function l(e){for(var t in e)if(a(e,t)&&t in i)throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}var f=r(n(7)).compile;return c.prototype.eval=function(e){return this.compile().eval(e)},c.prototype.type="Node",c.prototype.isNode=!0,c.prototype.comment="",c.prototype.compile=function(){if(arguments.length>0)throw new Error("Calling compile(math) is deprecated. Call the function as compile() instead.");var e={math:u.expression.mathWithTransform,args:{},_validateScope:l},t={},n=f(this,e,t),r=Object.keys(e).map(function(e){return"    var "+e+' = defs["'+e+'"];'}),i=r.join(" ")+'return {  "eval": function (scope) {    if (scope) _validateScope(scope);    scope = scope || {};    return '+n+";  }};",o=new Function("defs",i);return o(e)},c.prototype.forEach=function(e){throw new Error("Cannot run forEach on a Node interface")},c.prototype.map=function(e){throw new Error("Cannot run map on a Node interface")},c.prototype._ifNode=function(e){if(!e||!e.isNode)throw new TypeError("Callback function must return a Node");return e},c.prototype.traverse=function(e){function t(e,n){e.forEach(function(e,r,i){n(e,r,i),t(e,n)})}e(this,null,null),t(this,e)},c.prototype.transform=function(e){function t(e,n){return e.map(function(e,r,i){var o=n(e,r,i);return t(o,n)})}var n=e(this,null,null);return t(n,e)},c.prototype.filter=function(e){var t=[];return this.traverse(function(n,r,i){e(n,r,i)&&t.push(n)}),t},c.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},c.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},c.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},c.prototype.cloneDeep=function(){return this.map(function(e){return e.cloneDeep()})},c.prototype.equals=function(e){return!!e&&o(this,e)},c.prototype.toString=function(e){var t;if(e&&"object"==typeof e)switch(typeof e.handler){case"object":case"undefined":break;case"function":t=e.handler(this,e);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof t?t:this._toString(e)},c.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},c.prototype.toTex=function(e){var t;if(e&&"object"==typeof e)switch(typeof e.handler){case"object":case"undefined":break;case"function":t=e.handler(this,e);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof t?t:this._toTex(e)},c.prototype._toTex=function(e){throw new Error("_toTex not implemented for "+this.type)},c.prototype.getIdentifier=function(){return this.type},c.prototype.getContent=function(){return this},c}var i=n(64),o=n(5).deepEqual,a=n(5).hasOwnProperty;t.name="Node",t.path="expression.node",t.math=!0,t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=e.DenseMatrix,a=function(e,t,n,a){var s=e._data,u=e._size,c=e._datatype,l=t._values,f=t._index,h=t._ptr,p=t._size,m=t._datatype;if(u.length!==p.length)throw new i(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,v=u[0],g=u[1],y=0,w=n;"string"==typeof c&&c===m&&(d=c,y=r.convert(0,d),w=r.find(n,[d,d]));for(var x=[],b=0;b<v;b++)x[b]=[];for(var C=[],M=[],T=0;T<g;T++){for(var N=T+1,E=h[T],A=h[T+1],S=E;S<A;S++){var P=f[S];C[P]=a?w(l[S],s[P][T]):w(s[P][T],l[S]),M[P]=N}for(var O=0;O<v;O++)M[O]===N?x[O][T]=C[O]:x[O][T]=a?w(y,s[O][T]):w(s[O][T],y)}return new o({data:x,size:[v,g],datatype:d})};return a}var i=n(9);t.name="algorithm03",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(10)),a=e.SparseMatrix,s=function(e,t,n,r){var s=e._values,u=e._index,c=e._ptr,l=e._size,f=e._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=l[0],m=l[1],d=o,v=0,g=n;"string"==typeof f&&(h=f,d=i.find(o,[h,h]),v=i.convert(0,h),t=i.convert(t,h),g=i.find(n,[h,h]));for(var y=[],w=[],x=[],b=new a({values:y,index:w,ptr:x,size:[p,m],datatype:h}),C=0;C<m;C++){x[C]=w.length;for(var M=c[C],T=c[C+1],N=M;N<T;N++){var E=u[N],A=r?g(t,s[N]):g(s[N],t);d(A,v)||(w.push(E),y.push(A))}}return x[m]=w.length,b};return s}t.name="algorithm11",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=e.DenseMatrix,o=function(e,t,n,o){var a=e._values,s=e._index,u=e._ptr,c=e._size,l=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f,h=c[0],p=c[1],m=n;"string"==typeof l&&(f=l,t=r.convert(t,f),m=r.find(n,[f,f]));for(var d=[],v=new i({data:d,size:[h,p],datatype:f}),g=[],y=[],w=0;w<p;w++){for(var x=w+1,b=u[w],C=u[w+1],M=b;M<C;M++){var T=s[M];g[T]=a[M],y[T]=x}for(var N=0;N<h;N++)0===w&&(d[N]=[]),y[N]===x?d[N][w]=o?m(t,g[N]):m(g[N],t):d[N][w]=o?m(t,0):m(0,t)}return v};return o}t.name="algorithm12",t.factory=r},function(e,t,n){"use strict";function r(e,t){if(u(e)){if(c(e,t))return e[t];if(!(t in e))return}if("function"==typeof e[t]&&s(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function i(e,t,n){if(u(e)){if(!(t in e))return e[t]=n;
if(c(e,t))return e[t]=n}throw new Error('No access to property "'+t+'"')}function o(e){return!(e in{})}function a(e,t){if(!s(e,t))throw new Error('No access to method "'+t+'"')}function s(e,t){return c(e,t)?u(e):e&&"function"!=typeof e&&(c(e.constructor.prototype,t)||c(e.__proto__,t))&&(!c(Object.prototype,t)||c(l,t))}function u(e){return"object"==typeof e&&e&&e.constructor===Object}var c=n(5).hasOwnProperty,l={toString:!0,valueOf:!0,toLocaleString:!0};t.getSafeProperty=r,t.setSafeProperty=i,t.isSafeProperty=o,t.validateSafeMethod=a,t.isSafeMethod=s,t.isPlainObject=u},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(0)),s=r(n(20)),u=n(4),c=r(n(29)),l=r(n(76)),f=r(n(34)),h=r(n(8)),p=r(n(6)),m=o("add",i({"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,s);break;default:n=c(t,e,s,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,s,!1);break;default:n=h(e,t,s)}}return n},"Array, Array":function(e,t){return m(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return m(a(e),t)},"Matrix, Array":function(e,t){return m(e,a(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,s,!1);break;default:n=p(e,t,s,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=f(t,e,s,!0);break;default:n=p(t,e,s,!0)}return n},"Array, any":function(e,t){return p(a(e),t,s,!1).valueOf()},"any, Array":function(e,t){return p(a(t),e,s,!0).valueOf()},"any, any":s,"any, any, ...any":function(e,t,n){for(var r=m(e,t),i=0;i<n.length;i++)r=m(r,n[i]);return r}},s.signatures));return m.toTex={2:"\\left(${args[0]}"+u.operators.add+"${args[1]}\\right)"},m}var i=n(5).extend;t.name="add",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(22)),a=i("divide",{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Fraction | BigNumber":function(e,t){var n=e.clone();return n.value=a(null===n.value?n._normalize(1):n.value,t),n},"number | Fraction | BigNumber, Unit":function(e,t){var n=t.pow(-1);return n.value=o(null===n.value?n._normalize(1):n.value,e),n},"Unit, Unit":function(e,t){return e.divide(t)}});return a}t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=r("add",{"number, number":function(e,t){return e+t},"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":function(e,t){if(null==e.value)throw new Error("Parameter x contains a unit with undefined value");if(null==t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=i(n.value,t.value),n.fixPrefix=!1,n}});return i}t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=r(n(0)),u=r(n(20)),c=r(n(32)),l=r(n(29)),f=r(n(14)),h=r(n(59)),p=r(n(34)),m=r(n(8)),d=r(n(6)),v=o("subtract",{"number, number":function(e,t){return e-t},"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":function(e,t){if(null==e.value)throw new Error("Parameter x contains a unit with undefined value");if(null==t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=v(n.value,t.value),n.fixPrefix=!1,n},"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();if(n.length!==r.length)throw new i(n.length,r.length);var o;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":o=h(e,t,v);break;default:o=f(t,e,v,!0)}break;default:switch(t.storage()){case"sparse":o=l(e,t,v,!1);break;default:o=m(e,t,v)}}return o},"Array, Array":function(e,t){return v(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return v(s(e),t)},"Matrix, Array":function(e,t){return v(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=p(e,c(t),u);break;default:n=d(e,t,v)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=p(t,e,v,!0);break;default:n=d(t,e,v,!0)}return n},"Array, any":function(e,t){return d(s(e),t,v,!1).valueOf()},"any, Array":function(e,t){return d(s(t),e,v,!0).valueOf()}});return v.toTex={2:"\\left(${args[0]}"+a.operators.subtract+"${args[1]}\\right)"},v}var i=n(9);t.name="subtract",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=r("multiplyScalar",{"number, number":function(e,t){return e*t},"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":function(e,t){var n=t.clone();return n.value=null===n.value?n._normalize(e):i(n.value,e),n},"Unit, number | Fraction | BigNumber | Complex":function(e,t){var n=e.clone();return n.value=null===n.value?n._normalize(t):i(n.value,t),n},"Unit, Unit":function(e,t){return e.multiply(t)}});return i}t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(10)),s=e.SparseMatrix,u=function(e,t,n,r){var u=e._data,c=e._size,l=e._datatype,f=t._values,h=t._index,p=t._ptr,m=t._size,d=t._datatype;if(c.length!==m.length)throw new i(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");if(!f)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var v,g=c[0],y=c[1],w=a,x=0,b=n;"string"==typeof l&&l===d&&(v=l,w=o.find(a,[v,v]),x=o.convert(0,v),b=o.find(n,[v,v]));for(var C=[],M=[],T=[],N=0;N<y;N++){T[N]=M.length;for(var E=p[N],A=p[N+1],S=E;S<A;S++){var P=h[S],O=r?b(f[S],u[P][N]):b(u[P][N],f[S]);w(O,x)||(M.push(P),C.push(O))}}return T[y]=M.length,new s({values:C,index:M,ptr:T,size:[g,y],datatype:v})};return u}var i=n(9);t.name="algorithm02",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=e.DenseMatrix,a=function(e,t,n){var a=e._size,u=e._datatype,c=t._size,l=t._datatype;if(a.length!==c.length)throw new i(a.length,c.length);if(a[0]!==c[0]||a[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");var f,h=a[0],p=a[1],m=0,d=n;"string"==typeof u&&u===l&&(f=u,m=r.convert(0,f),d=r.find(n,[f,f]));var v,g,y=[];for(v=0;v<h;v++)y[v]=[];var w=new o({data:y,size:[h,p],datatype:f}),x=[],b=[],C=[],M=[];for(g=0;g<p;g++){var T=g+1;for(s(e,g,C,x,T),s(t,g,M,b,T),v=0;v<h;v++){var N=C[v]===T?x[v]:m,E=M[v]===T?b[v]:m;y[v][g]=d(N,E)}}return w},s=function(e,t,n,r,i){for(var o=e._values,a=e._index,s=e._ptr,u=s[t],c=s[t+1];u<c;u++){var l=a[u];n[l]=i,r[l]=o[u]}};return a}var i=n(9);t.name="algorithm07",t.factory=r},function(e,t,n){"use strict";t.array=n(3),t.boolean=n(509),t.function=n(37),t.number=n(2),t.object=n(5),t.string=n(11),t.types=n(63),t.emitter=n(139)},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("abs",{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},Fraction:function(e){return e.abs()},"Array | Matrix":function(e){return i(e,o,!0)},Unit:function(e){return e.abs()}});return o.toTex={1:"\\left|${args[0]}\\right|"},o}var i=n(1);t.name="abs",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,u,c){function l(e){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}function f(e,t,n){if(!(e instanceof l))throw new TypeError("No valid SymbolNode");t.undef=h,t.Unit=d,t.getSafeProperty=s,t.hasOwnProperty=a;var r=o(e.name);return a(n,e.name)?n[e.name]:e.name in t.math?"("+r+" in scope ? getSafeProperty(scope, "+r+") : getSafeProperty(math, "+r+"))":"("+r+" in scope ? getSafeProperty(scope, "+r+") : "+(d.isValuelessUnit(e.name)?"new Unit(null, "+r+")":"undef("+r+")")+")"}function h(e){throw new Error("Undefined symbol "+e)}var p=r(n(7)).register,m=(r(n(7)).compile,r(n(13))),d=r(n(137));return l.prototype=new m,l.prototype.type="SymbolNode",l.prototype.isSymbolNode=!0,p(l.prototype.type,f),l.prototype.forEach=function(e){},l.prototype.map=function(e){return this.clone()},l.prototype.clone=function(){return new l(this.name)},l.prototype._toString=function(e){return this.name},l.prototype._toTex=function(e){var t=!1;"undefined"==typeof c[this.name]&&d.isValuelessUnit(this.name)&&(t=!0);var n=i.toSymbol(this.name,t);return"\\"===n[0]?n:" "+n},l}var i=n(4),o=n(11).stringify,a=n(5).hasOwnProperty,s=n(17).getSafeProperty;t.name="SymbolNode",t.path="expression.node",t.math=!0,t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(24)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=n(4),m=a("larger",{"boolean, boolean":function(e,t){return e>t},"number, number":function(e,n){return e>n&&!i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.gt(n)&&!o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return 1===e.compare(t)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return m(e.value,t.value)},"string, string":function(e,t){return e>t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,m);break;default:n=u(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,m,!1);break;default:n=f(e,t,m)}}return n},"Array, Array":function(e,t){return m(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return m(s(e),t)},"Matrix, Array":function(e,t){return m(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=h(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,m,!0);break;default:n=h(t,e,m,!0)}return n},"Array, any":function(e,t){return h(s(e),t,m,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+p.operators.larger+"${args[1]}\\right)"},m}var i=n(2).nearlyEqual,o=n(35);t.name="larger",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=e.DenseMatrix,a=function(e,t,n,a){var s=e._data,u=e._size,c=e._datatype,l=t._values,f=t._index,h=t._ptr,p=t._size,m=t._datatype;if(u.length!==p.length)throw new i(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,v,g=u[0],y=u[1],w="string"==typeof c&&c===m?c:void 0,x=w?r.find(n,[w,w]):n,b=[];for(d=0;d<g;d++)b[d]=[];var C=[],M=[];for(v=0;v<y;v++){for(var T=v+1,N=h[v],E=h[v+1],A=N;A<E;A++)d=f[A],C[d]=a?x(l[A],s[d][v]):x(s[d][v],l[A]),M[d]=T;for(d=0;d<g;d++)M[d]===T?b[d][v]=C[d]:b[d][v]=s[d][v]}return new o({data:b,size:[g,y],datatype:w})};return a}var i=n(9);t.name="algorithm01",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(t,n){if(1!=arguments.length&&2!=arguments.length)throw new i("parse",arguments.length,1,2);if(pe=n&&n.nodes?n.nodes:{},"string"==typeof t)return me=t,g();if(Array.isArray(t)||t instanceof e.Matrix)return o(t,function(e){if("string"!=typeof e)throw new TypeError("String expected");return me=e,g()});throw new TypeError("String or matrix expected")}function u(){ve=0,ge=me.charAt(0),xe=0,be=null}function c(){ve++,ge=me.charAt(ve)}function l(){return me.charAt(ve-1)}function f(){return me.charAt(ve+1)}function h(){return me.charAt(ve+2)}function p(){for(we=le.NULL,ye="",de="";s.isWhitespace(ge,xe);)c();if("#"==ge)for(;"\n"!=ge&&""!=ge;)de+=ge,c();if(""==ge)return void(we=le.DELIMITER);if("\n"==ge&&!xe)return we=le.DELIMITER,ye=ge,void c();var e=ge+f(),t=e+h();if(3==t.length&&fe[t])return we=le.DELIMITER,ye=t,c(),c(),void c();if(2==e.length&&fe[e])return we=le.DELIMITER,ye=e,c(),void c();if(fe[ge])return we=le.DELIMITER,ye=ge,void c();if(!s.isDigitDot(ge)){if(s.isAlpha(ge,l(),f())){for(;s.isAlpha(ge,l(),f())||s.isDigit(ge);)ye+=ge,c();return void(we=he.hasOwnProperty(ye)?le.DELIMITER:le.SYMBOL)}for(we=le.UNKNOWN;""!=ge;)ye+=ge,c();throw Z('Syntax error in part "'+ye+'"')}if(we=le.NUMBER,"."==ge)ye+=ge,c(),s.isDigit(ge)||(we=le.DELIMITER);else{for(;s.isDigit(ge);)ye+=ge,c();s.isDecimalMark(ge,f())&&(ye+=ge,c())}for(;s.isDigit(ge);)ye+=ge,c();if(e=f(),"E"==ge||"e"==ge)if(s.isDigit(e)||"-"==e||"+"==e){if(ye+=ge,c(),"+"!=ge&&"-"!=ge||(ye+=ge,c()),!s.isDigit(ge))throw Z('Digit expected, got "'+ge+'"');for(;s.isDigit(ge);)ye+=ge,c();if(s.isDecimalMark(ge,f()))throw Z('Digit expected, got "'+ge+'"')}else if("."==e)throw c(),Z('Digit expected, got "'+ge+'"')}function m(){do p();while("\n"==ye)}function d(){xe++}function v(){xe--}function g(){u(),p();var e=y();if(""!=ye)throw we==le.DELIMITER?Y("Unexpected operator "+ye):Z('Unexpected part "'+ye+'"');return e}function y(){var e,t,n=[];for(""!=ye&&"\n"!=ye&&";"!=ye&&(e=w(),e.comment=de);"\n"==ye||";"==ye;)0==n.length&&e&&(t=";"!=ye,n.push({node:e,visible:t})),p(),"\n"!=ye&&";"!=ye&&""!=ye&&(e=w(),e.comment=de,t=";"!=ye,n.push({node:e,visible:t}));return n.length>0?new K(n):(e||(e=new te("undefined","undefined"),e.comment=de),e)}function w(){var e,t,n,r,i=x();if("="==ye){if(i&&i.isSymbolNode)return e=i.name,m(),n=w(),new Q(new ce(e),n);if(i&&i.isAccessorNode)return m(),n=w(),new Q(i.object,i.index,n);if(i&&i.isFunctionNode&&(r=!0,t=[],e=i.name,i.args.forEach(function(e,n){e&&e.isSymbolNode?t[n]=e.name:r=!1}),r))return m(),n=w(),new ne(e,t,n);throw Z("Invalid left hand side of assignment operator =")}return i}function x(){for(var e=b();"?"==ye;){var t=be;be=xe,m();var n=e,r=w();if(":"!=ye)throw Z("False part of conditional expression expected");be=null,m();var i=w();e=new ee(n,r,i),be=t}return e}function b(){for(var e=C();"or"==ye;)m(),e=new oe("or","or",[e,C()]);return e}function C(){for(var e=M();"xor"==ye;)m(),e=new oe("xor","xor",[e,M()]);return e}function M(){for(var e=T();"and"==ye;)m(),e=new oe("and","and",[e,T()]);return e}function T(){for(var e=N();"|"==ye;)m(),e=new oe("|","bitOr",[e,N()]);return e}function N(){for(var e=E();"^|"==ye;)m(),e=new oe("^|","bitXor",[e,E()]);return e}function E(){for(var e=A();"&"==ye;)m(),e=new oe("&","bitAnd",[e,A()]);return e}function A(){var e,t,n,r,i;for(e=S(),t={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};t.hasOwnProperty(ye);)n=ye,r=t[n],m(),i=[e,S()],e=new oe(n,r,i);return e}function S(){var e,t,n,r,i;for(e=P(),t={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};t.hasOwnProperty(ye);)n=ye,r=t[n],m(),i=[e,P()],e=new oe(n,r,i);return e}function P(){var e,t,n,r,i;for(e=O(),t={to:"to",in:"to"};t.hasOwnProperty(ye);)n=ye,r=t[n],m(),"in"===n&&""===ye?e=new oe("*","multiply",[e,new ce("in")],!0):(i=[e,O()],e=new oe(n,r,i));return e}function O(){var e,t=[];if(e=":"==ye?new te("1","number"):_(),":"==ye&&be!==xe){for(t.push(e);":"==ye&&t.length<3;)m(),")"==ye||"]"==ye||","==ye||""==ye?t.push(new ce("end")):t.push(_());e=3==t.length?new ue(t[0],t[2],t[1]):new ue(t[0],t[1])}return e}function _(){var e,t,n,r,i;for(e=I(),t={"+":"add","-":"subtract"};t.hasOwnProperty(ye);)n=ye,r=t[n],m(),i=[e,I()],e=new oe(n,r,i);return e}function I(){var e,t,n,r,i;for(e=B(),t=e,n={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};;)if(n.hasOwnProperty(ye))r=ye,i=n[r],m(),t=B(),e=new oe(r,i,[e,t]);else{if(!(we==le.SYMBOL||"in"==ye&&e&&e.isConstantNode)&&(we!=le.NUMBER||t.isConstantNode||t.isOperatorNode&&"!"!==t.op)&&"("!=ye)break;t=B(),e=new oe("*","multiply",[e,t],!0)}return e}function B(){var e,t,n,r={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return r.hasOwnProperty(ye)?(n=r[ye],e=ye,m(),t=[B()],new oe(e,n,t)):k()}function k(){var e,t,n,r;return e=V(),"^"!=ye&&".^"!=ye||(t=ye,n="^"==t?"pow":"dotPow",m(),r=[e,B()],e=new oe(t,n,r)),e}function V(){var e,t,n,r,i;for(e=z(),t={"!":"factorial","'":"transpose"};t.hasOwnProperty(ye);)n=ye,r=t[n],p(),i=[e],e=new oe(n,r,i),e=D(e);return e}function z(){var e=[];if(we==le.SYMBOL&&pe.hasOwnProperty(ye)){var t=pe[ye];if(p(),"("==ye){if(e=[],d(),p(),")"!=ye)for(e.push(w());","==ye;)p(),e.push(w());if(")"!=ye)throw Z("Parenthesis ) expected");v(),p()}return new t(e)}return F()}function F(){var e,t;return we==le.SYMBOL||we==le.DELIMITER&&ye in he?(t=ye,p(),e=new ce(t),e=D(e)):R()}function D(e,t){for(var n;!("("!=ye&&"["!=ye&&"."!=ye||t&&t.indexOf(ye)===-1);)if(n=[],"("==ye){if(!(e.isSymbolNode||e.isAccessorNode||e.isFunctionNode))return e;if(d(),p(),")"!=ye)for(n.push(w());","==ye;)p(),n.push(w());if(")"!=ye)throw Z("Parenthesis ) expected");v(),p(),e=new se(e,n)}else if("["==ye){if(d(),p(),"]"!=ye)for(n.push(w());","==ye;)p(),n.push(w());if("]"!=ye)throw Z("Parenthesis ] expected");v(),p(),e=new X(e,new re(n))}else{if(p(),we!=le.SYMBOL)throw Z("Property name expected after dot");n.push(new te(ye)),p();var r=!0;e=new X(e,new re(n,r))}return e}function R(){var e,t;return'"'==ye?(t=U(),e=new te(t,"string"),e=D(e)):L()}function U(){for(var e="";""!=ge&&'"'!=ge;)"\\"==ge&&(e+=ge,c()),e+=ge,c();if(p(),'"'!=ye)throw Z('End of string " expected');return p(),e}function L(){var e,t,n,r;if("["==ye){if(d(),p(),"]"!=ye){var i=q();if(";"==ye){for(n=1,t=[i];";"==ye;)p(),t[n]=q(),n++;if("]"!=ye)throw Z("End of matrix ] expected");v(),p(),r=t[0].items.length;for(var o=1;o<n;o++)if(t[o].items.length!=r)throw Y("Column dimensions mismatch ("+t[o].items.length+" != "+r+")");e=new J(t)}else{if("]"!=ye)throw Z("End of matrix ] expected");v(),p(),e=i}}else v(),p(),e=new J([]);return D(e)}return j()}function q(){for(var e=[w()],t=1;","==ye;)p(),e[t]=w(),t++;return new J(e)}function j(){if("{"==ye){var e,t={};do if(p(),"}"!=ye){if('"'==ye)e=U();else{if(we!=le.SYMBOL)throw Z("Symbol or string expected as object key");e=ye,p()}if(":"!=ye)throw Z("Colon : expected after object key");p(),t[e]=w()}while(","==ye);if("}"!=ye)throw Z("Comma , or bracket } expected after object value");p();var n=new ie(t);return n=D(n)}return W()}function W(){var e;return we==le.NUMBER?(e=ye,p(),new te(e,"number")):G()}function G(){var e;if("("==ye){if(d(),p(),e=w(),")"!=ye)throw Z("Parenthesis ) expected");return v(),p(),e=new ae(e),e=D(e)}return H()}function H(){throw Z(""==ye?"Unexpected end of expression":"Value expected")}function $(){return ve-ye.length+1}function Z(e){var t=$(),n=new SyntaxError(e+" (char "+t+")");return n.char=t,n}function Y(e){var t=$(),n=new SyntaxError(e+" (char "+t+")");return n.char=t,n}var X=r(n(86)),J=r(n(65)),Q=r(n(87)),K=r(n(88)),ee=r(n(89)),te=r(n(45)),ne=r(n(90)),re=r(n(66)),ie=r(n(91)),oe=r(n(52)),ae=r(n(53)),se=r(n(46)),ue=r(n(67)),ce=r(n(27)),le={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},fe={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},he={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},pe={},me="",de="",ve=0,ge="",ye="",we=le.NULL,xe=0,be=null;return s.isAlpha=function(e,t,n){return s.isValidLatinOrGreek(e)||s.isValidMathSymbol(e,n)||s.isValidMathSymbol(t,e)},s.isValidLatinOrGreek=function(e){return/^[a-zA-Z_\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},s.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},s.isWhitespace=function(e,t){return" "==e||"\t"==e||"\n"==e&&t>0},s.isDecimalMark=function(e,t){return"."==e&&"/"!==t&&"*"!==t&&"^"!==t},s.isDigitDot=function(e){return e>="0"&&e<="9"||"."==e},s.isDigit=function(e){return e>="0"&&e<="9"},s}var i=n(43),o=n(1);t.name="parse",t.path="expression",t.factory=r},function(e,t,n){var r=n(44);t.transform=function(e){return e&&e.isIndexError?new r(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=o("unaryMinus",{number:function(e){return-e},Complex:function(e){return e.neg()},BigNumber:function(e){return e.neg()},Fraction:function(e){return e.neg()},Unit:function(e){var t=e.clone();return t.value=s(e.value),t},"Array | Matrix":function(e){return i(e,s,!0)}});return s.toTex={1:a.operators.unaryMinus+"\\left(${args[0]}\\right)"},s}var i=n(1);t.name="unaryMinus",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(t,n){var r=u(t),i=r?new e.BigNumber(0):0;if(c(t),n){var a=l(n);return t.length>0?a.resize(t,i):a}var s=[];return t.length>0?o(s,t,i):s}function u(e){var t=!1;return e.forEach(function(e,n,r){e&&e.isBigNumber===!0&&(t=!0,r[n]=e.toNumber())}),t}function c(e){e.forEach(function(e){if("number"!=typeof e||!i(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")})}var l=r(n(0)),f=a("zeros",{"":function(){return"Array"===t.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(e){var n=e[e.length-1];if("string"==typeof n){var r=e.pop();return s(e,r)}return"Array"===t.matrix?s(e):s(e,"default")},Array:s,Matrix:function(e){var t=e.storage();return s(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return s(e.valueOf(),t)}});return f.toTex=void 0,f}var i=n(2).isInteger,o=n(3).resize;t.name="zeros",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=e.DenseMatrix,o=function(e,t,n,o){var a=e._values,s=e._index,u=e._ptr,c=e._size,l=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f,h=c[0],p=c[1],m=n;"string"==typeof l&&(f=l,t=r.convert(t,f),m=r.find(n,[f,f]));for(var d=[],v=new i({data:d,size:[h,p],datatype:f}),g=[],y=[],w=0;w<p;w++){for(var x=w+1,b=u[w],C=u[w+1],M=b;M<C;M++){var T=s[M];g[T]=a[M],y[T]=x}for(var N=0;N<h;N++)0===w&&(d[N]=[]),y[N]===x?d[N][w]=o?m(t,g[N]):m(g[N],t):d[N][w]=t}return v};return o}t.name="algorithm10",t.factory=r},function(e,t,n){"use strict";e.exports=function(e,t,n){if(null==n)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var r=e.minus(t).abs();if(r.isZero())return!0;var i=e.constructor.max(e.abs(),t.abs());return r.lte(i.times(n))}return!1}},function(e,t,n){"use strict";e.exports=function e(t,n){t&&t.isMatrix===!0&&(t=t.valueOf());for(var r=0,i=t.length;r<i;r++){var o=t[r];Array.isArray(o)?e(o,n):n(o)}}},function(e,t){t.memoize=function(e,t){return function n(){"object"!=typeof n.cache&&(n.cache={});for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=t?t(r):JSON.stringify(r);return o in n.cache?n.cache[o]:n.cache[o]=e.apply(e,r)}},t.maxArgumentCount=function(e){return Object.keys(e.signatures||{}).reduce(function(e,t){var n=(t.match(/,/g)||[]).length+1;return Math.max(e,n)},-1)}},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(19)),s=r(n(12)),u=r(n(114)),c=r(n(0)),l=r(n(15)),f=r(n(6)),h=o("divide",i({"Array | Matrix, Array | Matrix":function(e,t){return s(e,u(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,a,!1);break;case"dense":n=f(e,t,a,!1)}return n},"Array, any":function(e,t){return f(c(e),t,a,!1).valueOf()},"any, Array | Matrix":function(e,t){return s(e,u(t))}},a.signatures));return h.toTex={2:"\\frac{${args[0]}}{${args[1]}}"},h}var i=n(5).extend;t.name="divide",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(n,r){if(t.predictable&&!i(r)&&n<0)try{var o=m(r),a=d(o);if((r===a||Math.abs((r-a)/r)<1e-14)&&o.d%2===1)return(o.n%2===0?1:-1)*Math.pow(-n,r)}catch(e){}return n*n<1&&r===1/0||n*n>1&&r===-(1/0)?0:t.predictable&&(n<-1&&r===1/0||n>-1&&n<0&&r===-(1/0))?NaN:i(r)||n>=0||t.predictable?Math.pow(n,r):new e.Complex(n,0).pow(r,0)}function u(e,t){if(!i(t)||t<0)throw new TypeError("For A^b, b must be a positive integer (value is "+t+")");var n=o(e);if(2!=n.length)throw new Error("For A^b, A must be 2 dimensional (A has "+n.length+" dimensions)");if(n[0]!=n[1])throw new Error("For A^b, A must be square (size is "+n[0]+"x"+n[1]+")");for(var r=f(n[0]).valueOf(),a=e;t>=1;)1==(1&t)&&(r=h(a,r)),t>>=1,a=h(a,a);return r}function c(e,t){return p(u(e.valueOf(),t))}var l=n(4),f=r(n(54)),h=r(n(12)),p=r(n(0)),m=r(n(132)),d=r(n(78)),v=a("pow",{"number, number":s,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(n,r){return r.isInteger()||n>=0||t.predictable?n.pow(r):new e.Complex(n.toNumber(),0).pow(r.toNumber(),0)},"Fraction, Fraction":function(e,n){if(1!==n.d){if(t.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return s(e.valueOf(),n.valueOf())}return e.pow(n)},"Array, number":u,"Array, BigNumber":function(e,t){return u(e,t.toNumber())},"Matrix, number":c,"Matrix, BigNumber":function(e,t){return c(e,t.toNumber())},"Unit, number":function(e,t){return e.pow(t)}});return v.toTex={2:"\\left(${args[0]}\\right)"+l.operators.pow+"{${args[1]}}"},v}var i=n(2).isInteger,o=n(3).size;t.name="pow",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(24)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=n(4),m=a("smaller",{"boolean, boolean":function(e,t){return e<t},"number, number":function(e,n){return e<n&&!i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.lt(n)&&!o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return e.compare(t)===-1},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return m(e.value,t.value)},"string, string":function(e,t){return e<t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,m);break;default:n=u(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,m,!1);break;default:n=f(e,t,m)}}return n},"Array, Array":function(e,t){return m(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return m(s(e),t)},"Matrix, Array":function(e,t){return m(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=h(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,m,!0);break;default:n=h(t,e,m,!0)}return n},"Array, any":function(e,t){return h(s(e),t,m,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+p.operators.smaller+"${args[1]}\\right)"},m}var i=n(2).nearlyEqual,o=n(35);t.name="smaller",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("isInteger",{number:o.isInteger,BigNumber:function(e){return e.isInt()},Fraction:function(e){return 1===e.d&&isFinite(e.n)},"Array | Matrix":function(e){return i(e,a)}});return a}var i=n(1),o=n(2);t.name="isInteger",t.factory=r},function(e,t,n){"use strict";e.exports=function(e){return Array.isArray(e)||e&&e.isMatrix===!0}},function(e,t,n){"use strict";function r(e,t,n,i){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=n,this.max=i,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+n+(void 0!=i?"-"+i:"")+" expected)",this.stack=(new Error).stack}r.prototype=new Error,r.prototype.constructor=Error,r.prototype.name="ArgumentsError",r.prototype.isArgumentsError=!0,e.exports=r},function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="IndexError",r.prototype.isIndexError=!0,e.exports=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e,t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(t){if("string"!=typeof t)throw new TypeError('String expected for parameter "valueType"');if("string"!=typeof e)throw new TypeError('String expected for parameter "value"');this.value=e,this.valueType=t}else this.value=e+"",this.valueType=i(e);if(!h[this.valueType])throw new TypeError('Unsupported type of value "'+this.valueType+'"')}function u(e,n,r){if(!(e instanceof s))throw new TypeError("No valid ConstantNode");switch(e.valueType){case"number":return"BigNumber"===t.number?"math.bignumber("+o(e.value)+")":"Fraction"===t.number?"math.fraction("+o(e.value)+")":(c(e.value),e.value.replace(/^(0*)[0-9]/,function(e,t){return e.substring(t.length)}));case"string":return o(e.value);case"boolean":return"true"===String(e.value)?"true":"false";case"undefined":return"undefined";case"null":return"null";default:throw new TypeError('Unsupported type of constant "'+e.valueType+'"')}}function c(e){if("string"!=typeof e||!/^[\-+]?((\d+\.?\d*)|(\d*\.?\d+))([eE][+\-]?\d+)?$/.test(e))throw new Error('Invalid numeric value "'+e+'"')}var l=r(n(7)).register,f=(r(n(7)).compile,r(n(13))),h={number:!0,string:!0,boolean:!0,undefined:!0,null:!0};return s.prototype=new f,s.prototype.type="ConstantNode",s.prototype.isConstantNode=!0,l(s.prototype.type,u),s.prototype.forEach=function(e){},s.prototype.map=function(e){return this.clone()},s.prototype.clone=function(){return new s(this.value,this.valueType)},s.prototype._toString=function(e){switch(this.valueType){case"string":return o(this.value);default:return this.value}},s.prototype._toTex=function(e){var t,n=this.value;switch(this.valueType){case"string":return"\\mathtt{"+o(n)+"}";case"number":return t=n.toLowerCase().indexOf("e"),t!==-1?n.substring(0,t)+"\\cdot10^{"+n.substring(t+1)+"}":n;default:return n}},s}var i=n(63).type,o=n(11).stringify;t.name="ConstantNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,h,p){function m(e,t){if(!(this instanceof m))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof e&&(e=new b(e)),!e||!e.isNode)throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(function(e){return e&&e.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var n=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:n,set:n})}function d(e,t,n){if(!(e instanceof m))throw new TypeError("No valid FunctionNode");var r,i=w(e.fn,t,n),a=u(e.args,function(e){return w(e,t,n)}),h=v(t,n);if(e.fn.isSymbolNode){var p=e.fn.name,d=s(t.math,p)?t.math[p]:void 0,g="function"==typeof d&&1==d.rawArgs;return g?(r=f(t),t[r]=e.args,i+"("+r+", math, "+h+")"):i+"("+c(a,", ")+")"}if(e.fn.isAccessorNode&&e.fn.index.isObjectProperty()){r=f(t),t[r]=e.args,t.validateSafeMethod=l;var y=w(e.fn.object,t,n),x=o(e.fn.index.getObjectProperty());return"(function () {var object = "+y+";validateSafeMethod(object, "+x+");return (object["+x+"] && object["+x+"].rawArgs)  ? object["+x+"]("+r+", math, "+h+") : object["+x+"]("+c(a,", ")+")})()"}return r=f(t),t[r]=e.args,"(function () {var fn = "+i+";return (fn && fn.rawArgs)  ? fn("+r+", math, "+h+") : fn("+c(a,", ")+")})()"}function v(e,t){var n=Object.keys(t);
if(0===n.length)return"scope";e.extend=a;var r=u(n,function(e){return o(e)+": "+t[e]});return"extend(extend({}, scope), {"+c(r,", ")+"})"}function g(e,t,n){for(var r,i="",o=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),a=0;null!==(r=o.exec(e));)if(i+=e.substring(a,r.index),a=r.index,"$$"===r[0])i+="$",a++;else{a+=r[0].length;var s=t[r[1]];if(!s)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(typeof s){case"string":i+=s;break;case"object":if(s.isNode)i+=s.toTex(n);else{if(!Array.isArray(s))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");i+=s.map(function(e,t){if(e&&e.isNode)return e.toTex(n);throw new TypeError("Template: "+r[1]+"["+t+"] is not a Node.")}).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!s[r[2]]||!s[r[2]].isNode)throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");i+=s[r[2]].toTex(n)}}return i+=e.slice(a)}var y=r(n(7)).register,w=r(n(7)).compile,x=r(n(13)),b=r(n(27));m.prototype=new x,m.prototype.type="FunctionNode",m.prototype.isFunctionNode=!0,y(m.prototype.type,d),m.prototype.forEach=function(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)},m.prototype.map=function(e){for(var t=this.fn.map(e),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new m(t,n)},m.prototype.clone=function(){return new m(this.fn,this.args.slice(0))};var C=m.prototype.toString;m.prototype.toString=function(e){var t,n=this.fn.toString(e);return e&&"object"==typeof e.handler&&s(e.handler,n)&&(t=e.handler[n](this,e)),"undefined"!=typeof t?t:C.call(this,e)},m.prototype._toString=function(e){var t=this.args.map(function(t){return t.toString(e)});return this.fn.toString(e)+"("+t.join(", ")+")"};var M=m.prototype.toTex;return m.prototype.toTex=function(e){var t;return e&&"object"==typeof e.handler&&s(e.handler,this.name)&&(t=e.handler[this.name](this,e)),"undefined"!=typeof t?t:M.call(this,e)},m.prototype._toTex=function(e){var t,n=this.args.map(function(t){return t.toTex(e)});!p[this.name]||"function"!=typeof p[this.name].toTex&&"object"!=typeof p[this.name].toTex&&"string"!=typeof p[this.name].toTex||(t=p[this.name].toTex);var r;switch(typeof t){case"function":r=t(this,e);break;case"string":r=g(t,this,e);break;case"object":switch(typeof t[n.length]){case"function":r=t[n.length](this,e);break;case"string":r=g(t[n.length],this,e)}}return"undefined"!=typeof r?r:g(i.defaultTemplate,this,e)},m.prototype.getIdentifier=function(){return this.type+":"+this.name},m}var i=n(4),o=n(11).stringify,a=n(5).extend,s=n(5).hasOwnProperty,u=n(3).map,c=n(3).join,l=n(17).validateSafeMethod,f=n(93);t.name="FunctionNode",t.path="expression.node",t.math=!0,t.factory=r},function(e,t,n){"use strict";function r(e,t){var n=e;"keep"!==t&&(n=e.getContent());for(var r=n.getIdentifier(),i=0;i<a.length;i++)if(r in a[i])return i;return null}function i(e,t){var n=e;"keep"!==t&&(n=e.getContent());var i=n.getIdentifier(),o=r(n,t);if(null===o)return null;var s=a[o][i];if(s.hasOwnProperty("associativity")){if("left"===s.associativity)return"left";if("right"===s.associativity)return"right";throw Error("'"+i+"' has the invalid associativity '"+s.associativity+"'.")}return null}function o(e,t,n){var i=e,o=t;if("keep"!==n)var i=e.getContent(),o=t.getContent();var s=i.getIdentifier(),u=o.getIdentifier(),c=r(i,n);if(null===c)return null;var l=a[c][s];if(l.hasOwnProperty("associativeWith")&&l.associativeWith instanceof Array){for(var f=0;f<l.associativeWith.length;f++)if(l.associativeWith[f]===u)return!0;return!1}return null}var a=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];e.exports.properties=a,e.exports.getPrecedence=r,e.exports.getAssociativity=i,e.exports.isAssociativeWith=o},function(e,t,n){"use strict";function r(e,t,n,r){function o(n){return n>=0||t.predictable?Math.sqrt(n):new e.Complex(n,0).sqrt()}var a=r("sqrt",{number:o,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():o(e.toNumber())},"Array | Matrix":function(e){return i(e,a,!0)},Unit:function(e){return e.pow(.5)}});return a.toTex={1:"\\sqrt{${args[0]}}"},a}var i=n(1);t.name="sqrt",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(59)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=a("compare",{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"number, number":function(e,n){return e===n||i(e,n,t.epsilon)?0:e>n?1:-1},"BigNumber, BigNumber":function(n,r){return n.eq(r)||o(n,r,t.epsilon)?new e.BigNumber(0):new e.BigNumber(n.cmp(r))},"Fraction, Fraction":function(t,n){return new e.Fraction(t.compare(n))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return p(e.value,t.value)},"string, string":function(e,t){return e===t?0:e>t?1:-1},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,p);break;default:n=u(t,e,p,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,p,!1);break;default:n=f(e,t,p)}}return n},"Array, Array":function(e,t){return p(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return p(s(e),t)},"Matrix, Array":function(e,t){return p(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,p,!1);break;default:n=h(e,t,p,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,p,!0);break;default:n=h(t,e,p,!0)}return n},"Array, any":function(e,t){return h(s(e),t,p,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,p,!0).valueOf()}});return p.toTex=void 0,p}var i=n(2).nearlyEqual,o=n(35);t.name="compare",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isNegative",{number:function(e){return e<0},BigNumber:function(e){return e.isNeg()&&!e.isZero()&&!e.isNaN()},Fraction:function(e){return e.s<0},Unit:function(e){return o(e.value)},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);n(2),t.name="isNegative",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isPositive",{number:function(e){return e>0},BigNumber:function(e){return!e.isNeg()&&!e.isZero()&&!e.isNaN()},Fraction:function(e){return e.s>0&&e.n>0},Unit:function(e){return o(e.value)},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);n(2),t.name="isPositive",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,l,f){function h(e,t,n,r){if(!(this instanceof h))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof e)throw new TypeError('string expected for parameter "op"');if("string"!=typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(n)||!n.every(function(e){return e&&e.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=r===!0,this.op=e,this.fn=t,this.args=n||[]}function p(e,t,n){if(!(e instanceof h))throw new TypeError("No valid OperatorNode");if("string"!=typeof e.fn||!u(t.math,e.fn))throw t.math[e.fn]?new Error('No access to function "'+e.fn+'"'):new Error("Function "+e.fn+' missing in provided namespace "math"');var r=o(e.args,function(e){return v(e,t,n)});return"math["+s(e.fn)+"]("+a(r,", ")+")"}function m(e,t,n,r){var i=c.getPrecedence(e,t),o=c.getAssociativity(e,t);if("all"===t||n.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()){var a=n.map(function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});return a}if(0===n.length)return[];if(1===n.length){var s=c.getPrecedence(n[0],t);if(r&&null!==s){var u,l;if("keep"===t?(u=n[0].getIdentifier(),l=e.getIdentifier()):(u=n[0].getContent().getIdentifier(),l=e.getContent().getIdentifier()),c.properties[i][l].latexLeftParens===!1)return[!1];if(c.properties[s][u].latexParens===!1)return[!1]}return null===s?[!1]:s<=i?[!0]:[!1]}if(2===n.length){var f,h=c.getPrecedence(n[0],t),p=c.isAssociativeWith(e,n[0],t);f=null!==h&&(h===i&&"right"===o&&!p||h<i);var m,d=c.getPrecedence(n[1],t),v=c.isAssociativeWith(e,n[1],t);if(m=null!==d&&(d===i&&"left"===o&&!v||d<i),r){var l,g,y;"keep"===t?(l=e.getIdentifier(),g=e.args[0].getIdentifier(),y=e.args[1].getIdentifier()):(l=e.getContent().getIdentifier(),g=e.args[0].getContent().getIdentifier(),y=e.args[1].getContent().getIdentifier()),null!==h&&(c.properties[i][l].latexLeftParens===!1&&(f=!1),c.properties[h][g].latexParens===!1&&(f=!1)),null!==d&&(c.properties[i][l].latexRightParens===!1&&(m=!1),c.properties[d][y].latexParens===!1&&(m=!1))}return[f,m]}if(n.length>2&&("OperatorNode:add"===e.getIdentifier()||"OperatorNode:multiply"===e.getIdentifier())){var w=n.map(function(n){var r=c.getPrecedence(n,t),a=c.isAssociativeWith(e,n,t),s=c.getAssociativity(n,t);return null!==r&&(i===r&&o===s&&!a||r<i)});return w}}var d=r(n(7)).register,v=r(n(7)).compile,g=r(n(13));return r(n(45)),r(n(27)),r(n(46)),h.prototype=new g,h.prototype.type="OperatorNode",h.prototype.isOperatorNode=!0,d(h.prototype.type,p),h.prototype.forEach=function(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)},h.prototype.map=function(e){for(var t=[],n=0;n<this.args.length;n++)t[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new h(this.op,this.fn,t)},h.prototype.clone=function(){return new h(this.op,this.fn,this.args.slice(0),this.implicit)},h.prototype._toString=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",r=this.args,i=m(this,t,r,!1);if(1===r.length){var o=c.getAssociativity(this,t),a=r[0].toString(e);return i[0]&&(a="("+a+")"),"right"===o?this.op+a:"left"===o?a+this.op:a+this.op}if(2==r.length){var s=r[0].toString(e),u=r[1].toString(e);return i[0]&&(s="("+s+")"),i[1]&&(u="("+u+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"==n?s+" "+u:s+" "+this.op+" "+u}if(r.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var l=r.map(function(t,n){return t=t.toString(e),i[n]&&(t="("+t+")"),t});return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?l.join(" "):l.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"},h.prototype._toTex=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",r=this.args,o=m(this,t,r,!0),a=i.operators[this.fn];if(a="undefined"==typeof a?this.op:a,1===r.length){var s=c.getAssociativity(this,t),u=r[0].toTex(e);return o[0]&&(u="\\left("+u+"\\right)"),"right"===s?a+u:"left"===s?u+a:u+a}if(2===r.length){var l=r[0],f=l.toTex(e);o[0]&&(f="\\left("+f+"\\right)");var h=r[1],p=h.toTex(e);o[1]&&(p="\\left("+p+"\\right)");var d;switch(d="keep"===t?l.getIdentifier():l.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return a+"{"+f+"}{"+p+"}";case"OperatorNode:pow":switch(f="{"+f+"}",p="{"+p+"}",d){case"ConditionalNode":case"OperatorNode:divide":f="\\left("+f+"\\right)"}case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return f+"~"+p}return f+a+p}if(r.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var v=r.map(function(t,n){return t=t.toTex(e),o[n]&&(t="\\left("+t+"\\right)"),t});return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit?v.join("~"):v.join(a)}return"\\mathrm{"+this.fn+"}\\left("+r.map(function(t){return t.toTex(e)}).join(",")+"\\right)"},h.prototype.getIdentifier=function(){return this.type+":"+this.fn},h}var i=n(4),o=n(3).map,a=n(3).join,s=n(11).stringify,u=n(17).isSafeMethod,c=n(47);t.name="OperatorNode",t.path="expression.node",t.math=!0,t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!e||!e.isNode)throw new TypeError('Node expected for parameter "content"');this.content=e}function a(e,t,n){if(!(e instanceof o))throw new TypeError("No valid ParenthesisNode");return u(e.content,t,n)}var s=r(n(7)).register,u=r(n(7)).compile,c=r(n(13));return o.prototype=new c,o.prototype.type="ParenthesisNode",o.prototype.isParenthesisNode=!0,s(o.prototype.type,a),o.prototype.getContent=function(){return this.content.getContent()},o.prototype.forEach=function(e){e(this.content,"content",this)},o.prototype.map=function(e){var t=e(this.content,"content",this);return new o(t)},o.prototype.clone=function(){return new o(this.content)},o.prototype._toString=function(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)},o.prototype._toTex=function(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left("+this.content.toTex(e)+"\\right)":this.content.toTex(e)},o}t.name="ParenthesisNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e,t){switch(e.length){case 0:return t?c(t):[];case 1:return u(e[0],e[0],t);case 2:return u(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function u(t,n,r){var a=t&&t.isBigNumber===!0?e.BigNumber:n&&n.isBigNumber===!0?e.BigNumber:null;if(t&&t.isBigNumber===!0&&(t=t.toNumber()),n&&n.isBigNumber===!0&&(n=n.toNumber()),!o(t)||t<1)throw new Error("Parameters in function eye must be positive integers");if(!o(n)||n<1)throw new Error("Parameters in function eye must be positive integers");var s=a?new e.BigNumber(1):1,u=a?new a(0):0,c=[t,n];if(r){var l=e.Matrix.storage(r);return l.diagonal(c,s,0,u)}for(var f=i.resize([],c,u),h=t<n?t:n,p=0;p<h;p++)f[p][p]=s;return f}var c=r(n(0)),l=a("eye",{"":function(){return"Matrix"===t.matrix?c([]):[]},string:function(e){return c(e)},"number | BigNumber":function(e){return u(e,e,"Matrix"===t.matrix?"default":void 0)},"number | BigNumber, string":function(e,t){return u(e,e,t)},"number | BigNumber, number | BigNumber":function(e,n){return u(e,n,"Matrix"===t.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,n){return u(e,t,n)},Array:function(e){return s(e)},"Array, string":function(e,t){return s(e,t)},Matrix:function(e){return s(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return s(e.valueOf(),t)}});return l.toTex=void 0,l}var i=n(3),o=n(2).isInteger;t.name="eye",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,u){function c(e,t){if(!t||t.isIndex!==!0)throw new TypeError("Index expected");if(1!=t.size().length)throw new l(t.size().length,1);var n=e.length;s(t.min()[0],n),s(t.max()[0],n);var r=t.dimension(0),i="";return r.forEach(function(t){i+=e.charAt(t)}),i}function f(e,t,n,r){if(!t||t.isIndex!==!0)throw new TypeError("Index expected");if(1!=t.size().length)throw new l(t.size().length,1);if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=t.dimension(0),o=i.size()[0];if(o!=n.length)throw new l(i.size()[0],n.length);var a=e.length;s(t.min()[0]),s(t.max()[0]);for(var u=[],c=0;c<a;c++)u[c]=e.charAt(c);if(i.forEach(function(e,t){u[e]=n.charAt(t[0])}),u.length>a)for(c=a-1,o=u.length;c<o;c++)u[c]||(u[c]=r);return u.join("")}var h=r(n(0)),p=u("subset",{"Array, Index":function(e,t){var n=h(e),r=n.subset(t);return t.isScalar()?r:r.valueOf()},"Matrix, Index":function(e,t){return e.subset(t)},"Object, Index":i,"string, Index":c,"Array, Index, any":function(e,t,n){return h(a(e)).subset(t,n,void 0).valueOf()},"Array, Index, any, any":function(e,t,n,r){return h(a(e)).subset(t,n,r).valueOf()},"Matrix, Index, any":function(e,t,n){return e.clone().subset(t,n)},"Matrix, Index, any, any":function(e,t,n,r){return e.clone().subset(t,n,r)},"string, Index, string":f,"string, Index, string, string":f,"Object, Index, any":o});return p.toTex=void 0,p}function i(e,t){if(1!==t.size().length)throw new l(t.size(),1);var n=t.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");return u(e,n)}function o(e,t,n){if(1!==t.size().length)throw new l(t.size(),1);var r=t.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");var i=a(e);return c(i,r,n),i}var a=n(5).clone,s=n(3).validateIndex,u=n(17).getSafeProperty,c=n(17).setSafeProperty,l=n(9);t.name="subset",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=e.DenseMatrix,l=e.SparseMatrix,f=a("transpose",{Array:function(e){return f(u(e)).valueOf()},Matrix:function(e){var t,n=e.size();switch(n.length){case 1:t=e.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+o(n)+")");switch(e.storage()){case"dense":t=h(e,r,i);break;case"sparse":t=p(e,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+o(this._size)+")")}return t},any:function(e){return i(e)}}),h=function(e,t,n){for(var r,o=e._data,a=[],s=0;s<n;s++){r=a[s]=[];for(var u=0;u<t;u++)r[u]=i(o[u][s])}return new c({data:a,size:[n,t],datatype:e._datatype})},p=function(e,t,n){for(var r=e._values,o=e._index,a=e._ptr,s=r?[]:void 0,u=[],c=[],f=[],h=0;h<t;h++)f[h]=0;var p,m,d;for(p=0,m=o.length;p<m;p++)f[o[p]]++;for(var v=0,g=0;g<t;g++)c.push(v),v+=f[g],f[g]=c[g];for(c.push(v),d=0;d<n;d++)for(var y=a[d],w=a[d+1],x=y;x<w;x++){var b=f[o[x]]++;u[b]=d,r&&(s[b]=i(r[x]))}return new l({values:s,index:u,ptr:c,size:[n,t],datatype:e._datatype})};return f.toTex={1:"\\left(${args[0]}\\right)"+s.operators.transpose},f}var i=n(5).clone,o=n(11).format;t.name="transpose",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("combinations",{"number, number":function(e,t){var n,r,i;if(!o(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!o(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(n=Math.max(t,e-t),r=1,i=1;i<=e-n;i++)r=r*(n+i)/i;return r},"BigNumber, BigNumber":function(t,n){var r,o,a,s,u=new e.BigNumber(1);if(!i(t)||!i(n))throw new TypeError("Positive integer value expected in function combinations");if(n.gt(t))throw new TypeError("k must be less than n in function combinations");for(r=t.minus(n),n.lt(r)&&(r=n),o=u,a=u,s=t.minus(r);a.lte(s);a=a.plus(1))o=o.times(r.plus(a)).dividedBy(a);return o}});return a.toTex={2:"\\binom{${args[0]}}{${args[1]}}"},a}function i(e){return e.isInteger()&&e.gte(0)}var o=n(2).isInteger;t.name="combinations",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(118)),s=n(4),u=o("factorial",{number:function(e){if(e<0)throw new Error("Value must be non-negative");return a(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return a(e.plus(1))},"Array | Matrix":function(e){return i(e,u)}});return u.toTex={1:"\\left(${args[0]}\\right)"+s.operators.factorial},u}var i=n(1);t.name="factorial",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(10)),s=e.SparseMatrix,u=function(e,t,n){var r=e._values,u=e._index,c=e._ptr,l=e._size,f=e._datatype,h=t._values,p=t._index,m=t._ptr,d=t._size,v=t._datatype;if(l.length!==d.length)throw new i(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var g,y=l[0],w=l[1],x=a,b=0,C=n;"string"==typeof f&&f===v&&(g=f,x=o.find(a,[g,g]),b=o.convert(0,g),C=o.find(n,[g,g]));var M,T,N,E,A=r&&h?[]:void 0,S=[],P=[],O=new s({values:A,index:S,ptr:P,size:[y,w],datatype:g}),_=A?[]:void 0,I=A?[]:void 0,B=[],k=[];for(T=0;T<w;T++){P[T]=S.length;var V=T+1;for(N=c[T],E=c[T+1];N<E;N++)M=u[N],S.push(M),B[M]=V,_&&(_[M]=r[N]);for(N=m[T],E=m[T+1];N<E;N++)M=p[N],B[M]!==V&&S.push(M),k[M]=V,I&&(I[M]=h[N]);if(A)for(N=P[T];N<S.length;){M=S[N];var z=B[M],F=k[M];if(z===V||F===V){var D=z===V?_[M]:b,R=F===V?I[M]:b,U=C(D,R);x(U,b)?S.splice(N,1):(A.push(U),N++)}}}return P[w]=S.length,O};return u}var i=n(9);t.name="algorithm05",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(10)),u=e.SparseMatrix,c=function(e,t,n){var r=e._values,c=e._size,l=e._datatype,f=t._values,h=t._size,p=t._datatype;if(c.length!==h.length)throw new o(c.length,h.length);if(c[0]!==h[0]||c[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+h+")");var m,d=c[0],v=c[1],g=s,y=0,w=n;"string"==typeof l&&l===p&&(m=l,g=a.find(s,[m,m]),y=a.convert(0,m),w=a.find(n,[m,m]));for(var x=r&&f?[]:void 0,b=[],C=[],M=new u({values:x,index:b,ptr:C,size:[d,v],datatype:m}),T=x?[]:void 0,N=[],E=[],A=0;A<v;A++){C[A]=b.length;var S=A+1;if(i(e,A,N,T,E,S,M,w),i(t,A,N,T,E,S,M,w),T)for(var P=C[A];P<b.length;){var O=b[P];if(E[O]===S){var _=T[O];g(_,y)?b.splice(P,1):(x.push(_),P++)}else b.splice(P,1)}else for(var I=C[A];I<b.length;){var B=b[I];E[B]!==S?b.splice(I,1):I++}}return C[v]=b.length,M};return c}var i=n(510),o=n(9);t.name="algorithm06",t.factory=r},function(e,t,n){"use strict";var r=n(42);e.exports=function(e){for(var t=0;t<e.length;t++)if(r(e[t]))return!0;return!1}},function(e,t,n){"use strict";function r(e,t,n){var o,a,s,u;if(t<=0){if(Array.isArray(e[0])){for(u=i(e),a=[],o=0;o<u.length;o++)a[o]=r(u[o],t-1,n);return a}for(s=e[0],o=1;o<e.length;o++)s=n(s,e[o]);return s}for(a=[],o=0;o<e.length;o++)a[o]=r(e[o],t-1,n);return a}function i(e){var t,n,r=e.length,i=e[0].length,o=[];for(n=0;n<i;n++){var a=[];for(t=0;t<r;t++)a.push(e[t][n]);o.push(a)}return o}var o=n(3).size,a=n(44);e.exports=function(e,t,n){var i=Array.isArray(e)?o(e):e.size();if(t<0||t>=i.length)throw new a(t,i.length);return e&&e.isMatrix===!0?e.create(r(e.valueOf(),t,n)):r(e,t,n)}},function(e,t,n){"use strict";t.type=function(e){var t=typeof e;return"object"===t?null===e?"null":e instanceof Boolean?"boolean":e instanceof Number?"number":e instanceof String?"string":Array.isArray(e)?"Array":e instanceof Date?"Date":e instanceof RegExp?"RegExp":"Object":"function"===t?"Function":t},t.isScalar=function(e){return!(e&&e.isMatrix||Array.isArray(e))}},function(e,t,n){"use strict";e.exports={end:!0}},function(e,t,n){"use strict";function r(e,t,r,a){function s(e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=e||[],!Array.isArray(this.items)||!this.items.every(function(e){return e&&e.isNode}))throw new TypeError("Array containing Nodes expected");var t=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:t,set:t})}function u(e,t,n){if(!(e instanceof s))throw new TypeError("No valid ArrayNode");var r="Array"!==t.math.config().matrix,a=i(e.items,function(e){return l(e,t,n)});return(r?"math.matrix([":"[")+o(a,",")+(r?"])":"]")}var c=r(n(7)).register,l=r(n(7)).compile,f=r(n(13));return s.prototype=new f,s.prototype.type="ArrayNode",s.prototype.isArrayNode=!0,c(s.prototype.type,u),s.prototype.forEach=function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];e(n,"items["+t+"]",this)}},s.prototype.map=function(e){for(var t=[],n=0;n<this.items.length;n++)t[n]=this._ifNode(e(this.items[n],"items["+n+"]",this));return new s(t)},s.prototype.clone=function(){return new s(this.items.slice(0))},s.prototype._toString=function(e){var t=this.items.map(function(t){return t.toString(e)});return"["+t.join(", ")+"]"},s.prototype._toTex=function(e){var t="\\begin{bmatrix}";return this.items.forEach(function(n){t+=n.items?n.items.map(function(t){return t.toTex(e)}).join("&"):n.toTex(e),t+="\\\\"}),t+="\\end{bmatrix}"},s}var i=n(3).map,o=n(3).join;t.name="ArrayNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e,t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=e,this.dotNotation=t||!1,!p(e)||!e.every(function(e){return e&&e.isNode}))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var n=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:n,set:n})}function u(e,t,n){if(!(e instanceof s))throw new TypeError("No valid IndexNode");var r=Object.create(n);t.range=function(e,t,n){return new h(e&&e.isBigNumber===!0?e.toNumber():e,t&&t.isBigNumber===!0?t.toNumber():t,n&&n.isBigNumber===!0?n.toNumber():n)};var a=i(e.dimensions,function(e,n){return e&&e.isRangeNode?e.needsEnd()?(r.end="end","(function () {var end = size["+n+"]; return range("+l(e.start,t,r)+", "+l(e.end,t,r)+", "+(e.step?l(e.step,t,r):"1")+"); })()"):"range("+l(e.start,t,r)+", "+l(e.end,t,r)+", "+(e.step?l(e.step,t,r):"1")+")":e.isSymbolNode&&"end"===e.name?(r.end="end","(function () {var end = size["+n+"]; return "+l(e,t,r)+"; })()"):l(e,t,r)});return"math.index("+o(a,", ")+")"}var c=r(n(7)).register,l=r(n(7)).compile,f=r(n(13)),h=(r(n(67)),r(n(27)),r(n(134))),p=Array.isArray;return s.prototype=new f,s.prototype.type="IndexNode",s.prototype.isIndexNode=!0,c(s.prototype.type,u),s.prototype.forEach=function(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)},s.prototype.map=function(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this._ifNode(e(this.dimensions[n],"dimensions["+n+"]",this));return new s(t)},s.prototype.clone=function(){return new s(this.dimensions.slice(0))},s.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&this.dimensions[0].isConstantNode&&"string"===this.dimensions[0].valueType},s.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},s.prototype._toString=function(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},s.prototype._toTex=function(e){var t=this.dimensions.map(function(t){return t.toTex(e)});return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"},s.prototype.needsSize=function(){return this.dimensions.some(function(e){return e.isRangeNode&&e.needsEnd()||e.isSymbolNode&&"end"===e.name})},s}var i=n(3).map,o=n(3).join;t.name="IndexNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t,n){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!e||!e.isNode)throw new TypeError("Node expected");if(!t||!t.isNode)throw new TypeError("Node expected");if(n&&(!n||!n.isNode))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=n||null}function s(e,t,n){if(!(e instanceof a))throw new TypeError("No valid RangeNode");return"math.range("+l(e.start,t,n)+", "+l(e.end,t,n)+(e.step?", "+l(e.step,t,n):"")+")"}function u(e,t){var n=i.getPrecedence(e,t),r={},o=i.getPrecedence(e.start,t);if(r.start=null!==o&&o<=n||"all"===t,e.step){var a=i.getPrecedence(e.step,t);r.step=null!==a&&a<=n||"all"===t}var s=i.getPrecedence(e.end,t);return r.end=null!==s&&s<=n||"all"===t,r}var c=r(n(7)).register,l=r(n(7)).compile,f=r(n(13));return a.prototype=new f,a.prototype.type="RangeNode",a.prototype.isRangeNode=!0,a.prototype.needsEnd=function(){var e=this.filter(function(e){return e&&e.isSymbolNode&&"end"==e.name});return e.length>0},c(a.prototype.type,s),a.prototype.forEach=function(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)},a.prototype.map=function(e){return new a(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))},a.prototype.clone=function(){return new a(this.start,this.end,this.step&&this.step)},a.prototype._toString=function(e){var t,n=e&&e.parenthesis?e.parenthesis:"keep",r=u(this,n),i=this.start.toString(e);if(r.start&&(i="("+i+")"),t=i,this.step){var o=this.step.toString(e);r.step&&(o="("+o+")"),t+=":"+o}var a=this.end.toString(e);return r.end&&(a="("+a+")"),t+=":"+a},a.prototype._toTex=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=u(this,t),r=this.start.toTex(e);if(n.start&&(r="\\left("+r+"\\right)"),this.step){var i=this.step.toTex(e);n.step&&(i="\\left("+i+"\\right)"),r+=":"+i}var o=this.end.toTex(e);return n.end&&(o="\\left("+o+"\\right)"),r+=":"+o},a}var i=n(47);t.name="RangeNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e){var t=e.DenseMatrix,n=function(e,n,r){var i=e.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+o.format(i)+")");var u=i[0],c=i[1];if(u!==c)throw new RangeError("Matrix must be square (size: "+o.format(i)+")");var l,f,h;if(n&&n.isMatrix===!0){var p=n.size();if(1===p.length){if(p[0]!==u)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(l=[],h=n._data,f=0;f<u;f++)l[f]=[h[f]];return new t({data:l,size:[u,1],datatype:n._datatype})}if(2===p.length){if(p[0]!==u||1!==p[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(n.isDenseMatrix===!0){if(r){for(l=[],h=n._data,f=0;f<u;f++)l[f]=[h[f][0]];return new t({data:l,size:[u,1],datatype:n._datatype})}return n}for(l=[],f=0;f<u;f++)l[f]=[0];for(var m=n._values,d=n._index,v=n._ptr,g=v[1],y=v[0];y<g;y++)f=d[y],l[f][0]=m[y];return new t({data:l,size:[u,1],datatype:n._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");
}if(s(n)){var w=a.size(n);if(1===w.length){if(w[0]!==u)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(l=[],f=0;f<u;f++)l[f]=[n[f]];return new t({data:l,size:[u,1]})}if(2===w.length){if(w[0]!==u||1!==w[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(l=[],f=0;f<u;f++)l[f]=[n[f][0]];return new t({data:l,size:[u,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}};return n}var i=n(25),o=i.string,a=i.array,s=Array.isArray;t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e){return-e-2};return e}t.name="cs_flip",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t){return-c(e,t)}function s(e,t,n){if(!i(t)||t<0)throw new Error("k must be a non-negative integer");if(e&&e.isMatrix){var r=e.size();if(r.length>1)throw new Error("Only one dimensional matrices supported");return u(e.valueOf(),t,n)}if(Array.isArray(e))return u(e,t,n)}function u(e,t,n){if(t>=e.length)throw new Error("k out of bounds");for(var r=0,i=e.length-1;r<i;){for(var o=r,a=i,s=e[Math.floor(Math.random()*(i-r+1))+r];o<a;)if(n(e[o],s)>=0){var u=e[a];e[a]=e[o],e[o]=u,--a}else++o;n(e[o],s)>0&&--o,t<=o?i=o:r=o+1}return e[t]}var c=r(n(49));return o("partitionSelect",{"Array | Matrix, number":function(e,t){return s(e,t,c)},"Array | Matrix, number, string":function(e,t,n){if("asc"===n)return s(e,t,c);if("desc"===n)return s(e,t,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s})}var i=n(2).isInteger;t.name="partitionSelect",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s,u){function c(e){if(!p.hasOwnProperty(e))throw new Error("Unknown distribution "+e);var t=Array.prototype.slice.call(arguments,1),n=p[e].apply(this,t);return function(e){var t={random:function(e,t,n){var s,u,f;if(arguments.length>3)throw new i("random",arguments.length,0,3);if(1===arguments.length?o(e)?s=e:f=e:2===arguments.length?o(e)?(s=e,f=t):(u=e,f=t):(s=e,u=t,f=n),void 0!==u&&!a(u)||void 0!==f&&!a(f))throw new TypeError("Invalid argument in function random");if(void 0===f&&(f=1),void 0===u&&(u=0),void 0!==s){var h=c(s.valueOf(),u,f,r);return s&&s.isMatrix===!0?l(h):h}return r(u,f)},randomInt:s({"number | Array":function(e){var t=0;if(o(e)){var n=e,r=1,i=c(n.valueOf(),t,r,u);return n&&n.isMatrix===!0?l(i):i}var r=e;return u(t,r)},"number | Array, number":function(e,t){if(o(e)){var n=e,r=t,i=0,a=c(n.valueOf(),i,r,u);return n&&n.isMatrix===!0?l(a):a}var i=e,r=t;return u(i,r)},"Array, number, number":function(e,t,n){var r=c(e.valueOf(),t,n,u);return e&&e.isMatrix===!0?l(r):r}}),pickRandom:s({Array:function(e){return n(e)},"Array, number | Array":function(e,t){var r,i;if(Array.isArray(t))i=t;else{if(!a(t))throw new TypeError("Invalid argument in function pickRandom");r=t}return n(e,r,i)},"Array, number | Array, Array | number":function(e,t,r){var i,o;if(Array.isArray(t)?(o=t,i=r):(o=r,i=t),!Array.isArray(o)||!a(i))throw new TypeError("Invalid argument in function pickRandom");return n(e,i,o)}})},n=function(e,t,n){var r="undefined"==typeof t;if(r&&(t=1),e&&e.isMatrix===!0)e=e.valueOf();else if(!Array.isArray(e))throw new TypeError("Unsupported type of value in function pickRandom");if(f.size(e).length>1)throw new Error("Only one dimensional vectors supported");if("undefined"!=typeof n){if(n.length!=e.length)throw new Error("Weights must have the same length as possibles");for(var i=0,o=0,s=n.length;o<s;o++){if(!a(n[o])||n[o]<0)throw new Error("Weights must be an array of positive numbers");i+=n[o]}}var u=e.length;if(0==u)return[];if(t>=u)return e;for(var c,l=[];l.length<t;){if("undefined"==typeof n)c=e[Math.floor(h()*u)];else for(var p=h()*i,o=0,s=e.length;o<s;o++)if(p-=n[o],p<0){c=e[o];break}l.indexOf(c)==-1&&l.push(c)}return r?l[0]:l},r=function(t,n){return t+e()*(n-t)},u=function(t,n){return Math.floor(t+e()*(n-t))},c=function(e,t,n,r){var i,o,a=[];if(e=e.slice(0),e.length>1)for(var o=0,i=e.shift();o<i;o++)a.push(c(e,t,n,r));else for(var o=0,i=e.shift();o<i;o++)a.push(r(t,n));return a};return t}(n)}var l=r(n(0)),f=n(3),h=r(n(430)),p={uniform:function(){return h},normal:function(){return function(){for(var e,t,n=-1;n<0||n>1;)e=h(),t=h(),n=1/6*Math.pow(-2*Math.log(e),.5)*Math.cos(2*Math.PI*t)+.5;return n}}};return c.toTex=void 0,c}var i=n(43),o=n(42),a=n(2).isNumber;t.name="distribution",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(10)),s=r(n(14)),u=r(n(24)),c=r(n(16)),l=r(n(8)),f=r(n(6)),h=n(4),p=i("equal",{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:a(e,t)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=u(e,t,a);break;default:n=s(t,e,a,!0)}break;default:switch(t.storage()){case"sparse":n=s(e,t,a,!1);break;default:n=l(e,t,a)}}return n},"Array, Array":function(e,t){return p(o(e),o(t)).valueOf()},"Array, Matrix":function(e,t){return p(o(e),t)},"Matrix, Array":function(e,t){return p(e,o(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=c(e,t,a,!1);break;default:n=f(e,t,a,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=c(t,e,a,!0);break;default:n=f(t,e,a,!0)}return n},"Array, any":function(e,t){return f(o(e),t,a,!1).valueOf()},"any, Array":function(e,t){return f(o(t),e,a,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+h.operators.equal+"${args[1]}\\right)"},p}t.name="equal",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string":function(){return!1},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);n(2),t.name="isNumeric",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isZero",{number:function(e){return 0===e},BigNumber:function(e){return e.isZero()},Complex:function(e){return 0===e.re&&0===e.im},Fraction:function(e){return 1===e.d&&0===e.n},Unit:function(e){return o(e.value)},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);n(2),t.name="isZero",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.type="Matrix",i.prototype.isMatrix=!0,i.storage=function(e){if(!a(e))throw new TypeError("format must be a string value");var t=i._storage[e];if(!t)throw new SyntaxError("Unsupported matrix storage format: "+e);return t},i._storage={},i.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},i.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},i.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},i.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},i.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},i.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},i.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},i.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},i.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},i.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},i.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},i.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},i.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},i.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},i.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},i.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},i}var i=n(25),o=i.string,a=o.isString;t.name="Matrix",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(10)),s=e.SparseMatrix,u=function(e,t,n){var r=e._values,u=e._index,c=e._ptr,l=e._size,f=e._datatype,h=t._values,p=t._index,m=t._ptr,d=t._size,v=t._datatype;if(l.length!==d.length)throw new i(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var g,y=l[0],w=l[1],x=a,b=0,C=n;"string"==typeof f&&f===v&&(g=f,x=o.find(a,[g,g]),b=o.convert(0,g),C=o.find(n,[g,g]));var M,T,N,E,A,S=r&&h?[]:void 0,P=[],O=[],_=new s({values:S,index:P,ptr:O,size:[y,w],datatype:g}),I=r&&h?[]:void 0,B=r&&h?[]:void 0,k=[],V=[];for(T=0;T<w;T++){O[T]=P.length;var z=T+1;for(E=c[T],A=c[T+1],N=E;N<A;N++)M=u[N],P.push(M),k[M]=z,I&&(I[M]=r[N]);for(E=m[T],A=m[T+1],N=E;N<A;N++)if(M=p[N],k[M]===z){if(I){var F=C(I[M],h[N]);x(F,b)?k[M]=null:I[M]=F}}else P.push(M),V[M]=z,B&&(B[M]=h[N]);if(I&&B)for(N=O[T];N<P.length;)M=P[N],k[M]===z?(S[N]=I[M],N++):V[M]===z?(S[N]=B[M],N++):P.splice(N,1)}return O[w]=P.length,_};return u}var i=n(9);t.name="algorithm04",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(10)),s=e.SparseMatrix,u=function(e,t,n){var r=e._values,u=e._index,c=e._ptr,l=e._size,f=e._datatype,h=t._values,p=t._index,m=t._ptr,d=t._size,v=t._datatype;if(l.length!==d.length)throw new i(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!r||!h)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var g,y=l[0],w=l[1],x=a,b=0,C=n;"string"==typeof f&&f===v&&(g=f,x=o.find(a,[g,g]),b=o.convert(0,g),C=o.find(n,[g,g]));for(var M,T,N,E,A=[],S=[],P=[],O=new s({values:A,index:S,ptr:P,size:[y,w],datatype:g}),_=[],I=[],B=0;B<w;B++){P[B]=S.length;var k=B+1;for(T=c[B],N=c[B+1],M=T;M<N;M++)E=u[M],I[E]=k,_[E]=r[M],S.push(E);for(T=m[B],N=m[B+1],M=T;M<N;M++)E=p[M],I[E]===k&&(_[E]=C(_[E],h[M]));for(M=P[B];M<S.length;){E=S[M];var V=_[E];x(V,b)?S.splice(M,1):(A.push(V),M++)}}return P[w]=S.length,O};return u}var i=n(9);t.name="algorithm08",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("number",{"":function(){return 0},number:function(e){return e},string:function(e){var t=Number(e);if(isNaN(t))throw new SyntaxError('String "'+e+'" is no valid number');return t},BigNumber:function(e){return e.toNumber()},Fraction:function(e){return e.valueOf()},Unit:function(e){throw new Error("Second argument with valueless unit expected")},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var i=n(1);t.name="number",t.factory=r},function(e,t){e.exports=function(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,n=t.precision;t.config({precision:1e9});var e=e.plus(new t(1));return e.s=-e.s||null,t.config({precision:n}),e}},function(e,t,n){function r(e){for(var t=e.d,n=t[0]+"",r=1;r<t.length;++r){for(var i=t[r]+"",o=7-i.length;o--;)i="0"+i;n+=i}var a;for(a=n.length-1;"0"==n.charAt(a);--a);var s=e.e,u=n.slice(0,a+1||1),c=u.length;if(s>0)if(++s>c)for(s-=c;s--;u+="0");else s<c&&(u=u.slice(0,s)+"."+u.slice(s));for(var l=[0],r=0;r<u.length;){for(var f=l.length;f--;l[f]*=10);l[0]+=u.charAt(r++)<<0;for(var a=0;a<l.length;++a)l[a]>1&&(null==l[a+1]&&(l[a+1]=0),l[a+1]+=l[a]>>1,l[a]&=1)}return l.reverse()}var i=n(79);e.exports=function(e,t,n){var o,a,s=e.constructor,u=+(e.s<0),c=+(t.s<0);if(u){o=r(i(e));for(var l=0;l<o.length;++l)o[l]^=1}else o=r(e);if(c){a=r(i(t));for(var l=0;l<a.length;++l)a[l]^=1}else a=r(t);var f,h,p;o.length<=a.length?(f=o,h=a,p=u):(f=a,h=o,p=c);var m=f.length,d=h.length,v=1^n(u,c),g=new s(1^v),y=new s(1),w=new s(2),x=s.precision;for(s.config({precision:1e9});m>0;)n(f[--m],h[--d])==v&&(g=g.plus(y)),y=y.times(w);for(;d>0;)n(p,h[--d])==v&&(g=g.plus(y)),y=y.times(w);return s.config({precision:x}),0==v&&(g.s=-g.s),g}},function(e,t,n){"use strict";function r(e,t,r,a,s){function u(){if(!(this instanceof u))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}var c=r(n(30));return u.prototype.type="Parser",u.prototype.isParser=!0,u.prototype.parse=function(e){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},u.prototype.compile=function(e){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},u.prototype.eval=function(e){return c(e).compile().eval(this.scope)},u.prototype.get=function(e){return e in this.scope?o.getSafeProperty(this.scope,e):void 0},u.prototype.getAll=function(){return i({},this.scope)},u.prototype.set=function(e,t){return o.setSafeProperty(this.scope,e,t)},u.prototype.remove=function(e){delete this.scope[e]},u.prototype.clear=function(){for(var e in this.scope)this.scope.hasOwnProperty(e)&&delete this.scope[e]},u}var i=n(5).extend,o=n(17);t.name="Parser",t.path="expression",t.factory=r,t.math=!0},function(e,t){e.exports={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]}},function(e,t){e.exports={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]}},function(e,t,n){function r(e,t,r,i){var o={};return o.bignumber=n(164),o.boolean=n(165),o.complex=n(166),o.createUnit=n(167),o.fraction=n(168),o.index=n(169),o.matrix=n(170),o.number=n(171),o.sparse=n(172),o.splitUnit=n(173),o.string=n(174),o.unit=n(175),o.e=n(82),o.E=n(82),o.false=n(157),o.i=n(158),o.Infinity=n(149),o.LN2=n(151),o.LN10=n(150),o.LOG2E=n(153),o.LOG10E=n(152),o.NaN=n(154),o.null=n(159),o.pi=n(83),o.PI=n(83),o.phi=n(160),o.SQRT1_2=n(155),o.SQRT2=n(156),o.tau=n(161),o.true=n(162),o.version=n(163),o.speedOfLight={description:"Speed of light in vacuum",examples:["speedOfLight"]},o.gravitationConstant={description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},o.planckConstant={description:"Planck constant",examples:["planckConstant"]},o.reducedPlanckConstant={description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},o.magneticConstant={description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},o.electricConstant={description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},o.vacuumImpedance={description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},o.coulomb={description:"Coulomb's constant",examples:["coulomb"]},o.elementaryCharge={description:"Elementary charge",examples:["elementaryCharge"]},o.bohrMagneton={description:"Borh magneton",examples:["bohrMagneton"]},o.conductanceQuantum={description:"Conductance quantum",examples:["conductanceQuantum"]},o.inverseConductanceQuantum={description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},o.magneticFluxQuantum={description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},o.nuclearMagneton={description:"Nuclear magneton",examples:["nuclearMagneton"]},o.klitzing={description:"Von Klitzing constant",examples:["klitzing"]},o.bohrRadius={description:"Borh radius",examples:["bohrRadius"]},o.classicalElectronRadius={description:"Classical electron radius",examples:["classicalElectronRadius"]},o.electronMass={description:"Electron mass",examples:["electronMass"]},o.fermiCoupling={description:"Fermi coupling constant",examples:["fermiCoupling"]},o.fineStructure={description:"Fine-structure constant",examples:["fineStructure"]},o.hartreeEnergy={description:"Hartree energy",examples:["hartreeEnergy"]},o.protonMass={description:"Proton mass",examples:["protonMass"]},o.deuteronMass={description:"Deuteron Mass",examples:["deuteronMass"]},o.neutronMass={description:"Neutron mass",examples:["neutronMass"]},o.quantumOfCirculation={description:"Quantum of circulation",examples:["quantumOfCirculation"]},o.rydberg={description:"Rydberg constant",examples:["rydberg"]},o.thomsonCrossSection={description:"Thomson cross section",examples:["thomsonCrossSection"]},o.weakMixingAngle={description:"Weak mixing angle",examples:["weakMixingAngle"]},o.efimovFactor={description:"Efimov factor",examples:["efimovFactor"]},o.atomicMass={description:"Atomic mass constant",examples:["atomicMass"]},o.avogadro={description:"Avogadro's number",examples:["avogadro"]},o.boltzmann={description:"Boltzmann constant",examples:["boltzmann"]},o.faraday={description:"Faraday constant",examples:["faraday"]},o.firstRadiation={description:"First radiation constant",examples:["firstRadiation"]},o.loschmidt={description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},o.gasConstant={description:"Gas constant",examples:["gasConstant"]},o.molarPlanckConstant={description:"Molar Planck constant",examples:["molarPlanckConstant"]},o.molarVolume={description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},o.sackurTetrode={description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},o.secondRadiation={description:"Second radiation constant",examples:["secondRadiation"]},o.stefanBoltzmann={description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},o.wienDisplacement={description:"Wien displacement law constant",examples:["wienDisplacement"]},o.molarMass={description:"Molar mass constant",examples:["molarMass"]},o.molarMassC12={description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},o.gravity={description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},o.planckLength={description:"Planck length",examples:["planckLength"]},o.planckMass={description:"Planck mass",examples:["planckMass"]},o.planckTime={description:"Planck time",examples:["planckTime"]},o.planckCharge={description:"Planck charge",examples:["planckCharge"]},o.planckTemperature={description:"Planck temperature",examples:["planckTemperature"]},o.derivative=n(179),o.lsolve=n(180),o.lup=n(181),o.lusolve=n(182),o.simplify=n(184),o.slu=n(185),o.usolve=n(186),o.qr=n(183),o.abs=n(187),o.add=n(188),o.cbrt=n(189),o.ceil=n(190),o.cube=n(191),o.divide=n(192),o.dotDivide=n(193),o.dotMultiply=n(194),o.dotPow=n(195),o.exp=n(196),o.fix=n(197),o.floor=n(198),o.gcd=n(199),o.hypot=n(200),o.lcm=n(201),o.log=n(202),o.log10=n(203),o.mod=n(204),o.multiply=n(205),o.norm=n(206),o.nthRoot=n(207),o.pow=n(208),o.round=n(209),o.sign=n(210),o.sqrt=n(211),o.square=n(212),o.subtract=n(213),o.unaryMinus=n(214),o.unaryPlus=n(215),o.xgcd=n(216),o.bitAnd=n(217),o.bitNot=n(218),o.bitOr=n(219),o.bitXor=n(220),o.leftShift=n(221),o.rightArithShift=n(222),o.rightLogShift=n(223),o.bellNumbers=n(224),o.catalan=n(225),o.composition=n(226),o.stirlingS2=n(227),o.config=n(176),o.import=n(177),o.typed=n(178),o.arg=n(228),o.conj=n(229),o.re=n(231),o.im=n(230),o.eval=n(232),o.help=n(233),o.distance=n(234),o.intersect=n(235),o.and=n(236),o.not=n(237),o.or=n(238),o.xor=n(239),o.concat=n(240),o.cross=n(241),o.det=n(242),o.diag=n(243),o.dot=n(244),o.eye=n(245),o.filter=n(246),o.flatten=n(247),o.forEach=n(248),o.inv=n(249),o.kron=n(250),o.map=n(251),o.ones=n(252),o.partitionSelect=n(253),o.range=n(254),o.resize=n(256),o.reshape=n(255),o.size=n(257),o.sort=n(258),o.squeeze=n(259),o.subset=n(260),o.trace=n(261),o.transpose=n(262),o.zeros=n(263),o.combinations=n(264),o.factorial=n(265),o.gamma=n(266),o.kldivergence=n(267),o.multinomial=n(268),o.permutations=n(269),o.pickRandom=n(270),o.random=n(271),o.randomInt=n(272),o.compare=n(273),o.deepEqual=n(274),o.equal=n(275),o.larger=n(276),o.largerEq=n(277),o.smaller=n(278),o.smallerEq=n(279),o.unequal=n(280),o.erf=n(281),o.mad=n(282),o.max=n(283),o.mean=n(284),o.median=n(285),o.min=n(286),o.mode=n(287),o.prod=n(288),o.quantileSeq=n(289),o.std=n(290),o.sum=n(291),o.var=n(292),o.acos=n(293),o.acosh=n(294),o.acot=n(295),o.acoth=n(296),o.acsc=n(297),o.acsch=n(298),o.asec=n(299),o.asech=n(300),o.asin=n(301),o.asinh=n(302),o.atan=n(303),o.atanh=n(305),o.atan2=n(304),o.cos=n(306),o.cosh=n(307),o.cot=n(308),o.coth=n(309),o.csc=n(310),o.csch=n(311),o.sec=n(312),o.sech=n(313),o.sin=n(314),o.sinh=n(315),o.tan=n(316),o.tanh=n(317),o.to=n(318),o.clone=n(319),o.format=n(320),o.isNaN=n(322),o.isInteger=n(321),o.isNegative=n(323),o.isNumeric=n(324),o.isPositive=n(325),o.isPrime=n(326),o.isZero=n(327),o.typeof=n(328),o}t.name="docs",t.path="expression",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i,o){var a=r(n(81));return i("parser",{"":function(){return new a(o)}})}t.name="parser",t.factory=r,t.math=!0},function(e,t,n){"use strict";function r(e,t,r,a){function s(e,t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!e||!e.isNode)throw new TypeError('Node expected for parameter "object"');if(!t||!t.isIndexNode)throw new TypeError('IndexNode expected for parameter "index"');this.object=e||null,this.index=t,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function u(e,t,n){if(!(e instanceof s))throw new TypeError("No valid AccessorNode");t.access=p,t.getSafeProperty=o;var r=f(e.object,t,n),a=f(e.index,t,n);if(e.index.isObjectProperty()){var u=i(e.index.getObjectProperty());return"getSafeProperty("+r+", "+u+")"}return e.index.needsSize()?"(function () {  var object = "+r+";  var size = math.size(object).valueOf();  return access(object, "+a+");})()":"access("+r+", "+a+")"}function c(e){return!(e.isAccessorNode||e.isArrayNode||e.isConstantNode||e.isFunctionNode||e.isObjectNode||e.isParenthesisNode||e.isSymbolNode)}var l=r(n(7)).register,f=r(n(7)).compile,h=r(n(13)),p=(r(n(66)),r(n(92)));return s.prototype=new h,s.prototype.type="AccessorNode",s.prototype.isAccessorNode=!0,l(s.prototype.type,u),s.prototype.forEach=function(e){e(this.object,"object",this),e(this.index,"index",this)},s.prototype.map=function(e){return new s(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))},s.prototype.clone=function(){return new s(this.object,this.index)},s.prototype._toString=function(e){var t=this.object.toString(e);return c(this.object)&&(t="("+t+")"),t+this.index.toString(e)},s.prototype._toTex=function(e){var t=this.object.toTex(e);return c(this.object)&&(t="\\left("+t+"\\right)"),t+this.index.toTex(e)},s}var i=n(11).stringify,o=n(17).getSafeProperty;t.name="AccessorNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){function u(e,t,n){if(!(this instanceof u))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=e,this.index=n?t:null,this.value=n?n:t,!e||!e.isSymbolNode&&!e.isAccessorNode)throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(e&&e.isSymbolNode&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!this.index.isIndexNode)throw new TypeError('IndexNode expected as "index"');if(!this.value||!this.value.isNode)throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function c(e,t,n){if(!(e instanceof u))throw new TypeError("No valid AssignmentNode");t.assign=m,t.access=d,t.getSafeProperty=o,t.setSafeProperty=a;var r,s=h(e.object,t,n),c=e.index?h(e.index,t,n):null,l=h(e.value,t,n),f=i(e.object.name);if(e.index){if(e.index.isObjectProperty()){var p=i(e.index.getObjectProperty());return"setSafeProperty("+s+", "+p+", "+l+")"}if(e.object.isSymbolNode)return r=e.index.needsSize()?"var size = math.size(object).valueOf();":"","(function () {  var object = "+s+";  var value = "+l+";  "+r+"  setSafeProperty(scope, "+f+", assign(object, "+c+", value));  return value;})()";r=e.index.needsSize()?"var size = math.size(object).valueOf();":"";var v=h(e.object.object,t,n);if(e.object.index.isObjectProperty()){var g=i(e.object.index.getObjectProperty());return"(function () {  var parent = "+v+";  var object = getSafeProperty(parent, "+g+");  var value = "+l+";"+r+"  setSafeProperty(parent, "+g+", assign(object, "+c+", value));  return value;})()"}var y=e.object.index.needsSize()?"var size = math.size(parent).valueOf();":"",w=h(e.object.index,t,n);return"(function () {  var parent = "+v+";  "+y+"  var parentIndex = "+w+";  var object = access(parent, parentIndex);  var value = "+l+";  "+r+"  assign(parent, parentIndex, assign(object, "+c+", value));  return value;})()"}if(!e.object.isSymbolNode)throw new TypeError("SymbolNode expected as object");return"setSafeProperty(scope, "+f+", "+l+")"}function l(e,t){t||(t="keep");var n=v.getPrecedence(e,t),r=v.getPrecedence(e.value,t);return"all"===t||null!==r&&r<=n}var f=r(n(7)).register,h=r(n(7)).compile,p=r(n(13)),m=(r(n(65)),r(n(0)),r(n(337))),d=r(n(92)),v=(n(64),n(47));return u.prototype=new p,u.prototype.type="AssignmentNode",u.prototype.isAssignmentNode=!0,f(u.prototype.type,c),u.prototype.forEach=function(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)},u.prototype.map=function(e){var t=this._ifNode(e(this.object,"object",this)),n=this.index?this._ifNode(e(this.index,"index",this)):null,r=this._ifNode(e(this.value,"value",this));return new u(t,n,r)},u.prototype.clone=function(){return new u(this.object,this.index,this.value)},u.prototype._toString=function(e){var t=this.object.toString(e),n=this.index?this.index.toString(e):"",r=this.value.toString(e);return l(this,e&&e.parenthesis)&&(r="("+r+")"),t+n+" = "+r},u.prototype._toTex=function(e){var t=this.object.toTex(e),n=this.index?this.index.toTex(e):"",r=this.value.toTex(e);return l(this,e&&e.parenthesis)&&(r="\\left("+r+"\\right)"),t+n+":="+r},u}var i=(n(4),n(11).stringify),o=n(17).getSafeProperty,a=n(17).setSafeProperty;t.name="AssignmentNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map(function(e){var t=e&&e.node,n=!e||void 0===e.visible||e.visible;if(!t||!t.isNode)throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:n}})}function u(e,t,n){if(!(e instanceof s))throw new TypeError("No valid BlockNode");t.ResultSet=h;var r=i(e.blocks,function(e){var r=l(e.node,t,n);return e.visible?"results.push("+r+");":r+";"});return"(function () {var results = [];"+o(r,"")+"return new ResultSet(results);})()"}var c=r(n(7)).register,l=r(n(7)).compile,f=r(n(13)),h=r(n(136));return s.prototype=new f,s.prototype.type="BlockNode",s.prototype.isBlockNode=!0,c(s.prototype.type,u),s.prototype.forEach=function(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)},s.prototype.map=function(e){for(var t=[],n=0;n<this.blocks.length;n++){var r=this.blocks[n],i=this._ifNode(e(r.node,"blocks["+n+"].node",this));t[n]={node:i,visible:r.visible}}return new s(t)},s.prototype.clone=function(){var e=this.blocks.map(function(e){return{node:e.node,visible:e.visible}});return new s(e)},s.prototype._toString=function(e){return this.blocks.map(function(t){return t.node.toString(e)+(t.visible?"":";")}).join("\n")},s.prototype._toTex=function(e){return this.blocks.map(function(t){return t.node.toTex(e)+(t.visible?"":";")}).join("\\;\\;\n")},s}var i=n(3).map,o=n(3).join;t.name="BlockNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t,n){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!e||!e.isNode)throw new TypeError("Parameter condition must be a Node");if(!t||!t.isNode)throw new TypeError("Parameter trueExpr must be a Node");if(!n||!n.isNode)throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=n}function s(e,t,n){if(!(e instanceof a))throw new TypeError("No valid ConditionalNode");return t.testCondition=function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(e.isBigNumber===!0)return!e.isZero();if(e.isComplex===!0)return!(!e.re&&!e.im);if(e.isUnit===!0)return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+t.math.typeof(e)+'"')},"testCondition("+c(e.condition,t,n)+") ? ( "+c(e.trueExpr,t,n)+") : ( "+c(e.falseExpr,t,n)+")"}var u=r(n(7)).register,c=r(n(7)).compile,l=r(n(13));return a.prototype=new l,a.prototype.type="ConditionalNode",a.prototype.isConditionalNode=!0,u(a.prototype.type,s),a.prototype.forEach=function(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)},a.prototype.map=function(e){return new a(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))},a.prototype.clone=function(){return new a(this.condition,this.trueExpr,this.falseExpr)},a.prototype._toString=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=i.getPrecedence(this,t),r=this.condition.toString(e),o=i.getPrecedence(this.condition,t);("all"===t||"OperatorNode"===this.condition.type||null!==o&&o<=n)&&(r="("+r+")");var a=this.trueExpr.toString(e),s=i.getPrecedence(this.trueExpr,t);("all"===t||"OperatorNode"===this.trueExpr.type||null!==s&&s<=n)&&(a="("+a+")");var u=this.falseExpr.toString(e),c=i.getPrecedence(this.falseExpr,t);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==c&&c<=n)&&(u="("+u+")"),r+" ? "+a+" : "+u},a.prototype._toTex=function(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},a}var i=(n(4),n(47));t.name="ConditionalNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,h){function p(e,t,n){if(!(this instanceof p))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!n||!n.isNode)throw new TypeError('Node expected for parameter "expr"');if(e in i)throw new Error('Illegal function name, "'+e+'" is a reserved keyword');this.name=e,this.params=t.map(function(e){return e&&e.name||e}),this.types=t.map(function(e){return e&&e.type||"any"}),this.expr=n}function m(e,t,n){if(!(e instanceof p))throw new TypeError("No valid FunctionAssignmentNode");t.typed=h,t.setSafeProperty=l;var r=Object.create(n),i=a(e.params,function(e){return r[e]=f(r),r[e]}),u=g(e.expr,t,r),c=o(e.name);return"setSafeProperty(scope, "+c+",   (function () {    var fn = typed("+c+", {      "+o(s(e.types,","))+": function ("+s(i,",")+") {        return "+u+"      }    });    fn.syntax = "+o(e.name+"("+s(e.params,", ")+")")+";    return fn;  })())"}function d(e,t){var n=c.getPrecedence(e,t),r=c.getPrecedence(e.expr,t);return"all"===t||null!==r&&r<=n}var v=r(n(7)).register,g=r(n(7)).compile,y=r(n(13));return p.prototype=new y,p.prototype.type="FunctionAssignmentNode",
p.prototype.isFunctionAssignmentNode=!0,v(p.prototype.type,m),p.prototype.forEach=function(e){e(this.expr,"expr",this)},p.prototype.map=function(e){var t=this._ifNode(e(this.expr,"expr",this));return new p(this.name,this.params.slice(0),t)},p.prototype.clone=function(){return new p(this.name,this.params.slice(0),this.expr)},p.prototype._toString=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toString(e);return d(this,t)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n},p.prototype._toTex=function(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toTex(e);return d(this,t)&&(n="\\left("+n+"\\right)"),"\\mathrm{"+this.name+"}\\left("+this.params.map(u.toSymbol).join(",")+"\\right):="+n},p}var i=n(64),o=n(11).stringify,a=n(3).map,s=n(3).join,u=n(4),c=n(47),l=n(17).setSafeProperty,f=n(93);t.name="FunctionAssignmentNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){function u(e){if(!(this instanceof u))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=e||{},e&&("object"!=typeof e||Object.keys(e).some(function(t){return!e[t]||!e[t].isNode})))throw new TypeError("Object containing Nodes expected")}function c(e,t,n){if(!(e instanceof u))throw new TypeError("No valid ObjectNode");var r=[];for(var s in e.properties)if(a(e.properties,s)){if(!o(s))throw new Error('No access to property "'+s+'"');r.push(i(s)+": "+f(e.properties[s],t,n))}return"{"+r.join(", ")+"}"}var l=r(n(7)).register,f=r(n(7)).compile,h=r(n(13));return u.prototype=new h,u.prototype.type="ObjectNode",u.prototype.isObjectNode=!0,l(u.prototype.type,c),u.prototype.forEach=function(e){for(var t in this.properties)this.properties.hasOwnProperty(t)&&e(this.properties[t],"properties["+i(t)+"]",this)},u.prototype.map=function(e){var t={};for(var n in this.properties)this.properties.hasOwnProperty(n)&&(t[n]=this._ifNode(e(this.properties[n],"properties["+i(n)+"]",this)));return new u(t)},u.prototype.clone=function(){var e={};for(var t in this.properties)this.properties.hasOwnProperty(t)&&(e[t]=this.properties[t]);return new u(e)},u.prototype._toString=function(e){var t=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&t.push(i(n)+": "+this.properties[n].toString(e));return"{"+t.join(", ")+"}"},u.prototype._toTex=function(e){var t=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&t.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"},u}var i=n(11).stringify,o=n(17).isSafeProperty,a=n(5).hasOwnProperty;t.name="ObjectNode",t.path="expression.node",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(55));return function(e,t){try{if(Array.isArray(e))return s(e,t);if(e&&"function"==typeof e.subset)return e.subset(t);if("string"==typeof e)return s(e,t);if("object"==typeof e){if(!t.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return o(e,t.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw i(e)}}}var i=n(31).transform,o=n(17).getSafeProperty;t.factory=r},function(e,t){function n(e){return"arg"+Object.keys(e).length}e.exports=n},function(e,t,n){"use strict";function r(e,t,r,i){var a=r(n(0)),s=r(n(26)),u=r(n(20)),c=r(n(19)),l=r(n(22)),f=r(n(21)),h=r(n(28)),p=r(n(10)),m=r(n(32)),d=e.SparseMatrix,v=e.DenseMatrix,g=e.Spa,y=i("lup",{DenseMatrix:function(e){return w(e)},SparseMatrix:function(e){return x(e)},Array:function(e){var t=a(e),n=w(t);return{L:n.L.valueOf(),U:n.U.valueOf(),p:n.p}}}),w=function(e){var t,n,r,i=e._size[0],a=e._size[1],m=Math.min(i,a),d=o.clone(e._data),g=[],y=[i,m],w=[],x=[m,a],b=[];for(t=0;t<i;t++)b[t]=t;for(n=0;n<a;n++){if(n>0)for(t=0;t<i;t++){var C=Math.min(t,n),M=0;for(r=0;r<C;r++)M=u(M,l(d[t][r],d[r][n]));d[t][n]=f(d[t][n],M)}var T=n,N=0,E=0;for(t=n;t<i;t++){var A=d[t][n],S=s(A);h(S,N)&&(T=t,N=S,E=A)}if(n!==T&&(b[n]=[b[T],b[T]=b[n]][0],v._swapRows(n,T,d)),n<i)for(t=n+1;t<i;t++){var P=d[t][n];p(P,0)||(d[t][n]=c(d[t][n],E))}}for(n=0;n<a;n++)for(t=0;t<i;t++)0===n&&(t<a&&(w[t]=[]),g[t]=[]),t<n?(t<a&&(w[t][n]=d[t][n]),n<i&&(g[t][n]=0)):t!==n?(t<a&&(w[t][n]=0),n<i&&(g[t][n]=d[t][n])):(t<a&&(w[t][n]=d[t][n]),n<i&&(g[t][n]=1));var O=new v({data:g,size:y}),_=new v({data:w,size:x}),I=[];for(t=0,m=b.length;t<m;t++)I[b[t]]=t;return{L:O,U:_,p:I,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}},x=function(e){var t,n,r,i=e._size[0],o=e._size[1],a=Math.min(i,o),u=e._values,f=e._index,v=e._ptr,y=[],w=[],x=[],b=[i,a],C=[],M=[],T=[],N=[a,o],E=[],A=[];for(t=0;t<i;t++)E[t]=t,A[t]=t;var S=function(e,t){var n=A[e],r=A[t];E[n]=t,E[r]=e,A[e]=r,A[t]=n};for(n=0;n<o;n++){var P=new g;n<i&&(x.push(y.length),y.push(1),w.push(n)),T.push(C.length);var O=v[n],_=v[n+1];for(r=O;r<_;r++)t=f[r],P.set(E[t],u[r]);n>0&&P.forEach(0,n-1,function(e,t){d._forEachRow(e,y,w,x,function(n,r){n>e&&P.accumulate(n,m(l(r,t)))})});var I=n,B=P.get(n),k=s(B);P.forEach(n+1,i-1,function(e,t){var n=s(t);h(n,k)&&(I=e,k=n,B=t)}),n!==I&&(d._swapRows(n,I,b[1],y,w,x),d._swapRows(n,I,N[1],C,M,T),P.swap(n,I),S(n,I)),P.forEach(0,i-1,function(e,t){e<=n?(C.push(t),M.push(e)):(t=c(t,B),p(t,0)||(y.push(t),w.push(e)))})}return T.push(C.length),x.push(y.length),{L:new d({values:y,index:w,ptr:x,size:b}),U:new d({values:C,index:M,ptr:T,size:N}),p:E,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}};return y}var i=n(25),o=i.object;t.name="lup",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(366)),s=r(n(361)),u=i("slu",{"SparseMatrix, number, number":function(e,t,n){if(!a(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(n<0||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=o(t,e,!1),i=s(e,r,n);return{L:i.L,U:i.U,p:i.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}});return u}var i=n(25),o=i.number,a=o.isInteger;t.name="slu",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i,o){function a(e){return e.transform(function(e,t,n){return e.isParenthesisNode?e.content:e})}function s(e){for(var t=[],n=0;n<e.length;n++){var r,i=e[n],o=typeof i;switch(o){case"string":var s=i.split("->");if(2!==s.length)throw SyntaxError("Could not parse rule: "+i);i={l:s[0],r:s[1]};case"object":if(r={l:a(d(i.l)),r:a(d(i.r))},i.context&&(r.evaluate=i.context),i.evaluate&&(r.evaluate=d(i.evaluate)),r.l.isOperatorNode&&T(r.l)){var c=S(r.l),l=u();r.expanded={},r.expanded.l=c([r.l.clone(),l]),N(r.expanded.l),E(r.expanded.l),r.expanded.r=c([r.r,l])}break;case"function":r=i;break;default:throw TypeError("Unsupported type of rule: "+o)}t.push(r)}return t}function u(){return new x("_p"+_++)}function c(e,t){var n,r,i=[],o=S(e);if(M(e,t))for(var a=0;a<e.args.length;a++)r=e.args.slice(0),r.splice(a,1),n=1===r.length?r[0]:o(r),i.push(o([e.args[a],n]));else r=e.args.slice(1),n=1===r.length?r[0]:o(r),i.push(o([e.args[0],n]));return i}function l(e,t){var n={placeholders:{}};if(!e.placeholders&&!t.placeholders)return n;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var r in e.placeholders)if(n.placeholders[r]=e.placeholders[r],t.placeholders.hasOwnProperty(r)&&!m(e.placeholders[r],t.placeholders[r]))return null;for(var r in t.placeholders)n.placeholders[r]=t.placeholders[r];return n}function f(e,t){var n=[];if(0===e.length||0===t.length)return n;for(var r,i=0;i<e.length;i++)for(var o=0;o<t.length;o++)r=l(e[i],t[o]),r&&n.push(r);return n}function h(e){if(0===e.length)return e;for(var t=e.reduce(f),n=[],r={},i=0;i<t.length;i++){var o=JSON.stringify(t[i]);r[o]||(r[o]=!0,n.push(t[i]))}return n}function p(e,t,n){var r=[{placeholders:{}}];if(e instanceof y&&t instanceof y||e instanceof g&&t instanceof g){if(e instanceof y){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof g&&e.name!==t.name)return[];if((1!==t.args.length||1!==e.args.length)&&T(t)&&!n){if(t.args.length>=2&&2===e.args.length){for(var i=c(t,e.context),a=[],s=0;s<i.length;s++){var u=p(e,i[s],!0);a=a.concat(u)}return a}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var l=[],s=0;s<e.args.length;s++){var f=p(e.args[s],t.args[s]);if(0===f.length)return[];l.push(f)}r=h(l)}else if(e instanceof x){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if(o.hasOwnProperty(e.name)){if(!O[e.name])throw new Error("Built in constant: "+e.name+" is not supported by simplify.");if(e.name!==t.name)return[]}else if("n"==e.name[0]||"_p"==e.name.substring(0,2))r[0].placeholders[e.name]=t;else if("v"==e.name[0]){if(t.isConstantNode)return[];r[0].placeholders[e.name]=t}else{if("c"!=e.name[0])throw new Error("Invalid symbol in rule: "+e.name);if(!(t instanceof v))return[];r[0].placeholders[e.name]=t}}else{if(!(e instanceof v))return[];if(e.value!==t.value)return[]}return r}function m(e,t){if(e instanceof v&&t instanceof v){if(e.value!==t.value)return!1}else if(e instanceof x&&t instanceof x){if(e.name!==t.name)return!1}else{if(!(e instanceof y&&t instanceof y||e instanceof g&&t instanceof g))return!1;if(e instanceof y){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof g&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var n=0;n<e.args.length;n++)if(!m(e.args[n],t.args[n]))return!1}return!0}var d=r(n(30)),v=r(n(45)),g=r(n(46)),y=r(n(52)),w=r(n(53)),x=r(n(27)),b=(r(n(13)),r(n(352))),C=r(n(97)),M=C.isCommutative,T=C.isAssociative,N=C.flatten,E=C.unflattenr,A=C.unflattenl,S=C.createMakeNodeFunction,P=i("simplify",{string:function(e){return P(d(e),P.rules)},"string, Array":function(e,t){return P(d(e),t)},Node:function(e){return P(e,P.rules)},"Node, Array":function(e,t){t=s(t);for(var n=a(e),r={},i=n.toString({parenthesis:"all"});!r[i];){r[i]=!0,_=0;for(var o=0;o<t.length;o++)"function"==typeof t[o]?n=t[o](n):(N(n),n=I(n,t[o])),A(n);i=n.toString({parenthesis:"all"})}return n}}),O={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};P.rules=[{l:"n+0",r:"n"},{l:"n^0",r:"1"},{l:"0*n",r:"0"},{l:"n/n",r:"1"},{l:"n^1",r:"n"},{l:"+n1",r:"n1"},{l:"n--n1",r:"n+n1"},{l:"log(e)",r:"1"},{l:"n-n1",r:"n+-n1"},{l:"-(c*v)",r:"(-c) * v"},{l:"-v",r:"(-1) * v"},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{l:"n*n",r:"n^2"},{l:"n * n^n1",r:"n^(n1+1)"},{l:"n^n1 * n^n2",r:"n^(n1+n2)"},{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},{l:"n1*n2 + n2",r:"(n1+1)*n2"},{l:"n1*n3 + n2*n3",r:"(n1+n2)*n3"},b,{l:"(-n)*n1",r:"-(n*n1)"},{l:"c+v",r:"v+c",context:{add:{commutative:!1}}},{l:"v*c",r:"c*v",context:{multiply:{commutative:!1}}},{l:"(-1) * n",r:"-n"},{l:"n+-n1",r:"n-n1"},{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"n-(n1+n2)",r:"n-n1-n2"},{l:"1*n",r:"n"}];var _=0,I=i("applyRule",{"Node, Object":function(e,t){var n=e;if(n instanceof y||n instanceof g){if(n.args)for(var r=0;r<n.args.length;r++)n.args[r]=I(n.args[r],t)}else n instanceof w&&n.content&&(n.content=I(n.content,t));var i=t.r,o=p(t.l,n)[0];return!o&&t.expanded&&(i=t.expanded.r,o=p(t.expanded.l,n)[0]),o&&(n=i.clone(),n=n.transform(function(e,t,n){if(e.isSymbolNode&&o.placeholders.hasOwnProperty(e.name)){var r=o.placeholders[e.name].clone();return r}return e})),n}});return P}t.math=!0,t.name="simplify",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r,i){function o(e,t){if(!e.args||e.args.length<=1)return!0;var n=e.fn.toString();return t&&t.hasOwnProperty(n)&&t[n].hasOwnProperty("commutative")?t[n].commutative:d[n]||!1}function a(e,t){if(!e.args||e.args.length<=1)return!0;var n=e.fn.toString();return t&&t.hasOwnProperty(n)&&t[n].hasOwnProperty("associative")?t[n].associative:v[n]||!1}function s(e){if(!e.args||0===e.args.length)return e;e.args=u(e);for(var t=0;t<e.args.length;t++)s(e.args[t])}function u(e){var t,n=[],r=function(e){for(var i=0;i<e.args.length;i++){var o=e.args[i];o.isOperatorNode&&t===o.op?r(o):n.push(o)}};return e.isOperatorNode&&a(e)?(t=e.op,r(e),n):e.args}function c(e){if(e.args&&0!==e.args.length){for(var t=f(e),n=e.args.length,r=0;r<n;r++)c(e.args[r]);if(n>2&&a(e)){for(var i=e.args.pop();e.args.length>0;)i=t([e.args.pop(),i]);e.args=i.args}}}function l(e){if(e.args&&0!==e.args.length){for(var t=f(e),n=e.args.length,r=0;r<n;r++)l(e.args[r]);if(n>2&&a(e)){for(var i=e.args.shift();e.args.length>0;)i=t([i,e.args.shift()]);e.args=i.args}}}function f(e){return e.isOperatorNode?function(t){try{return new p(e.op,e.fn,t)}catch(e){return console.error(e),[]}}:function(t){return new h(new m(e.name),t)}}var h=i.expression.node.FunctionNode,p=i.expression.node.OperatorNode,m=i.expression.node.SymbolNode,d={add:!0,multiply:!0},v={add:!0,multiply:!0};return{createMakeNodeFunction:f,isCommutative:o,isAssociative:a,flatten:s,allChildren:u,unflattenr:c,unflattenl:l}}t.factory=r,t.math=!0},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(19)),s=r(n(22)),u=r(n(21)),c=r(n(10)),l=r(n(68)),f=e.DenseMatrix,h=i("lsolve",{"SparseMatrix, Array | Matrix":function(e,t){return m(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return p(e,t)},"Array, Array | Matrix":function(e,t){var n=o(e),r=p(n,t);return r.valueOf()}}),p=function(e,t){t=l(e,t,!0);for(var n=t._data,r=e._size[0],i=e._size[1],o=[],h=e._data,p=0;p<i;p++){var m,d=n[p][0]||0;if(c(d,0))m=0;else{var v=h[p][p];if(c(v,0))throw new Error("Linear system cannot be solved since matrix is singular");m=a(d,v);for(var g=p+1;g<r;g++)n[g]=[u(n[g][0]||0,s(m,h[g][p]))]}o[p]=[m]}return new f({data:o,size:[r,1]})},m=function(e,t){t=l(e,t,!0);for(var n,r,i=t._data,o=e._size[0],h=e._size[1],p=e._values,m=e._index,d=e._ptr,v=[],g=0;g<h;g++){var y=i[g][0]||0;if(c(y,0))v[g]=[0];else{var w=0,x=[],b=[],C=d[g+1];for(r=d[g];r<C;r++)n=m[r],n===g?w=p[r]:n>g&&(x.push(p[r]),b.push(n));if(c(w,0))throw new Error("Linear system cannot be solved since matrix is singular");var M=a(y,w);for(r=0,C=b.length;r<C;r++)n=b[r],i[n]=[u(i[n][0]||0,s(M,x[r]))];v[g]=[M]}}return new f({data:v,size:[o,1]})};return h}t.name="lsolve",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(19)),s=r(n(22)),u=r(n(21)),c=r(n(10)),l=r(n(68)),f=e.DenseMatrix,h=i("usolve",{"SparseMatrix, Array | Matrix":function(e,t){return m(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return p(e,t)},"Array, Array | Matrix":function(e,t){var n=o(e),r=p(n,t);return r.valueOf()}}),p=function(e,t){t=l(e,t,!0);for(var n=t._data,r=e._size[0],i=e._size[1],o=[],h=e._data,p=i-1;p>=0;p--){var m,d=n[p][0]||0;if(c(d,0))m=0;else{var v=h[p][p];if(c(v,0))throw new Error("Linear system cannot be solved since matrix is singular");m=a(d,v);for(var g=p-1;g>=0;g--)n[g]=[u(n[g][0]||0,s(m,h[g][p]))]}o[p]=[m]}return new f({data:o,size:[r,1]})},m=function(e,t){t=l(e,t,!0);for(var n,r,i=t._data,o=e._size[0],h=e._size[1],p=e._values,m=e._index,d=e._ptr,v=[],g=h-1;g>=0;g--){var y=i[g][0]||0;if(c(y,0))v[g]=[0];else{var w=0,x=[],b=[],C=d[g],M=d[g+1];for(r=M-1;r>=C;r--)n=m[r],n===g?w=p[r]:n<g&&(x.push(p[r]),b.push(n));if(c(w,0))throw new Error("Linear system cannot be solved since matrix is singular");var T=a(y,w);for(r=0,M=b.length;r<M;r++)n=b[r],i[n]=[u(i[n][0],s(T,x[r]))];v[g]=[T]}}return new f({data:v,size:[o,1]})};return h}t.name="usolve",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(69)),o=function(e,t){e[t]=i(e[t])};return o}t.name="cs_mark",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t){return e[t]<0};return e}t.name="cs_marked",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t,n,r,i,o,a){var s=0;for(n[a]=e;s>=0;){var u=n[a+s],c=n[r+u];c==-1?(s--,o[t++]=u):(n[r+u]=n[i+c],++s,n[a+s]=c)}return t};return e}t.name="cs_tdfs",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(19)),s=n(4),u=r(n(23)),c=r(n(14)),l=r(n(24)),f=r(n(15)),h=r(n(16)),p=r(n(8)),m=r(n(6)),d=i("dotDivide",{"any, any":a,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,a,!1);break;default:n=u(t,e,a,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,a,!1);break;default:n=p(e,t,a)}}return n},"Array, Array":function(e,t){return d(o(e),o(t)).valueOf()},"Array, Matrix":function(e,t){return d(o(e),t)},"Matrix, Array":function(e,t){return d(e,o(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,a,!1);break;default:n=m(e,t,a,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=h(t,e,a,!0);break;default:n=m(t,e,a,!0)}return n},"Array, any":function(e,t){return m(o(e),t,a,!1).valueOf()},"any, Array":function(e,t){return m(o(t),e,a,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+s.operators.dotDivide+"${args[1]}\\right)"},d}t.name="dotDivide",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("fix",{number:function(e){return e>0?Math.floor(e):Math.ceil(e)},Complex:function(t){return new e.Complex(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im))},BigNumber:function(e){return e.isNegative()?e.ceil():e.floor()},Fraction:function(e){return e.s<0?e.ceil():e.floor()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="fix",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(19)),s=o("log",{number:function(n){return n>=0||t.predictable?Math.log(n):new e.Complex(n,0).log()},Complex:function(e){return e.log()},BigNumber:function(n){return!n.isNegative()||t.predictable?n.ln():new e.Complex(n.toNumber(),0).log()},"Array | Matrix":function(e){return i(e,s)},"any, any":function(e,t){return a(s(e),s(t))}});return s.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},s}var i=n(1);t.name="log",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("sign",{number:i.sign,Complex:function(e){return e.sign()},BigNumber:function(t){return new e.BigNumber(t.cmp(0))},Fraction:function(t){return new e.Fraction(t.s,1)},"Array | Matrix":function(e){return o(e,a,!0)},Unit:function(e){return a(e.value)}});return a.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},a}var i=n(2),o=n(1);t.name="sign",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(18)),a=r(n(21)),s=r(n(12)),u=r(n(38)),c=r(n(39)),l=r(n(58)),f=r(n(57)),h=r(n(50)),p=r(n(41)),m=r(n(28)),d=i("stirlingS2",{"number | BigNumber, number | BigNumber":function(e,t){if(!p(e)||h(e)||!p(t)||h(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(m(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var n=l(t),r=0,i=0;i<=t;i++){var d=c(-1,a(t,i)),v=f(t,i),g=c(i,e);r=o(r,s(s(v,g),d))}return u(r,n)}});return d.toTex={2:"\\mathrm{S}\\left(${args}\\right)"},d}t.name="stirlingS2",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("conj",{number:function(e){return e},BigNumber:function(e){return e},Complex:function(e){return e.conjugate()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\left(${args[0]}\\right)^*"},o}var i=n(1);t.name="conj",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=o("not",{number:function(e){return!e},Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},Unit:function(e){return s(e.value)},"Array | Matrix":function(e){return i(e,s)}});return s.toTex={1:a.operators.not+"\\left(${args[0]}\\right)"},s}var i=n(1);t.name="not",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,l){var f=r(n(0)),h=l("concat",{"...Array | Matrix | number | BigNumber":function(e){var t,n,r=e.length,l=-1,h=!1,p=[];for(t=0;t<r;t++){var m=e[t];if(m&&m.isMatrix===!0&&(h=!0),"number"==typeof m||m&&m.isBigNumber===!0){if(t!==r-1)throw new Error("Dimension must be specified as last argument");if(n=l,l=m.valueOf(),!a(l))throw new TypeError("Integer number expected for dimension");if(l<0||t>0&&l>n)throw new u(l,n+1)}else{var d=o(m).valueOf(),v=s.size(d);if(p[t]=d,n=l,l=v.length-1,t>0&&l!=n)throw new c(n+1,l+1)}}if(0==p.length)throw new SyntaxError("At least one matrix expected");for(var g=p.shift();p.length;)g=i(g,p.shift(),l,0);return h?f(g):g},"...string":function(e){return e.join("")}});return h.toTex=void 0,h}function i(e,t,n,r){if(r<n){if(e.length!=t.length)throw new c(e.length,t.length);for(var o=[],a=0;a<e.length;a++)o[a]=i(e[a],t[a],n,r+1);return o}return e.concat(t)}var o=n(5).clone,a=n(2).isInteger,s=n(3),u=n(44),c=n(9);t.name="concat",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function s(e,t,n){if(1==t)return o.clone(e[0][0]);if(2==t)return l(f(e[0][0],e[1][1]),f(e[1][0],e[0][1]));for(var r=function(e){var t,n,r=new Array(e.length),i=0;for(t=1;t<e.length;t++)i=c(i,e[t][t]);for(t=0;t<e.length;t++){for(r[t]=new Array(e.length),r[t][t]=h(i),n=0;n<t;n++)r[t][n]=0;for(n=t+1;n<e.length;n++)r[t][n]=e[t][n];t+1<e.length&&(i=l(i,e[t+1][t+1]))}return r},i=e,a=0;a<t-1;a++)i=f(r(i),e);return t%2==0?h(i[0][0]):i[0][0]}var u=r(n(0)),c=r(n(18)),l=r(n(21)),f=r(n(12)),h=r(n(32)),p=i("det",{any:function(e){return o.clone(e)},"Array | Matrix":function(e){var t;switch(e&&e.isMatrix===!0?t=e.size():Array.isArray(e)?(e=u(e),t=e.size()):t=[],t.length){case 0:return o.clone(e);case 1:if(1==t[0])return o.clone(e.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+a.format(t)+")");case 2:var n=t[0],r=t[1];if(n==r)return s(e.clone().valueOf(),n,r);throw new RangeError("Matrix must be square (size: "+a.format(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+a.format(t)+")")}}});return p.toTex={1:"\\det\\left(${args[0]}\\right)"},p}var i=n(25),o=i.object,a=i.string;t.name="det",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=a("filter",{"Array, function":i,"Array, RegExp":o,"Matrix, function":function(e,t){return s(i(e.toArray(),t))},"Matrix, RegExp":function(e,t){return s(o(e.toArray(),t))}});return u.toTex=void 0,u}function i(e,t){if(1!==a(e).length)throw new Error("Only one dimensional matrices supported");var n=s(t);return e.filter(function(e,r,i){return 1===n?t(e):2===n?t(e,[r]):t(e,[r],i)})}function o(e,t){if(1!==a(e).length)throw new Error("Only one dimensional matrices supported");return e.filter(function(e){return t.test(e)})}var a=n(3).size,s=n(37).maxArgumentCount;t.name="filter",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("forEach",{"Array, function":i,"Matrix, function":function(e,t){return e.forEach(t)}});return o.toTex=void 0,o}function i(e,t){var n=o(t),r=function(i,o){Array.isArray(i)?i.forEach(function(e,t){r(e,o.concat(t))}):1===n?t(i):2===n?t(i,o):t(i,o,e)};r(e,[])}var o=n(37).maxArgumentCount;t.name="forEach",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t,n){var r,i,o,a,s;if(1==t){if(a=e[0][0],0==a)throw Error("Cannot calculate inverse, determinant is zero");return[[u(1,a)]]}if(2==t){var m=h(e);if(0==m)throw Error("Cannot calculate inverse, determinant is zero");return[[u(e[1][1],m),u(f(e[0][1]),m)],[u(f(e[1][0]),m),u(e[0][0],m)]]}var d=e.concat();for(r=0;r<t;r++)d[r]=d[r].concat();for(var v=p(t).valueOf(),g=0;g<n;g++){for(r=g;r<t&&0==d[r][g];)r++;if(r==t||0==d[r][g])throw Error("Cannot calculate inverse, determinant is zero");r!=g&&(s=d[g],d[g]=d[r],d[r]=s,s=v[g],v[g]=v[r],v[r]=s);var y=d[g],w=v[g];for(r=0;r<t;r++){var x=d[r],b=v[r];if(r!=g){if(0!=x[g]){for(o=u(f(x[g]),y[g]),i=g;i<n;i++)x[i]=c(x[i],l(o,y[i]));for(i=0;i<n;i++)b[i]=c(b[i],l(o,w[i]))}}else{for(o=y[g],i=g;i<n;i++)x[i]=u(x[i],o);for(i=0;i<n;i++)b[i]=u(b[i],o)}}}return v}var s=r(n(0)),u=r(n(19)),c=r(n(20)),l=r(n(12)),f=r(n(32)),h=r(n(111)),p=r(n(54)),m=o("inv",{"Array | Matrix":function(e){var t=e.isMatrix===!0?e.size():i.array.size(e);switch(t.length){case 1:if(1==t[0])return e.isMatrix===!0?s([u(1,e.valueOf()[0])]):[u(1,e[0])];throw new RangeError("Matrix must be square (size: "+i.string.format(t)+")");case 2:var n=t[0],r=t[1];if(n==r)return e.isMatrix===!0?s(a(e.valueOf(),n,r),e.storage()):a(e,n,r);throw new RangeError("Matrix must be square (size: "+i.string.format(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+i.string.format(t)+")")}},any:function(e){return u(1,e)}});return m.toTex={1:"\\left(${args[0]}\\right)^{-1}"},m}var i=n(25);t.name="inv",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("map",{"Array, function":i,"Matrix, function":function(e,t){return e.map(t)}});return o.toTex=void 0,o}function i(e,t){var n=o(t),r=function(i,o){return Array.isArray(i)?i.map(function(e,t){return r(e,o.concat(t))}):1===n?t(i):2===n?t(i,o):t(i,o,e)};return r(e,[])}var o=n(37).maxArgumentCount;t.name="map",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e){return"Array"===t.matrix?e:h(e)}function a(n,r){var i=f(n);if(!i)throw new SyntaxError('String "'+n+'" is no valid range');var a;return"BigNumber"===t.number?(a=r?l:c,o(a(new e.BigNumber(i.start),new e.BigNumber(i.end),new e.BigNumber(i.step)))):(a=r?u:s,o(a(i.start,i.end,i.step)))}function s(e,t,n){var r=[],i=e;if(n>0)for(;i<t;)r.push(i),i+=n;else if(n<0)for(;i>t;)r.push(i),i+=n;return r}function u(e,t,n){var r=[],i=e;if(n>0)for(;i<=t;)r.push(i),i+=n;else if(n<0)for(;i>=t;)r.push(i),i+=n;return r}function c(e,t,n){var r=[],i=e;if(n.gt(p))for(;i.lt(t);)r.push(i),i=i.plus(n);else if(n.lt(p))for(;i.gt(t);)r.push(i),i=i.plus(n);return r}function l(e,t,n){var r=[],i=e;if(n.gt(p))for(;i.lte(t);)r.push(i),i=i.plus(n);else if(n.lt(p))for(;i.gte(t);)r.push(i),i=i.plus(n);return r}function f(e){var t=e.split(":"),n=t.map(function(e){return Number(e)}),r=n.some(function(e){return isNaN(e)});if(r)return null;switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}var h=r(n(0)),p=new e.BigNumber(0),m=new e.BigNumber(1),d=i("range",{string:a,"string, boolean":a,"number, number":function(e,t){return o(s(e,t,1))},"number, number, number":function(e,t,n){return o(s(e,t,n))},"number, number, boolean":function(e,t,n){return o(n?u(e,t,1):s(e,t,1))},"number, number, number, boolean":function(e,t,n,r){return o(r?u(e,t,n):s(e,t,n))},"BigNumber, BigNumber":function(e,t){return o(c(e,t,m))},"BigNumber, BigNumber, BigNumber":function(e,t,n){return o(c(e,t,n))},"BigNumber, BigNumber, boolean":function(e,t,n){return o(n?l(e,t,m):c(e,t,m))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,n,r){return o(r?l(e,t,n):c(e,t,n))}});return d.toTex=void 0,d}t.name="range",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(18)),c=a("trace",{Array:function(e){return c(s(e))},Matrix:function(e){var t;switch(e.storage()){case"dense":t=l(e);break;case"sparse":t=f(e)}return t},any:i}),l=function(e){var t=e._size,n=e._data;switch(t.length){case 1:if(1==t[0])return i(n[0]);throw new RangeError("Matrix must be square (size: "+o(t)+")");case 2:var r=t[0],a=t[1];if(r===a){for(var s=0,c=0;c<r;c++)s=u(s,n[c][c]);return s}throw new RangeError("Matrix must be square (size: "+o(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+o(t)+")")}},f=function(e){var t=e._values,n=e._index,r=e._ptr,i=e._size,a=i[0],s=i[1];if(a===s){var c=0;if(t.length>0)for(var l=0;l<s;l++)for(var f=r[l],h=r[l+1],p=f;p<h;p++){var m=n[p];if(m===l){c=u(c,t[p]);break}if(m>l)break}return c}throw new RangeError("Matrix must be square (size: "+o(i)+")")};return c.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"},c}var i=n(5).clone,o=n(11).format;t.name="trace",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,u){function c(n){if(n.isZero())return new e.BigNumber(1);for(var r=t.precision+(0|Math.log(n.toNumber())),i=e.BigNumber.clone({precision:r}),o=new i(n),a=n.toNumber()-1;a>1;)o=o.times(a),a--;return new e.BigNumber(o.toPrecision(e.BigNumber.precision))}var l=r(n(12)),f=r(n(39)),h=u("gamma",{number:function(e){var t,n;if(o(e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(var r=e-2,i=e-1;r>1;)i*=r,r--;return 0==i&&(i=1),i}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*h(1-e));if(e>=171.35)return 1/0;if(e>85){var u=e*e,c=u*e,l=c*e,f=l*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*u)-139/(51840*c)-571/(2488320*l)+163879/(209018880*f)+5246819/(75246796800*f*e))}--e,n=s[0];for(var p=1;p<s.length;++p)n+=s[p]/(e+p);return t=e+a+.5,Math.sqrt(2*Math.PI)*Math.pow(t,e+.5)*Math.exp(-t)*n},Complex:function(t){var n,r;if(0==t.im)return h(t.re);t=new e.Complex(t.re-1,t.im),r=new e.Complex(s[0],0);for(var i=1;i<s.length;++i){var o=t.re+i,u=o*o+t.im*t.im;0!=u?(r.re+=s[i]*o/u,r.im+=-(s[i]*t.im)/u):r.re=s[i]<0?-(1/0):1/0}n=new e.Complex(t.re+a+.5,t.im);var c=Math.sqrt(2*Math.PI);t.re+=.5;var p=f(n,t);0==p.im?p.re*=c:0==p.re?p.im*=c:(p.re*=c,p.im*=c);var m=Math.exp(-n.re);return n.re=m*Math.cos(-n.im),n.im=m*Math.sin(-n.im),l(l(p,n),r)},BigNumber:function(t){if(t.isInteger())return t.isNegative()||t.isZero()?new e.BigNumber(1/0):c(t.minus(1));if(!t.isFinite())return new e.BigNumber(t.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(e){return i(e,h)}});return h.toTex={1:"\\Gamma\\left(${args[0]}\\right)"},h}var i=n(1),o=n(2).isInteger,a=4.7421875,s=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];t.name="gamma",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(24)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=n(4),m=a("largerEq",{"boolean, boolean":function(e,t){return e>=t},"number, number":function(e,n){return e>=n||i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.gte(n)||o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return e.compare(t)!==-1},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return m(e.value,t.value)},"string, string":function(e,t){return e>=t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,m);break;default:n=u(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,m,!1);break;default:n=f(e,t,m)}}return n},"Array, Array":function(e,t){return m(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return m(s(e),t)},"Matrix, Array":function(e,t){return m(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=h(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,m,!0);break;default:n=h(t,e,m,!0)}return n},"Array, any":function(e,t){return h(s(e),t,m,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+p.operators.largerEq+"${args[1]}\\right)"},m}var i=n(2).nearlyEqual,o=n(35);t.name="largerEq",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(24)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=n(4),m=a("unequal",{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:d(e,t)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,d);break;default:n=u(t,e,d,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,d,!1);break;default:n=f(e,t,d)}}return n},"Array, Array":function(e,t){
return m(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return m(s(e),t)},"Matrix, Array":function(e,t){return m(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,d,!1);break;default:n=h(e,t,d,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,d,!0);break;default:n=h(t,e,d,!0)}return n},"Array, any":function(e,t){return h(s(e),t,d,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,d,!0).valueOf()}}),d=a("_unequal",{"boolean, boolean":function(e,t){return e!==t},"number, number":function(e,n){return!i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return!o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return!e.equals(t)},"Complex, Complex":function(e,t){return!e.equals(t)},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return m(e.value,t.value)},"string, string":function(e,t){return e!==t}});return m.toTex={2:"\\left(${args[0]}"+p.operators.unequal+"${args[1]}\\right)"},m}var i=n(2).nearlyEqual,o=n(35);t.name="unequal",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){function u(e,t){return l(e,t)?e:t}function c(e){var t=void 0;if(i(e,function(e){(void 0===t||l(e,t))&&(t=e)}),void 0===t)throw new Error("Cannot calculate max of an empty array");return t}var l=r(n(28)),f=s("max",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":function(e,t){return o(e,t.valueOf(),u)},"...":function(e){if(a(e))throw new TypeError("Scalar values expected in function max");return c(e)}});return f.toTex="\\max\\left(${args}\\right)",f}var i=n(36),o=n(62),a=n(61);t.name="max",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,u){function c(e,t){var n=a(e,t,f),r=Array.isArray(e)?i(e):e.size();return h(n,r[t])}function l(e){var t=0,n=0;if(o(e,function(e){t=f(t,e),n++}),0===n)throw new Error("Cannot calculate mean of an empty array");return h(t,n)}var f=r(n(18)),h=r(n(38)),p=u("mean",{"Array | Matrix":l,"Array | Matrix, number | BigNumber":c,"...":function(e){if(s(e))throw new TypeError("Scalar values expected in function mean");return l(e)}});return p.toTex=void 0,p}var i=n(3).size,o=n(36),a=n(62),s=n(61);t.name="mean",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e){e=i(e.valueOf());var t=e.length;if(0==t)throw new Error("Cannot calculate median of an empty array");if(t%2==0){for(var n=t/2-1,r=f(e,n+1),o=e[n],a=0;a<n;++a)l(e[a],o)>0&&(o=e[a]);return m(o,r)}var s=f(e,(t-1)/2);return p(s)}var u=r(n(20)),c=r(n(19)),l=r(n(49)),f=r(n(70)),h=a("median",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(o(e))throw new TypeError("Scalar values expected in function median");return s(e)}}),p=a({"number | BigNumber | Unit":function(e){return e}}),m=a({"number | BigNumber | Unit, number | BigNumber | Unit":function(e,t){return c(u(e,t),2)}});return h.toTex=void 0,h}var i=n(3).flatten,o=(n(62),n(61));t.name="median",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){function u(e,t){return l(e,t)?e:t}function c(e){var t=void 0;if(i(e,function(e){(void 0===t||l(e,t))&&(t=e)}),void 0===t)throw new Error("Cannot calculate min of an empty array");return t}var l=r(n(40)),f=s("min",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":function(e,t){return o(e,t.valueOf(),u)},"...":function(e){if(a(e))throw new TypeError("Scalar values expected in function min");return c(e)}});return f.toTex="\\min\\left(${args}\\right)",f}var i=n(36),o=n(62),a=n(61);t.name="min",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(n){var r=void 0;if(i(n,function(e){r=void 0===r?e:s(r,e)}),void 0===r)switch(t.number){case"number":return 0;case"BigNumber":return new e.BigNumber(0);case"Fraction":return new e.Fraction(0);default:return 0}return r}var s=r(n(20)),u=o("sum",{"Array | Matrix":function(e){return a(e)},"Array | Matrix, number | BigNumber":function(){throw new Error("sum(A, dim) is not yet supported")},"...":function(e){return a(e)}});return u.toTex=void 0,u}var i=n(36);t.name="sum",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(t,n){var r=0,i=0;if(0==t.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(o(t,function(e){r=u(r,e),i++}),0===i)throw new Error("Cannot calculate var of an empty array");var a=f(r,i);switch(r=0,o(t,function(e){var t=c(e,a);r=u(r,l(t,t))}),n){case"uncorrected":return f(r,i);case"biased":return f(r,i+1);case"unbiased":var s=r&&r.isBigNumber===!0?new e.BigNumber(0):0;return 1==i?s:f(r,i-1);default:throw new Error('Unknown normalization "'+n+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}var u=r(n(20)),c=r(n(21)),l=r(n(22)),f=r(n(19)),h=a("variance",{"Array | Matrix":function(e){return s(e,i)},"Array | Matrix, string":s,"...":function(e){return s(e,i)}});return h.toTex="\\mathrm{Var}\\left(${args}\\right)",h}var i="unbiased",o=n(36);t.name="var",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("format",{any:i.format,"any, Object | function | number":i.format});return o.toTex=void 0,o}var i=n(11);t.name="format",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("acosh",{number:function(n){return n>=1||t.predictable?o(n):n<=-1?new e.Complex(Math.log(Math.sqrt(n*n-1)-n),Math.PI):new e.Complex(n,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()},"Array | Matrix":function(e){return i(e,a)}});return a.toTex={1:"\\cosh^{-1}\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)};t.name="acosh",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("clone",{any:i.clone});return o.toTex=void 0,o}var i=n(5);t.name="clone",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("_typeof",{any:function(e){var t=i.type(e);if("Object"===t){if(e.isBigNumber===!0)return"BigNumber";if(e.isComplex===!0)return"Complex";if(e.isFraction===!0)return"Fraction";if(e.isMatrix===!0)return"Matrix";if(e.isUnit===!0)return"Unit";if(e.isIndex===!0)return"Index";if(e.isRange===!0)return"Range";if(e.isChain===!0)return"Chain";if(e.isHelp===!0)return"Help"}return t}});return o.toTex=void 0,o}var i=n(63);t.name="typeof",t.factory=r},function(e,t,n){function r(e,t,n,r,s){return i.prototype.type="Complex",i.prototype.isComplex=!0,i.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},i.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},i.prototype.format=function(e){var t="",n=this.im,r=this.re,i=o(this.re,e),s=o(this.im,e),u=a(e)?e:e?e.precision:null;if(null!==u){var c=Math.pow(10,-u);Math.abs(r/n)<c&&(r=0),Math.abs(n/r)<c&&(n=0)}return t=0==n?i:0==r?1==n?"i":n==-1?"-i":s+"i":n<0?n==-1?i+" - i":i+" - "+(/[\d-.]/.test(s.charAt(0))?s.substring(1):s)+"i":1==n?i+" + i":i+" + "+s+"i"},i.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"==typeof t)return i(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(a(n)){if(r&&r.isUnit&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),a(r))return new i({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},i.prototype.valueOf=i.prototype.toString,i.fromJSON=function(e){return new i(e)},i.EPSILON=t.epsilon,s.on("config",function(e,t){e.epsilon!==t.epsilon&&(i.EPSILON=e.epsilon)}),i}var i=n(512),o=n(2).format,a=n(2).isNumber;t.name="Complex",t.path="type",t.factory=r,t.math=!0},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new e.Fraction(t)},string:function(t){return new e.Fraction(t)},"number, number":function(t,n){return new e.Fraction(t,n)},BigNumber:function(t){return new e.Fraction(t.toString())},Fraction:function(e){return e},Object:function(t){return new e.Fraction(t)},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);t.name="fraction",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,c){function d(e,t){if(!(this instanceof d))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!p(t))throw new Error("Invalid datatype: "+t);if(e&&e.isMatrix===!0)"DenseMatrix"===e.type?(this._data=u.clone(e._data),this._size=u.clone(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&l(e.data)&&l(e.size))this._data=e.data,this._size=e.size,this._datatype=t||e.datatype;else if(l(e))this._data=b(e),this._size=s.size(this._data),s.validate(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+i.types.type(e)+")");this._data=[],this._size=[0],this._datatype=t}}function v(e,t){if(!t||t.isIndex!==!0)throw new TypeError("Invalid index");var n=t.isScalar();if(n)return e.get(t.min());var r=t.size();if(r.length!=e._size.length)throw new o(r.length,e._size.length);for(var i=t.min(),a=t.max(),s=0,u=e._size.length;s<u;s++)m(i[s],e._size[s]),m(a[s],e._size[s]);return new d(g(e._data,t,r.length,0),e._datatype)}function g(e,t,n,r){var i=r===n-1,o=t.dimension(r);return i?o.map(function(t){return m(t,e.length),e[t]}).valueOf():o.map(function(i){m(i,e.length);var o=e[i];return g(o,t,n,r+1)}).valueOf()}function y(e,t,n,r){if(!t||t.isIndex!==!0)throw new TypeError("Invalid index");var i,a=t.size(),c=t.isScalar();if(n&&n.isMatrix===!0?(i=n.size(),n=n.valueOf()):i=s.size(n),c){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(a.length<e._size.length)throw new o(a.length,e._size.length,"<");if(i.length<a.length){for(var l=0,f=0;1===a[l]&&1===i[l];)l++;for(;1===a[l];)f++,l++;n=s.unsqueeze(n,a.length,f,i)}if(!u.deepEqual(a,i))throw new o(a,i,">");var h=t.max().map(function(e){return e+1});x(e,h,r);var p=a.length,m=0;w(e._data,t,n,p,m)}return e}function w(e,t,n,r,i){var o=i===r-1,a=t.dimension(i);o?a.forEach(function(t,r){m(t),e[t]=n[r[0]]}):a.forEach(function(o,a){m(o),w(e[o],t,n[a[0]],r,i+1)})}function x(e,t,n){for(var r=e._size.slice(0),i=!1;r.length<t.length;)r.push(0),i=!0;for(var o=0,a=t.length;o<a;o++)t[o]>r[o]&&(r[o]=t[o],i=!0);i&&M(e,r,n)}function b(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];l(r)?e[t]=b(r):r&&r.isMatrix===!0&&(e[t]=b(r.valueOf()))}return e}var C=r(n(75));d.prototype=new C,d.prototype.type="DenseMatrix",d.prototype.isDenseMatrix=!0,d.prototype.storage=function(){return"dense"},d.prototype.datatype=function(){return this._datatype},d.prototype.create=function(e,t){return new d(e,t)},d.prototype.subset=function(e,t,n){switch(arguments.length){case 1:return v(this,e);case 2:case 3:return y(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}},d.prototype.get=function(e){if(!l(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);for(var t=0;t<e.length;t++)m(e[t],this._size[t]);for(var n=this._data,r=0,i=e.length;r<i;r++){var a=e[r];m(a,n.length),n=n[a]}return n},d.prototype.set=function(e,t,n){if(!l(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new o(e.length,this._size.length,"<");var r,i,a,s=e.map(function(e){return e+1});x(this,s,n);var u=this._data;for(r=0,i=e.length-1;r<i;r++)a=e[r],m(a,u.length),u=u[a];return a=e[e.length-1],m(a,u.length),u[a]=t,this},d.prototype.resize=function(e,t,n){if(!l(e))throw new TypeError("Array expected");var r=n?this.clone():this;return M(r,e,t)};var M=function(e,t,n){if(0===t.length){for(var r=e._data;l(r);)r=r[0];return r}return e._size=t.slice(0),e._data=s.resize(e._data,e._size,n),e};return d.prototype.reshape=function(e,t){var n=t?this.clone():this;return n._data=s.reshape(n._data,e),n._size=e.slice(0),n},d.prototype.clone=function(){var e=new d({data:u.clone(this._data),size:u.clone(this._size),datatype:this._datatype});return e},d.prototype.size=function(){return this._size.slice(0)},d.prototype.map=function(e){var t=this,n=function(r,i){return l(r)?r.map(function(e,t){return n(e,i.concat(t))}):e(r,i,t)};return new d({data:n(this._data,[]),size:u.clone(this._size),datatype:this._datatype})},d.prototype.forEach=function(e){var t=this,n=function(r,i){l(r)?r.forEach(function(e,t){n(e,i.concat(t))}):e(r,i,t)};n(this._data,[])},d.prototype.toArray=function(){return u.clone(this._data)},d.prototype.valueOf=function(){return this._data},d.prototype.format=function(e){return a.format(this._data,e)},d.prototype.toString=function(){return a.format(this._data)},d.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},d.prototype.diagonal=function(e){if(e){if(e.isBigNumber===!0&&(e=e.toNumber()),!f(e)||!h(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,n=e<0?-e:0,r=this._size[0],i=this._size[1],o=Math.min(r-n,i-t),a=[],s=0;s<o;s++)a[s]=this._data[s+n][s+t];return new d({data:a,size:[o],datatype:this._datatype})},d.diagonal=function(t,n,r,i,o){if(!l(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(e){if(e&&e.isBigNumber===!0&&(e=e.toNumber()),!f(e)||!h(e)||e<1)throw new Error("Size values must be positive integers");return e}),r){if(r&&r.isBigNumber===!0&&(r=r.toNumber()),!f(r)||!h(r))throw new TypeError("The parameter k must be an integer number")}else r=0;i&&p(o)&&(i=c.convert(i,o));var a,u=r>0?r:0,m=r<0?-r:0,v=t[0],g=t[1],y=Math.min(v-m,g-u);if(l(n)){if(n.length!==y)throw new Error("Invalid value array length");a=function(e){return n[e]}}else if(n&&n.isMatrix===!0){var w=n.size();if(1!==w.length||w[0]!==y)throw new Error("Invalid matrix length");a=function(e){return n.get([e])}}else a=function(){return n};i||(i=a(0)&&a(0).isBigNumber===!0?new e.BigNumber(0):0);var x=[];if(t.length>0){x=s.resize(x,t,i);for(var b=0;b<y;b++)x[b+m][b+u]=a(b)}return new d({data:x,size:[v,g]})},d.fromJSON=function(e){return new d(e)},d.prototype.swapRows=function(e,t){if(!(f(e)&&h(e)&&f(t)&&h(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return m(e,this._size[0]),m(t,this._size[0]),d._swapRows(e,t,this._data),this},d._swapRows=function(e,t,n){var r=n[e];n[e]=n[t],n[t]=r},e.Matrix._storage.dense=d,e.Matrix._storage.default=d,d}var i=n(25),o=n(9),a=(n(17).getSafeProperty,n(17).setSafeProperty,i.string),s=i.array,u=i.object,c=i.number,l=Array.isArray,f=c.isNumber,h=c.isInteger,p=a.isString,m=s.validateIndex;t.name="DenseMatrix",t.path="type",t.factory=r,t.lazy=!1},function(e,t,n){"use strict";function r(e,t,n,r){function o(e,t,n){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(null!=e)if(e.isBigNumber===!0)e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter start must be a number");if(null!=t)if(t.isBigNumber===!0)t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter end must be a number");if(null!=n)if(n.isBigNumber===!0)n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter step must be a number");this.start=null!=e?parseFloat(e):0,this.end=null!=t?parseFloat(t):0,this.step=null!=n?parseFloat(n):1}return o.prototype.type="Range",o.prototype.isRange=!0,o.parse=function(e){if("string"!=typeof e)return null;var t=e.split(":"),n=t.map(function(e){return parseFloat(e)}),r=n.some(function(e){return isNaN(e)});if(r)return null;switch(n.length){case 2:return new o(n[0],n[1]);case 3:return new o(n[0],n[2],n[1]);default:return null}},o.prototype.clone=function(){return new o(this.start,this.end,this.step)},o.prototype.size=function(){var e=0,t=this.start,n=this.step,r=this.end,o=r-t;return i.sign(n)==i.sign(o)?e=Math.ceil(o/n):0==o&&(e=0),isNaN(e)&&(e=0),[e]},o.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},o.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},o.prototype.forEach=function(e){var t=this.start,n=this.step,r=this.end,i=0;if(n>0)for(;t<r;)e(t,[i],this),t+=n,i++;else if(n<0)for(;t>r;)e(t,[i],this),t+=n,i++},o.prototype.map=function(e){var t=[];return this.forEach(function(n,r,i){t[r[0]]=e(n,r,i)}),t},o.prototype.toArray=function(){var e=[];return this.forEach(function(t,n){e[n[0]]=t}),e},o.prototype.valueOf=function(){return this.toArray()},o.prototype.format=function(e){var t=i.format(this.start,e);return 1!=this.step&&(t+=":"+i.format(this.step,e)),t+=":"+i.format(this.end,e)},o.prototype.toString=function(){return this.format()},o.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},o.fromJSON=function(e){return new o(e.start,e.end,e.step)},o}var i=n(2);t.name="Range",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(10)),s=e.SparseMatrix,u=function(e,t,n){var r=e._values,u=e._index,c=e._ptr,l=e._size,f=e._datatype,h=t._values,p=t._index,m=t._ptr,d=t._size,v=t._datatype;if(l.length!==d.length)throw new i(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var g,y=l[0],w=l[1],x=a,b=0,C=n;"string"==typeof f&&f===v&&(g=f,x=o.find(a,[g,g]),b=o.convert(0,g),C=o.find(n,[g,g]));var M,T,N,E,A,S=r&&h?[]:void 0,P=[],O=[],_=new s({values:S,index:P,ptr:O,size:[y,w],datatype:g}),I=S?[]:void 0,B=[];for(T=0;T<w;T++){O[T]=P.length;var k=T+1;if(I)for(E=m[T],A=m[T+1],N=E;N<A;N++)M=p[N],B[M]=k,I[M]=h[N];for(E=c[T],A=c[T+1],N=E;N<A;N++)if(M=u[N],I){var V=B[M]===k?I[M]:b,z=C(r[N],V);x(z,b)||(P.push(M),S.push(z))}else P.push(M)}return O[w]=P.length,_};return u}var i=n(9);t.name="algorithm09",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return i.prototype.type="ResultSet",i.prototype.isResultSet=!0,i.prototype.valueOf=function(){return this.entries},i.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},i.fromJSON=function(e){return new i(e.entries)},i}t.name="ResultSet",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s,u){function c(e,t){if(!(this instanceof c))throw new Error("Constructor must be called with the new operator");if(void 0!==e&&!P(e)&&!e.isComplex)throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(void 0!=t&&("string"!=typeof t||""==t))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!=t){var n=c.parse(t);this.units=n.units,this.dimensions=n.dimensions}else{this.units=[{unit:j,prefix:D.NONE,power:0}],this.dimensions=[];for(var r=0;r<U.length;r++)this.dimensions[r]=0}this.value=void 0!=e?this._normalize(e):null,this.fixPrefix=!1,this.isUnitListSimplified=!0}function l(){for(;" "==z||"\t"==z;)p()}function f(e){return e>="0"&&e<="9"||"."==e}function h(e){return e>="0"&&e<="9"}function p(){V++,z=k.charAt(V)}function m(e){V=e,z=k.charAt(V)}function d(){var e,t="";if(e=V,"+"==z?p():"-"==z&&(t+=z,p()),!f(z))return m(e),null;if("."==z){if(t+=z,p(),!h(z))return m(e),null}else{for(;h(z);)t+=z,p();"."==z&&(t+=z,p())}for(;h(z);)t+=z,p();if("E"==z||"e"==z){var n="",r=V;if(n+=z,p(),"+"!=z&&"-"!=z||(n+=z,p()),!h(z))return m(r),t;for(t+=n;h(z);)t+=z,p()}return t}function v(){for(var e="",t=k.charCodeAt(V);t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122;)e+=z,p(),t=k.charCodeAt(V);return t=e.charCodeAt(0),t>=65&&t<=90||t>=97&&t<=122?e||null:null}function g(e){return z===e?(p(),e):null}function y(e){if(W.hasOwnProperty(e)){var t=W[e],n=t.prefixes[""];return{unit:t,prefix:n}}for(var r in W)if(W.hasOwnProperty(r)&&i(e,r)){var t=W[r],o=e.length-r.length,a=e.substring(0,o),n=t.prefixes.hasOwnProperty(a)?t.prefixes[a]:void 0;if(void 0!==n)return{unit:t,prefix:n}}return null}function w(t){if("BigNumber"===t.number){var n=a.pi(e.BigNumber);W.rad.value=new e.BigNumber(1),W.deg.value=n.div(180),W.grad.value=n.div(200),W.cycle.value=n.times(2),W.arcsec.value=n.div(648e3),W.arcmin.value=n.div(10800)}else W.rad.value=1,W.deg.value=Math.PI/180,W.grad.value=Math.PI/200,W.cycle.value=2*Math.PI,W.arcsec.value=Math.PI/648e3,W.arcmin.value=Math.PI/10800}function x(e){for(var t=0;t<e.length;t++){var n=e.charAt(t),r=function(e){return/^[a-zA-Z]$/.test(e)},i=function(e){return e>="0"&&e<="9"};if(0===t&&!r(n))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!r(n)&&!i(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}var b=r(n(20)),C=r(n(21)),M=r(n(22)),T=r(n(19)),N=r(n(39)),E=r(n(26)),A=r(n(104)),S=r(n(72)),P=r(n(73)),O=r(n(127)),_=r(n(130)),I=r(n(78)),B=r(n(131));c.prototype.type="Unit",c.prototype.isUnit=!0;var k,V,z;c.parse=function(n,r){if(r=r||{},k=n,V=-1,z="","string"!=typeof k)throw new TypeError("Invalid argument in Unit.parse, string expected");var i=new c;i.units=[],p(),l();var o=d(),a=null;o&&(a="BigNumber"===t.number?new e.BigNumber(o):"Fraction"===t.number?new e.Fraction(o):parseFloat(o)),l();for(var s=1,u=!1,f=[],h=1;;){for(l();"("===z;)f.push(s),h*=s,s=1,p(),l();if(!z)break;var m=z,w=v();if(null==w)throw new SyntaxError('Unexpected "'+m+'" in "'+k+'" at index '+V.toString());var x=y(w);if(null==x)throw new SyntaxError('Unit "'+w+'" not found.');var b=s*h;if(l(),g("^")){l();var C=d();if(null==C)throw new SyntaxError('In "'+n+'", "^" must be followed by a floating-point number');b*=C}i.units.push({unit:x.unit,prefix:x.prefix,power:b});for(var M=0;M<U.length;M++)i.dimensions[M]+=(x.unit.dimensions[M]||0)*b;for(l();")"===z;){if(0===f.length)throw new SyntaxError('Unmatched ")" in "'+k+'" at index '+V.toString());h/=f.pop(),p(),l()}if(u=!1,g("*")?(s=1,u=!0):g("/")?(s=-1,u=!0):s=1,x.unit.base){var T=x.unit.base.key;H.auto[T]={unit:x.unit,prefix:x.prefix}}}if(l(),z)throw new SyntaxError('Could not parse: "'+n+'"');if(u)throw new SyntaxError('Trailing characters: "'+n+'"');if(0!==f.length)throw new SyntaxError('Unmatched "(" in "'+k+'"');if(0==i.units.length&&!r.allowNoUnits)throw new SyntaxError('"'+n+'" contains no units');return i.value=void 0!=a?i._normalize(a):null,i},c.prototype.clone=function(){var e=new c;e.fixPrefix=this.fixPrefix,e.isUnitListSimplified=this.isUnitListSimplified,e.value=o(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++){e.units[t]={};for(var n in this.units[t])this.units[t].hasOwnProperty(n)&&(e.units[t][n]=this.units[t][n])}return e},c.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},c.prototype._normalize=function(e){var t,n,r,i,o;if(null==e||0===this.units.length)return e;if(this._isDerived()){var a=e;o=c._getNumberConverter(_(e));for(var s=0;s<this.units.length;s++)t=o(this.units[s].unit.value),i=o(this.units[s].prefix.value),r=o(this.units[s].power),a=M(a,N(M(t,i),r));return a}return o=c._getNumberConverter(_(e)),t=o(this.units[0].unit.value),n=o(this.units[0].unit.offset),i=o(this.units[0].prefix.value),M(b(e,n),M(t,i))},c.prototype._denormalize=function(e,t){var n,r,i,o,a;if(null==e||0===this.units.length)return e;if(this._isDerived()){var s=e;a=c._getNumberConverter(_(e));for(var u=0;u<this.units.length;u++)n=a(this.units[u].unit.value),o=a(this.units[u].prefix.value),i=a(this.units[u].power),s=T(s,N(M(n,o),i));return s}return a=c._getNumberConverter(_(e)),n=a(this.units[0].unit.value),o=a(this.units[0].prefix.value),r=a(this.units[0].unit.offset),void 0==t?C(T(T(e,n),o),r):C(T(T(e,n),t),r)},c.isValuelessUnit=function(e){return null!=y(e)},c.prototype.hasBase=function(e){if("string"==typeof e&&(e=L[e]),!e)return!1;for(var t=0;t<U.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},c.prototype.equalBase=function(e){for(var t=0;t<U.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},c.prototype.equals=function(e){return this.equalBase(e)&&S(this.value,e.value)},c.prototype.multiply=function(e){for(var t=this.clone(),n=0;n<U.length;n++)t.dimensions[n]=(this.dimensions[n]||0)+(e.dimensions[n]||0);for(var n=0;n<e.units.length;n++){var r={};for(var i in e.units[n])r[i]=e.units[n][i];t.units.push(r)}if(null!=this.value||null!=e.value){var o=null==this.value?this._normalize(1):this.value,a=null==e.value?e._normalize(1):e.value;t.value=M(o,a)}else t.value=null;return t.isUnitListSimplified=!1,F(t)},c.prototype.divide=function(e){for(var t=this.clone(),n=0;n<U.length;n++)t.dimensions[n]=(this.dimensions[n]||0)-(e.dimensions[n]||0);for(var n=0;n<e.units.length;n++){var r={};for(var i in e.units[n])r[i]=e.units[n][i];r.power=-r.power,t.units.push(r)}if(null!=this.value||null!=e.value){var o=null==this.value?this._normalize(1):this.value,a=null==e.value?e._normalize(1):e.value;t.value=T(o,a)}else t.value=null;return t.isUnitListSimplified=!1,F(t)},c.prototype.pow=function(e){for(var t=this.clone(),n=0;n<U.length;n++)t.dimensions[n]=(this.dimensions[n]||0)*e;for(var n=0;n<t.units.length;n++)t.units[n].power*=e;return null!=t.value?t.value=N(t.value,e):t.value=null,t.isUnitListSimplified=!1,F(t)};var F=function(e){return e.equalBase(L.NONE)&&null!==e.value&&!t.predictable?e.value:e};c.prototype.abs=function(){var e=this.clone();e.value=E(e.value);for(var t in e.units)"VA"!==e.units[t].unit.name&&"VAR"!==e.units[t].unit.name||(e.units[t].unit=W.W);return e},c.prototype.to=function(e){var t,n=null==this.value?this._normalize(1):this.value;if("string"==typeof e){if(t=c.parse(e),!this.equalBase(t))throw new Error("Units do not match");if(null!==t.value)throw new Error("Cannot convert to a unit with a value");return t.value=o(n),t.fixPrefix=!0,t.isUnitListSimplified=!0,t}if(e&&e.isUnit){if(!this.equalBase(e))throw new Error("Units do not match");if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return t=e.clone(),t.value=o(n),t.fixPrefix=!0,t.isUnitListSimplified=!0,t}throw new Error("String or Unit expected as parameter")},c.prototype.toNumber=function(e){return I(this.toNumeric(e))},c.prototype.toNumeric=function(e){var t=this;return e&&(t=this.to(e)),t._isDerived()?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},c.prototype.toString=function(){return this.format()},c.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},c.fromJSON=function(e){var t=new c(e.value,e.unit);return t.fixPrefix=e.fixPrefix||!1,t},c.prototype.valueOf=c.prototype.toString,c.prototype.simplifyUnitListLazy=function(){if(!this.isUnitListSimplified&&null!=this.value){var e,t=[];for(var n in $)if(this.hasBase(L[n])){e=n;break}if("NONE"===e)this.units=[];else{var r;if(e&&$.hasOwnProperty(e)&&(r=$[e]),r)this.units=[{unit:r.unit,prefix:r.prefix,power:1}];else{for(var i=!1,o=0;o<U.length;o++){var a=U[o];Math.abs(this.dimensions[o]||0)>1e-12&&($.hasOwnProperty(a)?t.push({unit:$[a].unit,prefix:$[a].prefix,power:this.dimensions[o]||0}):i=!0)}t.length<this.units.length&&!i&&(this.units=t)}}this.isUnitListSimplified=!0}},c.prototype.toSI=function(){for(var e=this.clone(),t=[],n=0;n<U.length;n++){var r=U[n];if(Math.abs(e.dimensions[n]||0)>1e-12){if(!H.si.hasOwnProperty(r))throw new Error("Cannot express custom unit "+r+" in SI units");t.push({unit:H.si[r].unit,prefix:H.si[r].prefix,power:e.dimensions[n]||0})}}return e.units=t,e.isUnitListSimplified=!0,e},c.prototype.formatUnits=function(){this.simplifyUnitListLazy();for(var e="",t="",n=0,r=0,i=0;i<this.units.length;i++)this.units[i].power>0?(n++,e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(e+="^"+this.units[i].power)):this.units[i].power<0&&r++;if(r>0)for(var i=0;i<this.units.length;i++)this.units[i].power<0&&(n>0?(t+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power+1)>1e-15&&(t+="^"+-this.units[i].power)):(t+=" "+this.units[i].prefix.name+this.units[i].unit.name,t+="^"+this.units[i].power));e=e.substr(1),t=t.substr(1),n>1&&r>0&&(e="("+e+")"),r>1&&n>0&&(t="("+t+")");var o=e;return n>0&&r>0&&(o+=" / "),o+=t},c.prototype.format=function(e){this.simplifyUnitListLazy();var t=!1,n=!0;"undefined"!=typeof this.value&&null!==this.value&&this.value.isComplex&&(t=Math.abs(this.value.re)<1e-14,n=Math.abs(this.value.im)<1e-14);for(var r in this.units)this.units[r].unit&&("VA"===this.units[r].unit.name&&t?this.units[r].unit=W.VAR:"VAR"!==this.units[r].unit.name||t||(this.units[r].unit=W.VA));1!==this.units.length||this.fixPrefix||Math.abs(this.units[0].power-Math.round(this.units[0].power))<1e-14&&(this.units[0].prefix=this._bestPrefix());var i=this._denormalize(this.value),o=null!==this.value?O(i,e||{}):"",a=this.formatUnits();return this.value&&this.value.isComplex&&(o="("+o+")"),a.length>0&&o.length>0&&(o+=" "),o+=a},c.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var e=E(this.value),t=E(this.units[0].unit.value),n=this.units[0].prefix;if(0===e)return n;var r=this.units[0].power,i=Math.log(e/Math.pow(n.value*t,r))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return n;i=Math.abs(i);var o=this.units[0].unit.prefixes;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if(s.scientific){var u=Math.abs(Math.log(e/Math.pow(s.value*t,r))/Math.LN10-1.2);(u<i||u===i&&s.name.length<n.name.length)&&(n=s,i=u)}}return n},c.prototype.splitUnit=function(e){for(var t=this.clone(),n=[],r=0;r<e.length&&(t=t.to(e[r]),r!=e.length-1);r++){var i=A(t.toNumeric()),o=new c(i,e[r].toString());n.push(o),t=C(t,o)}return n.push(t),n};var D={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{
name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};D.SHORTLONG={};for(var R in D.SHORT)D.SHORT.hasOwnProperty(R)&&(D.SHORTLONG[R]=D.SHORT[R]);for(var R in D.LONG)D.LONG.hasOwnProperty(R)&&(D.SHORTLONG[R]=D.LONG[R]);var U=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],L={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var R in L)L[R].key=R;var q={},j={name:"",base:q,value:1,offset:0,dimensions:[0,0,0,0,0,0,0,0,0]},W={meter:{name:"meter",base:L.LENGTH,prefixes:D.LONG,value:1,offset:0},inch:{name:"inch",base:L.LENGTH,prefixes:D.NONE,value:.0254,offset:0},foot:{name:"foot",base:L.LENGTH,prefixes:D.NONE,value:.3048,offset:0},yard:{name:"yard",base:L.LENGTH,prefixes:D.NONE,value:.9144,offset:0},mile:{name:"mile",base:L.LENGTH,prefixes:D.NONE,value:1609.344,offset:0},link:{name:"link",base:L.LENGTH,prefixes:D.NONE,value:.201168,offset:0},rod:{name:"rod",base:L.LENGTH,prefixes:D.NONE,value:5.02921,offset:0},chain:{name:"chain",base:L.LENGTH,prefixes:D.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:L.LENGTH,prefixes:D.NONE,value:1e-10,offset:0},m:{name:"m",base:L.LENGTH,prefixes:D.SHORT,value:1,offset:0},in:{name:"in",base:L.LENGTH,prefixes:D.NONE,value:.0254,offset:0},ft:{name:"ft",base:L.LENGTH,prefixes:D.NONE,value:.3048,offset:0},yd:{name:"yd",base:L.LENGTH,prefixes:D.NONE,value:.9144,offset:0},mi:{name:"mi",base:L.LENGTH,prefixes:D.NONE,value:1609.344,offset:0},li:{name:"li",base:L.LENGTH,prefixes:D.NONE,value:.201168,offset:0},rd:{name:"rd",base:L.LENGTH,prefixes:D.NONE,value:5.02921,offset:0},ch:{name:"ch",base:L.LENGTH,prefixes:D.NONE,value:20.1168,offset:0},mil:{name:"mil",base:L.LENGTH,prefixes:D.NONE,value:254e-7,offset:0},m2:{name:"m2",base:L.SURFACE,prefixes:D.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:L.SURFACE,prefixes:D.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:L.SURFACE,prefixes:D.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:L.SURFACE,prefixes:D.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:L.SURFACE,prefixes:D.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:L.SURFACE,prefixes:D.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:L.SURFACE,prefixes:D.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:L.SURFACE,prefixes:D.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:L.SURFACE,prefixes:D.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:L.SURFACE,prefixes:D.NONE,value:1e4,offset:0},m3:{name:"m3",base:L.VOLUME,prefixes:D.CUBIC,value:1,offset:0},L:{name:"L",base:L.VOLUME,prefixes:D.SHORT,value:.001,offset:0},l:{name:"l",base:L.VOLUME,prefixes:D.SHORT,value:.001,offset:0},litre:{name:"litre",base:L.VOLUME,prefixes:D.LONG,value:.001,offset:0},cuin:{name:"cuin",base:L.VOLUME,prefixes:D.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:L.VOLUME,prefixes:D.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:L.VOLUME,prefixes:D.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:L.VOLUME,prefixes:D.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:L.VOLUME,prefixes:D.NONE,value:15e-6,offset:0},drop:{name:"drop",base:L.VOLUME,prefixes:D.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:L.VOLUME,prefixes:D.NONE,value:5e-8,offset:0},minim:{name:"minim",base:L.VOLUME,prefixes:D.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:L.VOLUME,prefixes:D.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:L.VOLUME,prefixes:D.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:L.VOLUME,prefixes:D.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:L.VOLUME,prefixes:D.NONE,value:1e-6,offset:0},cup:{name:"cup",base:L.VOLUME,prefixes:D.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:L.VOLUME,prefixes:D.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:L.VOLUME,prefixes:D.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:L.VOLUME,prefixes:D.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:L.VOLUME,prefixes:D.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:L.VOLUME,prefixes:D.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:L.VOLUME,prefixes:D.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:L.VOLUME,prefixes:D.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:L.VOLUME,prefixes:D.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:L.VOLUME,prefixes:D.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:L.VOLUME,prefixes:D.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:L.VOLUME,prefixes:D.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:L.VOLUME,prefixes:D.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:L.VOLUME,prefixes:D.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:L.VOLUME,prefixes:D.NONE,value:.1173478,offset:0},obl:{name:"obl",base:L.VOLUME,prefixes:D.NONE,value:.1589873,offset:0},g:{name:"g",base:L.MASS,prefixes:D.SHORT,value:.001,offset:0},gram:{name:"gram",base:L.MASS,prefixes:D.LONG,value:.001,offset:0},ton:{name:"ton",base:L.MASS,prefixes:D.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:L.MASS,prefixes:D.SHORT,value:1e3,offset:0},grain:{name:"grain",base:L.MASS,prefixes:D.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:L.MASS,prefixes:D.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:L.MASS,prefixes:D.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:L.MASS,prefixes:D.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:L.MASS,prefixes:D.NONE,value:45.359237,offset:0},stick:{name:"stick",base:L.MASS,prefixes:D.NONE,value:.115,offset:0},stone:{name:"stone",base:L.MASS,prefixes:D.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:L.MASS,prefixes:D.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:L.MASS,prefixes:D.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:L.MASS,prefixes:D.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:L.MASS,prefixes:D.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:L.MASS,prefixes:D.NONE,value:45.359237,offset:0},s:{name:"s",base:L.TIME,prefixes:D.SHORT,value:1,offset:0},min:{name:"min",base:L.TIME,prefixes:D.NONE,value:60,offset:0},h:{name:"h",base:L.TIME,prefixes:D.NONE,value:3600,offset:0},second:{name:"second",base:L.TIME,prefixes:D.LONG,value:1,offset:0},sec:{name:"sec",base:L.TIME,prefixes:D.LONG,value:1,offset:0},minute:{name:"minute",base:L.TIME,prefixes:D.NONE,value:60,offset:0},hour:{name:"hour",base:L.TIME,prefixes:D.NONE,value:3600,offset:0},day:{name:"day",base:L.TIME,prefixes:D.NONE,value:86400,offset:0},week:{name:"week",base:L.TIME,prefixes:D.NONE,value:604800,offset:0},month:{name:"month",base:L.TIME,prefixes:D.NONE,value:2629800,offset:0},year:{name:"year",base:L.TIME,prefixes:D.NONE,value:31557600,offset:0},decade:{name:"year",base:L.TIME,prefixes:D.NONE,value:315576e3,offset:0},century:{name:"century",base:L.TIME,prefixes:D.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:L.TIME,prefixes:D.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:L.FREQUENCY,prefixes:D.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:L.FREQUENCY,prefixes:D.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:L.ANGLE,prefixes:D.LONG,value:1,offset:0},deg:{name:"deg",base:L.ANGLE,prefixes:D.LONG,value:null,offset:0},grad:{name:"grad",base:L.ANGLE,prefixes:D.LONG,value:null,offset:0},cycle:{name:"cycle",base:L.ANGLE,prefixes:D.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:L.ANGLE,prefixes:D.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:L.ANGLE,prefixes:D.NONE,value:null,offset:0},A:{name:"A",base:L.CURRENT,prefixes:D.SHORT,value:1,offset:0},ampere:{name:"ampere",base:L.CURRENT,prefixes:D.LONG,value:1,offset:0},K:{name:"K",base:L.TEMPERATURE,prefixes:D.NONE,value:1,offset:0},degC:{name:"degC",base:L.TEMPERATURE,prefixes:D.NONE,value:1,offset:273.15},degF:{name:"degF",base:L.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:L.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:L.TEMPERATURE,prefixes:D.NONE,value:1,offset:0},celsius:{name:"celsius",base:L.TEMPERATURE,prefixes:D.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:L.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:L.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:L.AMOUNT_OF_SUBSTANCE,prefixes:D.SHORT,value:1,offset:0},mole:{name:"mole",base:L.AMOUNT_OF_SUBSTANCE,prefixes:D.LONG,value:1,offset:0},cd:{name:"cd",base:L.LUMINOUS_INTENSITY,prefixes:D.NONE,value:1,offset:0},candela:{name:"candela",base:L.LUMINOUS_INTENSITY,prefixes:D.NONE,value:1,offset:0},N:{name:"N",base:L.FORCE,prefixes:D.SHORT,value:1,offset:0},newton:{name:"newton",base:L.FORCE,prefixes:D.LONG,value:1,offset:0},dyn:{name:"dyn",base:L.FORCE,prefixes:D.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:L.FORCE,prefixes:D.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:L.FORCE,prefixes:D.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:L.FORCE,prefixes:D.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:L.FORCE,prefixes:D.LONG,value:4448.2216,offset:0},J:{name:"J",base:L.ENERGY,prefixes:D.SHORT,value:1,offset:0},joule:{name:"joule",base:L.ENERGY,prefixes:D.SHORT,value:1,offset:0},erg:{name:"erg",base:L.ENERGY,prefixes:D.NONE,value:1e-5,offset:0},Wh:{name:"Wh",base:L.ENERGY,prefixes:D.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:L.ENERGY,prefixes:D.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:L.ENERGY,prefixes:D.SHORT,value:1.602176565e-19,offset:0},electronvolt:{name:"electronvolt",base:L.ENERGY,prefixes:D.LONG,value:1.602176565e-19,offset:0},W:{name:"W",base:L.POWER,prefixes:D.SHORT,value:1,offset:0},watt:{name:"W",base:L.POWER,prefixes:D.LONG,value:1,offset:0},hp:{name:"hp",base:L.POWER,prefixes:D.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:L.POWER,prefixes:D.SHORT,value:B.I,offset:0},VA:{name:"VA",base:L.POWER,prefixes:D.SHORT,value:1,offset:0},Pa:{name:"Pa",base:L.PRESSURE,prefixes:D.SHORT,value:1,offset:0},psi:{name:"psi",base:L.PRESSURE,prefixes:D.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:L.PRESSURE,prefixes:D.NONE,value:101325,offset:0},bar:{name:"bar",base:L.PRESSURE,prefixes:D.NONE,value:1e5,offset:0},torr:{name:"torr",base:L.PRESSURE,prefixes:D.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:L.PRESSURE,prefixes:D.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:L.PRESSURE,prefixes:D.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:L.PRESSURE,prefixes:D.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:L.ELECTRIC_CHARGE,prefixes:D.LONG,value:1,offset:0},C:{name:"C",base:L.ELECTRIC_CHARGE,prefixes:D.SHORT,value:1,offset:0},farad:{name:"farad",base:L.ELECTRIC_CAPACITANCE,prefixes:D.LONG,value:1,offset:0},F:{name:"F",base:L.ELECTRIC_CAPACITANCE,prefixes:D.SHORT,value:1,offset:0},volt:{name:"volt",base:L.ELECTRIC_POTENTIAL,prefixes:D.LONG,value:1,offset:0},V:{name:"V",base:L.ELECTRIC_POTENTIAL,prefixes:D.SHORT,value:1,offset:0},ohm:{name:"ohm",base:L.ELECTRIC_RESISTANCE,prefixes:D.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:L.ELECTRIC_INDUCTANCE,prefixes:D.LONG,value:1,offset:0},H:{name:"H",base:L.ELECTRIC_INDUCTANCE,prefixes:D.SHORT,value:1,offset:0},siemens:{name:"siemens",base:L.ELECTRIC_CONDUCTANCE,prefixes:D.LONG,value:1,offset:0},S:{name:"S",base:L.ELECTRIC_CONDUCTANCE,prefixes:D.SHORT,value:1,offset:0},weber:{name:"weber",base:L.MAGNETIC_FLUX,prefixes:D.LONG,value:1,offset:0},Wb:{name:"Wb",base:L.MAGNETIC_FLUX,prefixes:D.SHORT,value:1,offset:0},tesla:{name:"tesla",base:L.MAGNETIC_FLUX_DENSITY,prefixes:D.LONG,value:1,offset:0},T:{name:"T",base:L.MAGNETIC_FLUX_DENSITY,prefixes:D.SHORT,value:1,offset:0},b:{name:"b",base:L.BIT,prefixes:D.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:L.BIT,prefixes:D.BINARY_LONG,value:1,offset:0},B:{name:"B",base:L.BIT,prefixes:D.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:L.BIT,prefixes:D.BINARY_LONG,value:8,offset:0}},G={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",hertz:"hertz",radians:"rad",degree:"deg",degrees:"deg",gradian:"grad",gradians:"grad",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole"};w(t),u.on("config",function(e,t){e.number!==t.number&&w(e)});var H={si:{NONE:{unit:j,prefix:D.NONE[""]},LENGTH:{unit:W.m,prefix:D.SHORT[""]},MASS:{unit:W.g,prefix:D.SHORT.k},TIME:{unit:W.s,prefix:D.SHORT[""]},CURRENT:{unit:W.A,prefix:D.SHORT[""]},TEMPERATURE:{unit:W.K,prefix:D.SHORT[""]},LUMINOUS_INTENSITY:{unit:W.cd,prefix:D.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:W.mol,prefix:D.SHORT[""]},ANGLE:{unit:W.rad,prefix:D.SHORT[""]},BIT:{unit:W.bit,prefix:D.SHORT[""]},FORCE:{unit:W.N,prefix:D.SHORT[""]},ENERGY:{unit:W.J,prefix:D.SHORT[""]},POWER:{unit:W.W,prefix:D.SHORT[""]},PRESSURE:{unit:W.Pa,prefix:D.SHORT[""]},ELECTRIC_CHARGE:{unit:W.C,prefix:D.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:W.F,prefix:D.SHORT[""]},ELECTRIC_POTENTIAL:{unit:W.V,prefix:D.SHORT[""]},ELECTRIC_RESISTANCE:{unit:W.ohm,prefix:D.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:W.H,prefix:D.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:W.S,prefix:D.SHORT[""]},MAGNETIC_FLUX:{unit:W.Wb,prefix:D.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:W.T,prefix:D.SHORT[""]},FREQUENCY:{unit:W.Hz,prefix:D.SHORT[""]}}};H.cgs=JSON.parse(JSON.stringify(H.si)),H.cgs.LENGTH={unit:W.m,prefix:D.SHORT.c},H.cgs.MASS={unit:W.g,prefix:D.SHORT[""]},H.cgs.FORCE={unit:W.dyn,prefix:D.SHORT[""]},H.cgs.ENERGY={unit:W.erg,prefix:D.NONE[""]},H.us=JSON.parse(JSON.stringify(H.si)),H.us.LENGTH={unit:W.ft,prefix:D.NONE[""]},H.us.MASS={unit:W.lbm,prefix:D.NONE[""]},H.us.TEMPERATURE={unit:W.degF,prefix:D.NONE[""]},H.us.FORCE={unit:W.lbf,prefix:D.NONE[""]},H.us.ENERGY={unit:W.BTU,prefix:D.BTU[""]},H.us.POWER={unit:W.hp,prefix:D.NONE[""]},H.us.PRESSURE={unit:W.psi,prefix:D.NONE[""]},H.auto=JSON.parse(JSON.stringify(H.si));var $=H.auto;c.setUnitSystem=function(e){if(!H.hasOwnProperty(e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys(H).join(", "));$=H[e]},c.getUnitSystem=function(){for(var e in H)if(H[e]===$)return e},c.typeConverters={BigNumber:function(t){return new e.BigNumber(t+"")},Fraction:function(t){return new e.Fraction(t)},Complex:function(e){return e},number:function(e){return e}},c._getNumberConverter=function(e){if(!c.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return c.typeConverters[e]};for(var R in W){var Z=W[R];Z.dimensions=Z.base.dimensions}for(var Y in G)if(G.hasOwnProperty(Y)){var Z=W[G[Y]],X={};for(var R in Z)Z.hasOwnProperty(R)&&(X[R]=Z[R]);X.name=Y,W[Y]=X}return c.createUnit=function(e,t){if("object"!=typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var n in e)if(e.hasOwnProperty(n)&&c.deleteUnit(n),e[n].aliases)for(var r=0;r<e[n].aliases.length;r++)c.deleteUnit(e[n].aliases[r]);var i;for(var n in e)e.hasOwnProperty(n)&&(i=c.createUnitSingle(n,e[n]));return i},c.createUnitSingle=function(e,t,n){if("undefined"!=typeof t&&null!==t||(t={}),"string"!=typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(W.hasOwnProperty(e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');x(e);var r,i,o=null,a=[],s=0;if(t&&"Unit"===t.type)o=t.clone();else if("string"==typeof t)""!==t&&(r=t);else{if("object"!=typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');r=t.definition,i=t.prefixes,s=t.offset,t.aliases&&(a=t.aliases.valueOf())}if(a)for(var u=0;u<a.length;u++)if(W.hasOwnProperty(a[u]))throw new Error('Cannot create alias "'+a[u]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!o)try{o=c.parse(r,{allowNoUnits:!0})}catch(t){throw t.message='Could not create unit "'+e+'" from "'+r+'": '+t.message,t}else r&&"Unit"===r.type&&(o=r.clone());a=a||[],s=s||0,i=i&&i.toUpperCase?D[i.toUpperCase()]||D.NONE:D.NONE;var l={};if(o){l={name:e,value:o.value,dimensions:o.dimensions.slice(0),prefixes:i,offset:s};var f=!1;for(var u in L)if(L.hasOwnProperty(u)){for(var h=!0,p=0;p<U.length;p++)if(Math.abs((l.dimensions[p]||0)-(L[u].dimensions[p]||0))>1e-12){h=!1;break}if(h){f=!0;break}}if(!f){var m=e+"_STUFF",d={dimensions:o.dimensions.slice(0)};d.key=m,L[m]=d,$[m]={unit:l,prefix:D.NONE[""]},l.base=m}}else{var m=e+"_STUFF";if(U.indexOf(m)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');U.push(m);for(var v in L)L.hasOwnProperty(v)&&(L[v].dimensions[U.length-1]=0);for(var d={dimensions:[]},u=0;u<U.length;u++)d.dimensions[u]=0;d.dimensions[U.length-1]=1,d.key=m,L[m]=d,l={name:e,value:1,dimensions:L[m].dimensions.slice(0),prefixes:i,offset:s,base:m},$[m]={unit:l,prefix:D.NONE[""]}}c.UNITS[e]=l;for(var u=0;u<a.length;u++){var g=a[u],y={};for(var w in l)l.hasOwnProperty(w)&&(y[w]=l[w]);y.name=g,c.UNITS[g]=y}return new c(null,e)},c.deleteUnit=function(e){delete c.UNITS[e]},c.PREFIXES=D,c.BASE_DIMENSIONS=U,c.BASE_UNITS=L,c.UNIT_SYSTEMS=H,c.UNITS=W,c}var i=n(11).endsWith,o=n(5).clone,a=n(138);t.name="Unit",t.path="type",t.factory=r,t.math=!0},function(e,t,n){function r(e){return e[0].precision}var i=n(37).memoize;t.e=i(function(e){return new e(1).exp()},r),t.phi=i(function(e){return new e(1).plus(new e(5).sqrt()).div(2)},r),t.pi=i(function(e){return e.acos(-1)},r),t.tau=i(function(e){return t.pi(e).times(2)},r)},function(e,t,n){var r=n(516);t.mixin=function(e){var t=new r;return e.on=t.on.bind(t),e.off=t.off.bind(t),e.once=t.once.bind(t),e.emit=t.emit.bind(t),e}},function(e,t,n){e.exports=n(143)},function(e,t,n){e.exports=[n(487),n(142),n(334),n(406),n(474),n(147)]},function(e,t,n){"use strict";function r(e,t,a,u,c){c.on("config",function(n,i){n.number!==i.number&&r(e,t,a,u,c)}),i(c,"true",!0),i(c,"false",!1),i(c,"null",null),i(c,"uninitialized",n(3).UNINITIALIZED),"BigNumber"===t.number?(i(c,"Infinity",new e.BigNumber(1/0)),i(c,"NaN",new e.BigNumber(NaN)),o(c,"pi",function(){return s.pi(e.BigNumber)}),o(c,"tau",function(){return s.tau(e.BigNumber)}),o(c,"e",function(){return s.e(e.BigNumber)}),o(c,"phi",function(){return s.phi(e.BigNumber)}),o(c,"E",function(){return c.e}),o(c,"LN2",function(){return new e.BigNumber(2).ln()}),o(c,"LN10",function(){return new e.BigNumber(10).ln()}),o(c,"LOG2E",function(){return new e.BigNumber(1).div(new e.BigNumber(2).ln())}),o(c,"LOG10E",function(){return new e.BigNumber(1).div(new e.BigNumber(10).ln())}),o(c,"PI",function(){return c.pi}),o(c,"SQRT1_2",function(){return new e.BigNumber("0.5").sqrt()}),o(c,"SQRT2",function(){return new e.BigNumber(2).sqrt()})):(i(c,"Infinity",1/0),i(c,"NaN",NaN),i(c,"pi",Math.PI),i(c,"tau",2*Math.PI),i(c,"e",Math.E),i(c,"phi",1.618033988749895),i(c,"E",c.e),i(c,"LN2",Math.LN2),i(c,"LN10",Math.LN10),i(c,"LOG2E",Math.LOG2E),i(c,"LOG10E",Math.LOG10E),i(c,"PI",c.pi),i(c,"SQRT1_2",Math.SQRT1_2),i(c,"SQRT2",Math.SQRT2)),i(c,"i",e.Complex.I),i(c,"version",n(511))}function i(e,t,n){e[t]=n,e.expression.mathWithTransform[t]=n}function o(e,t,n){a.lazy(e,t,n),a.lazy(e.expression.mathWithTransform,t,n)}var a=n(5),s=n(138);t.factory=r,t.lazy=!1,t.math=!0},function(e,t,n){var r=n(5).isFactory,i=n(146),o=n(139),a=n(145),s=n(144);t.create=function(e){function t(e){if(!r(e))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var i,o=n.indexOf(e);return o===-1?(i=e.math===!0?e.factory(c.type,l,t,c.typed,c):e.factory(c.type,l,t,c.typed),n.push(e),u.push(i)):i=u[o],i}if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var n=[],u=[],c=o.mixin({});c.type={},c.expression={transform:{},mathWithTransform:{}},c.typed=i.create(c.type);var l={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};return c.import=t(a),c.config=t(s),c.expression.mathWithTransform.config=c.config,e&&c.config(e),c}},function(e,t,n){"use strict";function r(e,t,n,r,i){function o(e){if(e){var n=s.map(t,s.clone);a(e,"matrix",u),a(e,"number",c),s.deepExtend(t,e);var r=s.map(t,s.clone),o=s.map(e,s.clone);return i.emit("config",r,n,o),r}return s.map(t,s.clone)}var u=["Matrix","Array"],c=["number","BigNumber","Fraction"];return o.MATRIX=u,o.NUMBER=c,o}function i(e,t){return e.indexOf(t)!==-1}function o(e,t){return e.map(function(e){return e.toLowerCase()}).indexOf(t.toLowerCase())}function a(e,t,n){if(void 0!==e[t]&&!i(n,e[t])){var r=o(n,e[t]);r!==-1?(console.warn('Warning: Wrong casing for configuration option "'+t+'", should be "'+n[r]+'" instead of "'+e[t]+'".'),e[t]=n[r]):console.warn('Warning: Unknown value "'+e[t]+'" for configuration option "'+t+'". Available options: '+n.map(JSON.stringify).join(", ")+".")}}var s=n(5);t.name="config",t.math=!0,t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r,u){function c(e,t){var n=arguments.length;if(1!==n&&2!==n)throw new s("import",n,1,2);if(t||(t={}),o(e))p(e,t);else if(Array.isArray(e))e.forEach(function(e){c(e,t)});else if("object"==typeof e){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];m(i)?l(r,i,t):o(e)?p(e,t):c(i,t)}}else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}function l(e,t,n){if(n.wrap&&"function"==typeof t&&(t=h(t)),d(u[e])&&d(t))return t=n.override?r(e,t.signatures):r(u[e],t),u[e]=t,f(e,t),void u.emit("import",e,function(){return t});if(void 0===u[e]||n.override)return u[e]=t,f(e,t),void u.emit("import",e,function(){return t});if(!n.silent)throw new Error('Cannot import "'+e+'": already exists')}function f(e,t){t&&"function"==typeof t.transform?(u.expression.transform[e]=t.transform,v(e)&&(u.expression.mathWithTransform[e]=t.transform)):(delete u.expression.transform[e],v(e)&&(u.expression.mathWithTransform[e]=t))}function h(e){var t=function(){for(var t=[],n=0,r=arguments.length;n<r;n++){var i=arguments[n];t[n]=i&&i.valueOf()}return e.apply(u,t)};return e.transform&&(t.transform=e.transform),t}function p(e,t){if("string"==typeof e.name){var o=e.name,s=o in u.expression.transform,c=e.path?a(u,e.path):u,l=c.hasOwnProperty(o)?c[o]:void 0,f=function(){var i=n(e);if(i&&"function"==typeof i.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(d(l)&&d(i))return t.override||(i=r(l,i)),i;if(void 0===l||t.override)return i;if(!t.silent)throw new Error('Cannot import "'+o+'": already exists')};e.lazy!==!1?(i(c,o,f),s||("expression.transform"===e.path||g(e))&&i(u.expression.mathWithTransform,o,f)):(c[o]=f(),s||("expression.transform"===e.path||g(e))&&(u.expression.mathWithTransform[o]=f())),u.emit("import",o,f,e.path)}else n(e)}function m(e){return"function"==typeof e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e||e&&e.isUnit===!0||e&&e.isComplex===!0||e&&e.isBigNumber===!0||e&&e.isFraction===!0||e&&e.isMatrix===!0||e&&Array.isArray(e)===!0}function d(e){return"function"==typeof e&&"object"==typeof e.signatures}function v(e){return!y.hasOwnProperty(e)}function g(e){return void 0===e.path&&!y.hasOwnProperty(e.name)}var y={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return c}var i=n(5).lazy,o=n(5).isFactory,a=n(5).traverse,s=n(43);t.math=!0,t.name="import",t.factory=r,t.lazy=!0},function(e,t,n){var r=n(517),i=n(2).digits,o=function(){return o=r.create,r};t.create=function(e){var t=o();return t.types=[{name:"number",test:function(e){return"number"==typeof e}},{name:"Complex",test:function(e){return e&&e.isComplex}},{name:"BigNumber",test:function(e){return e&&e.isBigNumber}},{name:"Fraction",test:function(e){return e&&e.isFraction}},{name:"Unit",test:function(e){return e&&e.isUnit}},{name:"string",test:function(e){return"string"==typeof e}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(e){return e&&e.isMatrix}},{name:"DenseMatrix",test:function(e){return e&&e.isDenseMatrix}},{name:"SparseMatrix",test:function(e){return e&&e.isSparseMatrix}},{name:"Range",test:function(e){return e&&e.isRange}},{name:"Index",test:function(e){return e&&e.isIndex}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"ResultSet",test:function(e){return e&&e.isResultSet}},{name:"Help",test:function(e){return e&&e.isHelp}},{name:"function",test:function(e){return"function"==typeof e}},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:function(e){return"object"==typeof e}},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}},{name:"OperatorNode",test:function(e){return e&&e.isOperatorNode}},{name:"ConstantNode",test:function(e){return e&&e.isConstantNode}},{name:"SymbolNode",test:function(e){return e&&e.isSymbolNode}},{name:"ParenthesisNode",test:function(e){return e&&e.isParenthesisNode}},{name:"FunctionNode",test:function(e){return e&&e.isFunctionNode}},{name:"FunctionAssignmentNode",test:function(e){return e&&e.isFunctionAssignmentNode}},{name:"ArrayNode",test:function(e){return e&&e.isArrayNode}},{name:"AssignmentNode",test:function(e){return e&&e.isAssignmentNode}},{name:"BlockNode",test:function(e){return e&&e.isBlockNode}},{name:"ConditionalNode",test:function(e){return e&&e.isConditionalNode}},{name:"IndexNode",test:function(e){return e&&e.isIndexNode}},{name:"RangeNode",test:function(e){return e&&e.isRangeNode}},{name:"UpdateNode",test:function(e){return e&&e.isUpdateNode}},{name:"Node",test:function(e){return e&&e.isNode}}],t.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(i(t)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e.BigNumber(t)}},{from:"number",to:"Complex",convert:function(t){return new e.Complex(t,0)}},{from:"number",to:"string",convert:function(e){return e+""}},{from:"BigNumber",to:"Complex",convert:function(t){return new e.Complex(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return new e.Complex(t.valueOf(),0)}},{from:"number",
to:"Fraction",convert:function(t){var n=new e.Fraction(t);if(n.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return new e.Fraction(t)}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(t){try{return new e.BigNumber(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){try{return new e.Fraction(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){try{return new e.Complex(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(t){return new e.BigNumber(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return new e.Fraction(+t)}},{from:"boolean",to:"string",convert:function(e){return+e}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new e.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new e.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(t){return new e.DenseMatrix(t)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}],t}},function(e,t,n){"use strict";var r=n(43),i=n(9),o=n(44);e.exports=[{name:"ArgumentsError",path:"error",factory:function(){return r}},{name:"DimensionError",path:"error",factory:function(){return i}},{name:"IndexError",path:"error",factory:function(){return o}}]},function(e,t,n){"use strict";function r(e,t,r,a){function s(e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}var u=r(n(85))();return s.prototype.type="Help",s.prototype.isHelp=!0,s.prototype.toString=function(){var e=this.doc||{},t="\n";if(e.name&&(t+="Name: "+e.name+"\n\n"),e.category&&(t+="Category: "+e.category+"\n\n"),e.description&&(t+="Description:\n    "+e.description+"\n\n"),e.syntax&&(t+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){t+="Examples:\n";for(var n=0;n<e.examples.length;n++){var r=e.examples[n];t+="    "+r+"\n";var i;try{i=u.eval(r)}catch(e){i=e}i&&!i.isHelp&&(t+="        "+o.format(i,{precision:14})+"\n")}t+="\n"}return e.seealso&&(t+="See also: "+e.seealso.join(", ")+"\n"),t},s.prototype.toJSON=function(){var e=i.clone(this.doc);return e.mathjs="Help",e},s.fromJSON=function(e){var t={};for(var n in e)"mathjs"!==n&&(t[n]=e[n]);return new s(t)},s.prototype.valueOf=s.prototype.toString,s}var i=n(5),o=n(11);t.name="Help",t.path="type",t.factory=r},function(e,t){e.exports={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]}},function(e,t){e.exports={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]}},function(e,t){e.exports={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]}},function(e,t){e.exports={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]}},function(e,t){e.exports={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]}},function(e,t){e.exports={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]}},function(e,t){e.exports={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]}},function(e,t){e.exports={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]}},function(e,t){e.exports={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]}},function(e,t){e.exports={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]}},function(e,t){e.exports={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]}},function(e,t){e.exports={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["tau"],seealso:[]}},function(e,t){e.exports={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]}},function(e,t){e.exports={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]}},function(e,t){e.exports={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]}},function(e,t){e.exports={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]}},function(e,t){e.exports={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]}},function(e,t){e.exports={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]}},function(e,t){e.exports={name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]}},function(e,t){e.exports={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]}},function(e,t){e.exports={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]}},function(e,t){e.exports={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]}},function(e,t){e.exports={name:"number",category:"Construction",syntax:["x","number(x)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number("52cm", "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]}},function(e,t){e.exports={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]}},function(e,t){e.exports={name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]}},function(e,t){e.exports={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]}},function(e,t){e.exports={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]}},function(e,t){e.exports={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]}},function(e,t){e.exports={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]}},function(e,t){e.exports={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]}},function(e,t){e.exports={name:"derivative",category:"Algebra",syntax:["derivative(expr)","derivative(expr, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.eval({x: 3})"],seealso:["simplify","parse","eval"]}},function(e,t){e.exports={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]}},function(e,t){e.exports={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]}},function(e,t){e.exports={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]}},function(e,t){e.exports={name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]}},function(e,t){e.exports={name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.eval({x: 2})"],seealso:["derivative","parse","eval"]}},function(e,t){e.exports={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]}},function(e,t){e.exports={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]}},function(e,t){e.exports={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]}},function(e,t){e.exports={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]}},function(e,t){e.exports={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]}},function(e,t){e.exports={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]}},function(e,t){e.exports={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]}},function(e,t){e.exports={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]}},function(e,t){e.exports={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]}},function(e,t){e.exports={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]}},function(e,t){e.exports={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]}},function(e,t){e.exports={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["pow","log"]}},function(e,t){e.exports={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]}},function(e,t){e.exports={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]}},function(e,t){e.exports={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]}},function(e,t){e.exports={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]}},function(e,t){e.exports={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]}},function(e,t){e.exports={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log10"]}},function(e,t){e.exports={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]}},function(e,t){e.exports={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","function isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]}},function(e,t){e.exports={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]}},function(e,t){e.exports={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i))","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)","norm([[1, 2], [3, 4]], 'inf')","norm([[1, 2], [3, 4]], 'fro')"]}},function(e,t){e.exports={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["sqrt","pow"]}},function(e,t){e.exports={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3 = 8","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]}},function(e,t){e.exports={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]}},function(e,t){e.exports={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]}},function(e,t){e.exports={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","multiply"]}},function(e,t){e.exports={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]}},function(e,t){e.exports={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]}},function(e,t){e.exports={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]}},function(e,t){e.exports={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]}},function(e,t){e.exports={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]}},function(e,t){e.exports={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(e,t){e.exports={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(e,t){e.exports={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(e,t){e.exports={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]}},function(e,t){e.exports={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]}},function(e,t){e.exports={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]}},function(e,t){e.exports={name:"rightLogShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]}},function(e,t){e.exports={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]}},function(e,t){e.exports={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]}},function(e,t){e.exports={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]}},function(e,t){e.exports={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]}},function(e,t){e.exports={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]}},function(e,t){e.exports={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]}},function(e,t){e.exports={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]}},function(e,t){e.exports={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]}},function(e,t){e.exports={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]}},function(e,t){e.exports={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]}},function(e,t){e.exports={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]}},function(e,t){e.exports={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]}},function(e,t){e.exports={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]}},function(e,t){e.exports={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]}},function(e,t){e.exports={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]}},function(e,t){e.exports={name:"xor",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 or 4"],seealso:["not","and","or"]}},function(e,t){e.exports={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]}},function(e,t){e.exports={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"dot",category:"Matrix",syntax:["dot(A, B)"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]}},function(e,t){e.exports={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])","eye"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",
examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]}},function(e,t){e.exports={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]}},function(e,t){e.exports={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]}},function(e,t){e.exports={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"kron",category:"Matrix",syntax:["math.kron(x, y)"],description:"Calculates the kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]}},function(e,t){e.exports={name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], function(val) { return value * value })"],seealso:["filter","forEach"]}},function(e,t){e.exports={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])","ones"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]}},function(e,t){e.exports={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])"],seealso:["size","squeeze","resize"]}},function(e,t){e.exports={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]}},function(e,t){e.exports={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc" or "desc", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)'],seealso:["map","filter","forEach"]}},function(e,t){e.exports={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","trace","transpose","zeros"]}},function(e,t){e.exports={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","trace","transpose","zeros"]}},function(e,t){e.exports={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(e,t){e.exports={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","zeros"]}},function(e,t){e.exports={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])","zeros"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose"]}},function(e,t){e.exports={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]}},function(e,t){e.exports={name:"factorial",category:"Probability",syntax:["kldivergence(x, y)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","permutations","gamma"]}},function(e,t){e.exports={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]}},function(e,t){e.exports={name:"kldivergence",category:"Probability",syntax:["n!","factorial(n)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["math.kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]}},function(e,t){e.exports={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai <= 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]}},function(e,t){e.exports={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]}},function(e,t){e.exports={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]}},function(e,t){e.exports={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]}},function(e,t){e.exports={name:"randInt",category:"Probability",syntax:["randInt(max)","randInt(min, max)","randInt(size)","randInt(size, max)","randInt(size, min, max)"],description:"Return a random integer number",examples:["randInt(10, 20)","randInt([2, 3], 10)"],seealso:["pickRandom","random"]}},function(e,t){e.exports={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 if x is larger than y, -1 if x is smaller than y, and 0 if x and y are equal.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq"]}},function(e,t){e.exports={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["[1,3,4] == [1,3,4]","[1,3,4] == [1,3]"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]}},function(e,t){e.exports={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(e,t){e.exports={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]}},function(e,t){e.exports={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 > 1+1","2 >= 1+1","a = 3.2","b = 6-2.8","(a > b)"],seealso:["equal","unequal","smallerEq","smaller","largerEq","compare"]}},function(e,t){e.exports={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]}},function(e,t){e.exports={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 1+1","2 <= 1+1","a = 3.2","b = 6-2.8","(a < b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]}},function(e,t){e.exports={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(e,t){e.exports={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]}},function(e,t){e.exports={name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])","mad(10, 20, 30)"],seealso:["mean","median","std","abs"]}},function(e,t){e.exports={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]}},function(e,t){e.exports={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]}},function(e,t){e.exports={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var","quantileSeq"]}},function(e,t){e.exports={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]}},function(e,t){e.exports={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(5, 2, 7)","mode([3, -1, 5, 7])"],seealso:["max","mean","min","median","prod","std","sum","var"]}},function(e,t){e.exports={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","var"]}},function(e,t){e.exports={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","var"]}},function(e,t){e.exports={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]}},function(e,t){e.exports={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]}},function(e,t){e.exports={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]}},function(e,t){e.exports={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]}},function(e,t){e.exports={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]}},function(e,t){e.exports={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]}},function(e,t){e.exports={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(0.5)"],seealso:["acsch","asech"]}},function(e,t){e.exports={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(0.5)","acsc(csc(0.5))","acsc(2)"],seealso:["csc","asin","asec"]}},function(e,t){e.exports={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]}},function(e,t){e.exports={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]}},function(e,t){e.exports={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]}},function(e,t){e.exports={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(2.3))"],seealso:["sin","acos","atan"]}},function(e,t){e.exports={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]}},function(e,t){e.exports={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(2.3))"],seealso:["tan","acos","asin"]}},function(e,t){e.exports={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]}},function(e,t){e.exports={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]}},function(e,t){e.exports={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]}},function(e,t){e.exports={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]}},function(e,t){e.exports={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]}},function(e,t){e.exports={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]}},function(e,t){e.exports={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]}},function(e,t){e.exports={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]}},function(e,t){e.exports={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]}},function(e,t){e.exports={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]}},function(e,t){e.exports={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]}},function(e,t){e.exports={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]}},function(e,t){e.exports={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]}},function(e,t){e.exports={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]}},function(e,t){e.exports={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]}},function(e,t){e.exports={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]}},function(e,t){e.exports={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]}},function(e,t){e.exports={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(e,t){e.exports={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(e,t){e.exports={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]}},function(e,t){e.exports={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)","isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))",'isNumeric("3")',"isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN"]}},function(e,t){e.exports={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(e,t){e.exports={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(e,t){e.exports={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]}},function(e,t){e.exports={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]}},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(30));return o("compile",{string:function(e){return a(e).compile()},"Array | Matrix":function(e){return i(e,function(e){return a(e).compile()})}})}var i=n(1);t.name="compile",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(30));return o("compile",{string:function(e){var t={};return a(e).compile().eval(t)},"string, Object":function(e,t){return a(e).compile().eval(t)},"Array | Matrix":function(e){var t={};return i(e,function(e){return a(e).compile().eval(t)})},"Array | Matrix, Object":function(e,t){return i(e,function(e){return a(e).compile().eval(t)})}})}var i=n(1);t.name="eval",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i,o){var a=r(n(84));return i("help",{any:function(t){var n,r=t;if("string"!=typeof t)for(n in o)if(o.hasOwnProperty(n)&&t===o[n]){r=n;break}var i=a[r];if(!i)throw new Error('No documentation found on "'+r+'"');return new e.Help(i)}})}t.math=!0,t.name="help",t.factory=r},function(e,t,n){e.exports=[n(329),n(330),n(331),n(333),n(85)]},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(30));return i("parse",{"string | Array | Matrix":o,"string | Array | Matrix, Object":o})}t.name="parse",t.factory=r},function(e,t,n){e.exports=[n(84),n(332),n(336),n(341),n(148),n(30),n(81)]},function(e,t,n){"use strict";function r(e,t,n,r){function i(){throw new Error("UpdateNode is deprecated. Use AssignmentNode instead.")}return i}t.name="UpdateNode",t.path="expression.node",t.factory=r},function(e,t,n){e.exports=[n(86),n(65),n(87),n(88),n(89),n(45),n(66),n(90),n(46),n(13),n(91),n(52),n(53),n(67),n(27),n(335)]},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(55)),u=r(n(0));return function(e,t,n){try{if(Array.isArray(e))return u(e).subset(t,n).valueOf();if(e&&"function"==typeof e.subset)return e.subset(t,n);if("string"==typeof e)return s(e,t,n);if("object"==typeof e){if(!t.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return o(e,t.getObjectProperty(),n),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw i(e)}}}var i=n(31).transform,o=n(17).setSafeProperty;t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(110));return o("concat",{"...any":function(e){var t=e.length-1,n=e[t];"number"==typeof n?e[t]=n-1:n&&n.isBigNumber===!0&&(e[t]=n.minus(1));try{return a.apply(null,e)}catch(e){throw i(e)}}})}var i=n(31).transform;t.name="concat",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t,n){var r,i;if(e[0]&&(r=e[0].compile().eval(n)),e[1])if(e[1]&&e[1].isSymbolNode)i=e[1].compile().eval(n);else{var o=n||{},s=e[1].filter(function(e){return e&&e.isSymbolNode&&!(e.name in t)&&!(e.name in o)})[0],u=Object.create(o),c=e[1].compile();if(!s)throw new Error("No undefined variable found in filter equation");var l=s.name;i=function(e){return u[l]=e,c.eval(u)}}return a(r,i)}var a=r(n(112));return r(n(27)),o.rawArgs=!0,o}t.name="filter",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){return r(n(113)),o("forEach",{"Array | Matrix, function":function(e,t){var n=i(t),r=function(i,o){Array.isArray(i)?i.forEach(function(e,t){r(e,o.concat(t+1))}):1===n?t(i):2===n?t(i,o):t(i,o,e)};r(e.valueOf(),[])}})}var i=n(37).maxArgumentCount;t.name="forEach",t.path="expression.transform",t.factory=r},function(e,t,n){e.exports=[n(338),n(339),n(340),n(342),n(343),n(344),n(345),n(346),n(347),n(348)]},function(e,t,n){"use strict";function r(e,t,n){return function(){for(var t=[],n=0,r=arguments.length;n<r;n++){var i=arguments[n];if(i&&i.isRange===!0)i.start--,i.end-=i.step>0?0:2;else if(i&&i.isSet===!0)i=i.map(function(e){return e-1});else if(i&&(i.isArray===!0||i.isMatrix))i=i.map(function(e){return e-1});else if("number"==typeof i)i--;else if(i&&i.isBigNumber===!0)i=i.toNumber()-1;else if("string"!=typeof i)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");t[n]=i}var o=new e.Index;return e.Index.apply(o,t),o}}t.name="index",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(0));return o("max",{"Array, function":function(e,t){return i(e,t,e)},"Matrix, function":function(e,t){return a(i(e.valueOf(),t,e))}})}function i(e,t,n){function r(e,o){return Array.isArray(e)?e.map(function(e,t){return r(e,o.concat(t+1))}):1===i?t(e):2===i?t(e,o):t(e,o,n)}var i=o(t);return r(e,[])}var o=n(37).maxArgumentCount;t.name="map",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(121));return a("max",{"...any":function(e){if(2==e.length&&o(e[0])){var t=e[1];"number"==typeof t?e[1]=t-1:t&&t.isBigNumber===!0&&(e[1]=t.minus(1))}try{return s.apply(null,e)}catch(e){throw i(e)}}})}var i=n(31).transform,o=n(42);t.name="max",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(122));return a("mean",{"...any":function(e){if(2==e.length&&o(e[0])){var t=e[1];"number"==typeof t?e[1]=t-1:t&&t.isBigNumber===!0&&(e[1]=t.minus(1))}try{return s.apply(null,e)}catch(e){throw i(e)}}})}var i=n(31).transform,o=n(42);t.name="mean",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(124));return a("min",{"...any":function(e){if(2==e.length&&o(e[0])){var t=e[1];"number"==typeof t?e[1]=t-1:t&&t.isBigNumber===!0&&(e[1]=t.minus(1))}try{return s.apply(null,e)}catch(e){throw i(e)}}})}var i=n(31).transform,o=n(42);t.name="min",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(116));return i("range",{"...any":function(e){var t=e.length-1,n=e[t];return"boolean"!=typeof n&&e.push(!0),o.apply(null,e)}})}t.name="range",t.path="expression.transform",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(55));return o("subset",{"...any":function(e){try{return a.apply(null,e)}catch(e){throw i(e)}}})}var i=n(31).transform;t.name="subset",t.path="expression.transform",t.factory=r},function(e,t,n){
"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(33)),s=r(n(54)),u=(r(n(129)),r(n(74))),c=(r(n(51)),r(n(120))),l=(r(n(26)),r(n(106))),f=r(n(48)),h=r(n(108)),p=r(n(32)),m=r(n(20)),d=r(n(19)),v=r(n(22)),g=r(n(21)),y=i("qr",{DenseMatrix:function(e){return w(e)},SparseMatrix:function(e){return x(e)},Array:function(e){var t=o(e),n=w(t);return{Q:n.Q.valueOf(),R:n.R.valueOf()}}}),w=function(e){var t,n,r,i=e._size[0],o=e._size[1],y=s([i],"dense"),w=y._data,x=e.clone(),b=x._data,C=a([i],"");for(r=0;r<Math.min(o,i);++r){var M=b[r][r],T=p(l(M)),N=h(T),E=0;for(t=r;t<i;t++)E=m(E,v(b[t][r],h(b[t][r])));var A=v(T,f(E));if(!u(A)){var S=g(M,A);for(C[r]=1,t=r+1;t<i;t++)C[t]=d(b[t][r],S);var P,O=p(h(d(S,A)));for(n=r;n<o;n++){for(P=0,t=r;t<i;t++)P=m(P,v(h(C[t]),b[t][n]));for(P=v(P,O),t=r;t<i;t++)b[t][n]=v(g(b[t][n],v(C[t],P)),N)}for(t=0;t<i;t++){for(P=0,n=r;n<i;n++)P=m(P,v(w[t][n],C[n]));for(P=v(P,O),n=r;n<i;++n)w[t][n]=d(g(w[t][n],v(P,h(C[n]))),N)}}}for(t=0;t<i;++t)for(n=0;n<t&&n<o;++n){if(c(0,d(b[t][n],1e5)))throw new Error("math.qr(): unknown error - R is not lower triangular (element ("+t+", "+n+")  = "+b[t][n]+")");b[t][n]=v(b[t][n],0)}return{Q:y,R:x,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}},x=function(e){throw new Error("qr not implemented for sparse matrices yet")};return y}t.name="qr",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e){if("log"!=e.name&&"nthRoot"!=e.name||2!=e.args.length){for(var t=0;t<e.args.length;++t)e.args[t]=new u(0);throw e.compile().eval(),new Error("Expected TypeError, but none found")}}var a=r(n(30)),s=r(n(96)),u=r(n(45)),c=r(n(46)),l=r(n(52)),f=r(n(53)),h=r(n(27)),p=i("derivative",{"Node, SymbolNode, Object":function(e,t,n){var r={};d(r,e,t.name);var i=v(e,r);return n.simplify?s(i):i},"Node, SymbolNode":function(e,t){return p(e,t,{simplify:!0})},"string, SymbolNode":function(e,t){return p(a(e),t)},"string, SymbolNode, Object":function(e,t,n){return p(a(e),t,n)},"string, string":function(e,t){return p(a(e),a(t))},"string, string, Object":function(e,t,n){return p(a(e),a(t),n)},"Node, string":function(e,t){return p(e,a(t))},"Node, string, Object":function(e,t,n){return p(e,a(t),n)}});p._simplify=!0,p.toTex=function(e){return m.apply(null,e.args)};var m=i("_derivTex",{"Node, SymbolNode":function(e,t){return m(e.toString(),t.toString(),1)},"Node, SymbolNode, ConstantNode":function(e,t,n){return m(e.toString(),t.name,n.value)},"string, string, number":function(e,t,n){var r;return r=1===n?"{d\\over d"+t+"}":"{d^{"+n+"}\\over d"+t+"^{"+n+"}}",r+"\\left["+e+"\\right]"}}),d=i("constTag",{"Object, ConstantNode, string":function(e,t){return e[t]=!0},"Object, SymbolNode, string":function(e,t,n){return t.name!=n&&(e[t]=!0)},"Object, ParenthesisNode, string":function(e,t,n){return d(e,t.content,n)},"Object, FunctionAssignmentNode, string":function(e,t,n){return t.params.indexOf(n)==-1?e[t]=!0:d(e,t.expr,n)},"Object, FunctionNode | OperatorNode, string":function(e,t,n){if(0!=t.args.length){for(var r=d(e,t.args[0],n),i=1;i<t.args.length;++i)r=d(e,t.args[i],n)&&r;if(r)return e[t]=!0}return!1}}),v=i("_derivative",{"ConstantNode, Object":function(e){return new u("0",e.valueType)},"SymbolNode, Object":function(e,n){return void 0!==n[e]?new u("0",t.number):new u("1",t.number)},"ParenthesisNode, Object":function(e,t){return new f(v(e.content,t))},"FunctionAssignmentNode, Object":function(e,n){return void 0!==n[e]?new u("0",t.number):v(e.expr,n)},"FunctionNode, Object":function(e,n){if(1!=e.args.length&&o(e),void 0!==n[e])return new u("0",t.number);var r,i,a=e.args[0],s=!1,f=!1;switch(e.name){case"cbrt":s=!0,i=new l("*","multiply",[new u("3",t.number),new l("^","pow",[a,new l("/","divide",[new u("2",t.number),new u("3",t.number)])])]);break;case"sqrt":case"nthRoot":if(1==e.args.length){s=!0,i=new l("*","multiply",[new u("2",t.number),new c("sqrt",[a])]);break}return r=new l("/","divide",[new u("1",t.number),e.args[1]]),n[r]=n[e.args[1]],v(new l("^","pow",[a,r]),n);case"log10":r=new u("10",t.number);case"log":if(r||1!=e.args.length){if(!r&&void 0===n[e.args[1]])return v(new l("/","divide",[new c("log",[a]),new c("log",[e.args[1]])]),n);i=new l("*","multiply",[a.clone(),new c("log",[r||e.args[1]])])}else i=a.clone();s=!0;break;case"exp":i=new c("exp",[a.clone()]);break;case"sin":i=new c("cos",[a.clone()]);break;case"cos":i=new l("-","unaryMinus",[new c("sin",[a.clone()])]);break;case"tan":i=new l("^","pow",[new c("sec",[a.clone()]),new u("2",t.number)]);break;case"sec":i=new l("*","multiply",[e,new c("tan",[a.clone()])]);break;case"csc":f=!0,i=new l("*","multiply",[e,new c("cot",[a.clone()])]);break;case"cot":f=!0,i=new l("^","pow",[new c("csc",[a.clone()]),new u("2",t.number)]);break;case"asin":s=!0,i=new c("sqrt",[new l("-","subtract",[new u("1",t.number),new l("^","pow",[a.clone(),new u("2",t.number)])])]);break;case"acos":s=!0,f=!0,i=new c("sqrt",[new l("-","subtract",[new u("1",t.number),new l("^","pow",[a.clone(),new u("2",t.number)])])]);break;case"atan":s=!0,i=new l("+","add",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)]);break;case"asec":s=!0,i=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)])])]);break;case"acsc":s=!0,f=!0,i=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)])])]);break;case"acot":s=!0,f=!0,i=new l("+","add",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)]);break;case"sinh":i=new c("cosh",[a.clone()]);break;case"cosh":i=new c("sinh",[a.clone()]);break;case"tanh":i=new l("^","pow",[new c("sech",[a.clone()]),new u("2",t.number)]);break;case"sech":f=!0,i=new l("*","multiply",[e,new c("tanh",[a.clone()])]);break;case"csch":f=!0,i=new l("*","multiply",[e,new c("coth",[a.clone()])]);break;case"coth":f=!0,i=new l("^","pow",[new c("csch",[a.clone()]),new u("2",t.number)]);break;case"asinh":s=!0,i=new c("sqrt",[new l("+","add",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)])]);break;case"acosh":s=!0,i=new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)])]);break;case"atanh":s=!0,i=new l("-","subtract",[new u("1",t.number),new l("^","pow",[a.clone(),new u("2",t.number)])]);break;case"asech":s=!0,f=!0,i=new l("*","multiply",[a.clone(),new c("sqrt",[new l("-","subtract",[new u("1",t.number),new l("^","pow",[a.clone(),new u("2",t.number)])])])]);break;case"acsch":s=!0,f=!0,i=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("+","add",[new l("^","pow",[a.clone(),new u("2",t.number)]),new u("1",t.number)])])]);break;case"acoth":s=!0,f=!0,i=new l("-","subtract",[new u("1",t.number),new l("^","pow",[a.clone(),new u("2",t.number)])]);break;case"abs":i=new l("/","divide",[new c(new h("abs"),[a.clone()]),a.clone()]);break;case"gamma":default:throw new Error('Function "'+e.name+'" not supported by derivative')}var p,m;s?(p="/",m="divide"):(p="*",m="multiply");var d=v(a,n);return f&&(d=new l("-","unaryMinus",[d])),new l(p,m,[d,i])},"OperatorNode, Object":function(e,n){if(void 0!==n[e])return new u("0",t.number);var r=e.args[0],i=e.args[1];switch(e.op){case"+":case"-":return 1==e.args.length?new l(e.op,e.fn,[v(r,n)]):new l(e.op,e.fn,[v(r,n),v(i,n)]);case"*":if(void 0!==n[r]||void 0!==n[i]){var o=void 0!==n[r]?[r.clone(),v(i,n)]:[i.clone(),v(r,n)];return new l("*","multiply",o)}return new l("+","add",[new l("*","multiply",[v(r,n),i.clone()]),new l("*","multiply",[r.clone(),v(i,n)])]);case"/":return void 0!==n[i]?new l("/","divide",[v(r,n),i]):void 0!==n[r]?new l("*","multiply",[new l("-","unaryMinus",[r]),new l("/","divide",[v(i,n),new l("^","pow",[i.clone(),new u("2",t.number)])])]):new l("/","divide",[new l("-","subtract",[new l("*","multiply",[v(r,n),i.clone()]),new l("*","multiply",[r.clone(),v(i,n)])]),new l("^","pow",[i.clone(),new u("2",t.number)])]);case"^":if(void 0!==n[r])return!r.isConstantNode||"0"!=r.value&&"1"!=r.value?new l("*","multiply",[e,new l("*","multiply",[new c("log",[r.clone()]),v(i.clone(),n)])]):new u("0",t.number);if(void 0!==n[i]){if(i.isConstantNode){var a=i.value;if("0"==a)return new u("0",t.number);if("1"==a)return v(r,n)}var s=new l("^","pow",[r.clone(),new l("-","subtract",[i,new u("1",t.number)])]);return new l("*","multiply",[i.clone(),new l("*","multiply",[v(r,n),s])])}return new l("*","multiply",[new l("^","pow",[r.clone(),i.clone()]),new l("+","add",[new l("*","multiply",[v(r,n),new l("/","divide",[i.clone(),r.clone()])]),new l("*","multiply",[v(i,n),new c("log",[r.clone()])])])]);case"%":case"mod":default:throw new Error('Operator "'+e.op+'" not supported by derivative')}}});return p}t.name="derivative",t.factory=r},function(e,t,n){e.exports=[n(350),n(96),n(349),n(94),n(95),n(98),n(353),n(99)]},function(e,t,n){"use strict";function r(e,t,r,i,o){function a(e){var t=h(e);return t.isNode?t:x(t)}function s(e,t){try{return b(o[e].apply(null,t))}catch(n){return t=t.map(function(e){return e.isFraction?e.valueOf():e}),b(o[e].apply(null,t))}}function u(e){if(isFinite(e)){var t=o.fraction(e);if(t.valueOf()===e)return t}return e}function c(e){return new w("-","unaryMinus",[e])}function l(e){var t,n=e.s*e.n;return t=n<0?new w("-","unaryMinus",[new y(-n)]):new y(n),1===e.d?t:new w("/","divide",[t,new y(e.d)])}function f(e,t,n){return t.reduce(function(t,r){if(t.isNode||r.isNode)t.isNode?r.isNode||(r=x(r)):t=x(t);else{try{return s(e,[t,r])}catch(e){}t=x(t),r=x(r)}return n([t,r])})}function h(e){switch(e.type){case"SymbolNode":return e;case"ConstantNode":return"number"===e.valueType?b(e.value):e;case"FunctionNode":if(o[e.name]&&o[e.name].rawArgs)return e;case"OperatorNode":var t,n,r=e.fn.toString(),i=g(e);if(1===e.args.length)t=[h(e.args[0])],n=t[0].isNode?i(t):s(r,t);else if(d(e))if(t=v(e),t=t.map(h),m(r)){for(var a=[],u=[],c=0;c<t.length;c++)t[c].isNode?u.push(t[c]):a.push(t[c]);a.length>1?(n=f(r,a,i),u.unshift(n),n=f(r,u,i)):n=f(r,t,i)}else n=f(r,t,i);else t=e.args.map(h),n=f(r,t,i);return n;case"ParenthesisNode":return h(e.content);case"AccessorNode":case"ArrayNode":case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"IndexNode":case"ObjectNode":case"RangeNode":case"UpdateNode":case"ConditionalNode":default:throw"Unimplemented node type in simplifyConstant: "+e.type}}var p=r(n(97)),m=p.isCommutative,d=p.isAssociative,v=p.allChildren,g=p.createMakeNodeFunction,y=o.expression.node.ConstantNode,w=o.expression.node.OperatorNode,x=i({Fraction:l,number:function(e){return e<0?c(new y(-e)):new y(e)},BigNumber:function(e){return e<0?c(new y(e.negated().toString(),"number")):new y(e.toString(),"number")},Complex:function(e){throw"Cannot convert Complex number to Node"}}),b=i({string:function(e){return"BigNumber"===t.number?o.bignumber(e):"Fraction"===t.number?o.fraction(e):u(parseFloat(e))},Fraction:function(e){return e},BigNumber:function(e){return e},number:function(e){return u(e)},Complex:function(e){return 0!==e.im?e:u(e.re)}});return a}n(2).digits,t.math=!0,t.name="simplifyConstant",t.path="algebra.simplify",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(0)),s=r(n(94)),u=r(n(95)),c=r(n(359)),l=r(n(68)),f=r(n(99)),h=r(n(98)),p=o("lusolve",{"Array, Array | Matrix":function(e,t){e=a(e);var n=s(e),r=d(n.L,n.U,n.p,null,t);return r.valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var n=s(e);return d(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var n=s(e);return d(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,n,r){var i=u(e,n,r);return d(i.L,i.U,i.p,i.q,t)},"Object, Array | Matrix":function(e,t){return d(e.L,e.U,e.p,e.q,t)}}),m=function(e){if(e&&e.isMatrix===!0)return e;if(i(e))return a(e);throw new TypeError("Invalid Matrix LU decomposition")},d=function(e,t,n,r,i){e=m(e),t=m(t),i=l(e,i,!1),n&&(i._data=c(n,i._data));var o=h(e,i),a=f(t,o);return r&&(a._data=c(r,a._data)),a};return p}var i=Array.isArray;t.name="lusolve",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(69)),o=r(n(358)),a=r(n(102)),s=r(n(18)),u=r(n(12)),c=r(n(56)),l=function(e,t){if(!t||e<=0||e>3)return null;var n=t._size,r=n[0],s=n[1],u=0,c=Math.max(16,10*Math.sqrt(s));c=Math.min(s-2,c);var l=f(e,t,r,s,c);o(l,d,null);for(var v,g,y,w,x,b,C,M,T,N,E,A,S,P,O,_,I=l._index,B=l._ptr,k=B[s],V=[],z=[],F=0,D=s+1,R=2*(s+1),U=3*(s+1),L=4*(s+1),q=5*(s+1),j=6*(s+1),W=7*(s+1),G=V,H=h(s,B,z,F,U,G,R,W,D,j,L,q),$=p(s,B,z,q,L,j,c,D,U,G,R),Z=0;$<s;){for(y=-1;Z<s&&(y=z[U+Z])==-1;Z++);z[R+y]!=-1&&(G[z[R+y]]=-1),z[U+Z]=z[R+y];var Y=z[L+y],X=z[D+y];$+=X;var J=0;z[D+y]=-X;var Q=B[y],K=0===Y?Q:k,ee=K;for(w=1;w<=Y+1;w++){for(w>Y?(b=y,C=Q,M=z[F+y]-Y):(b=I[Q++],C=B[b],M=z[F+b]),x=1;x<=M;x++)v=I[C++],(T=z[D+v])<=0||(J+=T,z[D+v]=-T,I[ee++]=v,z[R+v]!=-1&&(G[z[R+v]]=G[v]),G[v]!=-1?z[R+G[v]]=z[R+v]:z[U+z[q+v]]=z[R+v]);b!=y&&(B[b]=i(y),z[j+b]=0)}for(0!==Y&&(k=ee),z[q+y]=J,B[y]=K,z[F+y]=ee-K,z[L+y]=-2,H=m(H,u,z,j,s),N=K;N<ee;N++)if(v=I[N],!((E=z[L+v])<=0)){T=-z[D+v];var te=H-T;for(Q=B[v],A=B[v]+E-1;Q<=A;Q++)b=I[Q],z[j+b]>=H?z[j+b]-=T:0!==z[j+b]&&(z[j+b]=z[q+b]+te)}for(N=K;N<ee;N++){for(v=I[N],A=B[v],S=A+z[L+v]-1,P=A,O=0,_=0,Q=A;Q<=S;Q++)if(b=I[Q],0!==z[j+b]){var ne=z[j+b]-H;ne>0?(_+=ne,I[P++]=b,O+=b):(B[b]=i(y),z[j+b]=0)}z[L+v]=P-A+1;var re=P,ie=A+z[F+v];for(Q=S+1;Q<ie;Q++){g=I[Q];var oe=z[D+g];oe<=0||(_+=oe,I[P++]=g,O+=g)}0===_?(B[v]=i(y),T=-z[D+v],J-=T,X+=T,$+=T,z[D+v]=0,z[L+v]=-1):(z[q+v]=Math.min(z[q+v],_),I[P]=I[re],I[re]=I[A],I[A]=y,z[F+v]=P-A+1,O=(O<0?-O:O)%s,z[R+v]=z[W+O],z[W+O]=v,G[v]=O)}for(z[q+y]=J,u=Math.max(u,J),H=m(H+u,u,z,j,s),N=K;N<ee;N++)if(v=I[N],!(z[D+v]>=0))for(O=G[v],v=z[W+O],z[W+O]=-1;v!=-1&&z[R+v]!=-1;v=z[R+v],H++){for(M=z[F+v],E=z[L+v],Q=B[v]+1;Q<=B[v]+M-1;Q++)z[j+I[Q]]=H;var ae=v;for(g=z[R+v];g!=-1;){var se=z[F+g]===M&&z[L+g]===E;for(Q=B[g]+1;se&&Q<=B[g]+M-1;Q++)z[j+I[Q]]!=H&&(se=0);se?(B[g]=i(v),z[D+v]+=z[D+g],z[D+g]=0,z[L+g]=-1,g=z[R+g],z[R+ae]=g):(ae=g,g=z[R+g])}}for(Q=K,N=K;N<ee;N++)v=I[N],(T=-z[D+v])<=0||(z[D+v]=T,_=z[q+v]+J-T,_=Math.min(_,s-$-T),z[U+_]!=-1&&(G[z[U+_]]=v),z[R+v]=z[U+_],G[v]=-1,z[U+_]=v,Z=Math.min(Z,_),z[q+v]=_,I[Q++]=v);z[D+y]=X,0===(z[F+y]=Q-K)&&(B[y]=-1,z[j+y]=0),0!==Y&&(k=Q)}for(v=0;v<s;v++)B[v]=i(B[v]);for(g=0;g<=s;g++)z[U+g]=-1;for(g=s;g>=0;g--)z[D+g]>0||(z[R+g]=z[U+B[g]],z[U+B[g]]=g);for(b=s;b>=0;b--)z[D+b]<=0||B[b]!=-1&&(z[R+b]=z[U+B[b]],z[U+B[b]]=b);for(y=0,v=0;v<=s;v++)B[v]==-1&&(y=a(v,y,z,U,R,V,j));return V.splice(V.length-1,1),V},f=function(e,t,n,r,i){var o=c(t);if(1===e&&r===n)return s(t,o);if(2==e){for(var a=o._index,l=o._ptr,f=0,h=0;h<n;h++){var p=l[h];if(l[h]=f,!(l[h+1]-p>i))for(var m=l[h+1];p<m;p++)a[f++]=a[p]}return l[n]=f,t=c(o),u(o,t)}return u(o,t)},h=function(e,t,n,r,i,o,a,s,u,c,l,f){for(var h=0;h<e;h++)n[r+h]=t[h+1]-t[h];n[r+e]=0;for(var p=0;p<=e;p++)n[i+p]=-1,o[p]=-1,n[a+p]=-1,n[s+p]=-1,n[u+p]=1,n[c+p]=1,n[l+p]=0,n[f+p]=n[r+p];var d=m(0,0,n,c,e);return n[l+e]=-2,t[e]=-1,n[c+e]=0,d},p=function(e,t,n,r,o,a,s,u,c,l,f){for(var h=0,p=0;p<e;p++){var m=n[r+p];if(0===m)n[o+p]=-2,h++,t[p]=-1,n[a+p]=0;else if(m>s)n[u+p]=0,n[o+p]=-1,h++,t[p]=i(e),n[u+e]++;else{var d=n[c+m];d!=-1&&(l[d]=p),n[f+p]=n[c+m],n[c+m]=p}}return h},m=function(e,t,n,r,i){if(e<2||e+t<0){for(var o=0;o<i;o++)0!==n[r+o]&&(n[r+o]=1);e=2}return e},d=function(e,t){return e!=t};return l}t.name="cs_amd",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(56)),o=r(n(360)),a=function(e,t,n,r){if(!e||!t||!n)return null;var a,s,u,c,l,f,h,p=e._size,m=p[0],d=p[1],v=4*d+(r?d+m+1:0),g=[],y=0,w=d,x=2*d,b=3*d,C=4*d,M=5*d+1;for(u=0;u<v;u++)g[u]=-1;var T=[],N=i(e),E=N._index,A=N._ptr;for(u=0;u<d;u++)for(s=n[u],T[s]=g[b+s]==-1?1:0;s!=-1&&g[b+s]==-1;s=t[s])g[b+s]=u;if(r){for(u=0;u<d;u++)g[n[u]]=u;for(a=0;a<m;a++){for(u=d,f=A[a],h=A[a+1],l=f;l<h;l++)u=Math.min(u,g[E[l]]);g[M+a]=g[C+u],g[C+u]=a}}for(a=0;a<d;a++)g[y+a]=a;for(u=0;u<d;u++){for(s=n[u],t[s]!=-1&&T[t[s]]--,c=r?g[C+u]:s;c!=-1;c=r?g[M+c]:-1)for(l=A[c];l<A[c+1];l++){a=E[l];var S=o(a,s,g,b,w,x,y);S.jleaf>=1&&T[s]++,2==S.jleaf&&T[S.q]--}t[s]!=-1&&(g[y+s]=t[s])}for(s=0;s<d;s++)t[s]!=-1&&(T[t[s]]+=T[s]);return T};return a}t.name="cs_counts",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(101)),o=r(n(100)),a=r(n(367)),s=function(e,t,n,r,s){var u,c,l,f=t._index,h=t._ptr,p=t._size,m=p[1],d=0;for(r[0]=e;d>=0;){e=r[d];var v=s?s[e]:e;i(h,e)||(o(h,e),r[m+d]=v<0?0:a(h[v]));var g=1;for(c=r[m+d],l=v<0?0:a(h[v+1]);c<l;c++)if(u=f[c],!i(h,u)){r[m+d]=c,r[++d]=u,g=0;break}g&&(d--,r[--n]=e)}return n};return s}t.name="cs_dfs",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t){if(!e)return null;var n,r,i=e._index,o=e._ptr,a=e._size,s=a[0],u=a[1],c=[],l=[],f=0,h=u;if(t)for(n=0;n<s;n++)l[h+n]=-1;for(var p=0;p<u;p++){c[p]=-1,l[f+p]=-1;for(var m=o[p],d=o[p+1],v=m;v<d;v++){var g=i[v];for(n=t?l[h+g]:g;n!=-1&&n<p;n=r)r=l[f+n],l[f+n]=p,r==-1&&(c[n]=p);t&&(l[h+g]=p)}}return c};return e}t.name="cs_etree",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t,n){for(var r=e._values,i=e._index,o=e._ptr,a=e._size,s=a[1],u=0,c=0;c<s;c++){var l=o[c];for(o[c]=u;l<o[c+1];l++)t(i[l],c,r?r[l]:1,n)&&(i[u]=i[l],r&&(r[u]=r[l]),u++)}return o[s]=u,i.splice(u,i.length-u),r&&r.splice(u,r.length-u),u};return e}t.name="cs_fkeep",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t,n){var r,n=t.length,i=[];if(e)for(r=0;r<n;r++)i[e[r]]=t[r];else for(r=0;r<n;r++)i[r]=t[r];return i};return e}t.name="cs_ipvec",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(){var e=function(e,t,n,r,i,o,a){var s,u,c,l,f=0;if(e<=t||n[r+t]<=n[i+e])return-1;if(n[i+e]=n[r+t],c=n[o+e],n[o+e]=t,c===-1)f=1,l=e;else{for(f=2,l=c;l!=n[a+l];l=n[a+l]);for(s=c;s!=l;s=u)u=n[a+s],n[a+s]=l}return{jleaf:f,q:l}};return e}t.name="cs_leaf",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(26)),o=r(n(19)),a=r(n(12)),s=r(n(28)),u=r(n(119)),c=r(n(365)),l=e.SparseMatrix,f=function(e,t,n){if(!e)return null;var r,f=e._size,h=f[1],p=100,m=100;t&&(r=t.q,p=t.lnz||p,m=t.unz||m);var d,v,g=[],y=[],w=[],x=new l({values:g,index:y,ptr:w,size:[h,h]}),b=[],C=[],M=[],T=new l({values:b,index:C,ptr:M,size:[h,h]}),N=[],E=[],A=[];for(d=0;d<h;d++)E[d]=0,N[d]=-1,w[d+1]=0;p=0,m=0;for(var S=0;S<h;S++){w[S]=p,M[S]=m;var P=r?r[S]:S,O=c(x,e,P,A,E,N,1),_=-1,I=-1;for(v=O;v<h;v++)if(d=A[v],N[d]<0){var B=i(E[d]);s(B,I)&&(I=B,_=d)}else C[m]=N[d],b[m++]=E[d];if(_==-1||I<=0)return null;N[P]<0&&u(i(E[P]),a(I,n))&&(_=P);var k=E[_];for(C[m]=S,b[m++]=k,N[_]=S,y[p]=_,g[p++]=1,v=O;v<h;v++)d=A[v],N[d]<0&&(y[p]=d,g[p++]=o(E[d],k)),E[d]=0}for(w[h]=p,M[h]=m,v=0;v<p;v++)y[v]=N[y[v]];return g.splice(p,g.length-p),y.splice(p,y.length-p),b.splice(m,b.length-m),C.splice(m,C.length-m),{L:x,U:T,pinv:N}};return f}t.name="cs_lu",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e){var t=e.SparseMatrix,n=function(e,n,r,i){for(var o=e._values,a=e._index,s=e._ptr,u=e._size,c=e._datatype,l=u[0],f=u[1],h=i&&e._values?[]:null,p=[],m=[],d=0,v=0;v<f;v++){m[v]=d;for(var g=r?r[v]:v,y=s[g],w=s[g+1],x=y;x<w;x++){var b=n?n[a[x]]:a[x];p[d]=b,h&&(h[d]=o[x]),d++}}return m[f]=d,new t({values:h,index:p,ptr:m,size:[l,f],datatype:c})};return n}t.name="cs_permute",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(102)),o=function(e,t){if(!e)return null;var n,r=0,o=[],a=[],s=0,u=t,c=2*t;for(n=0;n<t;n++)a[s+n]=-1;for(n=t-1;n>=0;n--)e[n]!=-1&&(a[u+n]=a[s+e[n]],a[s+e[n]]=n);for(n=0;n<t;n++)e[n]==-1&&(r=i(n,r,a,s,u,o,c));return o};return o}t.name="cs_post",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(356)),o=r(n(101)),a=r(n(100)),s=function(e,t,n,r,s){var u,c,l,f=e._ptr,h=e._size,p=t._index,m=t._ptr,d=h[1],v=d;for(c=m[n],l=m[n+1],u=c;u<l;u++){var g=p[u];o(f,g)||(v=i(g,e,v,r,s))}for(u=v;u<d;u++)a(f,r[u]);return v};return s}t.name="cs_reach",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(19)),o=r(n(12)),a=r(n(21)),s=r(n(364)),u=function(e,t,n,r,u,c,l){var f,h,p,m,d=e._values,v=e._index,g=e._ptr,y=e._size,w=y[1],x=t._values,b=t._index,C=t._ptr,M=s(e,t,n,r,c);for(f=M;f<w;f++)u[r[f]]=0;for(h=C[n],p=C[n+1],f=h;f<p;f++)u[b[f]]=x[f];for(var T=M;T<w;T++){var N=r[T],E=c?c[N]:N;if(!(E<0))for(h=g[E],p=g[E+1],u[N]=i(u[N],d[l?h:p-1]),f=l?h+1:h,m=l?p:p-1;f<m;f++){var A=v[f];u[A]=a(u[A],o(d[f],u[N]))}}return M};return u}t.name="cs_spsolve",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(354)),o=r(n(362)),a=r(n(357)),s=r(n(363)),u=r(n(355)),c=function(e,t,n){var r,c=t._ptr,f=t._size,h=f[1],p={};if(p.q=i(e,t),e&&!p.q)return null;if(n){var m=e?o(t,null,p.q,0):t;p.parent=a(m,1);var d=s(p.parent,h);if(p.cp=u(m,p.parent,d,1),m&&p.parent&&p.cp&&l(m,p))for(p.unz=0,r=0;r<h;r++)p.unz+=p.cp[r]}else p.unz=4*c[h]+h,p.lnz=p.unz;return p},l=function(e,t){var n=e._ptr,r=e._index,i=e._size,o=i[0],a=i[1];t.pinv=[],t.leftmost=[];var s,u,c,l,f,h=t.parent,p=t.pinv,m=t.leftmost,d=[],v=0,g=o,y=o+a,w=o+2*a;for(u=0;u<a;u++)d[g+u]=-1,d[y+u]=-1,d[w+u]=0;for(s=0;s<o;s++)m[s]=-1;for(u=a-1;u>=0;u--)for(l=n[u],f=n[u+1],c=l;c<f;c++)m[r[c]]=u;for(s=o-1;s>=0;s--)p[s]=-1,u=m[s],u!=-1&&(0===d[w+u]++&&(d[y+u]=s),d[v+s]=d[g+u],d[g+u]=s);for(t.lnz=0,t.m2=o,u=0;u<a;u++)if(s=d[g+u],t.lnz++,s<0&&(s=t.m2++),p[s]=u,!(--w[u]<=0)){t.lnz+=d[w+u];var x=h[u];x!=-1&&(0===d[w+x]&&(d[y+x]=d[y+u]),d[v+d[y+u]]=d[g+x],d[g+x]=d[v+s],d[w+x]+=d[w+u])}for(s=0;s<o;s++)p[s]<0&&(p[s]=u++);return!0};return c}t.name="cs_sqr",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){var i=r(n(69)),o=function(e){return e<0?i(e):e};return o}t.name="cs_unflip",t.path="sparse",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(n,r){var i=n.arg()/3,a=n.abs(),s=new e.Complex(o(a),0).mul(new e.Complex(0,i).exp());if(r){var u=[s,new e.Complex(o(a),0).mul(new e.Complex(0,i+2*Math.PI/3).exp()),new e.Complex(o(a),0).mul(new e.Complex(0,i-2*Math.PI/3).exp())];return"Array"===t.matrix?u:f(u)}return s}function u(t){if(t.value&&t.value.isComplex){var n=t.clone();return n.value=1,n=n.pow(1/3),n.value=s(t.value),n}var r=l(t.value);r&&(t.value=c(t.value));var i;i=t.value&&t.value.isBigNumber?new e.BigNumber(1).div(3):t.value&&t.value.isFraction?new e.Fraction(1,3):1/3;var n=t.pow(i);return r&&(n.value=c(n.value)),n}var c=r(n(32)),l=r(n(50)),f=r(n(0)),h=a("cbrt",{number:o,Complex:s,"Complex, boolean":s,BigNumber:function(e){return e.cbrt()},Unit:u,"Array | Matrix":function(e){return i(e,h,!0)}});return h.toTex={1:"\\sqrt[3]{${args[0]}}"},h}var i=n(1),o=Math.cbrt||function(e){if(0===e)return e;var t,n=e<0;return n&&(e=-e),isFinite(e)?(t=Math.exp(Math.log(e)/3),t=(e/(t*t)+2*t)/3):t=e,n?-t:t};t.name="cbrt",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("ceil",{number:Math.ceil,Complex:function(e){return e.ceil()},BigNumber:function(e){return e.ceil()},Fraction:function(e){return e.ceil()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\left\\lceil${args[0]}\\right\\rceil"},o}var i=n(1);t.name="ceil",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("cube",{number:function(e){return e*e*e},Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},Fraction:function(e){return e.pow(3)},"Array | Matrix":function(e){return i(e,o,!0)},Unit:function(e){return e.pow(3)}});return o.toTex={1:"\\left(${args[0]}\\right)^3"},o}var i=n(1);t.name="cube",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(22)),s=n(4),u=r(n(23)),c=r(n(135)),l=r(n(15)),f=r(n(8)),h=r(n(6)),p=i("dotMultiply",{"any, any":a,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,a,!1);break;default:n=u(t,e,a,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,a,!1);break;default:n=f(e,t,a)}}return n},"Array, Array":function(e,t){return p(o(e),o(t)).valueOf()},"Array, Matrix":function(e,t){return p(o(e),t)},"Matrix, Array":function(e,t){return p(e,o(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,a,!1);break;default:n=h(e,t,a,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,a,!0);break;default:n=h(t,e,a,!0)}return n},"Array, any":function(e,t){return h(o(e),t,a,!1).valueOf()},"any, Array":function(e,t){return h(o(t),e,a,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+s.operators.dotMultiply+"${args[1]}\\right)"},p}t.name="dotMultiply",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(39)),s=n(4),u=r(n(14)),c=r(n(24)),l=r(n(15)),f=r(n(16)),h=r(n(8)),p=r(n(6)),m=i("dotPow",{"any, any":a,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,a,!1);break;default:n=u(t,e,a,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,a,!1);break;default:n=h(e,t,a)}}return n},"Array, Array":function(e,t){return m(o(e),o(t)).valueOf()},"Array, Matrix":function(e,t){return m(o(e),t)},"Matrix, Array":function(e,t){return m(e,o(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=p(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=f(t,e,m,!0);break;default:n=p(t,e,m,!0)}return n},"Array, any":function(e,t){return p(o(e),t,m,!1).valueOf()},"any, Array":function(e,t){return p(o(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.dotPow+"${args[1]}\\right)"},m}t.name="dotPow",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("exp",{number:Math.exp,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\exp\\left(${args[0]}\\right)"},o}var i=n(1);t.name="exp",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("floor",{number:Math.floor,Complex:function(e){return e.floor()},BigNumber:function(e){return e.floor()},Fraction:function(e){return e.floor()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\left\\lfloor${args[0]}\\right\\rfloor"},o}var i=n(1);t.name="floor",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(t,n){if(!t.isInt()||!n.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var r=new e.BigNumber(0);!n.isZero();){var i=t.mod(n);t=n,n=i}return t.lt(r)?t.neg():t}var s=r(n(0)),u=r(n(29)),c=r(n(76)),l=r(n(34)),f=r(n(8)),h=r(n(6)),p=o("gcd",{"number, number":i,"BigNumber, BigNumber":a,"Fraction, Fraction":function(e,t){return e.gcd(t)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,p);break;default:n=u(t,e,p,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,p,!1);break;default:n=f(e,t,p)}}return n},"Array, Array":function(e,t){return p(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return p(s(e),t)},"Matrix, Array":function(e,t){return p(e,s(t))},"Matrix, number | BigNumber":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,p,!1);break;default:n=h(e,t,p,!1)}return n},"number | BigNumber, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,p,!0);break;default:n=h(t,e,p,!0)}return n},"Array, number | BigNumber":function(e,t){return h(s(e),t,p,!1).valueOf()},"number | BigNumber, Array":function(e,t){return h(s(t),e,p,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(e,t,n){for(var r=p(e,t),i=0;i<n.length;i++)r=p(r,n[i]);return r}});return p.toTex="\\gcd\\left(${args}\\right)",p}function i(e,t){if(!o(e)||!o(t))throw new Error("Parameters in function gcd must be integer numbers");for(var n;0!=t;)n=e%t,e=t,t=n;return e<0?-e:e}var o=n(2).isInteger;t.name="gcd",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e){for(var t=0,n=0,r=0;r<e.length;r++){var i=s(e[r]);h(n,i)?(t=l(t,l(c(n,i),c(n,i))),t=u(t,1),n=i):t=u(t,p(i)?l(c(i,n),c(i,n)):i)}return l(n,f(t))}var s=r(n(26)),u=r(n(20)),c=r(n(19)),l=r(n(22)),f=r(n(48)),h=r(n(40)),p=r(n(51)),m=o("hypot",{"... number | BigNumber":a,Array:function(e){return m.apply(m,i(e))},Matrix:function(e){return m.apply(m,i(e.toArray()))}});return m.toTex="\\hypot\\left(${args}\\right)",m}var i=n(3).flatten;t.name="hypot",t.factory=r},function(e,t,n){e.exports=[n(26),n(18),n(20),n(368),n(369),n(370),n(38),n(103),n(371),n(372),n(373),n(104),n(374),n(375),n(376),n(378),n(105),n(379),n(380),n(12),n(381),n(382),n(39),n(383),n(106),n(48),n(384),n(21),n(32),n(385),n(386)]},function(e,t,n){"use strict";function r(e,t,r,o){function a(t,n){if(!t.isInt()||!n.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(t.isZero()||n.isZero())return new e.BigNumber(0);for(var r=t.times(n);!n.isZero();){var i=n;n=t.mod(i),t=i}return r.div(t).abs()}var s=r(n(0)),u=r(n(23)),c=r(n(60)),l=r(n(15)),f=r(n(8)),h=r(n(6)),p=o("lcm",{"number, number":i,"BigNumber, BigNumber":a,"Fraction, Fraction":function(e,t){return e.lcm(t)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,p);break;default:n=u(t,e,p,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,p,!1);break;default:n=f(e,t,p)}}return n},"Array, Array":function(e,t){return p(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return p(s(e),t)},"Matrix, Array":function(e,t){return p(e,s(t))},"Matrix, number | BigNumber":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,p,!1);break;default:n=h(e,t,p,!1)}return n},"number | BigNumber, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,p,!0);break;default:n=h(t,e,p,!0)}return n},"Array, number | BigNumber":function(e,t){return h(s(e),t,p,!1).valueOf()},"number | BigNumber, Array":function(e,t){return h(s(t),e,p,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(e,t,n){for(var r=p(e,t),i=0;i<n.length;i++)r=p(r,n[i]);return r}});return p.toTex=void 0,p}function i(e,t){if(!o(e)||!o(t))throw new Error("Parameters in function lcm must be integer numbers");if(0==e||0==t)return 0;for(var n,r=e*t;0!=t;)n=t,t=e%n,e=n;return Math.abs(r/e)}var o=n(2).isInteger;t.name="lcm",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("log10",{number:function(n){return n>=0||t.predictable?o(n):new e.Complex(n,0).log().div(Math.LN10)},Complex:function(t){return new e.Complex(t).log().div(Math.LN10)},BigNumber:function(n){return!n.isNegative()||t.predictable?n.log():new e.Complex(n.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(e){return i(e,a)}});return a.toTex={1:"\\log_{10}\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.log10||function(e){return Math.log(e)/Math.LN10};t.name="log10",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t){if(t>0)return e-t*Math.floor(e/t);if(0===t)return e;throw new Error("Cannot calculate mod for a negative divisor")}var a=r(n(0)),s=n(4),u=r(n(23)),c=r(n(14)),l=r(n(59)),f=r(n(15)),h=r(n(16)),p=r(n(8)),m=r(n(6)),d=i("mod",{"number, number":o,"BigNumber, BigNumber":function(e,t){return t.isZero()?e:e.mod(t)},"Fraction, Fraction":function(e,t){return e.mod(t)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,d,!1);break;default:n=u(t,e,d,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,d,!1);break;default:n=p(e,t,d)}}return n},"Array, Array":function(e,t){return d(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return d(a(e),t)},"Matrix, Array":function(e,t){return d(e,a(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,d,!1);break;default:n=m(e,t,d,!1)}return n},"any, Matrix":function(e,t){
var n;switch(t.storage()){case"sparse":n=h(t,e,d,!0);break;default:n=m(t,e,d,!0)}return n},"Array, any":function(e,t){return m(a(e),t,d,!1).valueOf()},"any, Array":function(e,t){return m(a(t),e,d,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+s.operators.mod+"${args[1]}\\right)"},d}t.name="mod",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t){var n=e.size();if(1==n.length){if(t===Number.POSITIVE_INFINITY||"inf"===t){var r=0;return e.forEach(function(e){var t=a(e);h(t,r)&&(r=t)},!0),r}if(t===Number.NEGATIVE_INFINITY||"-inf"===t){var i;return e.forEach(function(e){var t=a(e);i&&!p(t,i)||(i=t)},!0),i||0}if("fro"===t)return o(e,2);if("number"==typeof t&&!isNaN(t)){if(!f(t,0)){var m=0;return e.forEach(function(e){m=s(u(a(e),t),m)},!0),u(m,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2==n.length){if(1===t){var g=[],y=0;return e.forEach(function(e,t){var n=t[1],r=s(g[n]||0,a(e));h(r,y)&&(y=r),g[n]=r},!0),y}if(t===Number.POSITIVE_INFINITY||"inf"===t){var w=[],x=0;return e.forEach(function(e,t){var n=t[0],r=s(w[n]||0,a(e));h(r,x)&&(x=r),w[n]=r},!0),x}if("fro"===t)return c(d(l(v(e),e)));if(2===t)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}var a=r(n(26)),s=r(n(18)),u=r(n(39)),c=r(n(48)),l=r(n(12)),f=r(n(10)),h=r(n(28)),p=r(n(40)),m=r(n(0)),d=r(n(117)),v=r(n(56)),g=i("norm",{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},"boolean | null":function(e){return Math.abs(e)},Array:function(e){return o(m(e),2)},Matrix:function(e){return o(e,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(e){return g(e)},"Array, number | BigNumber | string":function(e,t){return o(m(e),t)},"Matrix, number | BigNumber | string":function(e,t){return o(e,t)}});return g.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0},g}t.name="norm",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(t,n){var r=e.BigNumber.precision,i=e.BigNumber.clone({precision:r+2}),o=new e.BigNumber(0),a=new i(1),s=n.isNegative();if(s&&(n=n.neg()),n.isZero())throw new Error("Root must be non-zero");if(t.isNegative()&&!n.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(t.isZero())return s?new i(1/0):0;if(!t.isFinite())return s?o:t;var u=t.abs().pow(a.div(n));return u=t.isNeg()?u.neg():u,new e.BigNumber((s?a.div(u):u).toPrecision(r))}var u=r(n(0)),c=r(n(29)),l=r(n(23)),f=r(n(60)),h=r(n(15)),p=r(n(8)),m=r(n(6)),d=a("nthRoot",{number:function(e){return i(e,2)},"number, number":i,BigNumber:function(t){return s(t,new e.BigNumber(2))},Complex:function(e){return o(e,2)},"Complex, number":o,"BigNumber, BigNumber":s,"Array | Matrix":function(e){return d(e,2)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":if(1!==t.density())throw new Error("Root must be non-zero");n=f(e,t,d);break;default:n=l(t,e,d,!0)}break;default:switch(t.storage()){case"sparse":if(1!==t.density())throw new Error("Root must be non-zero");n=c(e,t,d,!1);break;default:n=p(e,t,d)}}return n},"Array, Array":function(e,t){return d(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return d(u(e),t)},"Matrix, Array":function(e,t){return d(e,u(t))},"Matrix, number | BigNumber":function(e,t){var n;switch(e.storage()){case"sparse":n=h(e,t,d,!1);break;default:n=m(e,t,d,!1)}return n},"number | BigNumber, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":if(1!==t.density())throw new Error("Root must be non-zero");n=h(t,e,d,!0);break;default:n=m(t,e,d,!0)}return n},"Array, number | BigNumber":function(e,t){return d(u(e),t).valueOf()},"number | BigNumber, Array":function(e,t){return d(e,u(t)).valueOf()}});return d.toTex={2:"\\sqrt[${args[1]}]{${args[0]}}"},d}function i(e,t){var n=t<0;if(n&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!=1)throw new Error("Root must be odd when a is negative.");if(0==e)return n?1/0:0;if(!isFinite(e))return n?0:e;var r=Math.pow(Math.abs(e),1/t);return r=e<0?-r:r,n?1/r:r}function o(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!==0)throw new Error("Root must be an integer");for(var n=e.arg(),r=e.abs(),i=[],o=Math.pow(r,1/t),a=0;a<t;a++)i.push({r:o,phi:(n+2*Math.PI*a)/t});return i}t.name="nthRoot",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var c=r(n(0)),l=r(n(10)),f=r(n(33)),h=r(n(15)),p=r(n(16)),m=r(n(6)),d=a("round",{number:Math.round,"number, number":function(e,t){if(!o(t))throw new TypeError(u);if(t<0||t>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return i(e,t)},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(u);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(u);var n=t.toNumber();return e.round(n)},"number, BigNumber":function(t,n){if(!n.isInteger())throw new TypeError(u);return new e.BigNumber(t).toDecimalPlaces(n.toNumber())},BigNumber:function(e){return e.toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(u);return e.toDecimalPlaces(t.toNumber())},Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(u);return e.round(t)},"Array | Matrix":function(e){return s(e,d,!0)},"Matrix, number | BigNumber":function(e,t){var n;switch(e.storage()){case"sparse":n=h(e,t,d,!1);break;default:n=m(e,t,d,!1)}return n},"number | Complex | BigNumber, Matrix":function(e,t){if(!l(e,0)){var n;switch(t.storage()){case"sparse":n=p(t,e,d,!0);break;default:n=m(t,e,d,!0)}return n}return f(t.size(),t.storage())},"Array, number | BigNumber":function(e,t){return m(c(e),t,d,!1).valueOf()},"number | Complex | BigNumber, Array":function(e,t){return m(c(t),e,d,!0).valueOf()}});return d.toTex={1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},d}function i(e,t){return parseFloat(a(e,t))}var o=n(2).isInteger,a=n(2).toFixed,s=n(1),u="Number of decimals in function round must be an integer";t.name="round",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("square",{number:function(e){return e*e},Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},Fraction:function(e){return e.mul(e)},"Array | Matrix":function(e){return i(e,o,!0)},Unit:function(e){return e.pow(2)}});return o.toTex={1:"\\left(${args[0]}\\right)^2"},o}var i=n(1);t.name="square",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=o("unaryPlus",{number:function(e){return e},Complex:function(e){return e},BigNumber:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":function(e){return i(e,s,!0)},"boolean | string | null":function(n){return"BigNumber"==t.number?new e.BigNumber(+n):+n}});return s.toTex={1:a.operators.unaryPlus+"\\left(${args[0]}\\right)"},s}var i=n(1);t.name="unaryPlus",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,n){var r,o,a,s=0,c=1,l=1,f=0;if(!i(e)||!i(n))throw new Error("Parameters in function xgcd must be integer numbers");for(;n;)o=Math.floor(e/n),a=e-o*n,r=s,s=c-o*s,c=r,r=l,l=f-o*l,f=r,e=n,n=a;var h;return h=e<0?[-e,-c,-f]:[e,e?c:0,f],"Array"===t.matrix?h:u(h)}function s(n,r){var i,o,a,s=new e.BigNumber(0),c=new e.BigNumber(1),l=s,f=c,h=c,p=s;if(!n.isInt()||!r.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!r.isZero();)o=n.div(r).floor(),a=n.mod(r),i=l,l=f.minus(o.times(l)),f=i,i=h,h=p.minus(o.times(h)),p=i,n=r,r=a;var m;return m=n.lt(s)?[n.neg(),f.neg(),p.neg()]:[n,n.isZero()?0:f,p],"Array"===t.matrix?m:u(m)}var u=r(n(0)),c=o("xgcd",{"number, number":a,"BigNumber, BigNumber":s});return c.toTex=void 0,c}var i=n(2).isInteger;t.name="xgcd",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(23)),l=r(n(60)),f=r(n(15)),h=r(n(8)),p=r(n(6)),m=a("bitAnd",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function bitAnd");return e&t},"BigNumber, BigNumber":o,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=c(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,m,!1);break;default:n=h(e,t,m)}}return n},"Array, Array":function(e,t){return m(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return m(u(e),t)},"Matrix, Array":function(e,t){return m(e,u(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,m,!1);break;default:n=p(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=f(t,e,m,!0);break;default:n=p(t,e,m,!0)}return n},"Array, any":function(e,t){return p(u(e),t,m,!1).valueOf()},"any, Array":function(e,t){return p(u(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.bitAnd+"${args[1]}\\right)"},m}var i=n(2).isInteger,o=n(503);t.name="bitAnd",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){var u=n(4),c=s("bitNot",{number:function(e){if(!a(e))throw new Error("Integer expected in function bitNot");return~e},BigNumber:o,"Array | Matrix":function(e){return i(e,c)}});return c.toTex={1:u.operators.bitNot+"\\left(${args[0]}\\right)"},c}var i=n(1),o=n(79),a=n(2).isInteger;t.name="bitNot",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(29)),l=r(n(76)),f=r(n(34)),h=r(n(8)),p=r(n(6)),m=a("bitOr",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function bitOr");return e|t},"BigNumber, BigNumber":o,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,m);break;default:n=c(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,m,!1);break;default:n=h(e,t,m)}}return n},"Array, Array":function(e,t){return m(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return m(u(e),t)},"Matrix, Array":function(e,t){return m(e,u(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,m,!1);break;default:n=p(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=f(t,e,m,!0);break;default:n=p(t,e,m,!0)}return n},"Array, any":function(e,t){return p(u(e),t,m,!1).valueOf()},"any, Array":function(e,t){return p(u(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.bitOr+"${args[1]}\\right)"},m}var i=n(2).isInteger,o=n(504);t.name="bitOr",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(14)),l=r(n(24)),f=r(n(16)),h=r(n(8)),p=r(n(6)),m=a("bitXor",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function bitXor");return e^t},"BigNumber, BigNumber":o,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,m);break;default:n=c(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,m,!1);break;default:n=h(e,t,m)}}return n},"Array, Array":function(e,t){return m(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return m(u(e),t)},"Matrix, Array":function(e,t){return m(e,u(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=f(e,t,m,!1);break;default:n=p(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=f(t,e,m,!0);break;default:n=p(t,e,m,!0)}return n},"Array, any":function(e,t){return p(u(e),t,m,!1).valueOf()},"any, Array":function(e,t){return p(u(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.bitXor+"${args[1]}\\right)"},m}var i=n(2).isInteger,o=n(505);t.name="bitXor",t.factory=r},function(e,t,n){e.exports=[n(387),n(388),n(389),n(390),n(392),n(393),n(394)]},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(10)),l=r(n(33)),f=r(n(29)),h=r(n(23)),p=r(n(77)),m=r(n(34)),d=r(n(15)),v=r(n(8)),g=r(n(6)),y=a("leftShift",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function leftShift");return e<<t},"BigNumber, BigNumber":o,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=p(e,t,y,!1);break;default:n=h(t,e,y,!0)}break;default:switch(t.storage()){case"sparse":n=f(e,t,y,!1);break;default:n=v(e,t,y)}}return n},"Array, Array":function(e,t){return y(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return y(u(e),t)},"Matrix, Array":function(e,t){return y(e,u(t))},"Matrix, number | BigNumber":function(e,t){if(!c(t,0)){var n;switch(e.storage()){case"sparse":n=d(e,t,y,!1);break;default:n=g(e,t,y,!1)}return n}return e.clone()},"number | BigNumber, Matrix":function(e,t){if(!c(e,0)){var n;switch(t.storage()){case"sparse":n=m(t,e,y,!0);break;default:n=g(t,e,y,!0)}return n}return l(t.size(),t.storage())},"Array, number | BigNumber":function(e,t){return y(u(e),t).valueOf()},"number | BigNumber, Array":function(e,t){return y(e,u(t)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+s.operators.leftShift+"${args[1]}\\right)"},y}var i=n(2).isInteger,o=n(507);t.name="leftShift",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=n(4),u=r(n(0)),c=r(n(10)),l=r(n(33)),f=r(n(29)),h=r(n(23)),p=r(n(77)),m=r(n(34)),d=r(n(15)),v=r(n(8)),g=r(n(6)),y=a("rightArithShift",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function rightArithShift");return e>>t},"BigNumber, BigNumber":o,"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=p(e,t,y,!1);break;default:n=h(t,e,y,!0)}break;default:switch(t.storage()){case"sparse":n=f(e,t,y,!1);break;default:n=v(e,t,y)}}return n},"Array, Array":function(e,t){return y(u(e),u(t)).valueOf()},"Array, Matrix":function(e,t){return y(u(e),t)},"Matrix, Array":function(e,t){return y(e,u(t))},"Matrix, number | BigNumber":function(e,t){if(!c(t,0)){var n;switch(e.storage()){case"sparse":n=d(e,t,y,!1);break;default:n=g(e,t,y,!1)}return n}return e.clone()},"number | BigNumber, Matrix":function(e,t){if(!c(e,0)){var n;switch(t.storage()){case"sparse":n=m(t,e,y,!0);break;default:n=g(t,e,y,!0)}return n}return l(t.size(),t.storage())},"Array, number | BigNumber":function(e,t){return y(u(e),t).valueOf()},"number | BigNumber, Array":function(e,t){return y(e,u(t)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+s.operators.rightArithShift+"${args[1]}\\right)"},y}var i=n(2).isInteger,o=n(508);t.name="rightArithShift",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=r(n(0)),u=r(n(10)),c=r(n(33)),l=r(n(29)),f=r(n(23)),h=r(n(77)),p=r(n(34)),m=r(n(15)),d=r(n(8)),v=r(n(6)),g=o("rightLogShift",{"number, number":function(e,t){if(!i(e)||!i(t))throw new Error("Integers expected in function rightLogShift");return e>>>t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=h(e,t,g,!1);break;default:n=f(t,e,g,!0)}break;default:switch(t.storage()){case"sparse":n=l(e,t,g,!1);break;default:n=d(e,t,g)}}return n},"Array, Array":function(e,t){return g(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return g(s(e),t)},"Matrix, Array":function(e,t){return g(e,s(t))},"Matrix, number | BigNumber":function(e,t){if(!u(t,0)){var n;switch(e.storage()){case"sparse":n=m(e,t,g,!1);break;default:n=v(e,t,g,!1)}return n}return e.clone()},"number | BigNumber, Matrix":function(e,t){if(!u(e,0)){var n;switch(t.storage()){case"sparse":n=p(t,e,g,!0);break;default:n=v(t,e,g,!0)}return n}return c(t.size(),t.storage())},"Array, number | BigNumber":function(e,t){return g(s(e),t).valueOf()},"number | BigNumber, Array":function(e,t){return g(e,s(t)).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+a.operators.rightLogShift+"${args[1]}\\right)"},g}var i=n(2).isInteger;t.name="rightLogShift",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(18)),a=r(n(107)),s=r(n(50)),u=r(n(41)),c=i("bellNumbers",{"number | BigNumber":function(e){if(!u(e)||s(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,n=0;n<=e;n++)t=o(t,a(e,n));return t}});return c.toTex={1:"\\mathrm{B}_{${args[0]}}"},c}t.name="bellNumbers",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(18)),a=r(n(38)),s=r(n(12)),u=r(n(57)),c=r(n(50)),l=r(n(41)),f=i("catalan",{"number | BigNumber":function(e){if(!l(e)||c(e))throw new TypeError("Non-negative integer value expected in function catalan");return a(u(s(e,2),e),o(e,1))}});return f.toTex={1:"\\mathrm{C}_{${args[0]}}"},f}t.name="catalan",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(57)),a=r(n(20)),s=r(n(51)),u=r(n(41)),c=r(n(28)),l=i("composition",{"number | BigNumber, number | BigNumber":function(e,t){if(!(u(e)&&s(e)&&u(t)&&s(t)))throw new TypeError("Positive integer value expected in function composition");if(c(t,e))throw new TypeError("k must be less than or equal to n in function composition");return o(a(e,-1),a(t,-1))}});return l.toTex=void 0,l}t.name="composition",t.factory=r},function(e,t,n){e.exports=[n(395),n(397),n(107),n(396)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(t){return e.BigNumber.atan2(0,t)},Complex:function(e){return e.arg()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\arg\\left(${args[0]}\\right)"},o}var i=n(1);t.name="arg",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("im",{number:function(e){return 0},BigNumber:function(t){return new e.BigNumber(0)},Complex:function(e){return e.im},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},o}var i=n(1);t.name="im",t.factory=r},function(e,t,n){e.exports=[n(399),n(108),n(400),n(402)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("re",{number:function(e){return e},BigNumber:function(e){return e},Complex:function(e){return e.re},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},o}var i=n(1);t.name="re",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,s){var m=(r(n(0)),s("distance",{"Array, Array, Array":function(e,t,n){if(2==e.length&&2==t.length&&2==n.length){if(!i(e))throw new TypeError("Array with 2 numbers expected for first argument");if(!i(t))throw new TypeError("Array with 2 numbers expected for second argument");if(!i(n))throw new TypeError("Array with 2 numbers expected for third argument");var r=(n[1]-n[0])/(t[1]-t[0]),o=r*r*t[0],a=-1*(r*t[0]),s=e[1];return c(e[0],e[1],o,a,s)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,n){if(2==Object.keys(e).length&&2==Object.keys(t).length&&2==Object.keys(n).length){if(!i(e))throw new TypeError("Values of pointX and pointY should be numbers");if(!i(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers");if(!i(n))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers");if(e.hasOwnProperty("pointX")&&e.hasOwnProperty("pointY")&&t.hasOwnProperty("lineOnePtX")&&t.hasOwnProperty("lineOnePtY")&&n.hasOwnProperty("lineTwoPtX")&&n.hasOwnProperty("lineTwoPtY")){var r=(n.lineTwoPtY-n.lineTwoPtX)/(t.lineOnePtY-t.lineOnePtX),o=r*r*t.lineOnePtX,a=-1*(r*t.lineOnePtX),s=e.pointX;return c(e.pointX,e.pointY,o,a,s)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2==e.length&&3==t.length){if(!i(e))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(t))throw new TypeError("Array with 3 numbers expected for second argument");return c(e[0],e[1],t[0],t[1],t[2])}if(3==e.length&&6==t.length){if(!o(e))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(t))throw new TypeError("Array with 6 numbers expected for second argument");return l(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(2==e.length&&2==t.length){if(!i(e))throw new TypeError("Array with 2 numbers expected for first argument");if(!i(t))throw new TypeError("Array with 2 numbers expected for second argument");return f(e[0],e[1],t[0],t[1])}if(3==e.length&&3==t.length){if(!o(e))throw new TypeError("Array with 3 numbers expected for first argument");if(!o(t))throw new TypeError("Array with 3 numbers expected for second argument");return h(e[0],e[1],e[2],t[0],t[1],t[2])}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2==Object.keys(e).length&&3==Object.keys(t).length){if(!i(e))throw new TypeError("Values of pointX and pointY should be numbers");if(!o(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers");if(e.hasOwnProperty("pointX")&&e.hasOwnProperty("pointY")&&t.hasOwnProperty("xCoeffLine")&&t.hasOwnProperty("yCoeffLine")&&t.hasOwnProperty("yCoeffLine"))return c(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3==Object.keys(e).length&&6==Object.keys(t).length){if(!o(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers");if(!a(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers");if(e.hasOwnProperty("pointX")&&e.hasOwnProperty("pointY")&&t.hasOwnProperty("x0")&&t.hasOwnProperty("y0")&&t.hasOwnProperty("z0")&&t.hasOwnProperty("a")&&t.hasOwnProperty("b")&&t.hasOwnProperty("c"))return l(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2==Object.keys(e).length&&2==Object.keys(t).length){if(!i(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers");if(!i(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers");if(e.hasOwnProperty("pointOneX")&&e.hasOwnProperty("pointOneY")&&t.hasOwnProperty("pointTwoX")&&t.hasOwnProperty("pointTwoY"))return f(e.pointOneX,e.pointOneY,t.pointTwoX,t.pointTwoY);throw new TypeError("Key names do not match")}if(3==Object.keys(e).length&&3==Object.keys(t).length){if(!o(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers");if(!o(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers");if(e.hasOwnProperty("pointOneX")&&e.hasOwnProperty("pointOneY")&&e.hasOwnProperty("pointOneZ")&&t.hasOwnProperty("pointTwoX")&&t.hasOwnProperty("pointTwoY")&&t.hasOwnProperty("pointTwoZ"))return h(e.pointOneX,e.pointOneY,e.pointOneZ,t.pointTwoX,t.pointTwoY,t.pointTwoZ);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!u(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return p(e)}}));return m}function i(e){return e.constructor!==Array&&(e=s(e)),"number"==typeof e[0]&&"number"==typeof e[1]}function o(e){return e.constructor!==Array&&(e=s(e)),"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]}function a(e){return e.constructor!==Array&&(e=s(e)),"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]&&"number"==typeof e[3]&&"number"==typeof e[4]&&"number"==typeof e[5]}function s(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}function u(e){if(2==e[0].length&&"number"==typeof e[0][0]&&"number"==typeof e[0][1]){for(var t in e)if(2!=e[t].length||"number"!=typeof e[t][0]||"number"!=typeof e[t][1])return!1}else{if(3!=e[0].length||"number"!=typeof e[0][0]||"number"!=typeof e[0][1]||"number"!=typeof e[0][2])return!1;for(var t in e)if(3!=e[t].length||"number"!=typeof e[t][0]||"number"!=typeof e[t][1]||"number"!=typeof e[t][2])return!1}return!0}function c(e,t,n,r,i){var o=Math.abs(n*e+r*t+i),a=Math.pow(n*n+r*r,.5),s=o/a;return s}function l(e,t,n,r,i,o,a,s,u){var c=[(i-t)*u-(o-n)*s,(o-n)*a-(r-e)*u,(r-e)*s-(i-t)*a];c=Math.pow(c[0]*c[0]+c[1]*c[1]+c[2]*c[2],.5);var l=Math.pow(a*a+s*s+u*u,.5),f=c/l;return f}function f(e,t,n,r){var i=r-t,o=n-e,a=i*i+o*o,s=Math.pow(a,.5);return s}function h(e,t,n,r,i,o){var a=o-n,s=i-t,u=r-e,c=a*a+s*s+u*u,l=Math.pow(c,.5);return l}function p(e){for(var t=[],n=0;n<e.length-1;n++)for(var r=n+1;r<e.length;r++)2==e[0].length?t.push(f(e[n][0],e[n][1],e[r][0],e[r][1])):3==e[0].length&&t.push(h(e[n][0],e[n][1],e[n][2],e[r][0],e[r][1],e[r][2]));return t}t.name="distance",t.factory=r},function(e,t,n){e.exports=[n(405),n(403)]},function(e,t,n){"use strict";function r(e,t,r,i){function o(e){return 2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function a(e){return 3===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]}function s(e){return 4===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]&&"number"==typeof e[3]}function u(e,n,r,i){var o=e,a=r,s=d(o,n),u=d(a,i),c=s[0]*u[1]-u[0]*s[1];if(f(c)<t.epsilon)return null;var l=(u[0]*o[1]-u[1]*o[0]-u[0]*a[1]+u[1]*a[0])/c;return h(m(s,l),o)}function c(e,t,n,r,i,o,a,s,u,c,l,f){var h=(e-a)*(c-a)+(t-s)*(l-s)+(n-u)*(f-u),p=(c-a)*(r-e)+(l-s)*(i-t)+(f-u)*(o-n),m=(e-a)*(r-e)+(t-s)*(i-t)+(n-u)*(o-n),d=(c-a)*(c-a)+(l-s)*(l-s)+(f-u)*(f-u),v=(r-e)*(r-e)+(i-t)*(i-t)+(o-n)*(o-n),g=(h*p-m*d)/(v*d-p*p),y=(h+g*p)/d,w=e+g*(r-e),x=t+g*(i-t),b=n+g*(o-n),C=a+y*(c-a),M=s+y*(l-s),T=u+y*(f-u);return w===C&&x===M&&b===T?[w,x,b]:null}function l(e,t,n,r,i,o,a,s,u,c){var l=(c-e*a-t*s-n*u)/(r*a+i*s+o*u-e*a-t*s-n*u),f=e+l*(r-e),h=t+l*(i-t),p=n+l*(o-n);return[f,h,p]}var f=r(n(26)),h=r(n(18)),p=r(n(0)),m=r(n(12)),d=r(n(21)),v=i("intersect",{"Array, Array, Array":function(e,t,n){if(!a(e))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(t))throw new TypeError("Array with 3 numbers expected for second argument");if(!s(n))throw new TypeError("Array with 4 numbers expected as third argument");return l(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],n[3])},"Array, Array, Array, Array":function(e,t,n,r){if(2===e.length){if(!o(e))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(t))throw new TypeError("Array with 2 numbers expected for second argument");if(!o(n))throw new TypeError("Array with 2 numbers expected for third argument");if(!o(r))throw new TypeError("Array with 2 numbers expected for fourth argument");return u(e,t,n,r)}if(3===e.length){if(!a(e))throw new TypeError("Array with 3 numbers expected for first argument");if(!a(t))throw new TypeError("Array with 3 numbers expected for second argument");if(!a(n))throw new TypeError("Array with 3 numbers expected for third argument");if(!a(r))throw new TypeError("Array with 3 numbers expected for fourth argument");return c(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],r[0],r[1],r[2])}throw new TypeError("Arrays with two or thee dimensional points expected")},"Matrix, Matrix, Matrix":function(e,t,n){return p(v(e.valueOf(),t.valueOf(),n.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(e,t,n,r){return p(v(e.valueOf(),t.valueOf(),n.valueOf(),r.valueOf()))}});return v}t.name="intersect",t.factory=r},function(e,t,n){e.exports=[n(351),n(377),n(391),n(398),n(401),n(404),n(408),n(415),n(423),n(432),n(435),n(436),n(442),n(462),n(469),n(471)]},function(e,t,n){"use strict";function r(e,t,r,i){var o=n(4),a=r(n(0)),s=r(n(33)),u=r(n(109)),c=(r(n(74)),r(n(23))),l=r(n(60)),f=r(n(15)),h=r(n(8)),p=r(n(6)),m=i("and",{"number, number":function(e,t){return!(!e||!t)},"Complex, Complex":function(e,t){return!(0===e.re&&0===e.im||0===t.re&&0===t.im)},"BigNumber, BigNumber":function(e,t){return!(e.isZero()||t.isZero()||e.isNaN()||t.isNaN())},"Unit, Unit":function(e,t){return m(e.value,t.value)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=c(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,m,!1);break;default:n=h(e,t,m)}}return n},"Array, Array":function(e,t){return m(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return m(a(e),t)},"Matrix, Array":function(e,t){return m(e,a(t))},"Matrix, any":function(e,t){if(u(t))return s(e.size(),e.storage());var n;switch(e.storage()){case"sparse":n=f(e,t,m,!1);break;default:n=p(e,t,m,!1)}return n},"any, Matrix":function(e,t){if(u(e))return s(e.size(),e.storage());var n;switch(t.storage()){case"sparse":n=f(t,e,m,!0);break;default:n=p(t,e,m,!0)}return n},"Array, any":function(e,t){return m(a(e),t).valueOf()},"any, Array":function(e,t){return m(e,a(t)).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+o.operators.and+"${args[1]}\\right)"},m}t.name="and",t.factory=r},function(e,t,n){e.exports=[n(407),n(109),n(409),n(410)]},function(e,t,n){"use strict";function r(e,t,r,i){var o=n(4),a=r(n(0)),s=r(n(14)),u=r(n(59)),c=r(n(16)),l=r(n(8)),f=r(n(6)),h=i("or",{"number, number":function(e,t){return!(!e&&!t)},"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"Unit, Unit":function(e,t){return h(e.value,t.value)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=u(e,t,h);break;default:n=s(t,e,h,!0)}break;default:switch(t.storage()){case"sparse":n=s(e,t,h,!1);break;default:n=l(e,t,h)}}return n},"Array, Array":function(e,t){return h(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return h(a(e),t)},"Matrix, Array":function(e,t){return h(e,a(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=c(e,t,h,!1);break;default:n=f(e,t,h,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=c(t,e,h,!0);break;default:n=f(t,e,h,!0)}return n},"Array, any":function(e,t){return f(a(e),t,h,!1).valueOf()},"any, Array":function(e,t){return f(a(t),e,h,!0).valueOf()}});return h.toTex={2:"\\left(${args[0]}"+o.operators.or+"${args[1]}\\right)"},h}t.name="or",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=n(4),a=r(n(0)),s=r(n(14)),u=r(n(24)),c=r(n(16)),l=r(n(8)),f=r(n(6)),h=i("xor",{"number, number":function(e,t){return!!(!!e^!!t)},"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!=(0!==t.re||0!==t.im)},"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!=(!t.isZero()&&!t.isNaN())},"Unit, Unit":function(e,t){return h(e.value,t.value)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=u(e,t,h);break;default:n=s(t,e,h,!0)}break;default:switch(t.storage()){case"sparse":n=s(e,t,h,!1);break;default:n=l(e,t,h)}}return n},"Array, Array":function(e,t){return h(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return h(a(e),t)},"Matrix, Array":function(e,t){return h(e,a(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=c(e,t,h,!1);break;default:n=f(e,t,h,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=c(t,e,h,!0);break;default:n=f(t,e,h,!0)}return n},"Array, any":function(e,t){return f(a(e),t,h,!1).valueOf()},"any, Array":function(e,t){return f(a(t),e,h,!0).valueOf()}});return h.toTex={2:"\\left(${args[0]}"+o.operators.xor+"${args[1]}\\right)"},h}t.name="xor",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t){var n=Math.max(i.size(e).length,i.size(t).length);e=i.squeeze(e),t=i.squeeze(t);var r=i.size(e),o=i.size(t);if(1!=r.length||1!=o.length||3!=r[0]||3!=o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+r.join(", ")+"], B = ["+o.join(", ")+"])");var a=[u(c(e[1],t[2]),c(e[2],t[1])),u(c(e[2],t[0]),c(e[0],t[2])),u(c(e[0],t[1]),c(e[1],t[0]))];return n>1?[a]:a}var s=r(n(0)),u=r(n(21)),c=r(n(12)),l=o("cross",{"Matrix, Matrix":function(e,t){return s(a(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return s(a(e.toArray(),t))},"Array, Matrix":function(e,t){return s(a(e,t.toArray()))},"Array, Array":a});return l.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"
},l}var i=n(3);t.name="cross",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(e,t,n,r){if(!o(t))throw new TypeError("Second parameter in function diag must be an integer");var i=t>0?t:0,a=t<0?-t:0;switch(n.length){case 1:return u(e,t,r,n[0],a,i);case 2:return c(e,t,r,n,a,i)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function u(t,n,r,i,o,a){var s=[i+o,i+a],u=e.Matrix.storage(r||"dense"),c=u.diagonal(s,t,n);return null!==r?c:c.valueOf()}function c(e,t,n,r,i,o){if(e&&e.isMatrix===!0){var a=e.diagonal(t);return null!==n?n!==a.storage()?l(a,n):a:a.valueOf()}for(var s=Math.min(r[0]-i,r[1]-o),u=[],c=0;c<s;c++)u[c]=e[c+i][c+o];return null!==n?l(u):u}var l=r(n(0)),f=a("diag",{Array:function(e){return s(e,0,i.size(e),null)},"Array, number":function(e,t){return s(e,t,i.size(e),null)},"Array, BigNumber":function(e,t){return s(e,t.toNumber(),i.size(e),null)},"Array, string":function(e,t){return s(e,0,i.size(e),t)},"Array, number, string":function(e,t,n){return s(e,t,i.size(e),n)},"Array, BigNumber, string":function(e,t,n){return s(e,t.toNumber(),i.size(e),n)},Matrix:function(e){return s(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return s(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return s(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return s(e,0,e.size(),t)},"Matrix, number, string":function(e,t,n){return s(e,t,e.size(),n)},"Matrix, BigNumber, string":function(e,t,n){return s(e,t.toNumber(),e.size(),n)}});return f.toTex=void 0,f}var i=n(3),o=(n(5).clone,n(2).isInteger);t.name="diag",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t){var n=i(e),r=i(t),o=n[0];if(1!==n.length||1!==r.length)throw new RangeError("Vector expected");if(n[0]!=r[0])throw new RangeError("Vectors must have equal length ("+n[0]+" != "+r[0]+")");if(0==o)throw new RangeError("Cannot calculate the dot product of empty vectors");for(var a=0,c=0;c<o;c++)a=s(a,u(e[c],t[c]));return a}var s=r(n(18)),u=r(n(12)),c=o("dot",{"Matrix, Matrix":function(e,t){return a(e.toArray(),t.toArray())},"Matrix, Array":function(e,t){return a(e.toArray(),t)},"Array, Matrix":function(e,t){return a(e,t.toArray())},"Array, Array":a});return c.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},c}var i=n(3).size;t.name="dot",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=a("flatten",{Array:function(e){return o(i(e))},Matrix:function(e){var t=o(i(e.toArray()));return s(t)}});return u.toTex=void 0,u}var i=n(5).clone,o=n(3).flatten;t.name="flatten",t.factory=r},function(e,t,n){e.exports=[n(110),n(411),n(111),n(412),n(413),n(54),n(112),n(414),n(113),n(114),n(416),n(115),n(417),n(70),n(116),n(418),n(419),n(420),n(421),n(422),n(55),n(117),n(56),n(33)]},function(e,t,n){"use strict";function r(e,t,r,o){function a(e,t){if(1===i(e).length&&(e=[e]),1===i(t).length&&(t=[t]),i(e).length>2||i(t).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(e.length)+", y = "+JSON.stringify(t.length)+")");var n=[],r=[];return e.map(function(e){return t.map(function(t){return e.map(function(e){return t.map(function(t){return r.push(u(e,t))})},n.push(r=[]))})},n=[])&&n}var s=r(n(0)),u=r(n(22)),c=o("kron",{"Matrix, Matrix":function(e,t){return s(a(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return s(a(e.toArray(),t))},"Array, Matrix":function(e,t){return s(a(e,t.toArray()))},"Array, Array":a});return c}var i=n(3).size;t.name="kron",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){function s(t,n){var r=u(t),i=r?new e.BigNumber(1):1;if(c(t),n){var a=l(n);return t.length>0?a.resize(t,i):a}var s=[];return t.length>0?o(s,t,i):s}function u(e){var t=!1;return e.forEach(function(e,n,r){e&&e.isBigNumber===!0&&(t=!0,r[n]=e.toNumber())}),t}function c(e){e.forEach(function(e){if("number"!=typeof e||!i(e)||e<0)throw new Error("Parameters in function ones must be positive integers")})}var l=r(n(0)),f=a("ones",{"":function(){return"Array"===t.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(e){var n=e[e.length-1];if("string"==typeof n){var r=e.pop();return s(e,r)}return"Array"===t.matrix?s(e):s(e,"default")},Array:s,Matrix:function(e){var t=e.storage();return s(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return s(e.valueOf(),t)}});return f.toTex=void 0,f}var i=n(2).isInteger,o=n(3).resize;t.name="ones",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=a("reshape",{"Matrix, Array":function(e,t){return e.reshape?e.reshape(t):s(o.reshape(e.valueOf(),t))},"Array, Array":function(e,t){return t.forEach(function(e){if(!i(e))throw new TypeError("Invalid size for dimension: "+e)}),o.reshape(e,t)}});return u.toTex=void 0,u}var i=(n(9),n(2).isInteger),o=n(3);t.name="reshape",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,l){function f(e,t,n){if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==t.length)throw new i(t.length,1);var r=t[0];if("number"!=typeof r||!a(r))throw new TypeError("Invalid size, must contain positive integers (size: "+s(t)+")");if(e.length>r)return e.substring(0,r);if(e.length<r){for(var o=e,u=0,c=r-e.length;u<c;u++)o+=n;return o}return e}var h=r(n(0)),p=function(e,n,r){if(2!=arguments.length&&3!=arguments.length)throw new o("resize",arguments.length,2,3);if(n&&n.isMatrix===!0&&(n=n.valueOf()),n.length&&n[0]&&n[0].isBigNumber===!0&&(n=n.map(function(e){return e&&e.isBigNumber===!0?e.toNumber():e})),e&&e.isMatrix===!0)return e.resize(n,r,!0);if("string"==typeof e)return f(e,n,r);var i=!Array.isArray(e)&&"Array"!==t.matrix;if(0==n.length){for(;Array.isArray(e);)e=e[0];return u(e)}Array.isArray(e)||(e=[e]),e=u(e);var a=c.resize(e,n,r);return i?h(a):a};return p.toTex=void 0,p}var i=n(9),o=n(43),a=n(2).isInteger,s=n(11).format,u=n(5).clone,c=n(3);t.name="resize",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(0)),s=o("size",{Matrix:function(e){return a(e.size())},Array:i.size,string:function(e){return"Array"===t.matrix?[e.length]:a([e.length])},"number | Complex | BigNumber | Unit | boolean | null":function(e){return"Array"===t.matrix?[]:a([])}});return s.toTex=void 0,s}var i=n(3);t.name="size",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e){if("asc"===e)return l;if("desc"===e)return f;throw new Error('String "asc" or "desc" expected')}function s(e){if(1!==i(e).length)throw new Error("One dimensional array expected")}function u(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}var c=r(n(0)),l=r(n(49)),f=function(e,t){return-l(e,t)},h=o("sort",{Array:function(e){return s(e),e.sort(l)},Matrix:function(e){return u(e),c(e.toArray().sort(l),e.storage())},"Array, function":function(e,t){return s(e),e.sort(t)},"Matrix, function":function(e,t){return u(e),c(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return s(e),e.sort(a(t))},"Matrix, string":function(e,t){return u(e),c(e.toArray().sort(a(t)),e.storage())}});return h.toTex=void 0,h}var i=n(3).size;t.name="sort",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=a("squeeze",{Array:function(e){return o.squeeze(i.clone(e))},Matrix:function(e){var t=o.squeeze(e.toArray());return Array.isArray(t)?s(t):t},any:function(e){return i.clone(e)}});return u.toTex=void 0,u}var i=n(5),o=n(3);t.name="squeeze",t.factory=r},function(e,t,n){e.exports=[n(57),n(58),n(118),n(424),n(425),n(426),n(427),n(428),n(429)]},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t){var n=t.size().length,r=e.size().length;if(n>1)throw new Error("first object must be one dimensional");if(r>1)throw new Error("second object must be one dimensional");if(n!==r)throw new Error("Length of two vectors must be equal");var i=u(e);if(0===i)throw new Error("Sum of elements in first object must be non zero");var o=u(t);if(0===o)throw new Error("Sum of elements in second object must be non zero");var a=s(e,u(e)),p=s(t,u(t)),m=u(c(a,f(l(a,p))));return h(m)?m:Number.NaN}var a=r(n(0)),s=r(n(38)),u=r(n(125)),c=r(n(12)),l=r(n(103)),f=r(n(105)),h=r(n(73)),p=i("kldivergence",{"Array, Array":function(e,t){return o(a(e),a(t))},"Matrix, Array":function(e,t){return o(e,a(t))},"Array, Matrix":function(e,t){return o(a(e),t)},"Matrix, Matrix":function(e,t){return o(e,t)}});return p}t.name="kldivergence",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=r(n(18)),s=r(n(12)),u=r(n(38)),c=r(n(58)),l=r(n(41)),f=r(n(51));return o("multinomial",{"Array | Matrix":function(e){var t=0,n=1;return i(e,function(e){if(!l(e)||!f(e))throw new TypeError("Positive integer value expected in function multinomial");t=a(t,e),n=s(n,c(e))}),u(c(t),n)}})}var i=n(36);t.name="multinomial",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(58)),u=a("permutations",{"number | BigNumber":s,"number, number":function(e,t){var n,r;if(!o(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!o(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");for(n=1,r=e-t+1;r<=e;r++)n*=r;return n},"BigNumber, BigNumber":function(t,n){var r,o;if(!i(t)||!i(n))throw new TypeError("Positive integer value expected in function permutations");if(n.gt(t))throw new TypeError("second argument k must be less than or equal to first argument n");for(r=new e.BigNumber(1),o=t.minus(n).plus(1);o.lte(t);o=o.plus(1))r=r.times(o);return r}});return u.toTex=void 0,u}function i(e){return e.isInteger()&&e.gte(0)}var o=n(2).isInteger;t.name="permutations",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(71)),a=o("uniform").pickRandom;return a.toTex=void 0,a}t.name="pickRandom",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(71)),a=o("uniform").random;return a.toTex=void 0,a}t.name="random",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(71)),a=o("uniform").randomInt;return a.toTex=void 0,a}t.name="randomInt",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r,a){function s(e){c=null===e?o:i(String(e))}function u(){return c()}var c;return s(t.randomSeed),a.on("config",function(e,t,n){void 0!==n.randomSeed&&s(e.randomSeed)}),u}var i=n(515),o=i();t.factory=r,t.math=!0},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(!o(e[r],t[r]))return!1;return!0}return!1}return!Array.isArray(t)&&a(e,t)}var a=r(n(72)),s=i("deepEqual",{"any, any":function(e,t){return o(e.valueOf(),t.valueOf())}});return s.toTex=void 0,s}t.name="deepEqual",t.factory=r},function(e,t,n){e.exports=[n(49),n(431),n(72),n(28),n(119),n(40),n(433),n(120)]},function(e,t,n){"use strict";function r(e,t,r,a){var s=r(n(0)),u=r(n(14)),c=r(n(24)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=n(4),m=a("smallerEq",{"boolean, boolean":function(e,t){return e<=t},"number, number":function(e,n){return e<=n||i(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.lte(n)||o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return 1!==e.compare(t)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return m(e.value,t.value)},"string, string":function(e,t){return e<=t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,m);break;default:n=u(t,e,m,!0)}break;default:switch(t.storage()){case"sparse":n=u(e,t,m,!1);break;default:n=f(e,t,m)}}return n},"Array, Array":function(e,t){return m(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return m(s(e),t)},"Matrix, Array":function(e,t){return m(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=l(e,t,m,!1);break;default:n=h(e,t,m,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,m,!0);break;default:n=h(t,e,m,!0)}return n},"Array, any":function(e,t){return h(s(e),t,m,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+p.operators.smallerEq+"${args[1]}\\right)"},m}var i=n(2).nearlyEqual,o=n(35);t.name="smallerEq",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){function f(e){var t,n=e*e,r=u[0][4]*n,i=n;for(t=0;t<3;t+=1)r=(r+u[0][t])*n,i=(i+c[0][t])*n;return e*(r+u[0][3])/(i+c[0][3])}function h(e){var t,n=u[1][8]*e,r=e;for(t=0;t<7;t+=1)n=(n+u[1][t])*e,r=(r+c[1][t])*e;var i=(n+u[1][7])/(r+c[1][7]),o=parseInt(16*e)/16,a=(e-o)*(e+o);return Math.exp(-o*o)*Math.exp(-a)*i}function p(e){var t,n=1/(e*e),r=u[2][5]*n,i=n;for(t=0;t<4;t+=1)r=(r+u[2][t])*n,i=(i+c[2][t])*n;var o=n*(r+u[2][4])/(i+c[2][4]);o=(s-o)/e,n=parseInt(16*e)/16;var a=(e-n)*(e+n);return Math.exp(-n*n)*Math.exp(-a)*o}var m=r("erf",{number:function(e){var t=Math.abs(e);return t>=l?o(e):t<=a?o(e)*f(t):t<=4?o(e)*(1-h(t)):o(e)*(1-p(t))},BigNumber:function(t){return new e.BigNumber(m(t.toNumber()))},"Array | Matrix":function(e){return i(e,m)}});return m.toTex={1:"erf\\left(${args[0]}\\right)"},m}var i=n(1),o=n(2).sign,a=.46875,s=.5641895835477563,u=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],c=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],l=Math.pow(2,53);t.name="erf",t.factory=r},function(e,t,n){e.exports=[n(434)]},function(e,t,n){e.exports=[n(437),n(121),n(122),n(123),n(124),n(438),n(439),n(440),n(441),n(125),n(126)]},function(e,t,n){"use strict";function r(e,t,r,o){function a(e){if(e=i(e.valueOf()),0===e.length)throw new Error("Cannot calculate median absolute deviation of an empty array");var t=c(e);return c(u(e,function(e){return s(l(e,t))}))}var s=r(n(26)),u=r(n(115)),c=r(n(123)),l=r(n(21)),f=o("mad",{"Array | Matrix":a,"...":function(e){return a(e)}});return f.toTex=void 0,f}var i=n(3).flatten;t.name="mad",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){function o(e){e=i(e.valueOf());var t=e.length;if(0==t)throw new Error("Cannot calculate mode of an empty array");var n={},r=[],o=0;for(var a in e)e[a]in n||(n[e[a]]=0),n[e[a]]++,n[e[a]]==o?r.push(e[a]):n[e[a]]>o&&(o=n[e[a]],r=[e[a]]);return r}var a=r("mode",{"Array | Matrix":o,"...":function(e){return o(e)}});return a}var i=n(3).flatten;t.name="mode",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){function a(e){var t=void 0;if(i(e,function(e){t=void 0===t?e:s(t,e)}),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}var s=r(n(22)),u=o("prod",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return a(e)}});return u.toTex=void 0,u}var i=n(36);t.name="prod",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,u){function c(t,n,r){var a,u,c;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(s(t)){if(r=r||!1,"boolean"==typeof r){if(u=t.valueOf(),o(n)){if(n<0)throw new Error("N/prob must be non-negative");if(n<=1)return l(u,n,r);if(n>1){if(!i(n))throw new Error("N must be a positive integer");var f=n+1;a=new Array(n);for(var h=0;h<n;)a[h]=l(u,++h/f,r);return a}}if(n&&n.isBigNumber){if(n.isNegative())throw new Error("N/prob must be non-negative");if(c=new n.constructor(1),n.lte(c))return l(u,n,r);if(n.gt(c)){if(!n.isInteger())throw new Error("N must be a positive integer");var p=n.toNumber();if(p>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var f=new e.BigNumber(p+1);a=new Array(p);for(var h=0;h<p;)a[h]=l(u,new e.BigNumber(++h).div(f),r);return a}}if(Array.isArray(n)){a=new Array(n.length);for(var h=0;h<a.length;++h){var m=n[h];if(o(m)){if(m<0||m>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!m||!m.isBigNumber)throw new TypeError("Unexpected type of argument in function quantileSeq");if(c=new m.constructor(1),m.isNegative()||m.gt(c))throw new Error("Probability must be between 0 and 1, inclusive")}a[h]=l(u,m,r)}return a}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}function l(e,t,n){var r=a(e),i=r.length;if(0===i)throw new Error("Cannot calculate quantile of an empty sequence");if(o(t)){var s=t*(i-1),u=s%1;if(0===u){var c=n?r[s]:p(r,s);return d(c),c}var l,v,g=Math.floor(s);if(n)l=r[g],v=r[g+1];else{v=p(r,g+1),l=r[g];for(var y=0;y<g;++y)m(r[y],l)>0&&(l=r[y])}return d(l),d(v),f(h(l,1-u),h(v,u))}var s=t.times(i-1);if(s.isInteger()){s=s.toNumber();var c=n?r[s]:p(r,s);return d(c),c}var l,v,g=s.floor(),u=s.minus(g),w=g.toNumber();if(n)l=r[w],v=r[w+1];else{v=p(r,w+1),l=r[w];for(var y=0;y<w;++y)m(r[y],l)>0&&(l=r[y])}d(l),d(v);var x=new u.constructor(1);return f(h(l,x.minus(u)),h(v,u))}var f=r(n(18)),h=r(n(12)),p=r(n(70)),m=r(n(49)),d=u({"number | BigNumber | Unit":function(e){return e}});return c}var i=n(2).isInteger,o=n(2).isNumber,a=n(3).flatten,s=n(42);t.name="quantileSeq",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){function o(e,t){if(0==e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");return a(s.apply(null,arguments))}var a=r(n(48)),s=r(n(126)),u=i("std",{"Array | Matrix":o,"Array | Matrix, string":o,"...":function(e){return o(e)}});return u.toTex=void 0,u}t.name="std",t.factory=r},function(e,t,n){e.exports=[n(127),n(443)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("print",{"string, Object":i,"string, Object, number | Object":i});return o.toTex=void 0,o}function i(e,t,n){return e.replace(/\$([\w\.]+)/g,function(e,r){for(var i=r.split("."),s=t[i.shift()];i.length&&void 0!==s;){var u=i.shift();s=u?s[u]:s+"."}return void 0!==s?o(s)?s:a(s,n):e})}var o=n(11).isString,a=n(11).format;t.name="print",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("acos",{number:function(n){return n>=-1&&n<=1||t.predictable?Math.acos(n):new e.Complex(n,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\cos^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="acos",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("acot",{number:function(e){return Math.atan(1/e)},Complex:function(e){return e.acot()},BigNumber:function(t){return new e.BigNumber(1).div(t).atan()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\cot^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="acot",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("acoth",{number:function(n){return n>=1||n<=-1||t.predictable?isFinite(n)?(Math.log((n+1)/n)+Math.log(n/(n-1)))/2:0:new e.Complex(n,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(t){return new e.BigNumber(1).div(t).atanh()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\coth^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="acoth",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("acsc",{number:function(n){return n<=-1||n>=1||t.predictable?Math.asin(1/n):new e.Complex(n,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(t){return new e.BigNumber(1).div(t).asin()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\csc^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="acsc",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("acsch",{number:function(e){return e=1/e,Math.log(e+Math.sqrt(e*e+1))},Complex:function(e){return e.acsch()},BigNumber:function(t){return new e.BigNumber(1).div(t).asinh()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="acsch",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("asec",{number:function(n){return n<=-1||n>=1||t.predictable?Math.acos(1/n):new e.Complex(n,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(t){return new e.BigNumber(1).div(t).acos()},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\sec^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="asec",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,o){var a=(o.find(r(n(128)),["Complex"]),o("asech",{number:function(n){if(n<=1&&n>=-1||t.predictable){n=1/n;var r=Math.sqrt(n*n-1);return n>0||t.predictable?Math.log(r+n):new e.Complex(Math.log(r-n),Math.PI)}return new e.Complex(n,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(t){return new e.BigNumber(1).div(t).acosh()},"Array | Matrix":function(e){return i(e,a)}}));return a.toTex={1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},a}var i=n(1);t.name="asech",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("asin",{number:function(n){return n>=-1&&n<=1||t.predictable?Math.asin(n):new e.Complex(n,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\sin^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="asin",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("asinh",{number:Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\sinh^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="asinh",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\tan^{-1}\\left(${args[0]}\\right)"},o}var i=n(1);t.name="atan",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,i){var o=r(n(0)),a=r(n(23)),s=r(n(14)),u=r(n(135)),c=r(n(15)),l=r(n(16)),f=r(n(8)),h=r(n(6)),p=i("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(t,n){return e.BigNumber.atan2(t,n)},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=u(e,t,p,!1);break;default:n=a(t,e,p,!0)}break;default:switch(t.storage()){case"sparse":n=s(e,t,p,!1);break;default:n=f(e,t,p)}}return n},"Array, Array":function(e,t){return p(o(e),o(t)).valueOf()},"Array, Matrix":function(e,t){return p(o(e),t)},"Matrix, Array":function(e,t){return p(e,o(t))},"Matrix, number | BigNumber":function(e,t){var n;switch(e.storage()){case"sparse":n=c(e,t,p,!1);break;default:n=h(e,t,p,!1)}return n},"number | BigNumber, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=l(t,e,p,!0);break;default:n=h(t,e,p,!0)}return n},"Array, number | BigNumber":function(e,t){return h(o(e),t,p,!1).valueOf()},"number | BigNumber, Array":function(e,t){return h(o(t),e,p,!0).valueOf()}});return p.toTex={2:"\\mathrm{atan2}\\left(${args}\\right)"},p}t.name="atan2",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("atanh",{number:function(n){return n<=1&&n>=-1||t.predictable?o(n):new e.Complex(n,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()},"Array | Matrix":function(e){return i(e,a,!0)}});return a.toTex={1:"\\tanh^{-1}\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2};t.name="atanh",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("cos",{number:Math.cos,Complex:function(e){return e.cos()},BigNumber:function(e){return e.cos()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\cos\\left(${args[0]}\\right)"},o}var i=n(1);t.name="cos",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("cosh",{number:o,Complex:function(e){return e.cosh()},BigNumber:function(e){return e.cosh()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return a(t.value)},"Array | Matrix":function(e){return i(e,a)}});return a.toTex={1:"\\cosh\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2};t.name="cosh",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("cot",{number:function(e){return 1/Math.tan(e)},Complex:function(e){return e.cot()},BigNumber:function(t){return new e.BigNumber(1).div(t.tan())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\cot\\left(${args[0]}\\right)"},o}var i=n(1);t.name="cot",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("coth",{number:i,Complex:function(e){return e.coth()},BigNumber:function(t){return new e.BigNumber(1).div(t.tanh())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return a(t.value)},"Array | Matrix":function(e){return o(e,a)}});return a.toTex={1:"\\coth\\left(${args[0]}\\right)"},a}function i(e){var t=Math.exp(2*e);return(t+1)/(t-1)}var o=n(1);t.name="coth",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("csc",{number:function(e){return 1/Math.sin(e)},Complex:function(e){return e.csc()},BigNumber:function(t){return new e.BigNumber(1).div(t.sin())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\csc\\left(${args[0]}\\right)"},o}var i=n(1);t.name="csc",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("csch",{number:i,Complex:function(e){return e.csch()},BigNumber:function(t){return new e.BigNumber(1).div(t.sinh())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return a(t.value)},"Array | Matrix":function(e){return o(e,a)}});return a.toTex={1:"\\mathrm{csch}\\left(${args[0]}\\right)"},a}function i(e){return 0==e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*a(e)}var o=n(1),a=n(2).sign;t.name="csch",t.factory=r},function(e,t,n){e.exports=[n(444),n(128),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(463),n(464),n(465),n(466),n(467),n(468)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("sec",{number:function(e){return 1/Math.cos(e)},Complex:function(e){return e.sec()},BigNumber:function(t){return new e.BigNumber(1).div(t.cos())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\sec\\left(${args[0]}\\right)"},o}var i=n(1);t.name="sec",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("sech",{number:i,Complex:function(e){return e.sech()},BigNumber:function(t){return new e.BigNumber(1).div(t.cosh())},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return a(t.value)},"Array | Matrix":function(e){return o(e,a)}});return a.toTex={1:"\\mathrm{sech}\\left(${args[0]}\\right)"},a}function i(e){return 2/(Math.exp(e)+Math.exp(-e))}var o=n(1);t.name="sech",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("sin",{number:Math.sin,Complex:function(e){return e.sin()},BigNumber:function(e){return e.sin()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\sin\\left(${args[0]}\\right)"},o}var i=n(1);t.name="sin",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("sinh",{number:o,Complex:function(e){return e.sinh()},BigNumber:function(e){return e.sinh()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return a(t.value)},"Array | Matrix":function(e){return i(e,a,!0)}});return a.toTex={1:"\\sinh\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2};t.name="sinh",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("tan",{number:Math.tan,Complex:function(e){return e.tan()},BigNumber:function(e){return e.tan()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return o(t.value)},"Array | Matrix":function(e){return i(e,o,!0)}});return o.toTex={1:"\\tan\\left(${args[0]}\\right)"},o}var i=n(1);t.name="tan",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("tanh",{number:o,Complex:function(e){return e.tanh()},BigNumber:function(e){return e.tanh()},Unit:function(t){if(!t.hasBase(e.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return a(t.value)},"Array | Matrix":function(e){return i(e,a,!0)}});return a.toTex={1:"\\tanh\\left(${args[0]}\\right)"},a}var i=n(1),o=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};t.name="tanh",t.factory=r},function(e,t,n){e.exports=[n(470)]},function(e,t,n){"use strict";function r(e,t,r,i){var o=n(4),a=r(n(0)),s=r(n(8)),u=r(n(6)),c=i("to",{"Unit, Unit | string":function(e,t){return e.to(t)},"Matrix, Matrix":function(e,t){return s(e,t,c)},"Array, Array":function(e,t){return c(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return c(a(e),t)},"Matrix, Array":function(e,t){return c(e,a(t))},"Matrix, any":function(e,t){return u(e,t,c,!1)},"any, Matrix":function(e,t){return u(t,e,c,!0)},"Array, any":function(e,t){return u(a(e),t,c,!1).valueOf()},"any, Array":function(e,t){return u(a(t),e,c,!0).valueOf()}});return c.toTex={2:"\\left(${args[0]}"+o.operators.to+"${args[1]}\\right)"},c}t.name="to",t.factory=r},function(e,t,n){e.exports=[n(129),n(41),n(50),n(73),n(51),n(473),n(74),n(472),n(130)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isNaN",{number:function(e){return Number.isNaN(e)},BigNumber:function(e){return e.isNaN()},Fraction:function(e){return!1},Complex:function(e){return Number.isNaN(e.re)&&Number.isNaN(e.im)},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":function(e){return i(e,Number.isNaN)}});return o}var i=n(1);n(2),t.name="isNaN",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("isPrime",{number:function(e){if(e<2)return!1;if(2==e)return!0;if(e%2==0)return!1;for(var t=3;t*t<=e;t+=2)if(e%t==0)return!1;return!0},BigNumber:function(t){if(t.lt(2))return!1;if(t.equals(2))return!0;if(t.mod(2).isZero())return!1;for(var n=e.BigNumber(3);n.times(n).lte(t);n=n.plus(1))if(t.mod(n).isZero())return!1;return!0},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);t.name="isPrime",t.factory=r},function(e,t,n){e.exports=[n(475)];
},function(e,t,n){"use strict";function r(e,t,n,r){return function(t,n){var r=e[n&&n.mathjs];return r&&"function"==typeof r.fromJSON?r.fromJSON(n):n}}t.name="reviver",t.path="json",t.factory=r},function(e,t,n){function r(e,t,n,r,o){var a=i.clone({precision:t.precision});return a.prototype.type="BigNumber",a.prototype.isBigNumber=!0,a.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},a.fromJSON=function(e){return new a(e.value)},o.on("config",function(e,t){e.precision!==t.precision&&a.config({precision:e.precision})}),a}var i=n(513);t.name="BigNumber",t.path="type",t.factory=r,t.math=!0},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("bignumber",{"":function(){return new e.BigNumber(0)},number:function(t){return new e.BigNumber(t+"")},string:function(t){return new e.BigNumber(t)},BigNumber:function(e){return e},Fraction:function(t){return new e.BigNumber(t.n).div(t.d)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)"},o}var i=n(1);t.name="bignumber",t.factory=r},function(e,t,n){e.exports=[n(476),n(477)]},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("bool",{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var n=Number(e);if(""!=e&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":function(e){return i(e,o)}});return o}var i=n(1);t.name="boolean",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r,a){function s(e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");e&&e.isChain?this.value=e.value:this.value=e}function u(e,t){"function"==typeof t&&(s.prototype[e]=l(t))}function c(e,t){o(s.prototype,e,function(){var e=t();if("function"==typeof e)return l(e)})}function l(e){return function(){for(var t=[this.value],n=0;n<arguments.length;n++)t[n+1]=arguments[n];return new s(e.apply(e,t))}}return s.prototype.type="Chain",s.prototype.isChain=!0,s.prototype.done=function(){return this.value},s.prototype.valueOf=function(){return this.value},s.prototype.toString=function(){return i(this.value)},s.createProxy=function(e,t){if("string"==typeof e)u(e,t);else for(var n in e)e.hasOwnProperty(n)&&u(n,e[n])},s.createProxy(a),a.on("import",function(e,t,n){void 0===n&&c(e,t)}),s}var i=n(11).format,o=n(5).lazy;t.name="Chain",t.path="type",t.factory=r,t.math=!0,t.lazy=!1},function(e,t,n){"use strict";function r(e,t,n,r){return r("chain",{"":function(){return new e.Chain},any:function(t){return new e.Chain(t)}})}t.name="chain",t.factory=r},function(e,t,n){e.exports=[n(480),n(481)]},function(e,t,n){"use strict";function r(e,t,r,o){var a=n(4),s=o("complex",{"":function(){return e.Complex.ZERO},number:function(t){return new e.Complex(t,0)},"number, number":function(t,n){return new e.Complex(t,n)},"BigNumber, BigNumber":function(t,n){return new e.Complex(t.toNumber(),n.toNumber())},Complex:function(e){return e.clone()},string:function(t){return e.Complex(t)},Object:function(t){if("re"in t&&"im"in t)return new e.Complex(t.re,t.im);if("r"in t&&"phi"in t)return new e.Complex(t);throw new Error("Expected object with either properties re and im, or properties r and phi.")},"Array | Matrix":function(e){return i(e,s)}});return s.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+"+a.symbols.i+"\\cdot\\left(${args[1]}\\right)\\right)"},s}var i=n(1);t.name="complex",t.factory=r},function(e,t,n){e.exports=[n(131),n(483)]},function(e,t,n){function r(e,t,n,r){return i}var i=n(514);i.prototype.type="Fraction",i.prototype.isFraction=!0,i.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},i.fromJSON=function(e){return new i(e)},t.name="Fraction",t.path="type",t.factory=r},function(e,t,n){e.exports=[n(485),n(132)]},function(e,t,n){e.exports=[n(478),n(479),n(482),n(484),n(486),n(495),n(78),n(496),n(497),n(501)]},function(e,t,n){"use strict";function r(e,t,r,i){function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}var a=r(n(40)),s=r(n(28)),u=1/Math.log((1+Math.sqrt(5))/2);o.prototype.type="FibonacciHeap",o.prototype.isFibonacciHeap=!0,o.prototype.insert=function(e,t){var n={key:e,value:t,degree:0};if(this._minimum){var r=this._minimum;n.left=r,n.right=r.right,r.right=n,n.right.left=n,a(e,r.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},o.prototype.size=function(){return this._size},o.prototype.clear=function(){this._minimum=null,this._size=0},o.prototype.isEmpty=function(){return!!this._minimum},o.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var t=this._minimum,n=e.degree,r=e.child;n>0;){var i=r.right;r.left.right=r.right,r.right.left=r.left,r.left=t,r.right=t.right,t.right=r,r.right.left=r,r.parent=null,r=i,n--}return e.left.right=e.right,e.right.left=e.left,e==e.right?t=null:(t=e.right,t=p(t,this._size)),this._size--,this._minimum=t,e},o.prototype.remove=function(e){this._minimum=c(this._minimum,e,-1),this.extractMinimum()};var c=function(e,t,n){t.key=n;var r=t.parent;return r&&a(t.key,r.key)&&(l(e,t,r),f(e,r)),a(t.key,e.key)&&(e=t),e},l=function(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child==t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1},f=function(e,t){var n=t.parent;n&&(t.mark?(l(e,t,n),f(n)):t.mark=!0)},h=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1},p=function(e,t){var n=Math.floor(Math.log(t)*u)+1,r=new Array(n),i=0,o=e;if(o)for(i++,o=o.right;o!==e;)i++,o=o.right;for(var c;i>0;){for(var l=o.degree,f=o.right;c=r[l],c;){if(s(o.key,c.key)){var p=c;c=o,o=p}h(c,o),r[l]=null,l++}r[l]=o,o=f,i--}e=null;for(var m=0;m<n;m++)c=r[m],c&&(e?(c.left.right=c.right,c.right.left=c.left,c.left=e,c.right=e.right,e.right=c,c.right.left=c,a(c.key,e.key)&&(e=c)):e=c);return e};return o}t.name="FibonacciHeap",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){function o(e,t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!u(t))throw new Error("Invalid datatype: "+t);if(e&&e.isMatrix===!0||s(e)){var n=new c(e,t);this._data=n._data,this._size=n._size,this._datatype=n._datatype,this._min=null,this._max=null}else if(e&&s(e.data)&&s(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min="undefined"!=typeof e.min?e.min:null,this._max="undefined"!=typeof e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+i.types.type(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}var c=r(n(133)),l=r(n(40));return o.prototype=new c,o.prototype.type="ImmutableDenseMatrix",o.prototype.isImmutableDenseMatrix=!0,o.prototype.subset=function(e){switch(arguments.length){case 1:var t=c.prototype.subset.call(this,e);return t.isMatrix?new o({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},o.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},o.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},o.prototype.clone=function(){var e=new o({data:a.clone(this._data),size:a.clone(this._size),datatype:this._datatype});return e},o.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},o.fromJSON=function(e){return new o(e)},o.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},o.prototype.min=function(){if(null===this._min){var e=null;this.forEach(function(t){(null===e||l(t,e))&&(e=t)}),this._min=null!==e?e:void 0}return this._min},o.prototype.max=function(){if(null===this._max){var e=null;this.forEach(function(t){(null===e||l(e,t))&&(e=t)}),this._max=null!==e?e:void 0}return this._max},o}var i=n(25),o=i.string,a=i.object,s=Array.isArray,u=o.isString;t.name="ImmutableDenseMatrix",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e){function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var r=0,i=arguments.length;r<i;r++){var o=arguments[r];if(o&&o.isRange===!0)this._dimensions.push(o),this._isScalar=!1;else if(o&&(Array.isArray(o)||o.isMatrix===!0)){var a=n(o.valueOf());this._dimensions.push(a);var s=a.size();1===s.length&&1===s[0]||(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(n([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}}}function n(t){for(var n=0,r=t.length;n<r;n++)if("number"!=typeof t[n]||!o(t[n]))throw new TypeError("Index parameters must be positive integer numbers");return new e.ImmutableDenseMatrix(t)}return t.prototype.type="Index",t.prototype.isIndex=!0,t.prototype.clone=function(){var e=new t;return e._dimensions=i(this._dimensions),e._isScalar=this._isScalar,e},t.create=function(e){var n=new t;return t.apply(n,e),n},t.prototype.size=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?1:r.size()[0]}return e},t.prototype.max=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?r:r.max()}return e},t.prototype.min=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?r:r.min()}return e},t.prototype.forEach=function(e){for(var t=0,n=this._dimensions.length;t<n;t++)e(this._dimensions[t],t,this)},t.prototype.dimension=function(e){return this._dimensions[e]||null},t.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},t.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},t.prototype.isScalar=function(){return this._isScalar},t.prototype.toArray=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e.push("string"==typeof r?r:r.toArray())}return e},t.prototype.valueOf=t.prototype.toArray,t.prototype.toString=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];"string"==typeof r?e.push(JSON.stringify(r)):e.push(r.toString())}return"["+e.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},t.fromJSON=function(e){return t.create(e.dimensions)},t}var i=n(5).clone,o=n(2).isInteger;t.name="Index",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new e.FibonacciHeap}var o=r(n(18)),a=r(n(10));return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var n=this._heap.insert(e,t);this._values[e]=n}},i.prototype.get=function(e){var t=this._values[e];return t?t.value:0},i.prototype.accumulate=function(e,t){var n=this._values[e];n?n.value=o(n.value,t):(n=this._heap.insert(e,t),this._values[e]=n)},i.prototype.forEach=function(e,t,n){var r=this._heap,i=this._values,o=[],s=r.extractMinimum();for(s&&o.push(s);s&&s.key<=t;)s.key>=e&&(a(s.value,0)||n(s.key,s.value,this)),s=r.extractMinimum(),s&&o.push(s);for(var u=0;u<o.length;u++){var c=o[u];s=r.insert(c.key,c.value),i[s.key]=s}},i.prototype.swap=function(e,t){var n=this._values[e],r=this._values[t];if(!n&&r)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(n&&!r)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i}t.name="Spa",t.path="type",t.factory=r},function(e,t,n){"use strict";function r(e,t,r,d){function v(e,t){if(!(this instanceof v))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!p(t))throw new Error("Invalid datatype: "+t);if(e&&e.isMatrix===!0)w(this,e,t);else if(e&&l(e.index)&&l(e.ptr)&&l(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(l(e))x(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+i.types.type(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}var g=r(n(75)),y=r(n(10)),w=function(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?s.clone(t._values):void 0,e._index=s.clone(t._index),e._ptr=s.clone(t._ptr),e._size=s.clone(t._size),e._datatype=n||t._datatype):x(e,t.valueOf(),n||t._datatype)},x=function(e,t,n){e._values=[],e._index=[],e._ptr=[],e._datatype=n;var r=t.length,i=0,o=y,a=0;if(p(n)&&(o=d.find(y,[n,n])||y,a=d.convert(0,n)),r>0){var s=0;do{e._ptr.push(e._index.length);for(var u=0;u<r;u++){var c=t[u];if(l(c)){if(0===s&&i<c.length&&(i=c.length),s<c.length){var f=c[s];o(f,a)||(e._values.push(f),e._index.push(u))}}else 0===s&&i<1&&(i=1),o(c,a)||(e._values.push(c),e._index.push(u))}s++}while(s<i)}e._ptr.push(e._index.length),e._size=[r,i]};v.prototype=new g,v.prototype.type="SparseMatrix",v.prototype.isSparseMatrix=!0,v.prototype.storage=function(){return"sparse"},v.prototype.datatype=function(){return this._datatype},v.prototype.create=function(e,t){return new v(e,t)},v.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},v.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return b(this,e);case 2:case 3:return C(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}};var b=function(e,t){if(!t||t.isIndex!==!0)throw new TypeError("Invalid index");var n=t.isScalar();if(n)return e.get(t.min());var r=t.size();if(r.length!=e._size.length)throw new o(r.length,e._size.length);var i,a,s,u,c=t.min(),l=t.max();for(i=0,a=e._size.length;i<a;i++)m(c[i],e._size[i]),m(l[i],e._size[i]);var f=e._values,h=e._index,p=e._ptr,d=t.dimension(0),g=t.dimension(1),y=[],w=[];d.forEach(function(e,t){w[e]=t[0],y[e]=!0});var x=f?[]:void 0,b=[],C=[];return g.forEach(function(e){for(C.push(b.length),s=p[e],u=p[e+1];s<u;s++)i=h[s],y[i]===!0&&(b.push(w[i]),x&&x.push(f[s]))}),C.push(b.length),new v({values:x,index:b,ptr:C,size:r,datatype:e._datatype})},C=function(e,t,n,r){if(!t||t.isIndex!==!0)throw new TypeError("Invalid index");var i,u=t.size(),c=t.isScalar();if(n&&n.isMatrix===!0?(i=n.size(),n=n.toArray()):i=a.size(n),c){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(1!==u.length&&2!==u.length)throw new o(u.length,e._size.length,"<");if(i.length<u.length){for(var l=0,f=0;1===u[l]&&1===i[l];)l++;for(;1===u[l];)f++,l++;n=a.unsqueeze(n,u.length,f,i)}if(!s.deepEqual(u,i))throw new o(u,i,">");for(var h=t.min()[0],p=t.min()[1],m=i[0],d=i[1],v=0;v<m;v++)for(var g=0;g<d;g++){var y=n[v][g];e.set([v+h,g+p],y,r)}}return e};v.prototype.get=function(e){if(!l(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];m(t,this._size[0]),m(n,this._size[1]);var r=M(t,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===t?this._values[r]:0},v.prototype.set=function(e,t,n){if(!l(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var r=e[0],i=e[1],a=this._size[0],s=this._size[1],u=y,c=0;p(this._datatype)&&(u=d.find(y,[this._datatype,this._datatype])||y,c=d.convert(0,this._datatype)),(r>a-1||i>s-1)&&(E(this,Math.max(r+1,a),Math.max(i+1,s),n),a=this._size[0],s=this._size[1]),m(r,a),m(i,s);var f=M(r,this._ptr[i],this._ptr[i+1],this._index);return f<this._ptr[i+1]&&this._index[f]===r?u(t,c)?T(f,i,this._values,this._index,this._ptr):this._values[f]=t:N(f,r,i,t,this._values,this._index,this._ptr),this};var M=function(e,t,n,r){if(n-t===0)return n;for(var i=t;i<n;i++)if(r[i]===e)return i;return t},T=function(e,t,n,r,i){n.splice(e,1),r.splice(e,1);for(var o=t+1;o<i.length;o++)i[o]--},N=function(e,t,n,r,i,o,a){i.splice(e,0,r),o.splice(e,0,t);for(var s=n+1;s<a.length;s++)a[s]++};v.prototype.resize=function(e,t,n){if(!l(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");e.forEach(function(t){if(!c.isNumber(t)||!c.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+u.format(e)+")")});var r=n?this.clone():this;return E(r,e[0],e[1],t)};var E=function(e,t,n,r){var i=r||0,o=y,a=0;p(e._datatype)&&(o=d.find(y,[e._datatype,e._datatype])||y,a=d.convert(0,e._datatype),i=d.convert(i,e._datatype));var s,u,c,l=!o(i,a),f=e._size[0],h=e._size[1];if(n>h){for(u=h;u<n;u++)if(e._ptr[u]=e._values.length,l)for(s=0;s<f;s++)e._values.push(i),e._index.push(s);e._ptr[n]=e._values.length}else n<h&&(e._ptr.splice(n+1,h-n),e._values.splice(e._ptr[n],e._values.length),e._index.splice(e._ptr[n],e._index.length));if(h=n,t>f){if(l){var m=0;for(u=0;u<h;u++){e._ptr[u]=e._ptr[u]+m,c=e._ptr[u+1]+m;var v=0;for(s=f;s<t;s++,v++)e._values.splice(c+v,0,i),e._index.splice(c+v,0,s),m++}e._ptr[h]=e._values.length}}else if(t<f){var g=0;for(u=0;u<h;u++){e._ptr[u]=e._ptr[u]-g;var w=e._ptr[u],x=e._ptr[u+1]-g;for(c=w;c<x;c++)s=e._index[c],s>t-1&&(e._values.splice(c,1),e._index.splice(c,1),g++)}e._ptr[u]=e._values.length}return e._size[0]=t,e._size[1]=n,e};v.prototype.reshape=function(e,t){if(!l(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(e.forEach(function(t){if(!c.isNumber(t)||!c.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+u.format(e)+")")}),this._size[0]*this._size[1]!==e[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var r=[],i=0;i<n._ptr.length;i++)for(var o=0;o<n._ptr[i+1]-n._ptr[i];o++)r.push(i);for(var a=n._values.slice(),s=n._index.slice(),i=0;i<n._index.length;i++){var f=s[i],h=r[i],p=f*n._size[1]+h;r[i]=p%e[1],s[i]=Math.floor(p/e[1])}n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice();for(var i=0;i<n._ptr.length;i++)n._ptr[i]=0;for(var m=0;m<a.length;m++){var i=s[m],o=r[m],d=a[m],v=M(i,n._ptr[o],n._ptr[o+1],n._index);N(v,i,o,d,n._values,n._index,n._ptr)}return n},v.prototype.clone=function(){var e=new v({values:this._values?s.clone(this._values):void 0,index:s.clone(this._index),ptr:s.clone(this._ptr),size:s.clone(this._size),datatype:this._datatype});return e},v.prototype.size=function(){return this._size.slice(0)},v.prototype.map=function(e,t){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this,r=this._size[0],i=this._size[1],o=function(t,r,i){return e(t,[r,i],n)};return A(this,0,r-1,0,i-1,o,t)};var A=function(e,t,n,r,i,o,a){var s=[],u=[],c=[],l=y,f=0;p(e._datatype)&&(l=d.find(y,[e._datatype,e._datatype])||y,f=d.convert(0,e._datatype));for(var h=function(e,t,n){e=o(e,t,n),l(e,f)||(s.push(e),u.push(t))},m=r;m<=i;m++){c.push(s.length);for(var g=e._ptr[m],w=e._ptr[m+1],x=t,b=g;b<w;b++){var C=e._index[b];if(C>=t&&C<=n){if(!a)for(var M=x;M<C;M++)h(0,M-t,m-r);h(e._values[b],C-t,m-r)}x=C+1}if(!a)for(var T=x;T<=n;T++)h(0,T-t,m-r)}return c.push(s.length),new v({values:s,index:u,ptr:c,size:[n-t+1,i-r+1]})};v.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],i=this._size[1],o=0;o<i;o++){for(var a=this._ptr[o],s=this._ptr[o+1],u=0,c=a;c<s;c++){var l=this._index[c];if(!t)for(var f=u;f<l;f++)e(0,[f,o],n);e(this._values[c],[l,o],n),u=l+1}if(!t)for(var h=u;h<r;h++)e(0,[h,o],n)}},v.prototype.toArray=function(){return S(this._values,this._index,this._ptr,this._size,!0)},v.prototype.valueOf=function(){return S(this._values,this._index,this._ptr,this._size,!1)};var S=function(e,t,n,r,i){var o,a,u=r[0],c=r[1],l=[];for(o=0;o<u;o++)for(l[o]=[],a=0;a<c;a++)l[o][a]=0;for(a=0;a<c;a++)for(var f=n[a],h=n[a+1],p=f;p<h;p++)o=t[p],l[o][a]=e?i?s.clone(e[p]):e[p]:1;return l};return v.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+u.format(t,e)+" x "+u.format(n,e)+"] density: "+u.format(r,e)+"\n",o=0;o<n;o++)for(var a=this._ptr[o],s=this._ptr[o+1],c=a;c<s;c++){var l=this._index[c];i+="\n    ("+u.format(l,e)+", "+u.format(o,e)+") ==> "+(this._values?u.format(this._values[c],e):"X")}return i},v.prototype.toString=function(){return u.format(this.toArray())},v.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},v.prototype.diagonal=function(e){if(e){if(e.isBigNumber===!0&&(e=e.toNumber()),!f(e)||!h(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,n=e<0?-e:0,r=this._size[0],i=this._size[1],o=Math.min(r-n,i-t),a=[],s=[],u=[];u[0]=0;for(var c=t;c<i&&a.length<o;c++)for(var l=this._ptr[c],p=this._ptr[c+1],m=l;m<p;m++){var d=this._index[m];if(d===c-t+n){a.push(this._values[m]),s[a.length-1]=d-n;break}}return u.push(a.length),new v({values:a,index:s,ptr:u,size:[o,1]})},v.fromJSON=function(e){return new v(e)},v.diagonal=function(e,t,n,r,i){if(!l(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(e){if(e&&e.isBigNumber===!0&&(e=e.toNumber()),!f(e)||!h(e)||e<1)throw new Error("Size values must be positive integers");return e}),n){if(n.isBigNumber===!0&&(n=n.toNumber()),!f(n)||!h(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var o=y,a=0;p(i)&&(o=d.find(y,[i,i])||y,a=d.convert(0,i));var s,u=n>0?n:0,c=n<0?-n:0,m=e[0],g=e[1],w=Math.min(m-c,g-u);if(l(t)){if(t.length!==w)throw new Error("Invalid value array length");s=function(e){return t[e]}}else if(t&&t.isMatrix===!0){var x=t.size();if(1!==x.length||x[0]!==w)throw new Error("Invalid matrix length");s=function(e){return t.get([e])}}else s=function(){return t};for(var b=[],C=[],M=[],T=0;T<g;T++){M.push(b.length);var N=T-u;if(N>=0&&N<w){var E=s(N);o(E,a)||(C.push(N+c),b.push(E))}}return M.push(b.length),new v({values:b,index:C,ptr:M,size:[m,g]})},v.prototype.swapRows=function(e,t){if(!(f(e)&&h(e)&&f(t)&&h(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return m(e,this._size[0]),m(t,this._size[0]),v._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},v._forEachRow=function(e,t,n,r,i){for(var o=r[e],a=r[e+1],s=o;s<a;s++)i(n[s],t[s])},v._swapRows=function(e,t,n,r,i,o){for(var a=0;a<n;a++){var s=o[a],u=o[a+1],c=M(e,s,u,i),l=M(t,s,u,i);if(c<u&&l<u&&i[c]===e&&i[l]===t){if(r){var f=r[c];r[c]=r[l],r[l]=f}}else if(c<u&&i[c]===e&&(l>=u||i[l]!==t)){var h=r?r[c]:void 0;i.splice(l,0,t),r&&r.splice(l,0,h),i.splice(l<=c?c+1:c,1),r&&r.splice(l<=c?c+1:c,1)}else if(l<u&&i[l]===t&&(c>=u||i[c]!==e)){var p=r?r[l]:void 0;i.splice(c,0,e),r&&r.splice(c,0,p),i.splice(c<=l?l+1:l,1),r&&r.splice(c<=l?l+1:l,1)}}},e.Matrix._storage.sparse=v,v}var i=n(25),o=n(9),a=i.array,s=i.object,u=i.string,c=i.number,l=Array.isArray,f=c.isNumber,h=c.isInteger,p=u.isString,m=a.validateIndex;t.name="SparseMatrix",t.path="type",t.factory=r,t.lazy=!1},function(e,t,n){"use strict";function r(e,t,n,r){return r("index",{"...number | string | BigNumber | Range | Array | Matrix":function(t){var n=t.map(function(e){return e&&e.isBigNumber===!0?e.toNumber():e&&(Array.isArray(e)||e.isMatrix===!0)?e.map(function(e){return e&&e.isBigNumber===!0?e.toNumber():e}):e}),r=new e.Index;return e.Index.apply(r,n),r}})}t.name="index",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=e.SparseMatrix,o=r("sparse",{"":function(){return new i([])},string:function(e){return new i([],e)},"Array | Matrix":function(e){return new i(e)},"Array | Matrix, string":function(e,t){return new i(e,t)}});return o.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},o}t.name="sparse",t.factory=r},function(e,t,n){e.exports=[n(75),n(133),n(492),n(491),n(488),n(489),n(490),n(134),n(493),n(0),n(494)]},function(e,t,n){e.exports=[n(136)]},function(e,t,n){"use strict";function r(e,t,n,r){var a=r("string",{"":function(){return""},number:o.format,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":function(e){return i(e,a)},any:function(e){return String(e)}});return a.toTex={0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},a}var i=n(1),o=n(2);t.name="string",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=r("createUnit",{"Object, Object":function(t,n){return e.Unit.createUnit(t,n)},Object:function(t){return e.Unit.createUnit(t,{})},"string, Unit | string | Object, Object":function(t,n,r){var i={};return i[t]=n,e.Unit.createUnit(i,r)},"string, Unit | string | Object":function(t,n){var r={};return r[t]=n,e.Unit.createUnit(r,{})},string:function(t){var n={};return n[t]={},e.Unit.createUnit(n,{})}});return i}n(1),t.name="createUnit",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var i=r("splitUnit",{"Unit, Array":function(e,t){return e.splitUnit(t)}});return i}n(1),t.name="splitUnit",t.factory=r},function(e,t,n){"use strict";function r(e,t,n,r){var o=r("unit",{Unit:function(e){return e.clone()},string:function(t){return e.Unit.isValuelessUnit(t)?new e.Unit(null,t):e.Unit.parse(t)},"number | BigNumber | Fraction | Complex, string":function(t,n){return new e.Unit(t,n)},"Array | Matrix":function(e){return i(e,o)}});return o.toTex={1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var i=n(1);t.name="unit",t.factory=r},function(e,t,n){e.exports=[n(137),n(500),n(498),n(499),n(502)]},function(e,t,n){function r(e,t,n,r,o){function a(t){var n=e.Unit.parse(t);return n.fixPrefix=!0,n}i(o,"speedOfLight",function(){return a("299792458 m s^-1")}),i(o,"gravitationConstant",function(){return a("6.6738480e-11 m^3 kg^-1 s^-2")}),i(o,"planckConstant",function(){return a("6.626069311e-34 J s")}),i(o,"reducedPlanckConstant",function(){return a("1.05457172647e-34 J s")}),i(o,"magneticConstant",function(){return a("1.2566370614e-6 N A^-2")}),i(o,"electricConstant",function(){return a("8.854187817e-12 F m^-1")}),i(o,"vacuumImpedance",function(){return a("376.730313461 ohm")}),i(o,"coulomb",function(){return a("8.9875517873681764e9 N m^2 C^-2")}),i(o,"elementaryCharge",function(){return a("1.60217656535e-19 C")}),i(o,"bohrMagneton",function(){return a("9.2740096820e-24 J T^-1")}),i(o,"conductanceQuantum",function(){return a("7.748091734625e-5 S")}),i(o,"inverseConductanceQuantum",function(){return a("12906.403721742 ohm")}),i(o,"magneticFluxQuantum",function(){return a("2.06783375846e-15 Wb")}),i(o,"nuclearMagneton",function(){return a("5.0507835311e-27 J T^-1")}),i(o,"klitzing",function(){return a("25812.807443484 ohm")}),i(o,"bohrRadius",function(){return a("5.291772109217e-11 m")}),i(o,"classicalElectronRadius",function(){return a("2.817940326727e-15 m")}),i(o,"electronMass",function(){return a("9.1093829140e-31 kg")}),i(o,"fermiCoupling",function(){return a("1.1663645e-5 GeV^-2")}),i(o,"fineStructure",function(){return.007297352569824}),i(o,"hartreeEnergy",function(){return a("4.3597443419e-18 J")}),i(o,"protonMass",function(){return a("1.67262177774e-27 kg")}),i(o,"deuteronMass",function(){return a("3.3435830926e-27 kg")}),i(o,"neutronMass",function(){return a("1.6749271613e-27 kg")}),i(o,"quantumOfCirculation",function(){return a("3.636947552024e-4 m^2 s^-1")}),i(o,"rydberg",function(){return a("10973731.56853955 m^-1")}),i(o,"thomsonCrossSection",function(){return a("6.65245873413e-29 m^2")}),i(o,"weakMixingAngle",function(){return.222321}),i(o,"efimovFactor",function(){return 22.7}),i(o,"atomicMass",function(){return a("1.66053892173e-27 kg")}),i(o,"avogadro",function(){return a("6.0221412927e23 mol^-1")}),i(o,"boltzmann",function(){return a("1.380648813e-23 J K^-1")}),i(o,"faraday",function(){return a("96485.336521 C mol^-1")}),i(o,"firstRadiation",function(){return a("3.7417715317e-16 W m^2")}),i(o,"loschmidt",function(){return a("2.686780524e25 m^-3")}),i(o,"gasConstant",function(){return a("8.314462175 J K^-1 mol^-1")}),i(o,"molarPlanckConstant",function(){return a("3.990312717628e-10 J s mol^-1")}),i(o,"molarVolume",function(){return a("2.241396820e-10 m^3 mol^-1")}),i(o,"sackurTetrode",function(){return-1.164870823}),i(o,"secondRadiation",function(){return a("1.438777013e-2 m K")}),i(o,"stefanBoltzmann",function(){return a("5.67037321e-8 W m^-2 K^-4")}),i(o,"wienDisplacement",function(){return a("2.897772126e-3 m K")}),i(o,"molarMass",function(){return a("1e-3 kg mol^-1")}),i(o,"molarMassC12",function(){return a("1.2e-2 kg mol^-1")}),i(o,"gravity",function(){return a("9.80665 m s^-2")}),i(o,"planckLength",function(){return a("1.61619997e-35 m")}),i(o,"planckMass",function(){return a("2.1765113e-8 kg")}),i(o,"planckTime",function(){return a("5.3910632e-44 s")}),i(o,"planckCharge",function(){return a("1.87554595641e-18 C")}),i(o,"planckTemperature",function(){return a("1.41683385e+32 K")})}function i(e,t,n){o(e,t,n),o(e.expression.mathWithTransform,t,n)}var o=n(5).lazy;t.factory=r,t.lazy=!1,t.math=!0},function(e,t,n){var r=n(80);e.exports=function(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()==t.isNegative()?e:new n(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e}return r(e,t,function(e,t){return e&t})}},function(e,t,n){var r=n(80);e.exports=function(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);var i=new n(-1);return e.isZero()||t.eq(i)||e.eq(t)?t:t.isZero()||e.eq(i)?e:e.isFinite()&&t.isFinite()?r(e,t,function(e,t){return e|t}):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?i:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}},function(e,t,n){var r=n(80),i=n(79);e.exports=function(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new n(0);var o=new n(-1);return e.eq(o)?i(t):t.eq(o)?i(e):e.isFinite()&&t.isFinite()?r(e,t,function(e,t){return e^t}):e.isFinite()||t.isFinite()?new n(e.isNegative()==t.isNegative()?1/0:-(1/0)):o}},function(e,t){t.format=function(e,n){if("function"==typeof n)return n(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";
var r="auto",i=void 0;switch(void 0!==n&&(n.notation&&(r=n.notation),"number"==typeof n?i=n:n.precision&&(i=n.precision)),r){case"fixed":return t.toFixed(e,i);case"exponential":return t.toExponential(e,i);case"auto":var o=.001,a=1e5;if(n&&n.exponential&&(void 0!==n.exponential.lower&&(o=n.exponential.lower),void 0!==n.exponential.upper&&(a=n.exponential.upper)),{toExpNeg:e.constructor.toExpNeg,toExpPos:e.constructor.toExpPos},e.constructor.config({toExpNeg:Math.round(Math.log(o)/Math.LN10),toExpPos:Math.round(Math.log(a)/Math.LN10)}),e.isZero())return"0";var s,u=e.abs();return s=u.gte(o)&&u.lt(a)?e.toSignificantDigits(i).toFixed():t.toExponential(e,i),s.replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},t.toExponential=function(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()},t.toFixed=function(e,t){return e.toFixed(t||0)}},function(e,t){e.exports=function(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new n(2).pow(t)):new n(NaN)}},function(e,t){e.exports=function(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new n(2).pow(t)).floor():new n(e.isNegative()?-1:e.isFinite()?0:NaN)}},function(e,t,n){"use strict";t.isBoolean=function(e){return"boolean"==typeof e}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o,a,s,u,c,l){var f,h,p,m,d=e._values,v=e._index,g=e._ptr,y=a._index;if(r)for(h=g[t],p=g[t+1],f=h;f<p;f++)m=v[f],n[m]!==o?(n[m]=o,y.push(m),c?(r[m]=u?s(d[f],l):s(l,d[f]),i[m]=o):r[m]=d[f]):(r[m]=u?s(d[f],r[m]):s(r[m],d[f]),i[m]=o);else for(h=g[t],p=g[t+1],f=h;f<p;f++)m=v[f],n[m]!==o?(n[m]=o,y.push(m)):i[m]=o}},function(e,t){e.exports="3.13.3"},function(e,t,n){var r,i;!function(n){"use strict";function o(e,t){var n=Math.abs(e),r=Math.abs(t);return 0===e?Math.log(r):0===t?Math.log(n):n<3e3&&r<3e3?.5*Math.log(e*e+t*t):Math.log(e/Math.cos(Math.atan2(t,e)))}function a(e,t){return this instanceof a?(c(e,t),this.re=s.re,void(this.im=s.im)):new a(e,t)}var s={re:0,im:0};Math.cosh=Math.cosh||function(e){return.5*(Math.exp(e)+Math.exp(-e))},Math.sinh=Math.sinh||function(e){return.5*(Math.exp(e)-Math.exp(-e))};var u=function(){throw SyntaxError("Invalid Param")},c=function(e,t){if(void 0===e||null===e)s.re=s.im=0;else if(void 0!==t)s.re=e,s.im=t;else switch(typeof e){case"object":"im"in e&&"re"in e?(s.re=e.re,s.im=e.im):"abs"in e&&"arg"in e?(s.re=e.abs*Math.cos(e.arg),s.im=e.abs*Math.sin(e.arg)):"r"in e&&"phi"in e?(s.re=e.r*Math.cos(e.phi),s.im=e.r*Math.sin(e.phi)):u();break;case"string":s.im=s.re=0;var n=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),r=1,i=0;null===n&&u();for(var o=0;o<n.length;o++){var a=n[o];" "===a||"\t"===a||"\n"===a||("+"===a?r++:"-"===a?i++:"i"===a||"I"===a?(r+i===0&&u()," "===n[o+1]||isNaN(n[o+1])?s.im+=parseFloat((i%2?"-":"")+"1"):(s.im+=parseFloat((i%2?"-":"")+n[o+1]),o++),r=i=0):((r+i===0||isNaN(a))&&u(),"i"===n[o+1]||"I"===n[o+1]?(s.im+=parseFloat((i%2?"-":"")+a),o++):s.re+=parseFloat((i%2?"-":"")+a),r=i=0))}r+i>0&&u();break;case"number":s.im=0,s.re=e;break;default:u()}isNaN(s.re)||isNaN(s.im)};a.prototype={re:0,im:0,sign:function(){var e=this.abs();return new a(this.re/e,this.im/e)},add:function(e,t){return c(e,t),new a(this.re+s.re,this.im+s.im)},sub:function(e,t){return c(e,t),new a(this.re-s.re,this.im-s.im)},mul:function(e,t){return c(e,t),0===s.im&&0===this.im?new a(this.re*s.re,0):new a(this.re*s.re-this.im*s.im,this.re*s.im+this.im*s.re)},div:function(e,t){c(e,t),e=this.re,t=this.im;var n,r,i=s.re,o=s.im;return 0===i&&0===o?new a(0!==e?e/0:0,0!==t?t/0:0):0===o?new a(e/i,t/i):Math.abs(i)<Math.abs(o)?(r=i/o,n=i*r+o,new a((e*r+t)/n,(t*r-e)/n)):(r=o/i,n=o*r+i,new a((e+t*r)/n,(t-e*r)/n))},pow:function(e,t){if(c(e,t),e=this.re,t=this.im,0===e&&0===t)return new a(0,0);var n=Math.atan2(t,e),r=o(e,t);if(0===s.im){if(0===t&&e>=0)return new a(Math.pow(e,s.re),0);if(0===e)switch(s.re%4){case 0:return new a(Math.pow(t,s.re),0);case 1:return new a(0,Math.pow(t,s.re));case 2:return new a(-Math.pow(t,s.re),0);case 3:return new a(0,-Math.pow(t,s.re))}}return e=Math.exp(s.re*r-s.im*n),t=s.im*r+s.re*n,new a(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e,t,n=this.re,r=this.im,i=this.abs();return n>=0&&0===r?new a(Math.sqrt(n),0):(e=n>=0?.5*Math.sqrt(2*(i+n)):Math.abs(r)/Math.sqrt(2*(i-n)),t=n<=0?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new a(e,r>=0?t:-t))},exp:function(){var e=Math.exp(this.re);return 0===this.im,new a(e*Math.cos(this.im),e*Math.sin(this.im))},log:function(){var e=this.re,t=this.im;return new a(o(e,t),Math.atan2(t,e))},abs:function(){var e=Math.abs(this.re),t=Math.abs(this.im);return e<3e3&&t<3e3?Math.sqrt(e*e+t*t):(e<t?(e=t,t=this.re/this.im):t=this.im/this.re,e*Math.sqrt(1+t*t))},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new a(Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t))},cos:function(){var e=this.re,t=this.im;return new a(Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t))},tan:function(){var e=2*this.re,t=2*this.im,n=Math.cos(e)+Math.cosh(t);return new a(Math.sin(e)/n,Math.sinh(t)/n)},cot:function(){var e=2*this.re,t=2*this.im,n=Math.cos(e)-Math.cosh(t);return new a(-Math.sin(e)/n,Math.sinh(t)/n)},sec:function(){var e=this.re,t=this.im,n=.5*Math.cosh(2*t)+.5*Math.cos(2*e);return new a(Math.cos(e)*Math.cosh(t)/n,Math.sin(e)*Math.sinh(t)/n)},csc:function(){var e=this.re,t=this.im,n=.5*Math.cosh(2*t)-.5*Math.cos(2*e);return new a(Math.sin(e)*Math.cosh(t)/n,-Math.cos(e)*Math.sinh(t)/n)},asin:function(){var e=this.re,t=this.im,n=new a(t*t-e*e+1,-2*e*t).sqrt(),r=new a(n.re-t,n.im+e).log();return new a(r.im,-r.re)},acos:function(){var e=this.re,t=this.im,n=new a(t*t-e*e+1,-2*e*t).sqrt(),r=new a(n.re-t,n.im+e).log();return new a(Math.PI/2-r.im,r.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new a(0,1/0);if(t===-1)return new a(0,-(1/0))}var n=e*e+(1-t)*(1-t),r=new a((1-t*t-e*e)/n,-2*e/n).log();return new a(-.5*r.im,.5*r.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new a(Math.atan2(1,e),0);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).atan():new a(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new a(0,1/0);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).acos():new a(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new a(Math.PI/2,1/0);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).asin():new a(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new a(Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new a(Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,n=Math.cosh(e)+Math.cos(t);return new a(Math.sinh(e)/n,Math.sin(t)/n)},coth:function(){var e=2*this.re,t=2*this.im,n=Math.cosh(e)-Math.cos(t);return new a(Math.sinh(e)/n,-Math.sin(t)/n)},csch:function(){var e=this.re,t=this.im,n=Math.cos(2*t)-Math.cosh(2*e);return new a(-2*Math.sinh(e)*Math.cos(t)/n,2*Math.cosh(e)*Math.sin(t)/n)},sech:function(){var e=this.re,t=this.im,n=Math.cos(2*t)+Math.cosh(2*e);return new a(2*Math.cosh(e)*Math.cos(t)/n,-2*Math.sinh(e)*Math.sin(t)/n)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e,t=this.acos();return t.im<=0?(e=t.re,t.re=-t.im,t.im=e):(e=t.im,t.im=-t.re,t.re=e),t},atanh:function(){var e=this.re,t=this.im,n=e>1&&0===t,r=1-e,i=1+e,s=r*r+t*t,u=0!==s?new a((i*r-t*t)/s,(t*r+i*t)/s):new a(e!==-1?e/0:0,0!==t?t/0:0),c=u.re;return u.re=o(u.re,u.im)/2,u.im=Math.atan2(u.im,c)/2,n&&(u.im=-u.im),u},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new a(0,Math.PI/2);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).atanh():new a(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new a(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).asinh():new a(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new a(1/0,0);var n=e*e+t*t;return 0!==n?new a(e/n,-t/n).acosh():new a(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){var e=this.re,t=this.im,n=e*e+t*t;return new a(0!==e?e/n:0,0!==t?-t/n:0)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new a(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new a(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new a(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){return c(e,t),Math.abs(s.re-this.re)<=a.EPSILON&&Math.abs(s.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){var e=this.re,t=this.im,n="";return isNaN(e)||isNaN(t)?"NaN":(0!==e&&(n+=e),0!==t&&(0!==e?n+=t<0?" - ":" + ":t<0&&(n+="-"),t=Math.abs(t),1!==t&&(n+=t),n+="i"),n?n:"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.EPSILON=1e-16,r=[],i=function(){return a}.apply(t,r),!(void 0!==i&&(e.exports=i))}(this)},function(e,t,n){var r;!function(i){"use strict";function o(e){var t,n,r,i=e.length-1,o="",a=e[0];if(i>0){for(o+=a,t=1;t<i;t++)r=e[t]+"",n=ke-r.length,n&&(o+=v(n)),o+=r;a=e[t],r=a+"",n=ke-r.length,n&&(o+=v(n))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}function a(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Te+e)}function s(e,t,n,r){var i,o,a,s;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=ke,i=0):(i=Math.ceil((t+1)/ke),t%=ke),o=Se(10,ke-t),s=e[i]%o|0,null==r?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),a=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):a=(n<4&&s+1==o||n>3&&s+1==o/2)&&(e[i+1]/o/100|0)==Se(10,t-2)-1||(s==o/2||0==s)&&0==(e[i+1]/o/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),a=(r||n<4)&&9999==s||!r&&n>3&&4999==s):a=((r||n<4)&&s+1==o||!r&&n>3&&s+1==o/2)&&(e[i+1]/o/1e3|0)==Se(10,t-3)-1,a}function u(e,t,n){for(var r,i,o=[0],a=0,s=e.length;a<s;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=ye.indexOf(e.charAt(a++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function c(e,t){var n,r,i=t.d.length;i<32?(n=Math.ceil(i/3),r=Math.pow(4,-n).toString()):(n=16,r="2.3283064365386962890625e-10"),e.precision+=n,t=E(e,1,t.times(r),new e(1));for(var o=n;o--;){var a=t.times(t);t=a.times(a).minus(a).times(8).plus(1)}return e.precision-=n,t}function l(e,t,n,r){var i,o,a,s,u,c,l,f,h,p=e.constructor;e:if(null!=t){if(f=e.d,!f)return e;for(i=1,s=f[0];s>=10;s/=10)i++;if(o=t-i,o<0)o+=ke,a=t,l=f[h=0],u=l/Se(10,i-a-1)%10|0;else if(h=Math.ceil((o+1)/ke),s=f.length,h>=s){if(!r)break e;for(;s++<=h;)f.push(0);l=u=0,i=1,o%=ke,a=o-ke+1}else{for(l=s=f[h],i=1;s>=10;s/=10)i++;o%=ke,a=o-ke+i,u=a<0?0:l/Se(10,i-a-1)%10|0}if(r=r||t<0||void 0!==f[h+1]||(a<0?l:l%Se(10,i-a-1)),c=n<4?(u||r)&&(0==n||n==(e.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(o>0?a>0?l/Se(10,i-a):0:f[h-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,c?(t-=e.e+1,f[0]=Se(10,(ke-t%ke)%ke),e.e=-t||0):f[0]=e.e=0,e;if(0==o?(f.length=h,s=1,h--):(f.length=h+1,s=Se(10,ke-o),f[h]=a>0?(l/Se(10,i-a)%Se(10,a)|0)*s:0),c)for(;;){if(0==h){for(o=1,a=f[0];a>=10;a/=10)o++;for(a=f[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(e.e++,f[0]==Be&&(f[0]=1));break}if(f[h]+=s,f[h]!=Be)break;f[h--]=0,s=1}for(o=f.length;0===f[--o];)f.pop()}return Ce&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function f(e,t,n){if(!e.isFinite())return C(e);var r,i=e.e,a=o(e.d),s=a.length;return t?(n&&(r=n-s)>0?a=a.charAt(0)+"."+a.slice(1)+v(r):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):i<0?(a="0."+v(-i-1)+a,n&&(r=n-s)>0&&(a+=v(r))):i>=s?(a+=v(i+1-s),n&&(r=n-i-1)>0&&(a=a+"."+v(r))):((r=i+1)<s&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(a+="."),a+=v(r))),a}function h(e,t){var n=e[0];for(t*=ke;n>=10;n/=10)t++;return t}function p(e,t,n){if(t>ze)throw Ce=!0,n&&(e.precision=n),Error(Ne);return l(new e(we),t,1,!0)}function m(e,t,n){if(t>Fe)throw Error(Ne);return l(new e(xe),t,n,!0)}function d(e){var t=e.length-1,n=t*ke+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function v(e){for(var t="";e--;)t+="0";return t}function g(e,t,n,r){var i,o=new e(1),a=Math.ceil(r/ke+4);for(Ce=!1;;){if(n%2&&(o=o.times(t),P(o.d,a)&&(i=!0)),n=Ae(n/2),0===n){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}t=t.times(t),P(t.d,a)}return Ce=!0,o}function y(e){return 1&e.d[e.d.length-1]}function w(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;){if(r=new e(t[o]),!r.s){i=r;break}i[n](r)&&(i=r)}return i}function x(e,t){var n,r,i,a,u,c,f,h=0,p=0,m=0,d=e.constructor,v=d.rounding,g=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(Ce=!1,f=g):f=t,c=new d(.03125);e.e>-2;)e=e.times(c),m+=5;for(r=Math.log(Se(2,m))/Math.LN10*2+5|0,f+=r,n=a=u=new d(1),d.precision=f;;){if(a=l(a.times(e),f,1),n=n.times(++p),c=u.plus(Re(a,n,f,1)),o(c.d).slice(0,f)===o(u.d).slice(0,f)){for(i=m;i--;)u=l(u.times(u),f,1);if(null!=t)return d.precision=g,u;if(!(h<3&&s(u.d,f-r,v,h)))return l(u,d.precision=g,v,Ce=!0);d.precision=f+=10,n=a=c=new d(1),p=0,h++}u=c}}function b(e,t){var n,r,i,a,u,c,f,h,m,d,v,g=1,y=10,w=e,x=w.d,C=w.constructor,M=C.rounding,T=C.precision;if(w.s<0||!x||!x[0]||!w.e&&1==x[0]&&1==x.length)return new C(x&&!x[0]?-1/0:1!=w.s?NaN:x?0:w);if(null==t?(Ce=!1,m=T):m=t,C.precision=m+=y,n=o(x),r=n.charAt(0),!(Math.abs(a=w.e)<15e14))return h=p(C,m+2,T).times(a+""),w=b(new C(r+"."+n.slice(1)),m-y).plus(h),C.precision=T,null==t?l(w,T,M,Ce=!0):w;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)w=w.times(e),n=o(w.d),r=n.charAt(0),g++;for(a=w.e,r>1?(w=new C("0."+n),a++):w=new C(r+"."+n.slice(1)),d=w,f=u=w=Re(w.minus(1),w.plus(1),m,1),v=l(w.times(w),m,1),i=3;;){if(u=l(u.times(v),m,1),h=f.plus(Re(u,new C(i),m,1)),o(h.d).slice(0,m)===o(f.d).slice(0,m)){if(f=f.times(2),0!==a&&(f=f.plus(p(C,m+2,T).times(a+""))),f=Re(f,new C(g),m,1),null!=t)return C.precision=T,f;if(!s(f.d,m-y,M,c))return l(f,C.precision=T,M,Ce=!0);C.precision=m+=y,h=u=w=Re(d.minus(1),d.plus(1),m,1),v=l(w.times(w),m,1),i=c=1}f=h,i+=2}}function C(e){return String(e.s*e.s/0)}function M(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%ke,n<0&&(r+=ke),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=ke;r<i;)e.d.push(+t.slice(r,r+=ke));t=t.slice(r),r=ke-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),Ce&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function T(e,t){var n,r,i,o,a,s,c,l,f;if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Oe.test(t))n=16,t=t.toLowerCase();else if(Pe.test(t))n=2;else{if(!_e.test(t))throw Error(Te+t);n=8}for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),a=o>=0,r=e.constructor,a&&(t=t.replace(".",""),s=t.length,o=s-o,i=g(r,new r(n),o,2*o)),l=u(t,n,Be),f=l.length-1,o=f;0===l[o];--o)l.pop();return o<0?new r(0*e.s):(e.e=h(l,f),e.d=l,Ce=!1,a&&(e=Re(e,i,4*s)),c&&(e=e.times(Math.abs(c)<54?Math.pow(2,c):be.pow(2,c))),Ce=!0,e)}function N(e,t){var n,r=t.d.length;if(r<3)return E(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:0|n,t=t.times(Math.pow(5,-n)),t=E(e,2,t,t);for(var i,o=new e(5),a=new e(16),s=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(a.times(i).minus(s))));return t}function E(e,t,n,r,i){var o,a,s,u,c=1,l=e.precision,f=Math.ceil(l/ke);for(Ce=!1,u=n.times(n),s=new e(r);;){if(a=Re(s.times(u),new e(t++*t++),l,1),s=i?r.plus(a):r.minus(a),r=Re(a.times(u),new e(t++*t++),l,1),a=s.plus(r),void 0!==a.d[f]){for(o=f;a.d[o]===s.d[o]&&o--;);if(o==-1)break}o=s,s=r,r=a,a=o,c++}return Ce=!0,a.d.length=f+1,a}function A(e,t){var n,r=t.s<0,i=m(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return de=r?4:1,t;if(n=t.divToInt(i),n.isZero())de=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return de=y(n)?r?2:3:r?4:1,t;de=y(n)?r?1:4:r?3:2}return t.minus(i).abs()}function S(e,t,n,r){var i,o,s,c,l,h,p,m,d,v=e.constructor,g=void 0!==n;if(g?(a(n,1,ge),void 0===r?r=v.rounding:a(r,0,8)):(n=v.precision,r=v.rounding),e.isFinite()){for(p=f(e),s=p.indexOf("."),g?(i=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):i=t,s>=0&&(p=p.replace(".",""),d=new v(1),d.e=p.length-s,d.d=u(f(d),10,i),d.e=d.d.length),m=u(p,10,i),o=l=m.length;0==m[--l];)m.pop();if(m[0]){if(s<0?o--:(e=new v(e),e.d=m,e.e=o,e=Re(e,d,n,r,0,i),m=e.d,o=e.e,h=me),s=m[n],c=i/2,h=h||void 0!==m[n+1],h=r<4?(void 0!==s||h)&&(0===r||r===(e.s<0?3:2)):s>c||s===c&&(4===r||h||6===r&&1&m[n-1]||r===(e.s<0?8:7)),m.length=n,h)for(;++m[--n]>i-1;)m[n]=0,n||(++o,m.unshift(1));for(l=m.length;!m[l-1];--l);for(s=0,p="";s<l;s++)p+=ye.charAt(m[s]);if(g){if(l>1)if(16==t||8==t){for(s=16==t?4:3,--l;l%s;l++)p+="0";for(m=u(p,i,t),l=m.length;!m[l-1];--l);for(s=1,p="1.";s<l;s++)p+=ye.charAt(m[s])}else p=p.charAt(0)+"."+p.slice(1);p=p+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)p="0"+p;p="0."+p}else if(++o>l)for(o-=l;o--;)p+="0";else o<l&&(p=p.slice(0,o)+"."+p.slice(o))}else p=g?"0p+0":"0";p=(16==t?"0x":2==t?"0b":8==t?"0o":"")+p}else p=C(e);return e.s<0?"-"+p:p}function P(e,t){if(e.length>t)return e.length=t,!0}function O(e){return new this(e).abs()}function _(e){return new this(e).acos()}function I(e){return new this(e).acosh()}function B(e,t){return new this(e).plus(t)}function k(e){return new this(e).asin()}function V(e){return new this(e).asinh()}function z(e){return new this(e).atan()}function F(e){return new this(e).atanh()}function D(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?m(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=m(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(Re(e,t,o,1)),t=m(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(Re(e,t,o,1)):(n=m(this,o,1).times(t.s>0?.25:.75),n.s=e.s):n=new this(NaN),n}function R(e){return new this(e).cbrt()}function U(e){return l(e=new this(e),e.e+1,2)}function L(e){if(!e||"object"!=typeof e)throw Error(Me+"Object expected");var t,n,r,i=["precision",1,ge,"rounding",0,8,"toExpNeg",-ve,0,"toExpPos",0,ve,"maxE",0,ve,"minE",-ve,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(void 0!==(r=e[n=i[t]])){if(!(Ae(r)===r&&r>=i[t+1]&&r<=i[t+2]))throw Error(Te+n+": "+r);this[n]=r}if(void 0!==(r=e[n="crypto"])){if(r!==!0&&r!==!1&&0!==r&&1!==r)throw Error(Te+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(Ee);this[n]=!0}else this[n]=!1}return this}function q(e){return new this(e).cos()}function j(e){return new this(e).cosh()}function W(e){function t(e){var n,r,i,o=this;if(!(o instanceof t))return new t(e);if(o.constructor=t,e instanceof t)return o.s=e.s,o.e=e.e,void(o.d=(e=e.d)?e.slice():e);if(i=typeof e,"number"===i){if(0===e)return o.s=1/e<0?-1:1,o.e=0,void(o.d=[0]);if(e<0?(e=-e,o.s=-1):o.s=1,e===~~e&&e<1e7){for(n=0,r=e;r>=10;r/=10)n++;return o.e=n,void(o.d=[e])}return 0*e!==0?(e||(o.s=NaN),o.e=NaN,void(o.d=null)):M(o,e.toString())}if("string"!==i)throw Error(Te+e);return 45===e.charCodeAt(0)?(e=e.slice(1),o.s=-1):o.s=1,Ie.test(e)?M(o,e):T(o,e)}var n,r,i;if(t.prototype=De,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.EUCLID=9,t.config=t.set=L,t.clone=W,t.abs=O,t.acos=_,t.acosh=I,t.add=B,t.asin=k,t.asinh=V,t.atan=z,t.atanh=F,t.atan2=D,t.cbrt=R,t.ceil=U,t.cos=q,t.cosh=j,t.div=G,t.exp=H,t.floor=$,t.hypot=Z,t.ln=Y,t.log=X,t.log10=Q,t.log2=J,t.max=K,t.min=ee,t.mod=te,t.mul=ne,t.pow=re,t.random=ie,t.round=oe,t.sign=ae,t.sin=se,t.sinh=ue,t.sqrt=ce,t.sub=le,t.tan=fe,t.tanh=he,t.trunc=pe,void 0===e&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)e.hasOwnProperty(r=i[n++])||(e[r]=this[r]);return t.config(e),t}function G(e,t){return new this(e).div(t)}function H(e){return new this(e).exp()}function $(e){return l(e=new this(e),e.e+1,3)}function Z(){var e,t,n=new this(0);for(Ce=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return Ce=!0,new this(1/0);n=t}return Ce=!0,n.sqrt()}function Y(e){return new this(e).ln()}function X(e,t){return new this(e).log(t)}function J(e){return new this(e).log(2)}function Q(e){return new this(e).log(10)}function K(){return w(this,arguments,"lt")}function ee(){return w(this,arguments,"gt")}function te(e,t){return new this(e).mod(t)}function ne(e,t){return new this(e).mul(t)}function re(e,t){return new this(e).pow(t)}function ie(e){var t,n,r,i,o=0,s=new this(1),u=[];if(void 0===e?e=this.precision:a(e,1,ge),r=Math.ceil(e/ke),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:u[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error(Ee);for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(u.push(i%1e7),o+=4);o=r/4}else for(;o<r;)u[o++]=1e7*Math.random()|0;for(r=u[--o],e%=ke,r&&e&&(i=Se(10,ke-e),u[o]=(r/i|0)*i);0===u[o];o--)u.pop();if(o<0)n=0,u=[0];else{for(n=-1;0===u[0];n-=ke)u.shift();for(r=1,i=u[0];i>=10;i/=10)r++;r<ke&&(n-=ke-r)}return s.e=n,s.d=u,s}function oe(e){return l(e=new this(e),e.e+1,this.rounding)}function ae(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function se(e){return new this(e).sin()}function ue(e){return new this(e).sinh()}function ce(e){return new this(e).sqrt()}function le(e,t){return new this(e).sub(t)}function fe(e){return new this(e).tan()}function he(e){return new this(e).tanh()}function pe(e){return l(e=new this(e),e.e+1,1)}var me,de,ve=9e15,ge=1e9,ye="0123456789abcdef",we="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",xe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",be={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ve,maxE:ve,crypto:!1},Ce=!0,Me="[DecimalError] ",Te=Me+"Invalid argument: ",Ne=Me+"Precision limit exceeded",Ee=Me+"crypto unavailable",Ae=Math.floor,Se=Math.pow,Pe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Oe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,_e=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ie=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Be=1e7,ke=7,Ve=9007199254740991,ze=we.length-1,Fe=xe.length-1,De={};De.absoluteValue=De.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),l(e)},De.ceil=function(){return l(new this.constructor(this),this.e+1,2)},De.comparedTo=De.cmp=function(e){var t,n,r,i,o=this,a=o.d,s=(e=new o.constructor(e)).d,u=o.s,c=e.s;if(!a||!s)return u&&c?u!==c?u:a===s?0:!a^u<0?1:-1:NaN;if(!a[0]||!s[0])return a[0]?u:s[0]?-c:0;if(u!==c)return u;if(o.e!==e.e)return o.e>e.e^u<0?1:-1;for(r=a.length,i=s.length,t=0,n=r<i?r:i;t<n;++t)if(a[t]!==s[t])return a[t]>s[t]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1},De.cosine=De.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+ke,r.rounding=1,n=c(r,A(r,n)),r.precision=e,r.rounding=t,l(2==de||3==de?n.neg():n,e,t,!0)):new r(1):new r(NaN)},De.cubeRoot=De.cbrt=function(){var e,t,n,r,i,a,s,u,c,f,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(Ce=!1,a=h.s*Math.pow(h.s*h,1/3),a&&Math.abs(a)!=1/0?r=new p(a.toString()):(n=o(h.d),e=h.e,(a=(e-n.length+1)%3)&&(n+=1==a||a==-2?"0":"00"),a=Math.pow(n,1/3),e=Ae((e+1)/3)-(e%3==(e<0?-1:2)),a==1/0?n="5e"+e:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new p(n),r.s=h.s),s=(e=p.precision)+3;;)if(u=r,c=u.times(u).times(u),f=c.plus(h),r=Re(f.plus(h).times(u),f.plus(c),s+2,1),o(u.d).slice(0,s)===(n=o(r.d)).slice(0,s)){if(n=n.slice(s-3,s+1),"9999"!=n&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(l(r,e+1,1),t=!r.times(r).times(r).eq(h));break}if(!i&&(l(u,e+1,0),u.times(u).times(u).eq(h))){r=u;break}s+=4,i=1}return Ce=!0,l(r,e,p.rounding,t)},De.decimalPlaces=De.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-Ae(this.e/ke))*ke,e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},De.dividedBy=De.div=function(e){return Re(this,new this.constructor(e))},De.dividedToIntegerBy=De.divToInt=function(e){var t=this,n=t.constructor;return l(Re(t,new n(e),0,1,1),n.precision,n.rounding)},De.equals=De.eq=function(e){return 0===this.cmp(e)},De.floor=function(){return l(new this.constructor(this),this.e+1,3)},De.greaterThan=De.gt=function(e){return this.cmp(e)>0},De.greaterThanOrEqualTo=De.gte=function(e){var t=this.cmp(e);return 1==t||0===t},De.hyperbolicCosine=De.cosh=function(){var e,t,n,r,i,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;n=a.precision,r=a.rounding,a.precision=n+Math.max(o.e,o.sd())+4,a.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=Math.pow(4,-e).toString()):(e=16,t="2.3283064365386962890625e-10"),o=E(a,1,o.times(t),new a(1),!0);for(var u,c=e,f=new a(8);c--;)u=o.times(o),o=s.minus(u.times(f.minus(u.times(f))));return l(o,a.precision=n,a.rounding=r,!0)},De.hyperbolicSine=De.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=E(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:0|e,i=i.times(Math.pow(5,-e)),i=E(o,2,i,i,!0);for(var a,s=new o(5),u=new o(16),c=new o(20);e--;)a=i.times(i),i=i.times(s.plus(a.times(u.times(a).plus(c))))}return o.precision=t,o.rounding=n,l(i,t,n,!0)},De.hyperbolicTangent=De.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,Re(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},De.inverseCosine=De.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?0===r?t.isNeg()?m(n,i,o):new n(0):new n(NaN):t.isZero()?m(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=m(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))},De.inverseHyperbolicCosine=De.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,Ce=!1,n=n.times(n).minus(1).sqrt().plus(n),Ce=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},De.inverseHyperbolicSine=De.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,Ce=!1,n=n.times(n).plus(1).sqrt().plus(n),Ce=!0,r.precision=e,r.rounding=t,n.ln())},De.inverseHyperbolicTangent=De.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?l(new o(i),e,t,!0):(o.precision=n=r-i.e,i=Re(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)},De.inverseSine=De.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?0===t?(e=m(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},De.inverseTangent=De.atan=function(){var e,t,n,r,i,o,a,s,u,c=this,f=c.constructor,h=f.precision,p=f.rounding;if(c.isFinite()){if(c.isZero())return new f(c);if(c.abs().eq(1)&&h+4<=Fe)return a=m(f,h+4,p).times(.25),a.s=c.s,a}else{if(!c.s)return new f(NaN);if(h+4<=Fe)return a=m(f,h+4,p).times(.5),a.s=c.s,a}for(f.precision=s=h+10,f.rounding=1,n=Math.min(28,s/ke+2|0),e=n;e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(Ce=!1,t=Math.ceil(s/ke),r=1,u=c.times(c),a=new f(c),i=c;e!==-1;)if(i=i.times(u),o=a.minus(i.div(r+=2)),i=i.times(u),a=o.plus(i.div(r+=2)),void 0!==a.d[t])for(e=t;a.d[e]===o.d[e]&&e--;);return n&&(a=a.times(2<<n-1)),Ce=!0,l(a,f.precision=h,f.rounding=p,!0)},De.isFinite=function(){return!!this.d},De.isInteger=De.isInt=function(){return!!this.d&&Ae(this.e/ke)>this.d.length-2},De.isNaN=function(){return!this.s},De.isNegative=De.isNeg=function(){return this.s<0},De.isPositive=De.isPos=function(){return this.s>0},De.isZero=function(){return!!this.d&&0===this.d[0]},De.lessThan=De.lt=function(e){return this.cmp(e)<0},De.lessThanOrEqualTo=De.lte=function(e){return this.cmp(e)<1},De.logarithm=De.log=function(e){var t,n,r,i,a,u,c,f,h=this,m=h.constructor,d=m.precision,v=m.rounding,g=5;if(null==e)e=new m(10),t=!0;else{if(e=new m(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new m(NaN);t=e.eq(10)}if(n=h.d,h.s<0||!n||!n[0]||h.eq(1))return new m(n&&!n[0]?-1/0:1!=h.s?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(i=n[0];i%10===0;)i/=10;a=1!==i}if(Ce=!1,c=d+g,u=b(h,c),r=t?p(m,c+10):b(e,c),f=Re(u,r,c,1),s(f.d,i=d,v))do if(c+=10,u=b(h,c),r=t?p(m,c+10):b(e,c),f=Re(u,r,c,1),!a){+o(f.d).slice(i+1,i+15)+1==1e14&&(f=l(f,d+1,0));
break}while(s(f.d,i+=10,v));return Ce=!0,l(f,d,v)},De.minus=De.sub=function(e){var t,n,r,i,o,a,s,u,c,f,p,m,d=this,v=d.constructor;if(e=new v(e),!d.d||!e.d)return d.s&&e.s?d.d?e.s=-e.s:e=new v(e.d||d.s!==e.s?d:NaN):e=new v(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(c=d.d,m=e.d,s=v.precision,u=v.rounding,!c[0]||!m[0]){if(m[0])e.s=-e.s;else{if(!c[0])return new v(3===u?-0:0);e=new v(d)}return Ce?l(e,s,u):e}if(n=Ae(e.e/ke),f=Ae(d.e/ke),c=c.slice(),o=f-n){for(p=o<0,p?(t=c,o=-o,a=m.length):(t=m,n=f,a=c.length),r=Math.max(Math.ceil(s/ke),a)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=c.length,a=m.length,p=r<a,p&&(a=r),r=0;r<a;r++)if(c[r]!=m[r]){p=c[r]<m[r];break}o=0}for(p&&(t=c,c=m,m=t,e.s=-e.s),a=c.length,r=m.length-a;r>0;--r)c[a++]=0;for(r=m.length;r>o;){if(c[--r]<m[r]){for(i=r;i&&0===c[--i];)c[i]=Be-1;--c[i],c[r]+=Be}c[r]-=m[r]}for(;0===c[--a];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=h(c,n),Ce?l(e,s,u):e):new v(3===u?-0:0)},De.modulo=De.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?l(new r(n),r.precision,r.rounding):(Ce=!1,9==r.modulo?(t=Re(n,e.abs(),0,3,1),t.s*=e.s):t=Re(n,e,0,r.modulo,1),t=t.times(e),Ce=!0,n.minus(t))},De.naturalExponential=De.exp=function(){return x(this)},De.naturalLogarithm=De.ln=function(){return b(this)},De.negated=De.neg=function(){var e=new this.constructor(this);return e.s=-e.s,l(e)},De.plus=De.add=function(e){var t,n,r,i,o,a,s,u,c,f,p=this,m=p.constructor;if(e=new m(e),!p.d||!e.d)return p.s&&e.s?p.d||(e=new m(e.d||p.s===e.s?p:NaN)):e=new m(NaN),e;if(p.s!=e.s)return e.s=-e.s,p.minus(e);if(c=p.d,f=e.d,s=m.precision,u=m.rounding,!c[0]||!f[0])return f[0]||(e=new m(p)),Ce?l(e,s,u):e;if(o=Ae(p.e/ke),r=Ae(e.e/ke),c=c.slice(),i=o-r){for(i<0?(n=c,i=-i,a=f.length):(n=f,r=o,a=c.length),o=Math.ceil(s/ke),a=o>a?o+1:a+1,i>a&&(i=a,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(a=c.length,i=f.length,a-i<0&&(i=a,n=f,f=c,c=n),t=0;i;)t=(c[--i]=c[i]+f[i]+t)/Be|0,c[i]%=Be;for(t&&(c.unshift(t),++r),a=c.length;0==c[--a];)c.pop();return e.d=c,e.e=h(c,r),Ce?l(e,s,u):e},De.precision=De.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(Te+e);return n.d?(t=d(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},De.round=function(){var e=this,t=e.constructor;return l(new t(e),e.e+1,t.rounding)},De.sine=De.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+ke,r.rounding=1,n=N(r,A(r,n)),r.precision=e,r.rounding=t,l(de>2?n.neg():n,e,t,!0)):new r(NaN)},De.squareRoot=De.sqrt=function(){var e,t,n,r,i,a,s=this,u=s.d,c=s.e,f=s.s,h=s.constructor;if(1!==f||!u||!u[0])return new h(!f||f<0&&(!u||u[0])?NaN:u?s:1/0);for(Ce=!1,f=Math.sqrt(+s),0==f||f==1/0?(t=o(u),(t.length+c)%2==0&&(t+="0"),f=Math.sqrt(t),c=Ae((c+1)/2)-(c<0||c%2),f==1/0?t="1e"+c:(t=f.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new h(t)):r=new h(f.toString()),n=(c=h.precision)+3;;)if(a=r,r=a.plus(Re(s,a,n+2,1)).times(.5),o(a.d).slice(0,n)===(t=o(r.d)).slice(0,n)){if(t=t.slice(n-3,n+1),"9999"!=t&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(l(r,c+1,1),e=!r.times(r).eq(s));break}if(!i&&(l(a,c+1,0),a.times(a).eq(s))){r=a;break}n+=4,i=1}return Ce=!0,l(r,c,h.rounding,e)},De.tangent=De.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=Re(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,l(2==de||4==de?n.neg():n,e,t,!0)):new r(NaN)},De.times=De.mul=function(e){var t,n,r,i,o,a,s,u,c,f=this,p=f.constructor,m=f.d,d=(e=new p(e)).d;if(e.s*=f.s,!(m&&m[0]&&d&&d[0]))return new p(!e.s||m&&!m[0]&&!d||d&&!d[0]&&!m?NaN:m&&d?0*e.s:e.s/0);for(n=Ae(f.e/ke)+Ae(e.e/ke),u=m.length,c=d.length,u<c&&(o=m,m=d,d=o,a=u,u=c,c=a),o=[],a=u+c,r=a;r--;)o.push(0);for(r=c;--r>=0;){for(t=0,i=u+r;i>r;)s=o[i]+d[r]*m[i-r-1]+t,o[i--]=s%Be|0,t=s/Be|0;o[i]=(o[i]+t)%Be|0}for(;!o[--a];)o.pop();return t?++n:o.shift(),e.d=o,e.e=h(o,n),Ce?l(e,p.precision,p.rounding):e},De.toBinary=function(e,t){return S(this,2,e,t)},De.toDecimalPlaces=De.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(a(e,0,ge),void 0===t?t=r.rounding:a(t,0,8),l(n,e+n.e+1,t))},De.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=f(r,!0):(a(e,0,ge),void 0===t?t=i.rounding:a(t,0,8),r=l(new i(r),e+1,t),n=f(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},De.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return void 0===e?n=f(i):(a(e,0,ge),void 0===t?t=o.rounding:a(t,0,8),r=l(new o(i),e+i.e+1,t),n=f(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},De.toFraction=function(e){var t,n,r,i,a,s,u,c,l,f,h,p,m=this,v=m.d,g=m.constructor;if(!v)return new g(m);if(l=n=new g(1),r=c=new g(0),t=new g(r),a=t.e=d(v)-m.e-1,s=a%ke,t.d[0]=Se(10,s<0?ke+s:s),null==e)e=a>0?t:l;else{if(u=new g(e),!u.isInt()||u.lt(l))throw Error(Te+u);e=u.gt(t)?a>0?t:l:u}for(Ce=!1,u=new g(o(v)),f=g.precision,g.precision=a=v.length*ke*2;h=Re(u,t,0,1,1),i=n.plus(h.times(r)),1!=i.cmp(e);)n=r,r=i,i=l,l=c.plus(h.times(i)),c=i,i=t,t=u.minus(h.times(i)),u=i;return i=Re(e.minus(n),r,0,1,1),c=c.plus(i.times(l)),n=n.plus(i.times(r)),c.s=l.s=m.s,p=Re(l,r,a,1).minus(m).abs().cmp(Re(c,n,a,1).minus(m).abs())<1?[l,r]:[c,n],g.precision=f,Ce=!0,p},De.toHexadecimal=De.toHex=function(e,t){return S(this,16,e,t)},De.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0!==t&&a(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(Ce=!1,t<4&&(t=[4,5,7,8][t]),n=Re(n,e,0,t,1).times(e),Ce=!0,l(n)):(e.s=n.s,n=e),n},De.toNumber=function(){return+this},De.toOctal=function(e,t){return S(this,8,e,t)},De.toPower=De.pow=function(e){var t,n,r,i,a,u,c,f=this,h=f.constructor,p=+(e=new h(e));if(!(f.d&&e.d&&f.d[0]&&e.d[0]))return new h(Se(+f,p));if(f=new h(f),f.eq(1))return f;if(r=h.precision,a=h.rounding,e.eq(1))return l(f,r,a);if(t=Ae(e.e/ke),n=e.d.length-1,c=t>=n,u=f.s,c){if((n=p<0?-p:p)<=Ve)return i=g(h,f,n,r),e.s<0?new h(1).div(i):l(i,r,a)}else if(u<0)return new h(NaN);return u=u<0&&1&e.d[Math.max(t,n)]?-1:1,n=Se(+f,p),t=0!=n&&isFinite(n)?new h(n+"").e:Ae(p*(Math.log("0."+o(f.d))/Math.LN10+f.e+1)),t>h.maxE+1||t<h.minE-1?new h(t>0?u/0:0):(Ce=!1,h.rounding=f.s=1,n=Math.min(12,(t+"").length),i=x(e.times(b(f,r+n)),r),i=l(i,r+5,1),s(i.d,r,a)&&(t=r+10,i=l(x(e.times(b(f,t+n)),t),t+5,1),+o(i.d).slice(r+1,r+15)+1==1e14&&(i=l(i,r+1,0))),i.s=u,Ce=!0,h.rounding=a,l(i,r,a))},De.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=f(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(a(e,1,ge),void 0===t?t=i.rounding:a(t,0,8),r=l(new i(r),e,t),n=f(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},De.toSignificantDigits=De.toSD=function(e,t){var n=this,r=n.constructor;return void 0===e?(e=r.precision,t=r.rounding):(a(e,1,ge),void 0===t?t=r.rounding:a(t,0,8)),l(new r(n),e,t)},De.toString=function(){var e=this,t=e.constructor,n=f(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},De.truncated=De.trunc=function(){return l(new this.constructor(this),this.e+1,1)},De.valueOf=De.toJSON=function(){var e=this,t=e.constructor,n=f(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var Re=function(){function e(e,t,n){var r,i=0,o=e.length;for(e=e.slice();o--;)r=e[o]*t+i,e[o]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,o,a,s,u){var c,f,h,p,m,d,v,g,y,w,x,b,C,M,T,N,E,A,S,P,O=r.constructor,_=r.s==i.s?1:-1,I=r.d,B=i.d;if(!(I&&I[0]&&B&&B[0]))return new O(r.s&&i.s&&(I?!B||I[0]!=B[0]:B)?I&&0==I[0]||!B?0*_:_/0:NaN);for(u?(m=1,f=r.e-i.e):(u=Be,m=ke,f=Ae(r.e/m)-Ae(i.e/m)),S=B.length,E=I.length,y=new O(_),w=y.d=[],h=0;B[h]==(I[h]||0);h++);if(B[h]>(I[h]||0)&&f--,null==o?(M=o=O.precision,a=O.rounding):M=s?o+(r.e-i.e)+1:o,M<0)w.push(1),d=!0;else{if(M=M/m+2|0,h=0,1==S){for(p=0,B=B[0],M++;(h<E||p)&&M--;h++)T=p*u+(I[h]||0),w[h]=T/B|0,p=T%B|0;d=p||h<E}else{for(p=u/(B[0]+1)|0,p>1&&(B=e(B,p,u),I=e(I,p,u),S=B.length,E=I.length),N=S,x=I.slice(0,S),b=x.length;b<S;)x[b++]=0;P=B.slice(),P.unshift(0),A=B[0],B[1]>=u/2&&++A;do p=0,c=t(B,x,S,b),c<0?(C=x[0],S!=b&&(C=C*u+(x[1]||0)),p=C/A|0,p>1?(p>=u&&(p=u-1),v=e(B,p,u),g=v.length,b=x.length,c=t(v,x,g,b),1==c&&(p--,n(v,S<g?P:B,g,u))):(0==p&&(c=p=1),v=B.slice()),g=v.length,g<b&&v.unshift(0),n(x,v,b,u),c==-1&&(b=x.length,c=t(B,x,S,b),c<1&&(p++,n(x,S<b?P:B,b,u))),b=x.length):0===c&&(p++,x=[0]),w[h++]=p,c&&x[0]?x[b++]=I[N]||0:(x=[I[N]],b=1);while((N++<E||void 0!==x[0])&&M--);d=void 0!==x[0]}w[0]||w.shift()}if(1==m)y.e=f,me=d;else{for(h=1,p=w[0];p>=10;p/=10)h++;y.e=h+f*m-1,l(y,s?o+y.e+1:o,a,d)}return y}}();be=W(be),we=new be(we),xe=new be(xe),r=function(){return be}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)},function(e,t,n){var r,i;!function(n){"use strict";function o(e){var t=function(){var t=Error.apply(this,arguments);t.name=this.name=e,this.stack=t.stack,this.message=t.message},n=function(){};return n.prototype=Error.prototype,t.prototype=new n,t}function a(e,t){return isNaN(e=parseInt(e,10))&&s(),e*t}function s(){throw new h}function u(e,t){return this instanceof u?(p(e,t),e=u.REDUCE?g(l.d,l.n):1,this.s=l.s,this.n=l.n/e,void(this.d=l.d/e)):new u(e,t)}var c=2e3,l={s:1,n:0,d:1},f=u.DivisionByZero=o("DivisionByZero"),h=u.InvalidParameter=o("InvalidParameter"),p=function(e,t){var n,r=0,i=1,o=1,u=0,c=0,h=0,p=1,m=1,d=0,v=1,g=1,y=1,w=1e7;if(void 0===e||null===e);else if(void 0!==t)r=e,i=t,o=r*i;else switch(typeof e){case"object":"d"in e&&"n"in e?(r=e.n,i=e.d,"s"in e&&(r*=e.s)):0 in e?(r=e[0],1 in e&&(i=e[1])):s(),o=r*i;break;case"number":if(e<0&&(o=e,e=-e),e%1===0)r=e;else if(e>0){for(e>=1&&(m=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)),e/=m);v<=w&&y<=w;){if(n=(d+g)/(v+y),e===n){v+y<=w?(r=d+g,i=v+y):y>v?(r=g,i=y):(r=d,i=v);break}e>n?(d+=g,v+=y):(g+=d,y+=v),v>w?(r=g,i=y):(r=d,i=v)}r*=m}else(isNaN(e)||isNaN(t))&&(i=r=NaN);break;case"string":if(v=e.match(/\d+|./g),"-"===v[d]?(o=-1,d++):"+"===v[d]&&d++,v.length===d+1?c=a(v[d++],o):"."===v[d+1]||"."===v[d]?("."!==v[d]&&(u=a(v[d++],o)),d++,(d+1===v.length||"("===v[d+1]&&")"===v[d+3]||"'"===v[d+1]&&"'"===v[d+3])&&(c=a(v[d],o),p=Math.pow(10,v[d].length),d++),("("===v[d]&&")"===v[d+2]||"'"===v[d]&&"'"===v[d+2])&&(h=a(v[d+1],o),m=Math.pow(10,v[d+1].length)-1,d+=3)):"/"===v[d+1]||":"===v[d+1]?(c=a(v[d],o),p=a(v[d+2],1),d+=3):"/"===v[d+3]&&" "===v[d+1]&&(u=a(v[d],o),c=a(v[d+2],o),p=a(v[d+4],1),d+=5),v.length<=d){i=p*m,o=r=h+i*u+m*c;break}default:s()}if(0===i)throw new f;l.s=o<0?-1:1,l.n=Math.abs(r),l.d=Math.abs(i)},m=function(e,t,n){for(var r=1;t>0;e=e*e%n,t>>=1)1&t&&(r=r*e%n);return r},d=function(e,t){for(;t%2===0;t/=2);for(;t%5===0;t/=5);if(1===t)return 0;for(var n=10%t,r=1;1!==n;r++)if(n=10*n%t,r>c)return 0;return r},v=function(e,t,n){for(var r=1,i=m(10,n,t),o=0;o<300;o++){if(r===i)return o;r=10*r%t,i=10*i%t}return 0},g=function(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}};u.REDUCE=1,u.prototype={s:1,n:0,d:1,abs:function(){return new u(this.n,this.d)},neg:function(){return new u(-this.s*this.n,this.d)},add:function(e,t){return p(e,t),new u(this.s*this.n*l.d+l.s*this.d*l.n,this.d*l.d)},sub:function(e,t){return p(e,t),new u(this.s*this.n*l.d-l.s*this.d*l.n,this.d*l.d)},mul:function(e,t){return p(e,t),new u(this.s*l.s*this.n*l.n,this.d*l.d)},div:function(e,t){return p(e,t),new u(this.s*l.s*this.n*l.d,this.d*l.n)},clone:function(){return new u(this)},mod:function(e,t){return isNaN(this.n)||isNaN(this.d)?new u(NaN):void 0===e?new u(this.s*this.n%this.d,1):(p(e,t),0===l.n&&0===this.d&&u(0,0),new u(this.s*l.d*this.n%(l.n*this.d),l.d*this.d))},gcd:function(e,t){return p(e,t),new u(g(l.n,this.n),l.d*this.d/g(l.d,this.d))},lcm:function(e,t){return p(e,t),0===l.n&&0===this.n?new u:new u(l.n*this.n/g(l.n,this.n),g(l.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new u(NaN):new u(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new u(NaN):new u(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new u(NaN):new u(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return new u(this.s*this.d,this.n)},pow:function(e){return e<0?new u(Math.pow(this.s*this.d,-e),Math.pow(this.n,-e)):new u(Math.pow(this.s*this.n,e),Math.pow(this.d,e))},equals:function(e,t){return p(e,t),this.s*this.n*l.d===l.s*l.n*this.d},compare:function(e,t){p(e,t);var n=this.s*this.n*l.d-l.s*l.n*this.d;return(0<n)-(n<0)},divisible:function(e,t){return p(e,t),!(!(l.n*this.d)||this.n*l.d%(l.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(e&&(t=Math.floor(r/i))>0&&(n+=t,n+=" ",r%=i),n+=r,n+="/",n+=i),n},toLatex:function(e){var t,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(e&&(t=Math.floor(r/i))>0&&(n+=t,r%=i),n+="\\frac{",n+=r,n+="}{",n+=i,n+="}"),n},toContinued:function(){var e,t=this.n,n=this.d,r=[];do r.push(Math.floor(t/n)),e=t%n,t=n,n=e;while(1!==t);return r},toString:function(){var e,t=this.n,n=this.d;if(isNaN(t)||isNaN(n))return"NaN";u.REDUCE||(e=g(t,n),t/=e,n/=e);for(var r=String(t).split(""),i=0,o=[~this.s?"":"-","",""],a="",s=d(t,n),c=v(t,n,s),l=-1,f=1,h=15+s+c+r.length,p=0;p<h;p++,i*=10){if(p<r.length?i+=Number(r[p]):(f=2,l++),s>0)if(l===c)o[f]+=a+"(",a="";else if(l===s+c){o[f]+=a+")";break}i>=n?(o[f]+=a+(i/n|0),a="",i%=n):f>1?a+="0":o[f]&&(o[f]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},r=[],i=function(){return u}.apply(t,r),!(void 0!==i&&(e.exports=i))}(this)},function(e,t,n){"use strict";(function(t){function n(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=d&o+e[i%n]+(t=a[i])],a[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,a=r.S;e--;)t=a[i=d&i+1],n=n*s+a[d&(a[i]=a[o=d&o+t])+(a[o]=t)];return r.i=i,r.j=o,n})(s)}function r(e,t){var n,i=[],o=(typeof e)[0];if(t&&"o"==o)for(n in e)try{i.push(r(e[n],t-1))}catch(e){}return i.length?i:"s"==o?e:e+"\0"}function i(e,t){for(var n,r=e+"",i=0;i<r.length;)t[d&i]=d&(n^=19*t[d&i])+r.charCodeAt(i++);return a(t)}function o(e){try{return f.crypto.getRandomValues(e=new Uint8Array(s)),a(e)}catch(e){return[+new Date,f,f.navigator&&f.navigator.plugins,f.screen,a(l)]}}function a(e){return String.fromCharCode.apply(0,e)}var s=256,u=6,c=52,l=[],f="undefined"==typeof t?window:t,h=Math.pow(s,u),p=Math.pow(2,c),m=2*p,d=s-1,v=Math.random;e.exports=function(t,c){if(c&&c.global===!0)return c.global=!1,Math.random=e.exports(t,c),c.global=!0,Math.random;var f=c&&c.entropy||!1,d=[],v=(i(r(f?[t,a(l)]:0 in arguments?t:o(),3),d),new n(d));return i(a(v.S),l),function(){for(var e=v.g(u),t=h,n=0;e<p;)e=(e+n)*s,t*=s,n=v.g(1);for(;e>=m;)e/=2,t/=2,n>>>=1;return(e+n)/t}},e.exports.resetGlobal=function(){Math.random=v},i(Math.random(),l)}).call(t,n(518))},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){i.off(e,r),t.apply(n,arguments)}var i=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;for(r;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,a=r.length;o<a;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},e.exports=n},function(e,t,n){"use strict";var r,i,o;!function(n,a){i=[],r=a,o="function"==typeof r?r.apply(t,i):r,!(void 0!==o&&(e.exports=o))}(this,function(){function e(){function t(e){for(var t,n=0;n<T.types.length;n++){var r=T.types[n];if(r.name===e){t=r.test;break}}if(!t){var i;for(n=0;n<T.types.length;n++)if(r=T.types[n],r.name.toLowerCase()==e.toLowerCase()){i=r.name;break}throw new Error('Unknown type "'+e+'"'+(i?'. Did you mean "'+i+'"?':""))}return t}function n(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(r.signatures&&""!=r.name)if(""==t)t=r.name;else if(t!=r.name){var i=new Error("Function names do not match (expected: "+t+", actual: "+r.name+")");throw i.data={actual:r.name,expected:t},i}}return t}function r(e,t,n,r,i){var o,a=d(r),s=i?i.split(","):null,u=e||"unnamed",c=s&&v(s,"any"),l={fn:e,index:n,actual:r,expected:s};o=s?t>n&&!c?"Unexpected type of argument in function "+u+" (expected: "+s.join(" or ")+", actual: "+a+", index: "+n+")":"Too few arguments in function "+u+" (expected: "+s.join(" or ")+", index: "+n+")":"Too many arguments in function "+u+" (expected: "+n+", actual: "+t+")";var f=new TypeError(o);return f.data=l,f}function i(e){this.name=e||"refs",this.categories={}}function o(e,t){if("string"==typeof e){var n=e.trim(),r="..."===n.substr(0,3);if(r&&(n=n.substr(3)),""===n)this.types=["any"];else{this.types=n.split("|");for(var i=0;i<this.types.length;i++)this.types[i]=this.types[i].trim()}}else{if(!Array.isArray(e)){if(e instanceof o)return e.clone();throw new Error("String or Array expected")}this.types=e}this.conversions=[],this.varArgs=r||t||!1,this.anyType=this.types.indexOf("any")!==-1}function a(e,t){var n;if("string"==typeof e)n=""!==e?e.split(","):[];else{if(!Array.isArray(e))throw new Error("string or Array expected");n=e}this.params=new Array(n.length),this.anyType=!1,this.varArgs=!1;for(var r=0;r<n.length;r++){var i=new o(n[r]);if(this.params[r]=i,i.anyType&&(this.anyType=!0),r===n.length-1)this.varArgs=i.varArgs;else if(i.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."')}this.fn=t}function s(e,t,n,r){this.path=e||[],this.param=e[e.length-1]||null,this.signature=t||null,this.childs=n||[],this.fallThrough=r||!1}function u(e){var t,n,r={},i=[];for(var o in e)if(e.hasOwnProperty(o)){var s=e[o];if(t=new a(o,s),t.ignore())continue;var u=t.expand();for(n=0;n<u.length;n++){var c=u[n],l=c.toString(),f=r[l];if(f){var h=a.compare(c,f);if(h<0)r[l]=c;else if(0===h)throw new Error('Signature "'+l+'" is defined twice')}else r[l]=c}}for(l in r)r.hasOwnProperty(l)&&i.push(r[l]);for(i.sort(function(e,t){return a.compare(e,t)}),n=0;n<i.length;n++)if(t=i[n],t.varArgs)for(var p=t.params.length-1,m=t.params[p],d=0;d<m.types.length;){if(m.conversions[d])for(var g=m.types[d],y=0;y<i.length;y++){var w=i[y],x=w.params[p];if(w!==t&&x&&v(x.types,g)&&!x.conversions[p]){m.types.splice(d,1),m.conversions.splice(d,1),d--;break}}d++}return i}function c(e){for(var t=[],n=0;n<e.length;n++)e[n].anyType&&t.push(e[n]);return t}function l(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if(r.fn&&!r.hasConversions()){var i=r.params.join(",");t[i]=r.fn}}return t}function f(e,t,n){var r,i,a,u=t.length,c=[];for(r=0;r<e.length;r++)i=e[r],i.params.length!==u||a||(a=i),void 0!=i.params[u]&&c.push(i);c.sort(function(e,t){return o.compare(e.params[u],t.params[u])});var l=[];for(r=0;r<c.length;r++){i=c[r];var h=i.params[u],p=l.filter(function(e){return e.param.overlapping(h)})[0];if(p){if(p.param.varArgs)throw new Error('Conflicting types "'+p.param+'" and "'+h+'"');p.signatures.push(i)}else l.push({param:h,signatures:[i]})}var m=[];for(r=0;r<n.length;r++)n[r].paramsStartWith(t)&&m.push(n[r]);var d=!1;for(r=0;r<m.length;r++)if(!v(e,m[r])){d=!0;break}var g=new Array(l.length);for(r=0;r<l.length;r++){var y=l[r];g[r]=f(y.signatures,t.concat(y.param),m)}return new s(t,a,g,d)}function h(e){for(var t=[],n=0;n<e;n++)t[n]="arg"+n;return t}function p(e,t){var n=new i,o=u(t);if(0==o.length)throw new Error("No signatures provided");var a=c(o),s=f(o,[],a),p=[],d=e||"",v=h(m(o));p.push("function "+d+"("+v.join(", ")+") {"),p.push('  "use strict";'),p.push("  var name = '"+d+"';"),p.push(s.toCode(n,"  ",!1)),p.push("}");var g=[n.toCode(),"return "+p.join("\n")].join("\n"),y=new Function(n.name,"createError",g),w=y(n,r);return w.signatures=l(o),w}function m(e){for(var t=0,n=0;n<e.length;n++){var r=e[n].params.length;r>t&&(t=r)}return t}function d(e){for(var t,n=0;n<T.types.length;n++){var r=T.types[n];if("Object"===r.name)t=r;else if(r.test(e))return r.name}return t&&t.test(e)?t.name:"unknown"}function v(e,t){return e.indexOf(t)!==-1}function g(e){return e[e.length-1]}function y(e,t){if(!e.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof t){n=t.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(t))throw new TypeError("String array or a comma separated string expected");n=t}var i=n.join(","),o=e.signatures[i];if(o)return o;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+n.join(", ")+"))")}function w(e,t){var n=d(e);if(t===n)return e;for(var r=0;r<T.conversions.length;r++){var i=T.conversions[r];if(i.from===n&&i.to===t)return i.convert(e)}throw new Error("Cannot convert from "+n+" to "+t)}i.prototype.add=function(e,t){var n=t||"fn";this.categories[n]||(this.categories[n]=[]);var r=this.categories[n].indexOf(e);return r==-1&&(r=this.categories[n].length,this.categories[n].push(e)),n+r},i.prototype.toCode=function(){var e=[],t=this.name+".categories",n=this.categories;for(var r in n)if(n.hasOwnProperty(r))for(var i=n[r],o=0;o<i.length;o++)e.push("var "+r+o+" = "+t+"['"+r+"']["+o+"];");return e.join("\n")},o.compare=function(e,t){if(e.anyType)return 1;if(t.anyType)return-1;if(v(e.types,"Object"))return 1;if(v(t.types,"Object"))return-1;if(e.hasConversions()){if(t.hasConversions()){var n,r,i;for(n=0;n<e.conversions.length;n++)if(void 0!==e.conversions[n]){r=e.conversions[n];break}for(n=0;n<t.conversions.length;n++)if(void 0!==t.conversions[n]){i=t.conversions[n];break}return T.conversions.indexOf(r)-T.conversions.indexOf(i)}return 1}if(t.hasConversions())return-1;var o,a;for(n=0;n<T.types.length;n++)if(T.types[n].name===e.types[0]){o=n;break}for(n=0;n<T.types.length;n++)if(T.types[n].name===t.types[0]){a=n;break}return o-a},o.prototype.overlapping=function(e){for(var t=0;t<this.types.length;t++)if(v(e.types,this.types[t]))return!0;return!1},o.prototype.matches=function(e){return this.anyType||e.anyType||this.overlapping(e)},o.prototype.clone=function(){var e=new o(this.types.slice(),this.varArgs);return e.conversions=this.conversions.slice(),e},o.prototype.hasConversions=function(){return this.conversions.length>0},o.prototype.contains=function(e){for(var t=0;t<this.types.length;t++)if(e[this.types[t]])return!0;return!1},o.prototype.toString=function(e){for(var t=[],n={},r=0;r<this.types.length;r++){var i=this.conversions[r],o=e&&i?i.to:this.types[r];o in n||(n[o]=!0,t.push(o))}return(this.varArgs?"...":"")+t.join("|")},a.prototype.clone=function(){return new a(this.params.slice(),this.fn)},a.prototype.expand=function(){function e(n,r){if(r.length<n.params.length){var i,s,u,c=n.params[r.length];if(c.varArgs){for(s=c.clone(),i=0;i<T.conversions.length;i++)if(u=T.conversions[i],!v(c.types,u.from)&&v(c.types,u.to)){var l=s.types.length;s.types[l]=u.from,s.conversions[l]=u}e(n,r.concat(s))}else{for(i=0;i<c.types.length;i++)e(n,r.concat(new o(c.types[i])));for(i=0;i<T.conversions.length;i++)u=T.conversions[i],!v(c.types,u.from)&&v(c.types,u.to)&&(s=new o(u.from),s.conversions[0]=u,e(n,r.concat(s)))}}else t.push(new a(r,n.fn))}var t=[];return e(this,[]),t},a.compare=function(e,t){if(e.params.length>t.params.length)return 1;if(e.params.length<t.params.length)return-1;var n,r=e.params.length,i=0,a=0;for(n=0;n<r;n++)e.params[n].hasConversions()&&i++,t.params[n].hasConversions()&&a++;if(i>a)return 1;if(i<a)return-1;for(n=0;n<e.params.length;n++){var s=o.compare(e.params[n],t.params[n]);if(0!==s)return s}return 0},a.prototype.hasConversions=function(){for(var e=0;e<this.params.length;e++)if(this.params[e].hasConversions())return!0;return!1},a.prototype.ignore=function(){for(var e={},t=0;t<T.ignore.length;t++)e[T.ignore[t]]=!0;for(t=0;t<this.params.length;t++)if(this.params[t].contains(e))return!0;return!1},a.prototype.paramsStartWith=function(e){if(0===e.length)return!0;for(var t=g(this.params),n=g(e),r=0;r<e.length;r++){var i=this.params[r]||(t.varArgs?t:null),o=e[r]||(n.varArgs?n:null);if(!i||!o||!i.matches(o))return!1}return!0},a.prototype.toCode=function(e,t){for(var n=[],r=new Array(this.params.length),i=0;i<this.params.length;i++){var o=this.params[i],a=o.conversions[0];o.varArgs?r[i]="varArgs":a?r[i]=e.add(a.convert,"convert")+"(arg"+i+")":r[i]="arg"+i}var s=this.fn?e.add(this.fn,"signature"):void 0;return s?t+"return "+s+"("+r.join(", ")+"); // signature: "+this.params.join(", "):n.join("\n")},a.prototype.toString=function(){return this.params.join(", ")},s.prototype.toCode=function(e,n){var r=[];if(this.param){var i=this.path.length-1,o=this.param.conversions[0],a="// type: "+(o?o.from+" (convert to "+o.to+")":this.param);if(this.param.varArgs)if(this.param.anyType)r.push(n+"if (arguments.length > "+i+") {"),r.push(n+"  var varArgs = [];"),r.push(n+"  for (var i = "+i+"; i < arguments.length; i++) {"),r.push(n+"    varArgs.push(arguments[i]);"),r.push(n+"  }"),r.push(this.signature.toCode(e,n+"  ")),r.push(n+"}");else{for(var s=function(n,r){for(var i=[],o=0;o<n.length;o++)i[o]=e.add(t(n[o]),"test")+"("+r+")";return i.join(" || ")}.bind(this),u=this.param.types,c=[],l=0;l<u.length;l++)void 0===this.param.conversions[l]&&c.push(u[l]);r.push(n+"if ("+s(u,"arg"+i)+") { "+a),r.push(n+"  var varArgs = [arg"+i+"];"),r.push(n+"  for (var i = "+(i+1)+"; i < arguments.length; i++) {"),r.push(n+"    if ("+s(c,"arguments[i]")+") {"),r.push(n+"      varArgs.push(arguments[i]);");for(var l=0;l<u.length;l++){var f=this.param.conversions[l];if(f){var h=e.add(t(u[l]),"test"),p=e.add(f.convert,"convert");r.push(n+"    }"),r.push(n+"    else if ("+h+"(arguments[i])) {"),r.push(n+"      varArgs.push("+p+"(arguments[i]));")}}r.push(n+"    } else {"),r.push(n+"      throw createError(name, arguments.length, i, arguments[i], '"+c.join(",")+"');"),r.push(n+"    }"),r.push(n+"  }"),r.push(this.signature.toCode(e,n+"  ")),r.push(n+"}")}else if(this.param.anyType)r.push(n+"// type: any"),r.push(this._innerCode(e,n));else{var m=this.param.types[0],h="any"!==m?e.add(t(m),"test"):null;r.push(n+"if ("+h+"(arg"+i+")) { "+a),r.push(this._innerCode(e,n+"  ")),r.push(n+"}")}}else r.push(this._innerCode(e,n));return r.join("\n")},s.prototype._innerCode=function(e,t){var n,r=[];for(this.signature&&(r.push(t+"if (arguments.length === "+this.path.length+") {"),r.push(this.signature.toCode(e,t+"  ")),r.push(t+"}")),n=0;n<this.childs.length;n++)r.push(this.childs[n].toCode(e,t));if(!this.fallThrough||this.param&&this.param.anyType){var i=this._exceptions(e,t);i&&r.push(i)}return r.join("\n")},s.prototype._exceptions=function(e,t){var n=this.path.length;if(0===this.childs.length)return[t+"if (arguments.length > "+n+") {",t+"  throw createError(name, arguments.length, "+n+", arguments["+n+"]);",t+"}"].join("\n");for(var r={},i=[],o=0;o<this.childs.length;o++){var a=this.childs[o];if(a.param)for(var s=0;s<a.param.types.length;s++){var u=a.param.types[s];u in r||a.param.conversions[s]||(r[u]=!0,i.push(u))}}return t+"throw createError(name, arguments.length, "+n+", arguments["+n+"], '"+i.join(",")+"');"};var x=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:function(e){return"object"==typeof e}},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],b={},C=[],M=[],T={config:b,types:x,conversions:C,ignore:M};return T=p("typed",{Object:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);var i=n(t);return p(i,e)},"string, Object":p,"...Function":function(e){for(var t,r=n(e),i={},o=0;o<e.length;o++){var a=e[o];if("object"!=typeof a.signatures)throw t=new TypeError("Function is no typed-function (index: "+o+")"),t.data={index:o},t;for(var s in a.signatures)if(a.signatures.hasOwnProperty(s))if(i.hasOwnProperty(s)){if(a.signatures[s]!==i[s])throw t=new Error('Signature "'+s+'" is defined twice'),t.data={signature:s},t}else i[s]=a.signatures[s]}return p(r,i)}}),T.config=b,T.types=x,T.conversions=C,T.ignore=M,T.create=e,T.find=y,T.convert=w,T.addType=function(e){if(!e||"string"!=typeof e.name||"function"!=typeof e.test)throw new TypeError("Object with properties {name: string, test: function} expected");T.types.push(e)},T.addConversion=function(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");T.conversions.push(e)},T}return e()})},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){function r(e){var t=i.create(e);return t.create=r,t.import(n(141)),t}var i=n(140);e.exports=r()}])}),define("scripts/App/MeasureArea",["./math.min"],function(e){function t(){return this}var n={test:function(){var e=[];e.push({x:24.6468,y:381.461,z:845.956}),e.push({x:-37.2669,y:370.757,z:828.06}),e.push({x:-126.696,y:337.96,z:817.206}),e.push({x:-106.622,y:286.136,z:811.693}),e.push({x:-7.81157,y:286.593,z:830.903});var t=this.fitPlane(e),n=this.projectionPoints(e,t);this.convertTo2D(n,t),this.dimensionsOfPolygon(n,t)},fitPlane:function(t){var n=[[0,0,0],[0,0,0],[0,0,0]],r=[0,0,0],i=[0,0,0],o={a:0,b:0,c:0,d:0},a=t.length;if(!a)return null;for(var s=0;s<a;s++)i[0]+=t[s].x,i[1]+=t[s].y,i[2]+=t[s].z;i[0]/=a,i[1]/=a,i[2]/=a;for(var s=0;s<a;s++)n[0][0]+=(t[s].x-i[0])*(t[s].x-i[0]),n[0][1]+=(t[s].x-i[0])*(t[s].y-i[1]),n[0][2]+=t[s].x-i[0],n[1][1]+=(t[s].y-i[1])*(t[s].y-i[1]),n[1][2]+=t[s].y-i[1],r[0]+=(t[s].x-i[0])*(t[s].z-i[2]),r[1]+=(t[s].y-i[1])*(t[s].z-i[2]),r[2]+=t[s].z-i[2];n[1][0]=n[0][1],n[2][0]=n[0][2],n[2][1]=n[1][2],n[2][2]=a;var u=e.matrix(n),c=e.det(u);if(0==c)return null;var l=e.inv(u),f=e.multiply(l,r),h=e.subset(f,e.index(0)),p=e.subset(f,e.index(1)),m=e.sqrt(h*h+p*p+1);return o.a=-h/m,o.b=-p/m,o.c=1/m,o.d=(-h*i[0]-p*i[1]+i[2])/m,o},projectionPoints:function(t,n){var r=[],i=t.length;if(!i)return r;var o,a,s,u,c,l=[0,0,0],f=[n.a,n.b,n.c];l=0!=n.a?e.add(l,[n.d/n.a,0,0]):0!=n.b?e.add(l,[0,n.d/n.b,0]):e.add(l,[0,0,n.c/n.d]);for(var h=0;h<i;h++)s=[t[h].x-l[0],t[h].y-l[1],t[h].z-l[2]],u=e.dot(s,f),c=e.multiply(u,f),o=e.subtract(s,c),a=e.add(l,o),r.push({x:a[0],y:a[1],z:a[2]});return r},centroidOfPoints:function(e){for(var t={x:0,y:0,z:0},n=e.length,r=0;r<n;r++)t.x+=e[r].x,t.y+=e[r].y,t.z+=e[r].z;return n>0&&(t.x/=n,t.y/=n,t.z/=n),t},dimensionsOfPolygon:function(e,n){var r=this.convertTo2D(e,n),i=new t.Polygon2D(r);return i.is_simple()?{area:i.area(),perimeter:i.perimeter()}:{area:0,perimeter:0}},convertTo2D:function(t,n){var r=[n.b,-n.a,0],i=e.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),o=n.c,a=i;0!=i&&(r[0]/=i,r[1]/=i,r[2]/=i);for(var s,u=this.computeRotMat(r,o,a),c=(e.matrix(u),[]),l=[0,0,0],f=t.length,h=0;h<f;h++)l=[t[h].x,t[h].y,t[h].z],s=e.multiply(u,l),c.push({x:s[0],y:s[1]});return c},computeRotMat:function(e,t,n){var r=[[0,0,0],[0,0,0],[0,0,0]];return r[0][0]=t+e[0]*e[0]*(1-t),r[0][1]=e[0]*e[1]*(1-t)-e[2]*n,r[0][2]=e[0]*e[2]*(1-t)+e[1]*n,r[1][0]=e[0]*e[1]*(1-t)+e[2]*n,r[1][1]=t+e[1]*e[1]*(1-t),r[1][2]=e[2]*e[1]*(1-t)-e[0]*n,r[2][0]=e[2]*e[0]*(1-t)-e[1]*n,r[2][1]=e[2]*e[1]*(1-t)+e[0]*n,r[2][2]=t+e[2]*e[2]*(1-t),r}};return t.Polygon2D=function(e){this.points=e,this.edges=[];for(var t=this.points.length,n=1;n<t;n++)this.edges.push({x1:this.points[n-1].x,
y1:this.points[n-1].y,x2:this.points[n].x,y2:this.points[n].y});t>2&&this.edges.push({x1:this.points[t-1].x,y1:this.points[t-1].y,x2:this.points[0].x,y2:this.points[0].y})},t.Polygon2D.prototype={},t.Polygon2D.prototype.is_simple=function(){var e=this.edges.length;if(e<=3)return!0;for(var t=0;t<e;t++){var n=e-1;0==t&&(n=e-2);for(var r=t+2;r<=n;r++)if(this.lines_intersect(this.edges[t],this.edges[r]))return!1}return!0},t.Polygon2D.prototype.lines_intersect=function(e,t){var n,r,i,o,a,s;return n=e.x2-e.x1,r=e.y2-e.y1,i=t.x2-t.x1,o=t.y2-t.y1,a=(-r*(e.x1-t.x1)+n*(e.y1-t.y1))/(-i*r+n*o),s=(i*(e.y1-t.y1)-o*(e.x1-t.x1))/(-i*r+n*o),a>=0&&a<=1&&s>=0&&s<=1},t.Polygon2D.prototype.area=function(){var e=0,t=0;nbPoints=this.points.length;for(var n=0;n<nbPoints-1;n++)e+=this.points[n].x*this.points[n+1].y,t+=this.points[n].y*this.points[n+1].x;e+=this.points[nbPoints-1].x*this.points[0].y,t+=this.points[nbPoints-1].y*this.points[0].x;var r=(e-t)/2;return r<0&&(r*=-1),r},t.Polygon2D.prototype.perimeter=function(){for(var t=0,n=this.edges.length,r=0;r<n;r++)length_square=(this.edges[r].x2-this.edges[r].x1)*(this.edges[r].x2-this.edges[r].x1)+(this.edges[r].y2-this.edges[r].y1)*(this.edges[r].y2-this.edges[r].y1),t+=e.sqrt(length_square);return t},n}),define("scripts/App/MeasureAreaTool",["../Bentley/Tools/PrimitiveTool","../Bentley/Util/extend","../Bentley/Bim/InputEventModifiers","./ToolId","./MeasureToolsCommon","./MeasureArea"],function(e,t,n,r,i,o){function a(t,n,o,a){e.call(this,t,r.MeasureArea),this.referencing=n,this.formatLength=Cesium.defaultValue(a.formatLength,i.formatLengthMeters),this.formatArea=Cesium.defaultValue(a.formatArea,i.formatAreaSqMeters),this.startUrl="resources/start.png",this.finishUrl="resources/finish.png",this.labelOffset=new Cesium.Cartesian2(0,-20),this.polygonFinished=!1,this.pointPositions=[],this.pointEntities=[],this.edgeEntities=[],this.polygonEntity=null,this.labelEntity=null,this.tmpLine1Entity=null,this.tmpLine2Entity=null,this.dataSourceCollection=new Cesium.DataSourceCollection,this.dataSourceDisplay=new Cesium.DataSourceDisplay({scene:this.viewport.scene,dataSourceCollection:this.dataSourceCollection}),this.entities=this.dataSourceDisplay.defaultDataSource.entities,this.displayDepthFail=this.viewport.scene.context.fragmentDepth,this.eventHelper=new Cesium.EventHelper,this.eventHelper.add(o.onTick,function(e){this.dataSourceDisplay.update(e)},this)}return t(e,a),a.prototype.clearTemporaryPolygonCompletion=function(){this.tmpLine1Entity&&(this.entities.remove(this.tmpLine1Entity),this.tmpLine1Entity=null),this.tmpLine2Entity&&(this.entities.remove(this.tmpLine2Entity),this.tmpLine2Entity=null)},a.prototype.clearAreaPolygon=function(){if(this.polygonFinished){for(var e=0;e<this.pointEntities.length;e++)this.entities.remove(this.pointEntities[e]);this.pointEntities.length=0;for(var e=0;e<this.edgeEntities.length;e++)this.entities.remove(this.edgeEntities[e]);this.edgeEntities.length=0,this.polygonEntity&&(this.entities.remove(this.polygonEntity),this.polygonEntity=null),this.labelEntity&&(this.entities.remove(this.labelEntity),this.labelEntity=null),this.pointPositions.length=0,this.polygonFinished=!1}},a.prototype.addPoint=function(e){var t=this.entities.add({billboard:{heightReference:Cesium.HeightReference.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,image:0==this.pointEntities.length?this.startUrl:this.finishUrl},position:e});this.pointEntities.push(t),this.pointPositions.push(e);var n=this.pointPositions.length-1;if(n>0){var r={polyline:{positions:[this.pointPositions[n-1],this.pointPositions[n]],width:2,material:Cesium.Color.STEELBLUE,followSurface:!1}};if(this.displayDepthFail){var i=new Cesium.Color(.67,.03,.03);r.polyline.depthFailMaterial=i}var o=this.entities.add(r);this.edgeEntities.push(o)}},a.prototype.updatePolygonEdges=function(e){for(var t=0;t<this.edgeEntities.length;t++)this.entities.remove(this.edgeEntities[t]);this.edgeEntities.length=0;for(var t=0;t<e.length;t++){var n={polyline:{positions:[e[t],e[(t+1)%e.length]],width:2,material:Cesium.Color.STEELBLUE,followSurface:!1}};if(this.displayDepthFail){var r=new Cesium.Color(.67,.03,.03);n.polyline.depthFailMaterial=r}var i=this.entities.add(n);this.edgeEntities.push(i)}},a.prototype.onDataButtonDown=function(e){if(n.None!=e.keyModifiers)return!1;var t=this.viewport.scene;if(!t.pickPositionSupported)return!1;var r=t.pickPosition(e.viewPoint);if(!Cesium.defined(r))return!1;var i=t.pick(e.viewPoint);return!!i&&(this.polygonFinished&&this.clearAreaPolygon(),this.addPoint(r),!0)},a.prototype.onModelMotion=function(e){if(n.None!=e.keyModifiers)return!1;if(this.polygonFinished)return!1;var t=this.pointPositions.length;if(t<1)return!1;var r=this.viewport.scene;if(!r.pickPositionSupported)return!1;var i=r.pickPosition(e.viewPoint);if(!Cesium.defined(i))return!1;var o=r.pick(e.viewPoint);if(!o)return!1;this.tmpLine1Entity||(this.tmpLine1Entity=this.entities.add({polyline:{width:2,material:Cesium.Color.LIMEGREEN,followSurface:!1}}));var a=this;return this.tmpLine1Entity.polyline.positions=new Cesium.CallbackProperty(function(){return[a.pointPositions[t-1],i]},!1),t>=2&&(this.tmpLine2Entity||(this.tmpLine2Entity=this.entities.add({polyline:{width:2,material:Cesium.Color.LIMEGREEN,followSurface:!1}})),this.tmpLine2Entity.polyline.positions=new Cesium.CallbackProperty(function(){return[a.pointPositions[0],i]},!1)),!0},a.prototype.onResetButtonDown=function(e){return n.None==e.keyModifiers&&this.finishPolygon(e.viewPoint)},a.prototype.onLongPress=function(e){return this.finishPolygon(e.viewPoint)},a.prototype.finishPolygon=function(e){if(this.polygonFinished)return!1;var t=this.pointPositions.length;if(t<2)return!1;var n=this.viewport.scene;if(!n.pickPositionSupported)return!1;var r=n.pickPosition(e);if(!Cesium.defined(r))return!1;var a=n.pick(e);if(!a)return!1;this.clearTemporaryPolygonCompletion(),this.addPoint(r),this.polygonFinished=!0;var t=this.pointPositions.length;if(t>2){var s={polyline:{positions:[this.pointPositions[0],this.pointPositions[t-1]],width:2,material:Cesium.Color.STEELBLUE,followSurface:!1}};if(this.displayDepthFail){var u=new Cesium.Color(.67,.03,.03);s.polyline.depthFailMaterial=u}var c=this.entities.add(s);this.edgeEntities.push(c)}var l=[],f=!1,h=o.fitPlane(this.pointPositions),p=[];if(h)if(l=o.projectionPoints(this.pointPositions,h),p=o.dimensionsOfPolygon(l,h),p.area>0){for(var m=Array(),d=0;d<l.length;d++){var v=Cesium.Cartesian3.fromElements(l[d].x,l[d].y,l[d].z);m.push(v)}this.polygonEntity=this.entities.add({name:"polygon with per-position heights",polygon:{hierarchy:m,perPositionHeight:!0,material:Cesium.Color.CORNFLOWERBLUE.withAlpha(.5)}}),this.updatePolygonEdges(m)}else f=!0;else f=!0;var g=o.centroidOfPoints(this.pointPositions),y="";if(f)y="Error: the area could not be computed.";else{var w=this.formatArea(p.area),x=this.formatLength(p.perimeter),b=Math.max(w.length,x.length);y="Area:     "+i.paddingStringLeft(w,b)+"\nPerimeter:"+i.paddingStringLeft(x,b)}return this.labelEntity=this.entities.add({label:{heightReference:Cesium.HeightReference.NONE,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:this.labelOffset,disableDepthTestDistance:Number.POSITIVE_INFINITY,text:y},position:g}),!0},a.prototype.onCleanup=function(){return this.clearTemporaryPolygonCompletion(),this.clearAreaPolygon(),this.eventHelper.removeAll(),this.dataSourceDisplay=this.dataSourceDisplay.destroy(),this.dataSourceCollection=this.dataSourceCollection.destroy(),!0},a}),define("scripts/App/main",["../Bentley/Util/requestJson","./ToolId","./ToolFactory","./RDS","../Bentley/Bentley","../Bentley/Tools/PrimitiveTool","../Bentley/Util/extend","./MeasurePositionTool","./MeasureDistanceTool","./MeasureAreaTool","./MeasureToolsCommon"],function(e,t,n,r,o,a,s,u,c,l,f){function h(){var e,t=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i=window.location.search.substring(1);for(urlParams={};e=n.exec(i);)urlParams[r(e[1])]=r(e[2]);return urlParams}function p(e,n,r){r=Cesium.defaultValue(r,{});var i=Cesium.defaultValue(r.server,!1),a=(Cesium.defaultValue(r.debug,!1),e.createToolbar());new o.ToolbarButton(a,"Views","bim-icon-savedview",e.createViewSelectionWidget()),new o.ToolbarButton(a,"Models","bim-icon-model",e.createModelToggleWidget()),new o.ToolbarButton(a,"Categories","bim-icon-categories",e.createCategoryToggleWidget()),new o.ToolbarButton(a,"View Rotation","bim-icon-gyroscope",e.createViewRotationWidget()),new o.ToolbarButton(a,"Settings","bim-icon-settings",e.createSettingsWidget()),new o.ToolbarButton(a,"Get link","bim-icon-link",e.createViewLinkWidget()),i&&e.createElementPropertiesWidget(e);var s=e.viewport;a.addActionButton(new o.ToolAction("Fit View","bim-icon-fitview",s,t.FitView,function(){return new o.FitViewTool(s,!0)})),a.addActionButton(new o.ToolAction("Window Area","bim-icon-windowarea",s,t.WindowArea));var h=new o.ToolAction("Rotate","bim-icon-gyroscope",s,t.Rotate);a.addActionButton(h),a.addActionButton(new o.ToolAction("Pan","bim-icon-pan",s,t.Pan)),a.addActionButton(new o.ToolAction("Walk","bim-icon-walk",s,t.Walk)),a.addActionButton(new o.ViewHistoryAction(s,!0)),a.addActionButton(new o.ViewHistoryAction(s,!1));var p=!0;if(p){var m,d,v=e.cesiumWidget.clock;n.isGeoreferenced?Cesium.defined(r.units)&&"imperial"==r.units?(m=f.formatLengthFeet,d=f.formatAreaSqFeet):(m=f.formatLengthMeters,d=f.formatAreaSqMeters):(m=f.formatLengthNoUnit,d=f.formatAreaNoUnit);var g=new o.ToolAction("Measure position","rd-icon-measure-position",s,t.MeasurePosition,function(){return new u(s,n,v,{formatLength:m})}),y=new o.ToolAction("Measure distance","rd-icon-measure-distance",s,t.MeasureDistance,function(){return new c(s,n,v,{formatLength:m})}),w=new o.ToolAction("Measure area","rd-icon-measure-area",s,t.MeasureArea,function(){return new l(s,n,v,{formatLength:m,formatArea:d})});if(a.addActionButton(g),a.addActionButton(y),a.addActionButton(w),!s.scene.pickPositionSupported){g.enabled=!1,y.enabled=!1,w.enabled=!1;var x=": this tool is not available because your browser does not support WEBGL_depth_texture";g.tooltipText+=x,y.tooltipText+=x,w.tooltipText+=x}}h.active=h.activate();var b=document.getElementsByClassName("cesium-viewer-fullscreenContainer");return a.cornerContainer.title="Toggle toolbars",a.cornerContainer.onclick=function(){var e="none"==a.topContainer.style.display?"block":"none";a.topContainer.style.display=e,a.leftContainer.style.display=e,1===b.length&&(b[0].style.display=e)},a}function m(e){a.call(this,e,t.Default)}function d(e){var t={};if(Cesium.defined(e.region))t.isGeoreferenced=!0,t.dataToGlobeTransform=Cesium.Matrix4.IDENTITY.clone(),t.globeToDataTransform=Cesium.Matrix4.IDENTITY.clone();else{var n;if(Cesium.defined(e.box)){var r=e.box;n=Cesium.Cartesian3.fromElements(r[0],r[1],r[2])}else if(Cesium.defined(e.sphere)){var i=e.sphere;n=Cesium.Cartesian3.fromElements(i[0],i[1],i[2])}var o=Cesium.Cartographic.fromCartesian(n);if(t.isGeoreferenced=o.height>-3e3&&o.height<9e3,t.isGeoreferenced)t.dataToGlobeTransform=Cesium.Matrix4.IDENTITY.clone(),t.globeToDataTransform=Cesium.Matrix4.IDENTITY.clone();else{var o=[-90,0,0],a=Cesium.Cartesian3.fromDegrees(o[0],o[1],o[2]);Cesium.Cartesian3.subtract(a,n,a),t.dataToGlobeTransform=Cesium.Matrix4.fromTranslation(a),Cesium.Cartesian3.negate(a,a),t.globeToDataTransform=Cesium.Matrix4.fromTranslation(a)}}return t}function v(e,t,n,r){if(Cesium.defined(e.box)){var o=e.box,a=Cesium.Cartesian3.fromElements(o[0],o[1],o[2]),s=Cesium.Cartesian3.fromElements(o[3],o[4],o[5]),u=Cesium.Cartesian3.fromElements(o[6],o[7],o[8]),c=Cesium.Cartesian3.fromElements(o[9],o[10],o[11]),l=[];l[0]=Cesium.Cartesian3.add(a,s,new Cesium.Cartesian3),l[1]=Cesium.Cartesian3.add(a,u,new Cesium.Cartesian3),l[2]=Cesium.Cartesian3.add(a,c,new Cesium.Cartesian3),l[3]=Cesium.Cartesian3.subtract(a,s,new Cesium.Cartesian3),l[4]=Cesium.Cartesian3.subtract(a,u,new Cesium.Cartesian3),l[5]=Cesium.Cartesian3.subtract(a,c,new Cesium.Cartesian3),a=Cesium.Matrix4.multiplyByPoint(t,a,a);var f=0;for(i=0;i<6;i++)l[i]=Cesium.Matrix4.multiplyByPoint(t,l[i],l[i]),f=Math.max(f,Cesium.Cartesian3.distance(a,l[i]));n.center=a,n.radius=f,r=Cesium.AxisAlignedBoundingBox.fromPoints(l,r)}else if(Cesium.defined(e.sphere)){var h=e.sphere,a=Cesium.Cartesian3.fromElements(h[0],h[1],h[2]);a=Cesium.Matrix4.multiplyByPoint(t,a,a);var f=h[3];n.center=a,n.radius=f;var p=new Cesium.Cartesian3(f,f,f);r.maximum=Cesium.Cartesian3.add(a,p,r.maximum),r.minimum=Cesium.Cartesian3.subtract(a,p,r.minimum)}}function g(e,t,n){if(Cesium.defined(t.root.boundingVolume)){var r={};r.referencing=d(t.root.boundingVolume);var i=new Cesium.BoundingSphere,o=new Cesium.AxisAlignedBoundingBox;v(t.root.boundingVolume,r.referencing.dataToGlobeTransform,i,o);var a=i.center,s=i.radius,u=r.referencing.isGeoreferenced?Cesium.Transforms.eastNorthUpToFixedFrame(a):Cesium.Matrix4.clone(r.referencing.dataToGlobeTransform);r.bimGeometryTransform=new Cesium.Matrix4,r.bimGeometryTransform.copyFrom(u);var c=2*i.radius,l=Cesium.Matrix4.getRotation(u,new Cesium.Matrix3);Cesium.Matrix3.transpose(l,l);var f=Cesium.Matrix3.fromRotationX(-1,new Cesium.Matrix3);Cesium.Matrix3.multiply(f,l,l);var h=Cesium.Matrix3.getRow(l,0,new Cesium.Cartesian3),p=Cesium.Matrix3.getRow(l,1,new Cesium.Cartesian3),m=Cesium.Matrix3.getRow(l,2,new Cesium.Cartesian3),g=Cesium.Cartesian3.add(i.center,Cesium.Cartesian3.multiplyByScalar(m,c,new Cesium.Cartesian3),new Cesium.Cartesian3),y=new Cesium.Cartesian3(a.x-s*(h.x+p.x+m.x),a.y-s*(h.y+p.y+m.y),a.z-s*(h.z+p.z+m.z)),w=new Cesium.Cartesian3(2*s,2*s,2*s);return extents={low:{x:o.minimum.x,y:o.minimum.y,z:o.minimum.z},high:{x:o.maximum.x,y:o.maximum.y,z:o.maximum.z}},r.bimDescription={categories:{1:"Uncategorized"},categorySelectors:{1:["1"]},defaultView:"1",displayStyles:{1:{backgroundColor:{blue:1,green:1,red:1}}},modelSelectors:{1:["1"]},models:{1:{extents:extents,name:e,tilesetUrl:n,type:"spatial"}},name:"Scene",projectExtents:extents,projectTransform:Cesium.Matrix4.toArray(r.bimGeometryTransform),views:{1:{categorySelector:"1",displayStyle:"1",extents:{x:w.x,y:w.y,z:w.z},eyePoint:{x:g.x,y:g.y,z:g.z},focusDistance:c,lensAngle:.8,modelSelector:"1",name:"Default view",origin:{x:y.x,y:y.y,z:y.z},rotation:Cesium.Matrix3.toArray(l),type:"camera"}}},r.referencing.isGeoreferenced?r.bimDescription.viewerOptions={displayInPlace:!0,imageryProvider:"ESRIWorldImagery",terrainProvider:"stk"}:r.bimDescription.viewerOptions={displayInPlace:!1},r}}s(a,m),m.prototype.onResetButtonDown=function(e){var t=n.createRotateTool(this.viewport,!1,!1);return t.InstallTool()},m.prototype.onDataButtonDown=function(e){var t=n.createPanTool(this.viewport,!1,!1);return t.installTool()};var y={loadConfig:function(t){var n=Cesium.when.defer(),r=this;return e("resources/"+t+".json",function(e,t){Cesium.defined(e)?n.reject(e):(r.config=t,n.resolve())}),n},startFromURL:function(t,n,r,i,a){document.title=Cesium.defined(a.title)?a.title:t.concat(" | ContextCapture Web Viewer 2.0 - Bentley Systems");var s=Cesium.when.defer();e(n,function(e,t){Cesium.defined(e)?s.reject(e):s.resolve(t)}),Cesium.when(s).then(function(e){var s=g(t,e,n),u=s.bimDescription,c=s.bimGeometryTransform,l=s.referencing;if(!Cesium.defined(u))return void i("Invalid dataset");var f=new o.Bim(u);Cesium.when(f.readyPromise).then(function(){var e={maximumScreenSpaceError:1,refineToVisible:!1},t=new o.BimGeometry(f,void 0,e);Cesium.when(t.readyPromise).then(function(){Cesium.defineProperties(o.BimGeometry.prototype,{rootTransform:{get:function(){return c}}});var e=t._primitives;for(var n in e)e[n].cesiumTileset._root.transform=l.dataToGlobeTransform;Cesium.BingMapsApi.defaultKey="",i(),f.geocoder=!1;var s=new o.Viewer(r,t,f.createBentleyViewerOptions());p(s,l,a),Cesium.defined(s.viewport.scene.globe)&&(s.viewport.scene.globe.depthTestAgainstTerrain=!1)},function(e){i("Failed to create scene geometry",e)})},function(e){i("Failed to create scene",e)})},function(e){i("Failed to load root of dataset",e)})},startFromID:function(e,t,n,i,o){var a=r.getTilesetNameAndURL(e,t,this.config.RDS),s=this;Cesium.when(a).then(function(e){s.startFromURL(e.Name,e.URL,n,i,o)},function(e){i("Failed to access dataset on ProjectWise ContextShare",e)})},run:function(e,t){var n=h(),r=n.id,i=n.projectId,o=Cesium.defined(n.config)?n.config:"config",a=this;Cesium.when(this.loadConfig(o)).then(function(){var o={};Cesium.defined(n.units)?o.units=n.units:Cesium.defined(a.config.units)&&(o.units=a.config.units),Cesium.defined(a.config.title)&&(o.title=a.config.title);var s;Cesium.defined(n.url)?s=n.url:Cesium.defined(a.config.url)&&(s=a.config.url);var u="Unknown";Cesium.defined(n.name)?u=n.name:Cesium.defined(a.config.name)&&(u=a.config.name),Cesium.defined(r)?a.startFromID(r,i,e,t,o):Cesium.defined(s)?a.startFromURL(u,s,e,t,o):t("No dataset is specified")},function(e){t("Failed to load application configuration",e)})}};return y}),define("scripts/App/App",["./ToolId","./ToolFactory","./main"],function(e,t,n){var r={ToolId:e,ToolFactory:t,main:n};return r});